(function(c){var g=window.AmazonUIPageJS||window.P,h=g._namespace||g.attributeErrors,a=h?h("WidgetStreamer",""):g;a.guardFatal?a.guardFatal(c)(a,window):a.execute(function(){c(a,window)})})(function(c,g,h){c.when("jQuery","widget-streamer-action-ws-append","widget-streamer-action-ws-prepend","widget-streamer-action-ws-update","widget-streamer-action-ws-event").register("widget-streamer-actions",function(a,d,e,b,f){var c={"ws-append":d,"ws-prepend":e,"ws-update":b,"ws-event":f},k={execute:a.noop};
return{create:function(f){var b,e,d;b=k;if(a.isArray(f)&&f.length&&f[0]){b=f[0];e=c[b];d="widget-streamer-action-"+b;if("function"!==typeof e)throw Error("Action: "+b+" is not supported. Register component "+d+" to handle this action");b=e(f)}return b}}});"use strict";c.register("widget-streamer-jquery-action",function(){return function(a,d,e){var b,f;if(!a||3>a.length)throw Error("Can not create update action, insufficient data in chunk: "+JSON.stringify(a));b=a[1];f=a[2];return{execute:function(a){var c=
a._$target.find(b).add(a._$target.filter(b));a._isTargetUpdated?e(c,f):d(c.get(0),f)}}}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-update",function(a){return function(d){return a(d,function(a,b){a.innerHTML=b},function(a,b){a.html(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-append",function(a){return function(d){return a(d,function(a,b){a.innerHTML+=b},function(a,b){a.append(b)})}});"use strict";c.when("widget-streamer-jquery-action").register("widget-streamer-action-ws-prepend",
function(a){return function(d){return a(d,function(a,b){a.innerHTML=b+a.innerHTML},function(a,b){a.prepend(b)})}});c.register("widget-streamer-action-ws-event",function(){return function(a){var d=a[1],c;try{c=JSON.parse(a[2])}catch(b){c=null}return{execute:function(a){a._emitEvent(d,c)}}}});"use strict";c.register("widget-streamer-utils",function(){return{isStreamingAjax:function(a){if(a&&"function"===typeof a.getResponseHeader)a=a.getResponseHeader("Content-Type");else if(a&&a.http&&"function"===
typeof a.http.getResponseHeader)a=a.http.getResponseHeader("Content-Type");else throw Error("Unable to retrive headers for the given xhr object: "+a);return"application/json-amazonui-streaming"===a}}});"use strict";c.when("A","jQuery","widget-streamer-actions").register("widget-streamer",function(a,c,e){function b(a){a=a||{};this._$originalTarget=a.$target;this._$target=a.$target.clone();this._actions=[];this._isExecutable="undefined"===typeof a.immediateExecution||a.immediateExecution;this._onUpdate=
a.onUpdate||c.noop;this._hasExecutionStarted=!1;this._events=a.events||{};this._isTargetUpdated=!1;this._updateTriggerEvent=a.updateTriggerEvent;this.chunkHandler=c.proxy(this.chunkHandler,this)}b.prototype.chunkHandler=function(a){a=e.create(a);this._actions.push(a);this.executeActions()};b.prototype.enableExecution=function(){this._isExecutable=!0;this.executeActions()};b.prototype.executeActions=function(){var a;if(this._isExecutable&&this._actions.length)for(this._hasExecutionStarted||(this._hasExecutionStarted=
!0,this._updateTriggerEvent||this._updateTarget()),a=this._actions.shift();a;)a.execute(this),a=this._actions.shift()};b.prototype._emitEvent=function(a,b){var e=(this._events||{})[a]||c.noop;a===this._updateTriggerEvent&&this._updateTarget(b);e.call(this,b)};b.prototype._updateTarget=function(){this._onUpdate.apply(this,arguments);this._$originalTarget.html(this._$target.html());this._$target=this._$originalTarget;this._isTargetUpdated=!0};return function(a){return new b(a)}})});
/* ******** */
(function(r){var q=window.AmazonUIPageJS||window.P,D=q._namespace||q.attributeErrors,na=D?D("CheckoutCommonAsset",""):q;na.guardFatal?na.guardFatal(r)(na,window):na.execute(function(){r(na,window)})})(function(r,q,D){r.register("polyfill-indexof",function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a,m){if(null==this)throw new TypeError('"this" is null or not defined');var k=Object(this),c=k.length>>>0;if(0===c)return-1;m=+m||0;Infinity===Math.abs(m)&&(m=0);if(m>=c)return-1;for(m=
Math.max(0<=m?m:c-Math.abs(m),0);m<c;){if(m in k&&k[m]===a)return m;m++}return-1})});"use strict";r.register("polyfill-filter",function(){Array.prototype.filter||(Array.prototype.filter=function(a){if(void 0===this||null===this)throw new TypeError;var m=Object(this),k=m.length>>>0;if("function"!==typeof a)throw new TypeError;for(var c=[],f=2<=arguments.length?arguments[1]:void 0,g=0;g<k;g++)if(g in m){var l=m[g];a.call(f,l,g,m)&&c.push(l)}return c})});"use strict";r.register("polyfill-json-stringify",
function(){"object"!==typeof JSON&&(JSON={});(function(){function a(a){return 10>a?"0"+a:a}function m(){return this.valueOf()}function k(a){h.lastIndex=0;return h.test(a)?'"'+a.replace(h,function(a){var b=t[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,e){var d,f,g=b,h,t=e[a];t&&"object"===typeof t&&"function"===typeof t.toJSON&&(t=t.toJSON(a));"function"===typeof z&&(t=z.call(e,a,t));switch(typeof t){case "string":return k(t);case "number":return isFinite(t)?
String(t):"null";case "boolean":case "null":return String(t);case "object":if(!t)return"null";b+=p;h=[];if("[object Array]"===Object.prototype.toString.apply(t)){f=t.length;for(a=0;a<f;a+=1)h[a]=c(a,t)||"null";e=0===h.length?"[]":b?"[\n"+b+h.join(",\n"+b)+"\n"+g+"]":"["+h.join(",")+"]";b=g;return e}if(z&&"object"===typeof z)for(f=z.length,a=0;a<f;a+=1)"string"===typeof z[a]&&(d=z[a],(e=c(d,t))&&h.push(k(d)+(b?": ":":")+e));else for(d in t)Object.prototype.hasOwnProperty.call(t,d)&&(e=c(d,t))&&h.push(k(d)+
(b?": ":":")+e);e=0===h.length?"{}":b?"{\n"+b+h.join(",\n"+b)+"\n"+g+"}":"{"+h.join(",")+"}";b=g;return e}}var f=/^[\],:{}\s]*$/,g=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,l=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,e=/(?:^|:|,)(?:\s*\[)+/g,h=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=m,Number.prototype.toJSON=m,String.prototype.toJSON=m);var b,p,t,z;"function"!==typeof JSON.stringify&&(t={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=
function(a,e,d){var f;p=b="";if("number"===typeof d)for(f=0;f<d;f+=1)p+=" ";else"string"===typeof d&&(p=d);if((z=e)&&"function"!==typeof e&&("object"!==typeof e||"number"!==typeof e.length))throw Error("JSON.stringify");return c("",{"":a})});"function"!==typeof JSON.parse&&(JSON.parse=function(a,b){function c(a,e){var d,f,p=a[e];if(p&&"object"===typeof p)for(d in p)Object.prototype.hasOwnProperty.call(p,d)&&(f=c(p,d),f!==D?p[d]=f:delete p[d]);return b.call(a,e,p)}a=String(a);d.lastIndex=0;d.test(a)&&
(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(f.test(a.replace(g,"@").replace(l,"]").replace(e,"")))return a=eval("("+a+")"),"function"===typeof b?c({"":a},""):a;throw new SyntaxError("JSON.parse");})})()});"use strict";r.when("A","jQuery","client-side-metrics","weblab-helper","polyfill-filter","polyfill-json-stringify").register("ajax-wrapper",function(a,m,k,c){function f(a,b){function e(a,b){for(var d=0;d<a._options.length;d++){var c=a._options[d];
if(c=b.call(a,c,"object"===typeof c?c.name:c))return c}}this._options=a instanceof f&&b&&b.length?a._options.concat(b):a instanceof f?a._options:a&&a.length?a:[];this.filter=function(a){var b={};e(this,function(e,d){d in a&&(b[d]=a[d])});return b};this.getOption=function(a){return e(this,function(b,d){if(d===a)return b})};return this}function g(a){this._options=a.allowedOptions;this._messageForViolation=a.messageForViolation;this._messageForViolationWithValue=a.messageForViolationWithValue;this._optionName=
a.optionName;this._valueName=a.valueName;this.validate=function(a){for(var b in a)if(a.hasOwnProperty(b)){var d=this._options.getOption(b);if(!d)throw d=this._messageForViolation.replace(this._optionName,b),Error(d);if("object"===typeof d&&!d.validate(a[b]))throw d=this._messageForViolationWithValue.replace(this._optionName,b),d=d.replace(this._valueName,a[b]),Error(d);}};return this}function l(a){try{C.validate(a)}catch(b){console.error(b)}var d=n.filter(a),d=m.extend(d,e(a));return m.ajax(d)}function e(a){if(a.params){if(a.data&&
a.params)throw Error("The option data can not be present with the emulated params option. Merge both and use just one.");return{data:a.params}}}function h(e){try{L.validate(e)}catch(f){console.error(f)}var n={url:D,options:u.filter(e)},h=new m.Deferred;n.url=e.url;if(e.data){if(e.data&&e.params)throw Error("Unsupported options. 'params' and 'data' options are both specified. Remove one of them.");if("object"===typeof e.data)n.options.params=e.data;else if("string"===typeof e.data)c.isSetParamsFormatAsStirngWeblabOn()?
"GET"===e.type?n.url+="?"+e.data:(n.options.params=e.data,n.options.paramsFormat="string"):n.url+="?"+e.data;else throw Error("Unsupported type provided in the 'data' attribute of an AJAX call");}if(e.type){if(e.type&&e.method)throw Error("Unsupported options. 'type' and 'method' options are both specified. Remove one of them.");n.options.method=e.type}if("crossDomain"in e){if("crossDomain"in e&&"withCredentials"in e)throw Error("Unsupported options. 'crossDomain' and 'withCredentials' options are both specified. Remove one of them.");
n.options.withCredentials=e.crossDomain}n=b(n,e,h);n=d(n,e,h);n=t(n,e,h);n=p(n,e,h);n=z(n,e,h);e.beforeSend&&e.beforeSend(n.options);n=y(n,e,h);e=a.ajax(n.url,n.options);return e=h.promise(e)}function d(a,b,e){var d=a.options.success;a.options.success=function(a,b,c){d&&d(a,b,c);e.resolve(a,b,c)};var c=a.options.error;a.options.error=function(a,b,d){c&&c(a,b,d);e.reject(a,b,d)};var f=a.options.abort;a.options.abort=function(a){f&&f(a);e.reject(a,"abort")};return a}function b(a,b){if(!b.complete)return a;
var e=a.options.success;a.options.success=function(a,d,c){e&&e(a,d,c);b.complete(c,"success")};var d=a.options.error;a.options.error=function(a,e,c){d&&d(a,e,c);b.complete(a,"error")};var c=a.options.abort;a.options.abort=function(a){c&&c(a);b.complete(a,"abort")};return a}function p(a,b){var e=a.options.success;a.options.success=function(a,d,c){e&&("text"===b.dataType&&"object"===typeof a&&(a=JSON.stringify(a)),e(a,d,c))};return a}function t(a,b){if(!b.useXMLHttp)return a;var e=a.options.success;
a.options.success=function(a,b,d){d&&(d=d.http);e(a,b,d)};var d=a.options.error;a.options.error=function(a,b,e){a&&(a=a.http);d(a,b,e)};var c=a.options.abort;a.options.abort=function(a){a&&(a=a.http);c(a)};return a}function z(a,b){var e=a.options.success;a.options.success=function(a,b,d){d&&304===d.http.status?e(a,"notmodified",d):e(a,"success",d)};var d=a.options.error;a.options.error=function(a,b,c){a&&a.http.readyState<v.DONE?d(a,"timeout",c):a&&200<=a.http.status&&300>a.http.status&&a.http.readyState===
v.DONE?e(a.http.responseText,"success",a):a&&0==a.http.status?d(a,"abort",c):d(a,"error",c)};return a}function y(a,b){var e=a.options.success;a.options.success=function(a,b,d){w(d,"success");e(a,b,d)};var d=a.options.error;a.options.error=function(a,b,e){w(a,"error");d(a,b,e)};return a}function w(a,b){a?(k.increaseCount("AUI:Ajax:"+b+":xhr:defined"),a.http?k.increaseCount("AUI:Ajax:"+b+":xhr:http:defined"):a.http===D?k.increaseCount("AUI:Ajax:"+b+":xhr:http:undefined"):null===a.http&&k.increaseCount("AUI:Ajax:"+
b+":xhr:http:null")):a===D?k.increaseCount("AUI:Ajax:"+b+":xhr:undefined"):null===a&&k.increaseCount("AUI:Ajax:"+b+":xhr:null")}var v={UNSET:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},n=new f("accepts async beforeSend cache complete contents contentType context converters crossDomain data dataFilter dataType error global headers ifModified isLocal jsonp jsonpCallback method mimeType password processData scriptCharset statusCode success timeout traditional type url username xhr xhrFields".split(" ")),
u=new f("abort accepts cache chunk contentType error headers indicator method params success timeout withCredentials".split(" ")),K=new f(u,[{name:"async",validate:function(a){return a}},"useXMLHttp","beforeSend","complete","crossDomain","dataType","data","type","url"]),A=new f(n,["params"]),L=new g({allowedOptions:K,messageForViolation:"The option %O is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in AUI ajax calls and default ajax. Consider using jQuery ajax.",
optionName:"%O",valueName:"%V"}),C=new g({allowedOptions:A,messageForViolation:"The option %O is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",messageForViolationWithValue:"The option %O with value %V is not supported in jQuery ajax calls and default ajax. Consider using AUI ajax.",optionName:"%O",valueName:"%V"}),H=m("meta[name\x3ddefaultAJAX]").attr("content");"jQuery"!==H&&"AUI"!==H&&(H="jQuery");return{default:function(a){try{L.validate(a),C.validate(a)}catch(b){console.error(b)}if("jQuery"===
H)l(a);else if("AUI"===H)h(a);else throw Error("Unknown AJAX method: "+H);},jQuery:l,aui:h,READY_STATE:v}});"use strict";r.when("jQuery").register("weblab-helper",function(a){return{isAJAXWeblabOn:function(){return"1"===a("meta[name\x3dPAGE_CONDUCTOR_AUI_AJAX]").attr("content")},isAjaxStreamingEnabled:function(){return"1"===a("meta[name\x3dENABLE_AJAX_STREAMING]").attr("content")},isNavCFWeblabOn:function(){return"1"===a("meta[name\x3dEMIT_NAV_CF]").attr("content")},isFixExtraPspPrefetchEnabled:function(){return"1"===
a("meta[name\x3dFIX_EXTRA_PSP_PREFETCH]").attr("content")},isRemoveOrderSummaryPrimaryActionBtnTextWeblabOff:function(){return"1"!==a("#is-remove-os-pabt").val()},isSetParamsFormatAsStirngWeblabOn:function(){return"1"===a("meta[name\x3dSET_PARAMS_FORMAT_AS_STRING]").attr("content")},disablePrefetchForScheduledDeliveryWeblabOn:function(){return"1"===a("meta[name\x3dDISABLE_PREFETCH_FOR_SCHEDULED_DELIVERY]").attr("content")},isRemoveAddressFormOnDeleteAddressWeblabOn:function(){return"1"===a("meta[name\x3dREMOVE_ADDRESS_FORM_ON_DELETE_ADDRESS]").attr("content")},
isSOSPExclusiveJSHandlerWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_EXCLUSIVE_JS]").attr("content")},sospPartialAvailabilityWeblabOn:function(){return"1"===a("meta[name\x3dSOSP_PARTIAL_UNAVAILABILITY]").attr("content")},refactorExtractURL:function(){return"1"===a("meta[name\x3dREFACTOR_EXTRACT_URL]").attr("content")},showGiftTextAreaOnWarning:function(){return"1"===a("meta[name\x3dSHOW_GIFT_TEXT_AREA_ON_WARNING]").attr("content")},isInterceptionAddressFormWidthFixEnabled:function(){return"1"===
a("meta[name\x3dFIX_FIELD_WIDTH_IN_CHECKOUT_INTERCEPTION_FIX_ENABLED]").attr("content")},removesGiftOptionOnRush:function(){return"1"===a("meta[name\x3dREMOVE_GIFT_OPTION_RUSH]").attr("content")},isSPCMobileDisplayMoreShipOptionsEnabled:function(){return"1"===a("meta[name\x3dSPC_MOBILE_DISPLAY_MORE_SHIP_OPTIONS]").attr("content")},isMCBMultiTenderWeblabEnabled:function(){return"1"===a("meta[name\x3dMCB_MULTI_TENDER_ENABLED]").attr("content")},isCreateAddressLinkForTaxAddressFormWeblabOn:function(){return"1"===
a("meta[name\x3dCREATE_ADDRESS_IN_TAX_COLLECTION_ENABLED]").attr("content")},isClearTemporaryPreferenceBugFixWeblabOn:function(){return"1"===a("meta[name\x3dSWP_CLEAR_TPP_BUG_FIX]").attr("content")},isMfaPSD2DeviceDescriptionCollectionEnabled:function(){return"1"===a("meta[name\x3dMFA_PSD2_DEVICE_DESCRIPTION_COLLECTION_ENABLED]").attr("content")},isSospCalendarFixEnabled:function(){return"1"===a("meta[name\x3dSOSP_CALENDAR_FIX]").attr("content")},isUpdateMobileNumberEnabled:function(){return"1"===
a("meta[name\x3dUPDATE_MOBILE_NUMBER]").attr("content")},isGILCreditCardEnabled:function(){return"1"===a("meta[name\x3dGIL_CREDIT_CARD_PAYMENT_METHOD]").attr("content")},isFTCMobileUpsellBannerMetricsEnabled:function(){return"1"===a("meta[name\x3dFTC_MOBILE_UPSELL_BANNER_METRICS_ENABLED]").attr("content")},isRefreshPageStateEnabled:function(){return"1"===a("meta[name\x3dPAGE_STATE]").attr("content")},isPyoClientSideInitiationEnabled:function(){return"1"===a("meta[name\x3dPYO_CLIENT_SIDE_INITIATION]").attr("content")},
isNoshiGiftMessageEnabled:function(){return"1"===a("meta[name\x3dGCX_ENABLE_NOSHI_GIFT_MESSAGE]").attr("content")},isSppItemSelectPageTypeFixEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SPP_ITEMSELECT_PAGETYPE_FIX_ENABLED]").attr("content")},isFixTfxCurrencyToggleEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_FIX_TFX_CURRENCY_TOGGLE_ENABLED]").attr("content")},isFreshMobileNoScrollOnRefreshEnabled:function(){return"1"===a("meta[name\x3dF3_CHECKOUT_MOBILE_NO_SCROLL_TO_TOP]").attr("content")},
isCSMErrorLoggingEnabled:function(){return"1"===a("meta[name\x3dENABLE_CSM_ERROR_LOGGING]").attr("content")},isCSMATLoggingEnabled:function(){return"1"===a("meta[name\x3dENABLE_CSM_AT_LOG]").attr("content")},isSOSPLinkPatchEnabled:function(){return"1"===a("meta[name\x3dRCX_CHECKOUT_SOSP_NAV]").attr("content")},isExecutionIdInQueryStringEnabled:function(){return"1"===a("meta[name\x3dADD_EXECUTION_ID_TO_QUERY_STRING]").attr("content")}}});"use strict";r.when("A","client-side-metrics").register("weekend-availability-expander-helper",
function(a,m){function k(a){return(a=l[a])?g("#weekend-availability-expander-header-text-"+a).text():g("#weekend-availability-default").text()}function c(){return 1==g("input[name\x3d'isBusinessDefaultWeekendDeliveryEnabled']").attr("value")?!0:!1}function f(a,c){return a&&c?"BOTH":a?"SAT":c?"SUN":"NONE"}var g=a.$,l={BOTH:"both",SAT:"sat",SUN:"sun",NONE:"none"};return{isBusinessDefaultWeekendDeliveryViewActive:c,logExpanderState:function(a,c,d,b){m.increaseCount("checkout:delivery-preferences:"+a+
":expander:"+c+":"+(d&&b?"neverExpanded":b?"collapsed":"expanded"),1)},stateToCheckboxes:function(a){var f=!1,d=!1;if(c()){if("BOTH"===a||"SAT"===a)f=!0;if("BOTH"===a||"SUN"===a)d=!0}else{if("BOTH"===a||"OTH"===a||"SAT"===a)f=!0;if("BOTH"===a||"OTH"===a||"SUN"===a)d=!0}return{isSaturdayChecked:f,isSundayChecked:d}},updateAllOptOutMessages:function(a){1==g("input[name\x3d'isSundayDeliveryPreferenceSuppressed']").attr("value")?a.isSaturdayChecked?g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",
!0):(g(".weekend-availability-opt-out-message").text(g("#weekend-availability-opt-out-sat-text").text()),g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):a.isSaturdayChecked||a.isSundayChecked?a.isSaturdayChecked?a.isSundayChecked?g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0):(g(".weekend-availability-opt-out-message").text(g("#weekend-availability-opt-out-sun-text").text()),g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(g(".weekend-availability-opt-out-message").text(g("#weekend-availability-opt-out-sat-text").text()),
g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1)):(g(".weekend-availability-opt-out-message").text(g("#weekend-availability-opt-out-both-text").text()),g(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!1))},updateAllTitles:function(a){a=f(a.isSaturdayChecked,a.isSundayChecked);g(".sat-sun-expander-heading-text").text(k(a))},updateAllWeekendAvailabilityStates:function(a){a=f(a.isSaturdayChecked,a.isSundayChecked);g("input[name\x3d'BusinessHours']").attr("value",a)}}});
"use strict";r.when("A","loading-spinner-controller","page-transition-controller","page-conductor","checkout-general-utils","address-utilities","page-detector-current-page","client-side-metrics","weblab-helper").register("address-popovers",function(a,m,k,c,f,g,l,e,h){function d(a){a.getResponseHeader("x-amz-checkout-popover-valid")||c.redirect({conductoraction:{url:"/gp/cart/view.html",type:"redirect"}})}function b(b,n,p){f.protectAgainstDoubleAction("show-add-address-popover",200)||(H=b.popover,
!C('input[name\x3d"preloadAddressPopover"]').length||n.is(":empty")?(n.empty(),n.css("min-height",397),H.updatePosition(!0),m.showSpinner(n,!1,H),b=(new Date).getTime(),p=l.getCurrentPage(),e.increaseCount("checkout:address-popover-pagetype:".curPage,1),p="itemselect"===p||"spp-itemselect"===p&&h.isSppItemSelectPageTypeFixEnabled()?1:0,C.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/display.html?cachebuster\x3d"+b,data:{isBilling:M,isMultiAddress:p},async:!0,cache:!1,headers:{"x-amz-checkout-page":"itemselect"},
success:function(a,b,e){d(e);n.css("min-height",0);u(n,a)},error:c.ajaxRedirect})):(g.customizeFormFromIdentity(n),g.countrySpecificPopoverOptimizationCheck(C("html")),p&&a.trigger("identity-assets")))}function p(a,b){if(!f.protectAgainstDoubleAction("add-new-address",200)){e.resetMetrics();var n=!1;C(".identity-protect-from-errant").each(function(){var a=C(this),a=a.is("input")?a:a.find("input:first");-1!==a.val().search(/(\d[ -]?){13}/)&&(n=!0)});if(n){var p=C(".address-form-security-error:first");
p.length?alert(p.text()):alert("Please check that the address you have entered is correct.")}else{b.$event.preventDefault();m.showSpinner(a,!1,H);var h=C("#domestic-address-popover-form, #international-address-popover-form, #address-popover-suggestions-form").filter(":visible"),p=h.serialize(),g=(new Date).getTime();b=b.$currentTarget.find('input[type\x3d"submit"]').attr("name");"useSelectedAddress"===b?p+="\x26fromSuggestionPage\x3d1":"fromAddressEditToContinue"===b&&(p+="\x26fromAddressEditToContinue\x3d1");
C("#addAddressOnly").length&&(p+="\x26addOnly\x3d1");M&&(p+="\x26isBilling\x3d1");var l="/gp/buy/addressselect/handlers/popover/new.html";if(H){if("domestic-address-popover-form"===h.attr("id")&&(h.find(".enterAddressFormField").blur(),h="#"+a.attr("id")+" div[id^\x3donblur-character-validation-error-]",0<C(h).size())){m.hideSpinner(a);return}l+="/ref\x3dchk_addr_editPopoverSubmit";c.isSPP()&&(H.lock(11),setTimeout(function(){H.unlock(12)},2E3))}var k=null!==q&&q!==D&&null!==P&&P!==D;"useSelectedAddress"===
b&&!M&&k&&(p+="\x26fromSTMAPopover\x3d1");C("#international-address-popover-form").filter(":visible").length&&(p+="\x26showSecondaryForm\x3d1");A()&&Q?t(a,g,p):C.ajax({type:"POST",url:l+"?cachebuster\x3d"+g,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:p,async:!0,cache:!1,error:c.ajaxRedirect,success:function(b,e,f){c.isSPP()&&H.unlock(12);d(f);f.getResponseHeader("x-amz-checkout-open-new-popover")?y(b,e,f):f.getResponseHeader("x-amz-checkout-reload-popover")?u(a,b):k?w(f):
v("added",f)}})}}}function t(a,b,e){var n=Q.getNewTaxAddressPopoverURL();C.ajax({type:"POST",url:n+"?cachebuster\x3d"+b,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8",data:e,async:!0,cache:!1,error:c.ajaxRedirect,success:function(b,e,n){c.isSPP()&&H.unlock(12);d(n);n.getResponseHeader("x-amz-checkout-reload-popover")?u(a,b):n.getResponseHeader("x-amz-checkout-new-address-id")&&(C(".a-button-close").trigger("click"),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"),
b=n.getResponseHeader("x-amz-checkout-new-address-id"),Q.submitTaxAddressFormWithNewAddressId(b))}})}function z(a){if(!f.protectAgainstDoubleAction("show-edit-address-popover",200)){var b=C("#address-suggestions-popover");a.$event.preventDefault();m.showSpinner(b,!1,H);a=C("#address-popover-suggestions-form");var e=a.serialize();a.find('input[type\x3d"radio"]').each(function(){var a=C(this);a.attr("checked")&&(e+="\x26edit_"+a.val()+"\x3d1")});M&&(e+="\x26isBilling\x3d1");H&&c.isSPP()&&(H.lock(11),
setTimeout(function(){H.unlock(12)},2E3));a=(new Date).getTime();C.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+a,data:e,async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,b,e){c.isSPP()&&H.unlock(12);d(e);y(a,b,e)}})}}function y(b,d,e){C('input[name\x3d"preloadAddressPopover"]').remove();d=e.getResponseHeader("x-amz-checkout-open-new-popover");"suggestions"===d?(C("#address-suggestions-popover").empty().append(b),C("#address-suggestions-popover-link").trigger("click")):
"edit"===d&&(G=1,d=C("#edit-address-popover"),d.empty().append(b),C("#edit-address-popover-link").trigger("click"),u(d,b));a.trigger("identity-assets")}function w(a){a=a.getResponseHeader("x-amz-checkout-new-address-id");var b=(new Date).getTime();C.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html?cachebuster\x3d"+b,data:{action:"update-address",lineitems:q,quantities:P,addresses:a+".home..",returnHTML:0},async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,b,d){v("applied",d)}})}
function v(b,d){var e=(new Date).getTime();C('input[name\x3d"shipToAddress"]').length?(b=function(){c.isSPP()?(k.blockAllActions(),k.shrinkPanel(C(".spp-panel.expanded"),!0)):k.show()},c.isNonBlockingAnimationEnabled()?a.delay(b,0):b(),b=l.getCurrentPage(),c.loadPage(b,"",D,{refTag:"chk_addr_editPopoverSubmit"},D,d)):(d=c.setAjaxTransitionHeader(),C.ajax({type:"POST",headers:d,url:"/gp/buy/shared/handlers/pipeline-dispatch.html?cachebuster\x3d"+e,data:{useCase:"multiAddress",showAddressAdded:b,page:"itemselect"},
dataType:"text",async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,b,d){c.ajaxUpdatePage(a,b,d);C(".a-button-close").trigger("click");f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}}))}function n(a){a=C("#"+a);a.length&&a.empty()}function u(b,d){b.html(d);g.customizeFormFromIdentity(b);H.updatePosition(!0);a.trigger("identity-assets");g.countrySpecificPopoverOptimizationCheck(C("html"))}function K(a){a=a.$currentTarget.closest(".lineitem");q=a.find('input[name^\x3d"lineItemEntityID."]').val();
P=a.find('input[name^\x3d"quantity."]').val();a=C("#add-address-popover-link");a.length?a.trigger("click"):C("#add-new-address-popover").trigger("click")}function A(){return h.isCreateAddressLinkForTaxAddressFormWeblabOn()&&0<C("#isTaxAddress").length}function L(){M=C("#isBilling").length?1:0;if(h.isInterceptionAddressFormWidthFixEnabled()){var a=C(".enter-address-form");g.customizeFormFromIdentity(a)}}var C=a.$,H,q,P,G=0,M=0,Q=null;if(!C("html").hasClass("a-ie6"))return a.on("a:popover:show:add-address",
function(a){n("edit-address-popover");n("add-billing-address-popover");M=0;b(a,C("#add-address-popover"),!1)}),a.on("a:popover:show:add-billing-address",function(a){n("edit-address-popover");n("add-address-popover");b(a,C("#add-billing-address-popover"),!0)}),a.on("a:popover:show:address-suggestions",function(a){H=a.popover}),a.on("a:popover:show:edit-address",function(a){H=a.popover;if(f.protectAgainstDoubleAction("show-edit-address-popover",200)||G)G=0;else{var b=C("#edit-address-popover"),e=H.$trigger.closest(".address-edit-link").find("a").attr("href");
b.empty();n("add-address-popover");n("add-billing-address-popover");var p=C("#delete-address-popover-button");p.length&&p.addClass("aok-hidden").addClass("a-disabled");a.popover.updatePosition(!0);m.showSpinner(b,!1,H);a=(new Date).getTime();C.ajax({type:"POST",url:e+"\x26cachebuster\x3d"+a,async:!0,cache:!1,success:function(a,e,c){d(c);u(b,a);p.length&&C("#delete-address-button").length&&p.removeClass("aok-hidden").removeClass("a-disabled")},error:c.ajaxRedirect})}}),a.on("a:popover:show:select-billing-address",
function(b){if(!f.protectAgainstDoubleAction("show-select-billing-address-popover",200)){var e=C("#select-billing-address-popover");e.empty();e.css("min-height",250);b.popover.updatePosition(!0);m.showSpinner(e,!1,b.popover);var p=(new Date).getTime(),h="/gp/buy/billingaddressselect/handlers/popover.html";c.isSPP()&&(h+="/ref\x3dchk_pay_billing_change_coll");n("add-billing-address-popover");C.ajax({type:"POST",url:h+"?cachebuster\x3d"+p,async:!0,cache:!1,success:function(c,f,n){d(n);e.html(c);a.trigger("checkout:reload:spp-billing-address");
e.css("min-height",0);b.popover.updatePosition(!0)},error:c.ajaxRedirect})}}),a.on("a:expander:delivery-expander:toggle:expand",function(a){a=C(".a-expander-content");g.fixOverflow(a)}),a.declarative("close-delete-popover",["click","touchend"],function(a){r.when("a-popover-base").execute(function(b){(b=b.get(a.data.popoverName))&&b.hide()})}),a.declarative("rm-address-action",["click","touchend"],function(a){r.when("a-popover-base").execute(function(b){(b=b.get(a.data.popoverName))&&b.hide()});h.isRemoveAddressFormOnDeleteAddressWeblabOn()&&
(n("edit-address-popover"),n("add-address-popover"),n("add-billing-address-popover"));r.when("page-conductor").execute(function(b){b.continueClicked(null,a.$target)})}),a.declarative("select-billing-address-action",["click","touchend"],function(a){r.when("a-popover-base").execute(function(a){a.get("select-billing-address").hide()});r.when("page-conductor").execute(function(b){b.continueClicked(null,a.$target)})}),C(document).delegate("a.prevent-default-marker","click",function(a){a.preventDefault()}),
a.declarative("select-billing-address-in-popover",["click","touchend"],function(a){r.when("a-popover-base").execute(function(a){(a=a.get("select-billing-address"))&&a.hide()})}),a.declarative("trigger-popover-from-link",["click","touchend"],function(a){f.protectAgainstDoubleAction("trigger-popover-from-link",200)||(P=q=null,C("#add-address-popover-link").trigger("click"))}),a.declarative("add-address-popover-submit",["click","touchend"],function(a){p(C("#add-address-popover"),a)}),a.declarative("add-billing-address-popover-submit",
["click","touchend"],function(a){p(C("#add-billing-address-popover"),a)}),a.declarative("edit-address-popover-submit",["click","touchend"],function(a){p(C("#edit-address-popover"),a)}),a.declarative("address-suggestions-submit",["click","touchend"],function(a){p(C("#address-suggestions-popover"),a)}),a.declarative("delete-address-popover-submit",["click","touchend"],function(a){a=C("#delete-address-button");0<a.length&&a.click()}),a.declarative("edit-address-suggestions",["click","touchend"],z),a.declarative("add-address-popover-edit",
["click","touchend"],function(a){if(!f.protectAgainstDoubleAction("add-address-popover-edit",200)){a.$event.preventDefault();var b=C("#add-address-popover");m.showSpinner(b,!1,H);a=C("#address-popover-suggestions-form").serialize()+"\x26"+a.$currentTarget.find('input[type\x3d"submit"]').attr("name")+"\x3d1";var e=(new Date).getTime();C.ajax({type:"POST",url:"/gp/buy/addressselect/handlers/popover/edit.html?cachebuster\x3d"+e,data:a,async:!0,cache:!1,error:c.ajaxRedirect,success:function(a,e,c){d(c);
u(b,a)}})}}),a.declarative("add-address-popover-toggle",["click","touchend"],function(a){f.protectAgainstDoubleAction("add-address-popover-toggle",200)||(a.$event.preventDefault(),a=a.$currentTarget.closest(".enter-address-form"),g.toggleAddressForm(a,a.siblings(".enter-address-form")))}),a.declarative("select-radio-option",["click","touchend"],function(a){a=a.$currentTarget.find(".radio-option");a.find('input[type\x3d"radio"]').attr("checked","checked");a.closest(".radio-option-list").find(".radio-option").removeClass("radio-option-selected");
a.addClass("radio-option-selected")}),a.declarative("trigger-address-popover",["click","touchend"],function(a){f.protectAgainstDoubleAction("trigger-address-popover",200)||C("#add-address-popover-link").trigger("click")}),a.on("checkout:reload:spp-shipaddress",L),a.on("checkout:reload:spp-billing-address",L),a.on("checkout:reload:itemselect",L),a.on("checkout:reload:spp-itemselect",L),{actionTriggerPopoverFromDropdown:K,actionRegisterTaxAddressController:function(a){A()&&!Q&&a&&(Q=a)}}});"use strict";
r.when("A").register("address-book-controller",function(a){function m(){k("div.address-book").unbind("recalculate-address-height").bind("recalculate-address-height",function(){var a,f=k(),g=0,l=k("div.address-book .js-same-height"),e=l.length;l.css({height:"auto"}).each(function(h){var d=k(this);a=a||d.offset().top;a!==d.offset().top&&(f.height(g),f=k(),g=0,a=d.offset().top);var b=d.height();f=f.add(d);b>g&&(g=b);h===e-1&&0<g&&f.height(g)})}).trigger("recalculate-address-height");k(q).unbind("resize.checkout-as").bind("resize.checkout-as",
function(){k("div.address-book").trigger("recalculate-address-height")})}var k=a.$;a.on("checkout:reload:spp-shipaddress",m);a.on("checkout:reload:shipaddressselect",m);a.on("checkout:reload:billingaddressselect",m);a.on("checkout:reload:spp-billing-address",m)});"use strict";r.when("A","client-side-metrics","weblab-helper").register("address-utilities",function(a,m,k){function c(a){a.find("input").each(function(){var a=e(this),b=a.outerWidth(!0),c=a.parent().outerWidth(!0);b>c&&a.attr("size")&&(document.getElementById(a.attr("id")).removeAttribute("size"),
a.width("100%"))})}function f(a){if(e('input[name\x3d"useLiveAUI"]').length)r.when("p-detect").execute(function(b){b.capabilities.inputPlaceholder&&a.find(".field-description").each(function(){var a=e(this),b=a.text(),d=a.closest(".a-col-right").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");d.attr("maxlength")<b.length&&d.attr("size",b.length);d.attr("placeholder",a.text())})}),a.find("input").each(function(){e(this).outerWidth()}),a.find("input[type\x3d'text'], select").each(function(){var a=
e(this).closest(".full-width-config"),b=e(this);0===a.find(".a-popover-trigger").length&&(k.isInterceptionAddressFormWidthFixEnabled()?b.addClass("addressform-textfield-width"):b.width("96%"))});else{r.when("p-detect").execute(function(b){b.capabilities.inputPlaceholder?a.find(".field-description").each(function(){var a=e(this),b=a.text(),d=a.closest(".a-column").find(":not(.address-form-skip-js-tweaks):not(.address-form-skip-js-tweaks *) input");d.attr("maxlength")<b.length&&d.attr("size",b.length);
d.attr("placeholder",a.text())}):a.find(".field-description").each(function(){var a=e(this);a.find("br").remove();a.show()})});a.find(".popover-field-label").each(function(){var a=e(this);a.find("b").each(function(){var a=e(this);a.text(e.trim(a.text()))});a.find("font").each(function(){var a=e(this);"-2"===a.attr("size")&&a.remove()})});var d=e(".enter-address-form");c(d);var b=0,d=a.find(".one-new-address-form-field").first();d.length&&d.find(".a-column").each(function(){b+=e(this).outerWidth()});
a.width(0<b?b:"")}}function g(e){function d(){k=c.val();(v=l[k])&&f.find(".learn-more a").text(v.popOverLinkText)}var b=q.P&&q.P.AUI_BUILD_DATE,c=e.find("#enterAddressCountryCode"),f=e.find(".country-specific-form-input"),g,l;b?(g=f.find("input"),l=e.find(".country-specific-config").data("popovercountryconfig")):(m.increaseCount("removeauijs2"),g=f.find("#"+f.data("inputid")),l=f.find(".country-specific-config").data("popovercountryconfig"));if(c.length&&f.length&&g.length&&l){var k=c.val(),v=l[k];
c.unbind("change.countryChangeConfigUpdate").bind("change.countryChangeConfigUpdate",d);d();var n=b?"show":"beforeShow";a.on("a:popover:"+n+":checkout-"+f.data("inputid")+"Name",function(a){"beforeShow"===n&&m.increaseCount("removeauijs3");v&&(a.popover.$popover.find(".a-popover-header h4").html(v.popOverTitle),a.popover.$popover.find(".a-popover-inner").html(v.popOverText),a.popover.updatePosition())})}}function l(a){function d(){var a=c.val();(a=l[a])?(a=(a=a.label)||"",g.attr("placeholder",e("\x3cdiv /\x3e").html(a).text().replace(":",
"")),f.show()):f.hide()}var b=q.P&&q.P.AUI_BUILD_DATE,c=a.find("#enterAddressCountryCode"),f=a.find(".country-specific-form-input-mobile"),g,l;b?(g=f.find("input"),l=a.find(".country-specific-config").data("labelcountryconfig")):(m.increaseCount("removeauijs3"),g=f.find("#"+f.data("inputid")),l=f.find(".country-specific-config").data("labelcountryconfig"));c.length&&f.length&&g.length&&l&&(c.unbind("change.countryChangeLabelUpdate").bind("change.countryChangeLabelUpdate",function(){f.hasClass("initial-edit-value")?
f.removeClass("initial-edit-value"):g.val("");d()}),d())}var e=a.$;r.when("a-checkbox").execute(function(e){a.declarative("delivery-preferences-weekend-availability-checkbox-triggered","click",function(a){if("undefined"!==typeof a.$target){var b=a.$target.val();a.$target.is(":checked")&&("NONE"===b?(e("#delivery-preferences-weekend-availability-sat").uncheck(),e("#delivery-preferences-weekend-availability-sun").uncheck()):"SAT"!==b&&"SUN"!==b||e("#delivery-preferences-weekend-availability-none").uncheck())}})});
a.declarative("wdp-redesign-addresstype-radio-clicked","click",function(a){var d=a.$target.context.id;a=e(".com-businesshours-text");var b=e("#delivery-preferences-weekend-availability-sat").is(":checked"),c=e("#delivery-preferences-weekend-availability-sun").is(":checked");"devyPrefs_AddressType_COM"===d?(m.increaseCount("WDPTotalCOMClick"),e(".wdp-res").removeClass("a-color-base-background").addClass("a-color-alternate-background"),e(".wdp-com").removeClass("a-color-alternate-background").addClass("a-color-base-background"),
e(".wdp-BusinessHours").removeClass("aok-hidden")):"devyPrefs_AddressType_RES"===d?(m.increaseCount("WDPTotalRESClick"),e(".wdp-com").removeClass("a-color-base-background").addClass("a-color-alternate-background"),e(".wdp-res").removeClass("a-color-alternate-background").addClass("a-color-base-background"),e(".wdp-BusinessHours").addClass("aok-hidden")):"delivery-preferences-weekend-availability-sat"===d?(m.increaseCount("WDPTotalSATClick"),d=b?c?"BOTH":"SAT":c?"SUN":"OTH",a.addClass("aok-hidden"),
e(".com-businesshours-"+d).removeClass("aok-hidden")):"delivery-preferences-weekend-availability-sun"===d&&(m.increaseCount("WDPTotalSUNClick"),d=c?b?"BOTH":"SUN":b?"SAT":"OTH",a.addClass("aok-hidden"),e(".com-businesshours-"+d).removeClass("aok-hidden"))});return{toggleAddressForm:function(a,d){a.hide();d.find("div.a-alert-error:not(.js-originally-shown-imb)").hide();a.find("input[type\x3d'text'], select, input[type\x3d'radio']:checked, input[type\x3d'hidden']").each(function(){var a=e(this),c=a.attr("name")||
a.data("copyto")||a.attr("id");if(!a.is(":disabled")&&!a.find(":selected").is(".js-not-a-value")){var f=d.find("input[name\x3d'"+c+"']");"enterAddressLandmark"===c&&(f=d.find("input[name\x3d'Landmark']"));"Landmark"!==c||f.length||(f=d.find("input[name\x3d'enterAddressLandmark']"));1<f.length&&a.is("input[type\x3d'radio']")?f.filter("[value\x3d'"+a.val()+"']").attr("checked",!0):f.is("select")?f.find("option[value\x3d'"+a.val()+"']").attr("selected",!0):a.is("input[type\x3d'hidden']")||f.is("input[type\x3d'hidden']")||
f.val(a.val())}});d.show();c(d);f(d)},customizeFormFromIdentity:f,fixOverflow:c,countrySpecificLabelOptimizationCheck:function(a){var d=a.find(".enter-address-form");1===d.data("taxidOpt")?setTimeout(function(){l(d)},100):l(d)},countrySpecificPopoverOptimizationCheck:function(a){var d=a.find(".enter-address-form");1===d.data("taxidOpt")?setTimeout(function(){g(d)},100):g(d)}}});"use strict";r.when("A","page-conductor","page-transition-controller","client-side-metrics").register("address-form-helper",
function(a,m,k,c){var f=a.$;a.on("a:popover:afterUpdatePosition:edit-address",function(c){c.popover&&c.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:edit-address",c.popover)});a.on("a:popover:afterUpdatePosition:add-address",function(c){c.popover&&c.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",c.popover)});a.on("a:popover:visible:add-address",function(c){c.popover&&c.popover.isVisible()&&a.trigger("checkout:popoverContentLoaded:add-address",c.popover)});
return{setDestination:function(a){a||(c.increaseCount("checkout:addressForm:setDestination:noRequest",1),a={});var l=a.addressId;l||c.increaseCount("checkout:addressForm:setDestination:noAddressId",1);var e=a.purchaseId||f("input[name\x3d'purchaseId']").val();e||c.increaseCount("checkout:addressForm:setDestination:noPurchaseId",1);a=a.ref||"ox_shipaddress_add_new_addr";f(".a-button-close").trigger("click");a=f("\x3cform/\x3e").attr("action","/gp/buy/addressselect/handlers/continue.html/ref\x3d"+a);
f('\x3cinput name\x3d"addressID"/\x3e').val(l).appendTo(a);f('\x3cinput name\x3d"purchaseId"/\x3e').val(e).appendTo(a);f('\x3cinput name\x3d"action" value\x3d"select-shipping"/\x3e').appendTo(a);m.continueClicked(null,a)},onPageTransitionStart:function(a){m.isSPP()?(k.blockAllActions(),k.showTransitionInContainer(a)):k.show()},onPageTransitionComplete:function(a){m.isSPP()?(k.unblockAllActions(),f(a).find("div.section-overwrap").remove()):k.hide()}}});"use strict";r.when("A","client-side-metrics",
"weblab-helper").register("action-logger",function(a,m){var k=a.$;a.declarative("ue-count",["click","touchend"],function(a){m.increaseCount(a.data.countFlag,a.data.countValue)});return{logUsedPrefetch:function(a,f,g,l){l||(m.increaseCount("Checkout:action-log:MissingRefMarker"),l="");k.ajax({type:"GET",url:"/gp/buy/shared/handlers/log-used-prefetch.html"+l,data:"pageType\x3d"+a+"\x26subPageType\x3d"+f+"\x26relatedRequestId\x3d"+g,dataType:"text",cache:!1})}}});"use strict";r.when("A","weblab-helper").register("ajax-utility",
function(a,m){return{jsonify:function(k){var c;if(c=m.isAJAXWeblabOn()){c=k instanceof Function;var f=k instanceof Array,g=k instanceof String;c=k instanceof Object&&!f&&!c&&!g}if(c)return k;try{k=a.$.parseJSON(k)}catch(l){k=null}return k}}});"use strict";r.when("A","page-conductor","client-side-metrics","weblab-helper").register("button-blocker",function(a,m,k,c){function f(a,b,d,e){m.isSPP()?b.closest("span.a-declarative").data("blockerText",d):b.find("input.a-button-text").data("blockerText",d);
g(e);p?(a.addClass("aok-hidden"),b.removeClass("aok-hidden"),l("#hasTVNavigation").length&&r.when("a-tv").execute(function(b){b.remove(a)})):(k.increaseCount("removeauijs10"),a.hide(),b.show(),b.hasClass("aok-hidden")&&b.removeClass("aok-hidden"))}function g(a){var b=l(".continue-button-blocker-text");b.length&&(a?(b.html(a),b.removeClass("aok-hidden")):(b.addClass("aok-hidden"),b.empty()))}var l=a.$,e={},h=[],d,b,p=q.P&&q.P.AUI_BUILD_DATE,t=!1;c=c.isPyoClientSideInitiationEnabled()?"checkout:unload":
"checkout:beforeReload";a.on(c,function(){h=[];e={};d=""});return{show:function(a,b,c){if(!t){var p=l(".continue-button");if(p.length)if(b){var n=l(".continue-button-blocker");if(n.length){c=c||"";var g=e[a]!==D&&e[a].tooltipText!==b,m=e[a]!==D&&e[a].buttonInlineText!==c;if(0===h.length||!e[a]||g||m)f(p,n,b,c),d=a;e[a]===D&&h.push(a);e[a]={tooltipText:b,buttonInlineText:c}}}else q.console&&q.console.error&&console.error("showBlockerOnContinue should not be called with an empty tooltip."),k.increaseCount("Checkout:ButtonBlocker:EmptyTooltip")}},
hide:function(a){if(!t){if(e[a]!==D){delete e[a];var b=l.inArray(a,h);h.splice(b,1)}var c=l(".continue-button");c.length&&(b=l(".continue-button-blocker"),b.length&&(0===h.length?(g(),p?(b.addClass("aok-hidden"),c.removeClass("aok-hidden"),l("#hasTVNavigation").length&&r.when("a-tv").execute(function(a){a.add(c)})):(k.increaseCount("removeauijs11"),b.hide(),c.show(),c.hasClass("aok-hidden")&&c.removeClass("aok-hidden"))):d===a&&(d=h[0],f(c,b,e[d].tooltipText,e[d].buttonInlineText))))}},lock:function(){t=
!0},unlock:function(){t=!1},getButtonBlocker:function(){b||(b=l(".continue-button-blocker"));return b}}});"use strict";r.when("A","button-blocker","client-side-metrics").register("button-blocker-controller",function(a,m,k){function c(a,b){l[a]!==D&&l[a].state!==b&&(l[a].state=b,f())}function f(){var a=!0,b;g.each(l,function(c,f){b=f.owner;if(f.state===h.DISABLE_CONTINUE)return a=!1,m.show(b,f.toolTipMessage,f.buttonInlineMessage),e||(k.increaseCount("removeauijs12"),g(".continue-button-blocker").css("display",
"inline-block")),!1});a&&m.hide(b)}var g=a.$,l={},e=q.P&&q.P.AUI_BUILD_DATE,h={ENABLE_CONTINUE:"enableContinue",DISABLE_CONTINUE:"disableContinue"};a.on("checkout:beforeReload",function(){l={}});return{disableContinue:function(a,b,e,g){g=g||"";l[b]===D&&(e?(l[b]!==D||(l[b]={state:h.ENABLE_CONTINUE,owner:a,toolTipMessage:e,buttonInlineMessage:g}),f()):q.console&&q.console.error&&console.error("_registerElement should not be called with an empty tooltip."));c(b,h.DISABLE_CONTINUE)},enableContinue:function(a){l[a]!==
D&&c(a,h.ENABLE_CONTINUE)}}});"use strict";r.when("jQuery").register("cache-page-data-controller",function(a){var m={};return{clearCache:function(){m={}},setCachedPageData:function(k,c,f,g,l){var e=[],h=!0;a(".cacheable-spp-panel").each(function(){var b=a(this),c;c=!b||b.find(".is-scheduled-delivery").length?!1:!0;if(!c)return h=!1;b.find(".expand-panel-button").removeClass("a-button-focus");e.push({id:b.attr("id"),content:b[0].outerHTML})});if(h){var d={panels:e};a(".cacheable-spp-section").each(function(){var b=
a(this);d[b.attr("id")]=b[0].outerHTML});m[k+"-"+c]={curPageData:d,state:q.history?history.state:f,page:k,title:document.title||g,url:q.location.href||l}}},getCachedPageData:function(a,c){return m[a+"-"+c]}}});"use strict";r.when("A").register("checkout-general-utils",function(a){function m(a,g,l,e){var h=c.getAssocParamValuesFromUrl(a);!l&&e?delete h[g]:h[g]=l;g=0<=a.indexOf("?")?a.substring(0,a.indexOf("?")):a;g=g+"?"+k.param(h,1);(a=c.getFragmentFromUrl(a))&&(g+="#"+a);return g}var k=a.$,c={moveToNextInput:function(a){a=
a.nextAll(":visible").find("input").get(0);a!==[]&&a.focus()},hide:function(a){a.hide()},show:function(a){q.P&&q.P.AUI_BUILD_DATE&&a.hasClass("aok-hidden")&&a.removeClass("aok-hidden");a.show()},getAssocParamValuesFromUrl:function(a){var c={};if("string"!==typeof a||-1===a.indexOf("?"))return c;a=a.slice(a.indexOf("?")+1);if(!a)return c;-1!=a.indexOf("#")&&(a=a.substring(a,a.indexOf("#")));a=a.split("\x26");for(var l=0;l<a.length;l++){var e=a[l].split("\x3d");c[e[0]]=e[1]}return c},addQueryStringParameter:function(a,
c,l){return m(a,c,l,!1)},addQueryStringParameterOrDeleteIfEmpty:function(a,c,l){return m(a,c,l,!0)},getQueryStringParameter:function(a,g){a=c.getAssocParamValuesFromUrl(a);return g in a?a[g]:D},getFragmentFromUrl:function(a){var c=a.indexOf("#");return-1==c?D:a.substring(c+1)},extractURLParts:function(a){if(!a||"string"!==typeof a)return{};a=/(.*html)(\/ref[^?\n]*)?[?]?(.*)/g.exec(a);var c={};a&&(a[1]&&(c.normalizedUrl=a[1]),a[2]&&(c.refMarker=a[2]),a[3]&&(c.query=a[3]));return c},redirectWithJavascript:function(a){q.location=
c.addQueryStringParameter(a,"hasWorkingJavascript","1")},bindActionEnterKeyOnButton:function(a){a.keyup(function(a){13===a.which&&k(a.target).trigger("click")})},toggleExpanderContent:function(a){a=a.$target.closest(".a-box");a.hasClass("a-single")?a.removeClass("a-single").addClass("a-first"):a.addClass("a-single").removeClass("a-first")},validateNumber:function(a,c,l){k.trim(a);return/^\d+$/.test(a)&&a>=c&&a<=l}};c.protectAgainstDoubleAction=function(){var a={};return function(c,l){if(!c)return q.console&&
q.console.error&&console.error("Function is not used properly, use a unique owner to identify the caller."),!1;if(a.hasOwnProperty(c))return!0;a[c]=1;setTimeout(function(){delete a[c]},l||100);return!1}}();c.logErrorOnLevel=function(a,c){(q.ueLogError||k.noop)({message:a,logLevel:c});if(q.console){var l={FATAL:q.console.error,"default":q.console.warn};c=l[c]||l["default"]}else c=k.noop;c.call(q,a)};c.logError=function(a){c.logErrorOnLevel(a,"FATAL")};c.updateCartByMash=function(a){r.when("safe-mash").execute(function(c){null!==
a&&a!==D&&"1"===k("#updateCartByMash").attr("content")&&c&&c.cart&&c.cart.didUpdate&&c.cart.didUpdate({newCartQuantity:a})})};c.getPosition=function(a,c,l){for(var e=0,h=a.length,d=0;d<h;d++)if(a.charAt(d)===c&&(e++,e===l))return d;return-1};c.limitInputToNumbers=function(a){var c=a.$event.keyCode;-1!==k.inArray(c,[46,8,9,37,39])||-1!==k.inArray(c,[65,67,86])&&!0===a.ctrlKey||(a.$event.shiftKey||(48>c||57<c)&&(96>c||105<c))&&a.$event.preventDefault()};c.nukeDropdowns=function(a){r.when("a-popover-base").execute(function(c){k.each(k(a),
function(){c.remove(this.name)})})};a.on("checkout:reload",function(){k('input[name\x3d"useLiveAUI"]').length||a.defer(function(){k(".a-declarative, .a-button").filter("[data-action]").unbind("keypress.checkout-page").bind("keypress.checkout-page",function(a){13===a.which&&k(this).trigger("click")})})});a.on("checkout:beforeLoadPage",function(){k("div.a-popover").find(".a-declarative:first:[data-action\x3dcustom-popover-close|a-popover-close]").click()});return c});"use strict";r.when("A","weblab-helper").register("client-side-metrics",
function(a,m){var k=a.$,c=null,f=null,g=0,l;a=function(){};var e=q.uet||a,h=q.uex||a,d=!1,b=!1,p=function(a){q.ue&&q.ue.t&&(q.uet(a,c),n("checkout:client-side-metrics:uet:marker:"+a,1,1),m.isCSMATLoggingEnabled()&&null===c&&null===f&&q.ue.isl&&(n("checkout:client-side-metrics:mark:at",1,1),q.uex("at")));"af"===a?d=!0:"fn"===a&&(b=!0)},t=function(a){q.ue&&q.uex&&(q.uex(a,c),n("checkout:client-side-metrics:uex:marker:"+a,1,1))},z=function(a){q.ue&&q.ues&&q.ues("id",c,a)},y=function(){q.ue&&q.ues&&q.ues("ctb",
c,"1")},w=function(){q.ue&&q.ues&&(q.ues("t0",c,(new Date).getTime()),p("ue"),p("bb"))},v=function(a){a?f="ctbajax"+g++:c="ajax"+g++},n=function(a,b,c){"undefined"!==typeof q.ue&&"undefined"!==typeof q.ue.count&&(b=b?b:1,c?q.ue.count(a,(q.ue.count(a)||0)+1):q.ue.count(a,b))},u=function(a){if(a&&a.length){var b=c;c=f;z(a);c=b}},K=function(){l===D&&(l=0<k("#transitionLogging").length);return l},A=function(a,b,c,e){q.ueLogError&&q.ueLogError(a,{message:b,attribution:c,logLevel:e})};return{getscope:function(){return c},
getasyncscope:function(){return f},setmarker:p,sendue:t,setrid:z,setctb:y,resetue:w,createscope:v,setscope:function(a){c=a},increaseCount:n,resetMetrics:function(){c=f;y();w()},setAsyncRequestId:u,sendUEPageLoadStats:function(){!m.isCSMErrorLoggingEnabled()||d&&b||A({message:"Logged ld without both af and fn logged first af:"+d+" fn:"+b},"","checkout-client-side-metrics","ERROR");t("ld");v(1);b=d=!1},isTransitionLoggingEnabled:K,logPageTransition:function(a,b,c,e){if(K()){var d=(new Date).getTime();
k.ajax({type:"POST",url:"/gp/buy/shared/handlers/log-page-transition.html?cachebuster\x3d"+d,data:{fromPage:a,toPage:b},async:!0,cache:!1,timeout:1E3,success:function(a,b,e){var d=e.getResponseHeader("x-amz-checkout-requestid");u(d);c&&c.call(this,a,b,e)},complete:function(a,b){e&&e.call(this,a,b)}})}},logError:A,startWidgetTiming:function(a){e("bb",a,{wb:1})},finishWidgetTiming:function(a){h("ld",a,{wb:1})},setMarkerForWidget:function(a,b){e(a,b,{wb:1})}}});"use strict";r.register("currency-formatter",
function(){function a(m,k){isNaN(k)||(m=Number(m).toFixed(k));m=m.toString();k=0<=m.lastIndexOf(".")?m.lastIndexOf("."):m.length;return 3>=k?m:a(m.substring(0,k-3),0)+","+m.substring(k-3)}return{getNumberWithSeparators:a}});"use strict";r.when("A","client-side-metrics","page-conductor","page-detector").register("delivery-preferences-csm-helper",function(a,m,k,c){function f(a){var f=k.isSPP()?"spp":"mpp",d="desktop";c.isMobile()?d="mobile":c.isTablet()&&(d="tablet");m.increaseCount("checkout:delivery-preferences:"+
d+":"+f+":"+a,1)}function g(a){return 0===a.length?"NoValueSet":a}var l=a.$;return{recordCSM:f,recordCSMWithCurrentFieldValues:function(a,c,d){c=l("input[name\x3d"+c+"]:checked");c.length&&(c=c.val(),f(a+":preference:"+g(c)));d=l("input[name\x3d"+d+"]");d.length&&f(a+":set-as-default:"+(d.is(":checked")?"yes":"no"))},recordCSMForEligiblePages:function(a){a=a||"";f(a+"eligible-page-displayed");var c=l("input[name\x3ddelivery-preferences-preference-set]");c.length&&f(a+"summary-displayed:preference:"+
g(c.val()))}}});"use strict";r.when("page-detector-current-page","A").register("error-feature-detection",function(a,m){function k(a){q.errorFeatureDetection&&q.errorFeatureDetection.safelyLogError?q.errorFeatureDetection.safelyLogError(a):(q.ueLogError&&q.ueLogError(a),q.console&&q.console.error&&console.error(a))}try{m.on("page-detector:page-changed",function(){var c=a.getCurrentPage();if(c&&"spc"===c)try{q.errorFeatureDetection&&q.errorFeatureDetection.enableErrorHandling&&q.errorFeatureDetection.enableErrorHandling()}catch(f){k(f)}else try{q.errorFeatureDetection&&
q.errorFeatureDetection.disableErrorHandling&&q.errorFeatureDetection.disableErrorHandling()}catch(f){k(f)}})}catch(c){k(c)}return{registerFeature:function(a,f){try{q.errorFeatureDetection&&q.errorFeatureDetection.registerFeature&&q.errorFeatureDetection.registerFeature(a,f)}catch(g){k(g)}},markFeatureAvailable:function(a){try{q.errorFeatureDetection&&q.errorFeatureDetection.markFeatureAvailable&&q.errorFeatureDetection.markFeatureAvailable(a)}catch(f){k(f)}},markFeatureUnavailable:function(a){try{q.errorFeatureDetection&&
q.errorFeatureDetection.markFeatureUnavailable&&q.errorFeatureDetection.markFeatureUnavailable(a)}catch(f){k(f)}}}});r.when("error-feature-detection").execute(function(a){a.registerFeature("continue-action",0);a.markFeatureAvailable("javascript-detection");a.markFeatureAvailable("continue-action")});"use strict";r.when("A","loading-spinner-controller","ajax-utility","currency-formatter","page-conductor","page-transition-controller").register("inline-points-register-controller",function(a,m,k,c,f,
g){function l(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))}function e(a){var b=z.$popover.find(".rewards-registration");m.hideSpinner(b);b.children("div").hide();b=b.find(".rewards-registration-error");a&&a.error?(a=b.find("[data-error\x3d'"+a.error+"']"),a.length?a.show():
b.find("[data-error\x3d'rewards_SystemUnavailable']").show()):b.find("[data-error\x3d'rewards_SystemUnavailable']").show();b.fadeIn(300)}function h(a){z=a.popover;var b=z.$popover.find(".rewards-registration");m.showSpinner(b,!1,z);a=b.data("issuer-id");var c=b.data("program-id"),d=b.data("cc-issuer"),p=b.data("cc-brand"),b=b.data("parent-payment-method-id"),f="/gp/buy/payselect/handlers/get-rewards-configuration.html?cachebuster\x3d"+(new Date).getTime();t.ajax({type:"POST",url:f,data:"programid\x3d"+
c+"\x26partner\x3d"+a+"\x26ccpaymentinstrumentid\x3d"+b+"\x26issuer\x3d"+d+"\x26brand\x3d"+p+"\x26hasWorkingJavascript\x3d1",dataType:"text",async:!0,cache:!1,dataFilter:function(a){return k.jsonify(a)},success:function(a,b,c){b=z.$popover.find(".rewards-registration");m.hideSpinner(b);c=a.fields||{};for(var d in c)if(c.hasOwnProperty(d)){var e=c[d],n=b.find("[data-field\x3d'"+e.type+"']");e.value&&n.filter("input").attr("value",e.value);n.parents(".rewardsfield").show()}a.termshtml&&b.find(".rewardstermstext").html(l(a.termshtml));
a.billingzip&&b.find("[data-field\x3dBILLING_POSTAL_CODE]").attr("value",a.billingzip);if(a.displaydata){d=b.find("[data-field]");for(var p in a.displaydata)a.displaydata.hasOwnProperty(p)&&d.filter("[data-field\x3d"+p+"]").html(a.displaydata[p])}a.marketinglink&&b.find("[data-field\x3d'rewards_marketing_link']").html(a.marketinglink);b.find("#rewards-registration-image").show();b.find(".rewards-registration-main").fadeIn(300);z.updatePosition(!0)},error:function(a){e(a)}})}function d(){if(z){var a=
z.$popover.find(".rewards-registration");m.hideSpinner(a);a.find(".rewards-registration-success").hide();a=a.find(".rewards-registration-error");a.hide();a.find("h4").hide();y&&(g.show(),f.isSPP()?f.reloadPage():t("div.pay").length?f.loadPage("payselect","payselect"):t("div.spc").length&&f.loadPage("spc","spc"))}}function b(a){return a.is("input")?a:a.find("input")}function p(){if(z){var a=z.$popover.find(".rewards-registration");a.find(".rewards-registration-main").hide();a.find("#rewards-registration-image").hide();
m.showSpinner(a,!1,z);var d=(new Date).getTime(),n="programid\x3d"+encodeURIComponent(a.data("programId")),n=n+("\x26paymentinstrumentid\x3d"+encodeURIComponent(a.data("parent-payment-method-id"))+"\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26cachebuster\x3d"+d),p=a.find("[data-field]");p.each(function(){var a=t(this).attr("data-field");if("CVV2"===a)n+="\x26registerRewardsCreditCardVerificationNumber\x3d"+encodeURIComponent(t(this).val());else if(t(this).data("entryindex")){if(1===t(this).data("entryindex")){var c=
p.filter("[data-field\x3d"+a+"]").sort(function(a,b){return Number(t(a).data("entryindex"))-Number(t(b).data("entryindex"))});n+="\x26"+a+"\x3d";c.each(function(){n+=encodeURIComponent(t(this).val())})}}else"TERMS_AND_CONDITIONS"===a?b(t(this)).is(":checked")&&(n+="\x26"+a+"\x3dtrue"):n+="\x26"+a+"\x3d"+encodeURIComponent(t(this).val())});d="ox_pay_page_swp_reg_popover_submit";a.data("programId")&&(d+="_"+a.data("programId"));a="/gp/buy/payselect/handlers/register-rewards-account.html/ref\x3d"+d+
"?cachebuster\x3d"+(new Date).getTime();t.ajax({type:"POST",url:a,data:n,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return k.jsonify(a)},success:function(a,b,d){a?a&&0===a.success?e(a):z&&(b=z.$popover.find(".rewards-registration-success"),b.find(".customername").text(a.customername),a.dollarbalancedisplay&&a.pointsbalance&&(b.find("[data-field\x3d'rewardsamount']").html(a.dollarbalancedisplay),b.find("[data-field\x3d'pointsamount']").html(c.getNumberWithSeparators(a.pointsbalance,a.rewardsdecimalplaces)),
b.find(".rewardsuccessbalance").show()),a.showwarnmessage&&b.find(".warnmessage").show(),y=!0,b.fadeIn(300),m.hideSpinner(z.$popover.find(".rewards-registration"))):e()},error:function(a){e(a)}})}}var t=a.$,z,y=!1;a.on("a:popover:show:rewards-registration",h);a.on("a:popover:hide:rewards-registration",d);a.declarative("close-rewards",["click"],function(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")});a.declarative("rewards-signup",["click"],function(a){a.$event.preventDefault();
p(a)});a.declarative("toggle-reward-signup-button","change",function(a){a=a.$target;var b=z.$popover.find(".rewards-registration");a&&a.is(":checked")?(b.find("#reward-signup-button").removeClass("aok-hidden"),b.find("#disabled-reward-signup-button").addClass("aok-hidden")):(b.find("#reward-signup-button").addClass("aok-hidden"),b.find("#disabled-reward-signup-button").removeClass("aok-hidden"))});a.on("a:popover:beforeShow:cvv2helpcontent",function(a){a.popover.$popover.find(".a-popover-inner").html(t(".cvv2helpcontent").text());
a.popover.updatePosition()});return{displayRewardsRegister:h,hideRewardsRegister:d}});"use strict";r.when("A","error-feature-detection","safe-mash","ready").register("shared-kitchensink",function(a,m,k){var c=a.$;a.on("checkout:reload",function(){(c("body.a-touch").length||c("div.a-touch:first").length)&&c("html").addClass("a-touch");c("form").each(function(){var a=c(this).find('input[name\x3d"hasWorkingJavascript"]');a&&0<a.length?a.val("1"):c(this).append('\x3cinput type\x3d"hidden" name\x3d"hasWorkingJavascript" value\x3d"1" /\x3e')});
k&&(c("div.checkout-tablet a[target\x3d'AmazonHelp']").each(function(){var a=c(this).attr("href"),a=a+(0<=a.indexOf("?")?"\x26app-nav-type\x3dmodal":"?app-nav-type\x3dmodal"),a=a.replace("#","");c(this).attr("href",a);c(this).removeAttr("data-action");c(this).removeAttr("data-help-popup");c(this).removeAttr("onclick")}),c("div.checkout.mobile a[target\x3d'AmazonHelp']").each(function(){var a=c(this).attr("href"),a=a.replace("#","");c(this).attr("href",a);c(this).removeAttr("data-help-popup");c(this).removeAttr("onclick");
c(this).addClass("a-declarative help-popup");c(this).attr("data-action","help-popup")}));if(0<c("div.checkout-tablet").length)for(var a=document.getElementsByTagName("a"),g=0;g<a.length;g++)a[g].href||(a[g].href="#")});c(document).bind("jsdetection",function(){m.markFeatureAvailable("javascript-detection")})});r.when("A","safe-mash","ready").execute(function(a,m){var k=a.$;a.declarative("mash-navigate",["click"],function(a){a=a.$currentTarget.attr("href");m&&m.navigate?m.navigate({url:a}):q.location.href=
a});a.declarative("expander-scroll-there",["click"],function(a){if("false"!==a.$currentTarget.closest(".a-expander-container").find(".a-expander-content").attr("aria-expanded")){var f=k(q),g=k(document),l=a.$currentTarget.offset().top,e=0,h=0,d=function(){q.setTimeout(function(){f.scrollTop(l);e===g.height()?h++:(h=0,e=g.height());10>h&&d()},10)};d()}})});q.amz_js_PopWin=function(a,m,k){(a=q.open(a,m,k))&&a.focus&&a.focus();return!1};var na=!1;q.confirmPurchase_onSubmit||(q.confirmPurchase_onSubmit=
function(){return na?!1:na=!0});"use strict";r.when("A","error-feature-detection","loading-spinner-spp-controller").register("loading-spinner-controller",function(a,m,k){function c(a){if(g&&l){var c,p,n;d&&t?(a=d.getContent(),c=a.innerHeight(),p=a.innerWidth()):(c=a.height(),p=a.width());n=a.offset();a=l.width();var h=l.height();if(e)n="1"===f("input[name\x3dfromAnywhere]").val()?f(document).height():f(q).height(),g.width(f(document).width()).height(n).css("left","0px").css("z-index",2E3),l.css("left",
p/2-a/2+"px").css("top",c/2-h/2+"px").css("z-index",4E3).show();else{var k=f(q),m=t?k.scrollLeft():0;g.css("position","fixed").width(p).height(c).css("z-index",3E3).css("left",n.left-m).css("top",n.top-k.scrollTop());b?l.css("position","fixed").css("left",n.left-m+(p/2-a/2)+"px").css("top",n.top-k.scrollTop()+(c/2-h/2)+"px").css("z-index",4E3).show():l.css("left",p/2-a/4+"px").css("top",c/2-h/4+"px").css("z-index",4E3).show()}}}var f=a.$,g,l,e,h,d,b=!1,p=!1,t=!1,z=!1;a.on("a:popover:positionUpdated",
function(a){if(t&&d&&d.name===a.popover.name&&g&&l){var b=d.getContent();a=b.innerHeight();var c=b.innerWidth(),b=b.offset(),e=f(q);g.width(c).height(a).css("left",b.left-e.scrollLeft()).css("top",b.top-e.scrollTop());l.css("left",b.left-e.scrollLeft()+(c/2-l.width()/2)+"px").css("top",b.top-e.scrollTop()+(a/2-l.height()/2)+"px")}});a.on("checkout:reload",function(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",c=f("#first-pipeline-load-page-spinner-img");
c.length&&(a=f.trim(c.attr("src")));1>f("#loading-spinner-blocker-doc").length&&(a=f(['\x3cdiv class\x3d"template loading-spinner" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-inner"\x3e','\x3cimg id\x3d"loading-spinner-img" class\x3d"loading-spinner-img" src\x3d"'+a+'"/\x3e','\x3c/div\x3e\x3c/div\x3e\x3cdiv id\x3d"loading-spinner-blocker-doc" class\x3d"loading-spinner-blocker" style\x3d"display:none;"\x3e\x3c/div\x3e\x3cdiv id\x3d"spinner-anchor" class\x3d"spinner-anchor" style\x3d"display:none"\x3e\x3c/div\x3e'].join("")),
l=g=h=null,"1"===f("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),f("body").prepend(a));f("input[name\x3duseModifiedSpinnerResizeFn]").length&&(b=!0);f("#useRelativeSpinner").length&&(p=!0);f("#modifiedBlockerDivSize").length&&(t=!0)});return{showSpinner:function(a,w,v){if(p&&!w&&t&&b&&v)return z=!0,k.showSpinner(a,v);z=!1;0!==a.length&&(d=(e=w)?D:v,h||(h=f(".loading-spinner.template").clone().removeClass("template"),h.show()),
a.append(h),e?(g=f("#loading-spinner-blocker-doc"),a.find(".loading-spinner-blocker").hide()):g=a.find(".loading-spinner-blocker"),g.show(),e&&m.markFeatureUnavailable("continue-action"),l=a.find(".loading-spinner-inner"),c(a))},hideSpinner:function(a,b){if(z)return z=!1,k.hideSpinner(a,b);z=!1;g&&(e&&(g.hide(),m.markFeatureAvailable("continue-action")),h.detach());b&&a.hide()},adjustSize:function(a){return z?k.adjustSize():c(a)}}});"use strict";r.when("A","error-feature-detection").register("loading-spinner-spp-controller",
function(a,m){function k(){if(f&&g){var a=e.innerHeight(),b=e.innerWidth();f.width(b).height(a);g.css("left",b/2-g.width()/2+"px").css("top",a/2-g.height()/2+"px")}}var c=a.$,f,g,l,e,h;a.on("a:popover:positionUpdated",function(a){h&&h.name===a.popover.name&&k()});a.on("checkout:reload",function(){var a="https://images-na.ssl-images-amazon.com/images/G/01/amazonui/loading/loading-4x._V391853216_.gif",b=c("#first-pipeline-load-page-spinner-img");b.length&&(a=c.trim(b.attr("src")));1>c(".loading-spinner-spp").length&&
(a=c(['\x3cdiv class\x3d"template loading-spinner-spp" style\x3d"display:none"\x3e\x3cdiv class\x3d"loading-spinner-spp-blocker"\x3e\x3c/div\x3e\x3cdiv class\x3d"loading-spinner-spp-inner"\x3e','\x3cimg class\x3d"loading-spinner-spp-img" src\x3d"'+a+'"/\x3e',"\x3c/div\x3e\x3c/div\x3e"].join("")),g=f=l=null,"1"===c("#showSpinnerWithoutBox").attr("content")&&a.find(".loading-spinner-inner").addClass("loading-spinner-inner-no-box"),c("body").prepend(a))});return{showSpinner:function(a,b){0!==a.length&&
(h=b,e=a,l||(l=c(".loading-spinner-spp.template").clone().removeClass("template"),l.show()),b.getContent().before(l),e.prepend(l),f=e.find(".loading-spinner-spp-blocker"),f.show(),g=e.find(".loading-spinner-spp-inner"),k())},hideSpinner:function(a,b){f&&l.detach();b&&a.hide()},adjustSize:k}});"use strict";r.when("A","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils","client-side-metrics","safe-mash","cache-page-data-controller","ajax-wrapper","widget-streamer",
"widget-streamer-utils","weblab-helper","temporary-preference-indicator").register("page-conductor",function(a,m,k,c,f,g,l,e,h,d,b,p,t){function z(a){q.ueLogError&&q.ueLogError({message:a},{logLevel:"WARN",attribution:"CheckoutCommonAsset-PageConductor"})}function y(a){ea&&(a?(a["x-amz-checkout-transition"]||(a["x-amz-checkout-transition"]="ajax"),a["x-amz-checkout-type"]||(a["x-amz-checkout-type"]="spp")):a={"x-amz-checkout-transition":"ajax","x-amz-checkout-type":"spp"});return a}function w(){oa=
!1;ca=null;wa=0;ka=!1;J=null}function v(a){var b=parseInt(S("#checkoutDisplayPage").data("delaySetTitle"),10)||0;b?q.setTimeout(function(){document.title=a},b):document.title=a}function n(b){p.isRefreshPageStateEnabled()&&"function"===typeof a.state.parse&&a.state.parse();a.trigger("checkout:beforeReload");a.trigger("checkout:reload");b&&("spp-revieworder"===b?a.trigger("checkout:reload:spc"):a.trigger("checkout:reload:"+b));a.trigger("checkout:afterReload")}function u(a){m.show();var b="/gp/buy/addtocart/handlers/display.html";
a&&(b+="?errorType\x3d"+a);q.location=b}function K(b){(b=S("#pageTypeRedirectedTo").text())&&a.trigger("checkout:reload:"+b)}function A(b,c){var e;if(c.getResponseHeader("x-amz-force-full-page-update"))L(b);else{if(c.getResponseHeader("x-amz-checkout-redirect-addtocart")){(c=k.jsonify(b))?u(c.errorCode):u();return}e=Aa(b)}b=S("#pipelinedPageTitle").text();v(b);var d=c.getResponseHeader("x-amz-checkout-page");ea?a.delay(function(){n(d)},e):n(d)}function L(a){var b=document.open("text/html","replace");
b.write(a);b.close()}function C(a,b){try{if(b.getResponseHeader("x-amz-force-full-page-update"))L(a);else{if(!U)throw Error("Member _updateDisplayPageContent not set in page-conductor. Make sure 'initFunc' is called.");U(a)}}catch(c){a="Error while replacing page content.",c.message&&(a+="  Error message: "+c.message),r.error(a,"page-conductor","replaceDisplayPage",c)}a=S("#pipelinedPageTitle").text();v(a);b=b.getResponseHeader("x-amz-checkout-page");n(b)}function H(a){var b=parseInt(S("#showPageTransition").attr("content"),
10);(b=isNaN(b)?1:b)||m.hide();b="/gp/buy/shared/handlers/dispatch.html";a&&(a.conductoraction&&a.conductoraction.url?b=a.conductoraction.url:a.pipedata&&a.pipedata.conductoraction&&a.pipedata.conductoraction.url&&(b=a.pipedata.conductoraction.url));b=0<b.indexOf("?")?b+"\x26":b+"?";S("input[name\x3dfromAnywhere][value\x3d1]").length&&(b+="fromAnywhere\x3d1");b=ga(b);l&&S("html").hasClass("a-tablet")&&-1<b.indexOf("/gp/cart/view.html")&&(b="/gp/aw/c?app-action\x3dcart");q.location=b}function N(a,
b,c,d,n){d=d||{};d.pushNewFrame=d.pushNewFrame||"true";d.anchor=d.anchor||D;w();"true"===d.pushNewFrame&&l&&l.navigate&&S("#checkoutDisplayPage").data("useMashNavigateForTransitions")?l.navigate({url:null,transitionEffect:"slide",successCallback:function(){M(a,b,c,d,n)},failCallback:function(a){}}):M(a,b,c,d,n);d.keepCachedPagesData||e.clearCache()}function P(){var a=S("input#isPipelinedPage");return 0<a.length&&"1"===a.val()}function G(a){return p.isExecutionIdInQueryStringEnabled()?a?a.getResponseHeader("x-amz-checkout-executionid"):
f.getQueryStringParameter(q.location.href,"executionId"):S("input#executionId").val()}function M(d,e,f,h,l){h=h||{};h.pushNewFrame=h.pushNewFrame||"true";h.anchor=h.anchor||D;var t=f.getResponseHeader("x-amz-checkout-page");c.setCurrentPage(t);if(h.freshLoad)h.freshLoad=!1,r.when("first-load-dependencies").execute(function(a){M(d,e,f,h)});else if(t){S("head .aui-page-asset").removeAttr("disabled");S("head .old-pipeline-asset").removeAttr("disabled");var m=f.getResponseHeader("x-amz-checkout-requestid");
g.setAsyncRequestId(m);if(m=f.getResponseHeader("x-amz-checkout-redirect"))H({conductoraction:{url:m,type:"redirect"}});else{var m=f.getResponseHeader("x-amz-checkout-url"),u=f.getResponseHeader("x-amz-checkout-additional-page-args");if(p.isAJAXWeblabOn()&&b.isStreamingAjax(f))p.isAjaxStreamingEnabled()?n(t):(K(f),E(d,t));else if(a.trigger("checkout:unload"),0<S("#checkoutDisplayPage").length?C(d,f):A(d,f),p.isAjaxStreamingEnabled()){var O=S("#pipelinedPageTitle").text();P()&&Q(t,O,m,G(f),u,h.anchor,
h.pushNewFrame)}p.isAjaxStreamingEnabled()||(O=S("#pipelinedPageTitle").text(),P()&&Q(t,O,m,G(f),u,h.anchor,h.pushNewFrame));h.anchor&&(t=S(h.anchor),0===t.length&&(t=h.anchor.replace("#",""),t=S(document.getElementsByName(t))),t.length&&S(document).scrollTop(t.offset().top));h.logUsedPrefetch&&r.when("action-logger").execute(function(a){a.logUsedPrefetch(f.getResponseHeader("x-amz-checkout-page-type"),f.getResponseHeader("x-amz-checkout-sub-page-type"),f.getResponseHeader("x-amz-checkout-requestid"),
l)})}}else{if(q.getOldAjaxSuccessCallback)return q.getOldAjaxSuccessCallback("ajaxConductor","generalErrorHandling","generalErrorHandling")(d,e,f);d=k.jsonify(d);H(d)}}function Q(a,b,c,d,e,n,h){b&&c&&q.history&&q.history.pushState&&(p.isExecutionIdInQueryStringEnabled()?"true"!==h||history.state&&history.state.page===a||(c=ga(c),n&&(c+=n),d&&(c=f.addQueryStringParameterOrDeleteIfEmpty(c,"executionId",d)),history.pushState({page:a,additionalURLArgs:e},b,c)):(c=ga(c),n&&(c+=n),d&&(c=f.addQueryStringParameter(c,
"executionId",d)),"true"===h&&history.state&&history.state.page!==a&&history.pushState({page:a,additionalURLArgs:e},b,c)))}function E(a,b){a.executeActions();a=S("#pipelinedPageTitle").text();v(a);n(b)}function F(){q.location=qa?"/gp/buy/addtocart/handlers/display.html":"/gp/buy/payselect/handlers/error.html"}function V(c,d,e,n,f,g){n=n||{};n.refTag=n.refTag||"";n.pushNewFrame=n.pushNewFrame||"true";n.anchor=n.anchor||D;n.refTag&&0!==n.refTag.indexOf("/ref\x3d")&&(n.refTag="/ref\x3d"+n.refTag);c=
"fromPage\x3d"+c+"\x26page\x3d"+d;(g=G(g))&&(c+="\x26executionId\x3d"+g);e&&(c+="\x26"+e);e=function(){};g=function(){};var l;"function"===typeof n.resultscallback?(d=function(a,b,c){n.resultscallback(a,b,c)},l=function(a,b,c){n.resultscallback(D,b,a)}):(e=function(b){a.trigger("checkout:beforeLoadPage");ra&&ra.abort();ra=b},d=function(a,c,d){p.isAJAXWeblabOn()&&b.isStreamingAjax(d)||n.callbackBeforePageUpdate&&n.callbackBeforePageUpdate();N(a,c,d,n);n.callbackAfterPageUpdate&&n.callbackAfterPageUpdate()},
l=function(a,b,c){"abort"!==b&&("error"===b&&a.readyState===h.READY_STATE.UNSET?r.when("a-tv","mash").execute(function(a,b){q.cordova.exec(null,null,"MASHDisplayErrorPlugin","execute",{})}):(Z(a,b),F()))},g=function(a){ra=null});f={type:"GET",url:(f?f:"/gp/buy/shared/handlers/pipeline-dispatch.html")+n.refTag,data:c,dataType:"text",async:!0,beforeSend:e,success:d,error:l,complete:g,cache:!1};ea&&(f.headers=y({"x-amz-checkout-transition":"ajax"}));return p.isAJAXWeblabOn()?(f.useXMLHttp=!0,f=p.isAjaxStreamingEnabled()?
X(f,n.callbackBeforePageUpdate,n.anchor,n.pushNewFrame):X(f,n.callbackBeforePageUpdate),h.aui(f)):S.ajax(f)}function X(e,n,f,h){e.timeout=5E4;e.data=aa(e.data,"acceptsStreaming\x3d1");var g;g=e.data.match(/.*isAsync=1.*/)?!0:!1;xa=d({$target:S("#checkoutDisplayPage"),updateTriggerEvent:"pageReady",immediateExecution:!g,updateTarget:S("#checkoutDisplayPage"),onUpdate:function(b){"function"===typeof n&&n();a.trigger("checkout:unload");v(b.title);Q(b.page,b.title,b.url,b.executionId,b.additionalURLArgs,
f,h||"true");c.setCurrentPage(b.page)}});e.chunk=xa.chunkHandler;if(!p.isAjaxStreamingEnabled()){var l=e.success;e.success=function(a,c,d){l&&b.isStreamingAjax(d)?l(xa,c,d):l&&l(a,c,d)}}return e}function aa(a,b){return a?a+"\x26"+b:b}function Z(a,b){g.increaseCount("Checkout:PageConductor:Ajax:Error");p.isAJAXWeblabOn()?(a?(g.increaseCount("Checkout:AUI:Ajax:jqXHR:defined"),z("jqXHR defined throw CheckoutErrorAW under AJAX Weblab, textStatus:"+b+" stateCode:"+a.state+" readyState:"+a.readyState)):
a===D?(g.increaseCount("Checkout:AUI:Ajax:jqXHR:undefined"),z("jqXHR undefined throw CheckoutErrorAW under AJAX Weblab")):null===a&&(g.increaseCount("Checkout:AUI:Ajax:jqXHR:null"),z("jqXHR null throw CheckoutErrorAW under AJAX Weblab")),g.increaseCount("Checkout:AUI:Ajax:Error:textStatus:"+b),g.increaseCount("Checkout:AUI:Ajax:Error:statusCode:"+a.status),g.increaseCount("Checkout:AUI:Ajax:Error:readyState:"+a.readyState)):(a?(g.increaseCount("Checkout:jQuery:Ajax:jqXHR:defined"),z("jqXHR defined throw CheckoutErrorAW using jQuery, textStatus:"+
b+" stateCode:"+a.state+" readyState:"+a.readyState)):a===D?(g.increaseCount("Checkout:jQuery:Ajax:jqXHR:undefined"),z("jqXHR undefined throw CheckoutErrorAW using jQuery")):null===a&&(g.increaseCount("Checkout:jQuery:Ajax:jqXHR:null"),z("jqXHR null throw CheckoutErrorAW using jQuery")),g.increaseCount("Checkout:jQuery:Ajax:Error:textStatus:"+b),g.increaseCount("Checkout:jQuery:Ajax:Error:statusCode:"+a.status),g.increaseCount("Checkout:jQuery:Ajax:Error:readyState:"+a.readyState))}function fa(a,
b,c,d){var e=a;b=aa(b,"isClientTimeBased\x3d1");if(p.refactorExtractURL()){var n=f.extractURLParts(a);a=n.normalizedUrl;if(!a)return g.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:T1"),z("Unable to normalize url ["+e+"]. Ajax request aborted."),!1;var l=a.indexOf("/gp/buy/");0<l?(a=a.substring(l),g.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:T1")):g.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:T1");n.query?(b+="\x26"+n.query,g.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:T1")):
g.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:T1");e=n.refMarker;e||(g.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:T1"),e="");e&&-1===e.indexOf("ref\x3d")&&(g.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:T1"),e="")}else{n=a.indexOf("?");0<n?(b+="\x26"+a.substring(n+1),a=a.substring(0,n),g.increaseCount("Checkout:PageConductor:submitAjax:url:hasQueryPart:C")):g.increaseCount("Checkout:PageConductor:submitAjax:url:missingQueryPart:C");
l=a.indexOf("/gp/buy/");0<l?(a=a.substring(l),g.increaseCount("Checkout:PageConductor:submitAjax:url:removedGpBuy:C")):g.increaseCount("Checkout:PageConductor:submitAjax:url:missingGpBuy:C");if(-1===a.indexOf(".html"))return g.increaseCount("Checkout:PageConductor:submitAjax:url:missingHtml:C"),z("url ["+e+"] is missing html extension. Ajax request aborted."),!1;n=a.indexOf(".html");e=a.substring(n+5);a=a.substring(0,n+5);e||g.increaseCount("Checkout:PageConductor:submitAjax:url:missingRefMarker:C");
e&&-1===e.indexOf("ref\x3d")&&(g.increaseCount("Checkout:PageConductor:submitAjax:url:refMarkerMalformed:C"),e="")}b+="\x26handler\x3d"+a;a={type:"POST",url:"/gp/buy/shared/handlers/async-continue.html"+e,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:y({"x-amz-checkout-transition":"ajax"}),data:b,dataType:"text",async:!0,success:c,error:function(a,b,c){"abort"!==b&&("error"===b&&a.readyState===h.READY_STATE.UNSET?r.when("a-tv","mash").execute(function(a,b){q.cordova.exec(null,
null,"MASHDisplayErrorPlugin","execute",{})}):"function"===typeof d&&(Z(a,b),d()))},cache:!1};return p.isAJAXWeblabOn()?(a.useXMLHttp=!0,X(a),h.aui(a)):S.ajax(a)}function Y(a,b,c,e,d){d=d&&d.action?d.action:a.attr("action");a=a.serialize();e&&(a+="\x26isAsync\x3d1");return fa(d,a,b,c)}function R(a,b,c,e){a=ga(a.attr("href"));e&&(a+="\x26isAsync\x3d1");return fa(a,"",b,c)}function ba(a){a=a||{};a.logUsedPrefetch=1;N(ca.data,ca.status,ca.response,a,ca.refMarker)}function ga(a){-1===a.toLowerCase().indexOf("hasworkingjavascript")&&
(a+=(0<=a.indexOf("?")?"\x26":"?")+"hasWorkingJavascript\x3d1");return a}function x(a){ka=!1;za&&clearTimeout(za);if(a.is("form"))ha(a)?ba():Y(a,N,F);else if(a.is("a"))if(da(a)){var b;1===parseInt(a.data("keepCachedPagesData"),10)&&(b={keepCachedPagesData:1});ba(b)}else R(a,N,F);else r.error("function called without a trigger","page-conductor","handleContinueAction")}function ha(a){return a.is("form")&&null!==ca&&ca.serializedValue===a.serialize()}function da(a){return a.is("a")&&null!==ca&&ga(ca.serializedValue)===
ga(a.attr("href"))}function ma(a){return ya&&(a.is("form")&&ya!==a.serialize()||a.is("a")&&ga(ya)!==ga(a.attr("href")))}function O(a,c,e,d,n){function h(f,m,v){var C=!0;if("success"===m){if(!p.isAJAXWeblabOn()||!b.isStreamingAjax(v)){var K=k.jsonify(f);null!==K&&K&&K.result&&"noPrefetch"===K.result&&(ca=null,C=!1)}C&&(ca={},ca.serializedValue=u,ca.data=f,ca.status=m,ca.response=v,ca.refMarker=t)}else ca=null;oa=!1;ea&&r.when("spp-button-blocker").execute(function(a){a.hideDefaultContinueBtnBlocker()});
if(ka)return x(J),!0;if(C){var z=function(){d?O(a,c,e,!0,n):sa(a)};if(null===ca||"form"===l&&ca.serializedValue!==a.serialize())return z(),!0;c&&(0===c?g.increaseCount("checkoutPrefetchTimeoutSetToZero",1):za=setTimeout(function(){ca=null;z()},1E3*c))}return!0}if(!P()||0===a.length)return!1;var l=a.get(0).tagName.toLowerCase();if("form"!==l&&"a"!==l||"function"===typeof n&&!n(l))return!1;c=c||0;e=e||0;d=d||!1;if(oa||wa>=e)return!1;oa=!0;ea&&r.when("spp-button-blocker").execute(function(a){a.showDefaultContinueBtnBlocker()});
wa++;za&&clearTimeout(za);var t=f.extractURLParts("form"===l?a.attr("action"):a.attr("href")).refMarker,m,u=null;"form"===l?(u=a.serialize(),m=p.isAJAXWeblabOn()?Y(a,h,h,!0):Y(a,null,null,!0)):"a"===l&&(u=ga(a.attr("href")),m=p.isAJAXWeblabOn()?R(a,h,h,!0):R(a,null,null,!0));p.isAjaxStreamingEnabled()&&u&&(ya=u);"object"!==typeof m||"function"!==typeof m.always||p.isAJAXWeblabOn()||m.always(h)}function sa(a){var b=parseInt(a.data("prefetchTimeout"),10),c=parseInt(a.data("maxPrefetches"),10);return O(a,
b,c,!1,function(b){if(a.find("input:checked").hasClass("no-prefetch"))return!1;if(p.disablePrefetchForScheduledDeliveryWeblabOn()){var c=a.find("div.one-shipment:not(:hidden)").find("input:checked");if(c.parents('[data-a-input-name\x3d"'+c.attr("name")+'"]').hasClass("no-prefetch"))return!1}return"1"===S("input#block-prefetch").val()||"1"===S("input#block-all-prefetch").val()||"form"===b&&!a.data("checkoutFormReady")?!1:!0})}function ta(){var a=c.getCurrentPage();return"payselect"===a||"spp-payment"===
a||"pay"===a}function W(b,c){b&&b.preventDefault();p.isClearTemporaryPreferenceBugFixWeblabOn()&&ta()&&t.hasActiveTemporaryPreference&&t.hasActiveTemporaryPreference()&&w();var e=b?S(b.currentTarget):c;b=function(){if(ea){m.blockAllActions();var a=e.data("shrink-panel"),b=e.data("loading-text");(a=S("#"+a))&&a.length?a.hasClass("expanded")||m.shrinkPanel(S(".spp-panel.expanded"),!1):a=S(".spp-panel.expanded");m.shrinkPanel(a,!0,b)}else m.show()};g.resetMetrics();!ja||ha(e)||da(e)?b():a.delay(b,0);
try{ka=!0,J=e,p.isAjaxStreamingEnabled()&&xa&&!ma(e)&&xa.enableExecution(),oa||x(e)}catch(d){b="An error occured while click on the continue button.",d.message&&(b+="  Error message: "+d.message),r.error(b,"page-conductor","continueClicked",d)}}function Ca(){S("#checkout-btf-spinner").addClass("aok-hidden")}var S=a.$,oa,ra,ca,wa,ka,J,za,Fa,U,ya,Aa=function(a){if(!Fa)throw Error("Member _updatePageContent not set in page-conductor. Make sure 'initFunc' is called.");return Fa(a)},ea=!1,qa=!1,ia=!1,
ja=!1,ua=!1,xa;w();a.declarative("page-transit-no-update-action","click",function(b){if(!ia){b.$event.preventDefault();g.resetMetrics();var d=b.data.targetDeclarativeActionId;if(d&&(d=S("#"+d),d.length)){d.trigger("click");return}var f=b.data.toPage,d=b.data.fromPage||c.getCurrentPage(),h=b.data.refTag||"chk_"+d+"_cancel_pri",l=b.data.args,t=b.$currentTarget.find("a.checkout-pipeline-pref-link");ea&&e.setCachedPageData(d,f);if(e.getCachedPageData(f,d)){g.increaseCount("checkout:"+d+":cancelpri",1);
h=e.getCachedPageData(f,d);w();c.setCurrentPage(h.page);var k;k=p.isAJAXWeblabOn()?Aa(h.curPageData):Aa(JSON.stringify(h.curPageData));if(ea)if(g.isTransitionLoggingEnabled()){var u=(new Date).getTime();g.logPageTransition(d+"-cached",f,D,function(b){b=(new Date).getTime()-u;b<k?a.delay(function(){n(f)},k-b):n(f)})}else a.delay(function(){n(f)},k);else n(f);h.title&&h.url&&q.history&&q.history.pushState&&history.state&&history.state.page!==h.page&&history.pushState(h.state,h.title,h.url)}else t.length?
W(null,t):(g.increaseCount("checkoutSPPCancelNoCachedData",1),t=function(){if(ea)if(m.blockAllActions(),b.data.noShrink)m.show();else{var a=b.data.loadingText,c=S("#"+b.data.shrinkPanel);c.length||(c=b.$currentTarget.closest("div.spp-panel"));m.shrinkPanel(c,!0,a)}else m.show()},ja?a.delay(t,0):t(),V(d,f,l,{refTag:h,keepCachedPagesData:1}))}});p.isAjaxStreamingEnabled()&&(a.on("checkout:page:atf",function(){m.hide();S("#checkout-btf-spinner").removeClass("aok-hidden")}),a.on("checkout:page:end",function(){Ca()}));
a.on("ready",function(){ja=0<S("#executeNonBlockingAnimations").length;ua=0<S("#prefetchFromAddressEnabled").length});a.on("checkout:afterReload",function(){m.hide();p.isAjaxStreamingEnabled()&&Ca();a.delay(g.sendUEPageLoadStats);if(P()){var b=S("form.checkout-page-form:not(:disabled):first"),c=S("a.checkout-continue-link:not(:disabled):first");S("#useFirstActivePrefetch").length&&(c=S("a.checkout-continue-link:not(:disabled)").filter(function(){return 0<(parseInt(S(this).data("maxPrefetches"),10)||
0)}).first());var d=!1;b.length&&(d=sa(b));!d&&c.length&&(d=sa(c));!d&&ea&&(b=S("a.checkout-pipeline-pref-link:not(:disabled):first"),b.length&&(c=b.data("fromPage"),d=b.data("toPage"),e.getCachedPageData(d,c)||(d=sa(b))))}});return{ajaxUpdatePage:N,ajaxRedirect:H,ajaxSorryPage:F,isPageLoadRequestInProgress:function(){return ra?1:0},submitFormAjax:Y,reloadPage:function(){var a=c.getCurrentPage();V(a,a)},loadPage:V,usePrefetch:ba,makePrefetch:sa,makePrefetchWithParams:O,isPrefetchValidFor:function(a){if(null!==
ca){var b=ca.response.getResponseHeader("x-amz-checkout-page");return a===b}return!1},redirect:H,continueClicked:W,initFunc:function(a,b){Fa=a;U=b},overrideIsSPP:function(a){ea=a},isSPP:function(){return ea},overrideAddToCart:function(a){qa=a},isAnimating:function(){return ia},overrideIsAnimating:function(a){ia=a},setAjaxTransitionHeader:y,isPipeliningOn:P,disablePageNoUpdateTransition:function(){ua&&r.when("a-button").execute(function(a){var b=S(".spp-panel.expanded").data("stepIndex");S(".expand-collapsed-panel-trigger").each(function(){var c=
S(this),d=c.parents(".spp-panel").data("stepIndex");if(!b||!d||d>b)c.filter(".clickable-heading").removeClass("clickable-heading").addClass("off-clickable-heading"),a(c.filter(".expand-panel-button")).disable(),c.filter("a.expand-panel-button").addClass("disabled-link"),c.parents(".a-declarative").addClass("off-declarative").removeClass("a-declarative")});S(".panel-cancel-row").hide()})},enablePageNoUpdateTransition:function(){ua&&r.when("a-button").execute(function(a){S(".off-clickable-heading").addClass("clickable-heading").removeClass("off-clickable-heading");
a(".expand-collapsed-panel-trigger.expand-panel-button").enable();S(".off-declarative").addClass("a-declarative").removeClass("off-declarative")})},isNonBlockingAnimationEnabled:function(){return ja},isPrefetchFromAddressEnabled:function(){return ua},getExecutionId:G}});r.when("jQuery","page-transition-controller","ajax-utility","page-detector-current-page","checkout-general-utils","page-conductor","cache-page-data-controller","client-side-metrics","weblab-helper","ready").execute(function(a,m,k,
c,f,g,l,e,h){if(g.isPipeliningOn()){q.history&&a(q).bind("popstate",function(){var b=this.history.state,d=c.getCurrentPage();b&&b.page&&d&&(b.page!==d||g.isPageLoadRequestInProgress())&&(m.show(),d=a("#checkoutDisplayPage"),d.data("wipeOnPipelineBackTransition")&&d.empty(),e.resetMetrics(),a("#useFastBackButton").length&&g.isPrefetchValidFor(b.page)?g.usePrefetch({pushNewFrame:!1}):(d="spc"===b.page?"":b.page,g.loadPage(c.getCurrentPage(),d,b.additionalURLArgs,{refTag:"pipelinedBackButton",pushNewFrame:"false"})))});
a(document).delegate("form.checkout-page-form","change",function(b){a(b.target).parent().hasClass("no-prefetch-on-change")||(b=a(b.currentTarget),g.makePrefetch(b))});a(document).delegate("form.checkout-page-form","submit",function(a){g.continueClicked(a)});a(document).delegate("a.checkout-continue-link","click",function(a){g.continueClicked(a)});a(document).delegate("form.checkout-page-form .submit-button-with-name","click",function(b){b=a(b.currentTarget);a("\x3cinput\x3e").attr({type:"hidden",
name:b.attr("name"),value:b.val()}).appendTo(b.closest("form.checkout-page-form"))});var d=!1;a(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a","touchmove",function(a){d=!0});a(document).delegate("a.pipeline-link, div.pipeline-link, span.pipeline-link a","click keypress touchend",function(b){if(d)d=!1,b.preventDefault();else if(f.protectAgainstDoubleAction("pipeline-link"))b.preventDefault();else if("keypress"!==b.type||13===b.which){var c=a(b.currentTarget),h=c.data("pipelineLinkFromPage"),
k=c.data("pipelineLinkToPage"),y=c.data("pipelineLinkAnchor"),w=c.data("pipelineLinkRef");w||((w=f.extractURLParts(c.attr("href")).refMarker)?e.increaseCount("Checkout:PageConductor:LoadPage:AddedRefMarker"):e.increaseCount("Checkout:PageConductor:LoadPage:NoRefMarkerInUrl"));c=c.data("pipelineLinkArgs");k&&(e.resetMetrics(),b.preventDefault(),g.isSPP()&&l.setCachedPageData(h,k),m.show(),b={refTag:w,anchor:y},g.isSPP()&&(b.keepCachedPagesData=1),g.loadPage(h,k,c,b))}});a(document).delegate("a.spclite-dispatch-link",
"click keypress touchend",function(b){if("keypress"!==b.type||13===b.which){var c=a(b.currentTarget),d=c.data("spcliteLinkFromPage"),e=c.data("spcliteLinkToPage");c.data("spcliteLinkAnchor");var f=c.data("spcliteLinkRef"),c=c.data("spcliteLinkArgs"),h=a("input#executionId").val(),c=c?c+("\x26executionId\x3d"+h):"executionId\x3d"+h;e&&(b.preventDefault(),m.show(),g.loadPage(d,e,c,{refTag:f},"/gp/buy/shared/handlers/spclite-dispatch.html"))}})}a(document).delegate("input.submit","click touchend",function(){e.resetMetrics()});
a(document).delegate("form","submit",function(){e.resetMetrics()});a(document).delegate(".panel-cancel-row a, .clickable-heading","click",function(){e.isTransitionLoggingEnabled()&&e.resetMetrics()});h.isExecutionIdInQueryStringEnabled()&&(a.ajaxSetup({beforeSend:function(a,c){c.url&&(a=f.getQueryStringParameter(q.location.href,"executionId"),c.url=f.addQueryStringParameterOrDeleteIfEmpty(c.url,"executionId",a));return!0}}),a(document).ajaxSuccess(function(a,c,d){if(d&&d.url&&d.url.match(/\/async-continue|\/set-|\/update-|\/new/i)&&
(a=c.getResponseHeader("x-amz-checkout-sub-page-type")||"Unknown",!a.match(/^p-/))){d=g.getExecutionId(c);if(q.history&&q.history.replaceState){var h=f.addQueryStringParameterOrDeleteIfEmpty(q.location.href,"executionId",d,!0);q.history.replaceState(q.history.state,"",h)}else e.increaseCount("Checkout:PageConductor:NoReplaceState");d||(c=c.getResponseHeader("x-amz-checkout-page-type")||"Unknown",e.increaseCount("Checkout:PageConductor:"+(null===d?"ExecutionIdIsNotSet":"ExecutionIdIsEmpty")+":"+c+
":"+a,1))}}))});"use strict";r.when("A","a-popover-base","a-popover-util").register("checkout-modal-popover",function(a,m,k){function c(b){return b.disableHide?function(){}:function(){var c=this;c.animating=!0;a.fadeOut(this.$popover,250);b.secondaryPopover||h("#a-popover-modal").hide();a.delay(function(){c.animating=!1},250)}}function f(a,b){var e=c(b);a=a.$event.triggerPositioningElement?a.$event.triggerPositioningElement:a.$declarativeParent;(d=m.show({$trigger:a,name:b.name,skin:p(b.header,b.closeButton,
b.closeTextOverride),content:b.content,url:b.url,data:b.data,update:z,alone:b.alone?"true"===b.alone:!0,position:b.position||"triggerVertical",hide:e}))&&d.$trigger!==a&&(d.$trigger=a,d.updatePosition())}function g(a,d){d.disableHide=!0;var e=c(d);b=!1;(d=m.show({$trigger:a.$declarativeParent,skin:t(d.header,d.footer,d.closeButton,d.contentClass),name:d.name,requestURL:d.url,position:"windowCenter",update:z,data:d.data,updatePosition:d.allowScrollOnPage?y:w,modal:!0,alone:d.alone?"true"===d.alone:
!0,show:function(){this.animating=!0;this.$popover.show();h("#a-popover-modal").show();this.animating=!1},hide:e}))&&d.$trigger!==a.$declarativeParent&&(d.$trigger=a.$declarativeParent,d.updatePosition())}function l(b){var c=b.$declarativeParent;a.delay(function(){e(b,c)},250)}function e(b,c){d&&(k.eventOccursWithin(b,c)||k.eventOccursWithin(b,d.$popover))?a.delay(function(){e(b,c)},250):m.hide(c)}var h=a.$,d,b=!1,p=function(a,b,c){return function(d){var e=c;c===D&&(e=h("input#closeButtonText").val()||
"");var f="";e&&(f='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+e+"\x3c/a\x3e\x26nbsp;");e="false"===b?"":['\x3cdiv class\x3d"popover-close-section"\x3e',f,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");return['\x3cdiv class\x3d"a-popover"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',a||
e?['\x3cdiv class\x3d"a-popover-header"\x3e\x3ch4\x3e',a,"\x3c/h4\x3e",e,"\x3c/div\x3e"].join(""):"",'\x3cdiv class\x3d"a-popover-inner"\x3e',d,'\x3c/div\x3e\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}},t=function(a,b,c,d){return function(e){var f=h("input#closeButtonText").val()||"",p="";f&&(p='\x3ca href\x3d"#" data-action\x3d"custom-popover-close" class\x3d"a-declarative popover-close-link"\x3e'+f+"\x3c/a\x3e\x26nbsp;");
f="false"===c?"":['\x3cdiv class\x3d"popover-close-section"\x3e',p,'\x3c/div\x3e\x3cbutton data-action\x3d"custom-popover-close" class\x3d"a-button-close a-declarative" role\x3d"button"\x3e\x3ci class\x3d"a-icon a-icon-close"\x3e\x3c/i\x3e\x3c/button\x3e'].join("");f=a||f?['\x3cdiv class\x3d"a-popover-header huawei-device-header-fix"\x3e\x3ch4\x3e',a,"\x3c/h4\x3e",f,"\x3c/div\x3e"].join(""):"";p="";if(b){var g=h("#a-popover-footer-"+b);0<g.length&&(p=['\x3cdiv class\x3d"a-popover-footer"\x3e',g.html(),
"\x3c/div\x3e"].join(""))}return['\x3cdiv class\x3d"a-popover a-popover-modal"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e',f,'\x3cdiv class\x3d"a-popover-inner ',d,'"\x3e',e,"\x3c/div\x3e",p,'\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")}};a.declarative("custom-popover-close",["click","touchend"],function(b){b.$event.preventDefault();var c=b.$target;h("html").hasClass("a-ie6")||h("html").hasClass("a-ie7")||h("html").hasClass("a-ie8")?
c.closest(".a-popover").hide():a.fadeOut(c.closest(".a-popover"),250);h("#a-popover-modal").hide();a.trigger("a:declarative:a-popover-close:click",{$target:c,$event:b.$event,$currentTarget:b.$currentTarget})});a.on("a:popover:positionUpdated",function(a){a=a.popover.$popover;0>a.offset().left&&a.offset({left:0});0>a.offset().top&&a.offset({top:0})});a.on("a:popover:show",function(a){if(a.popover&&a.popover.$trigger){var b=a.popover.$trigger.data("aCheckoutModalPopover");b&&b.allowScrollOnPage&&a.popover.$popover.css("position",
"absolute")}});var z=function(a){h(".a-popover-inner",this.$popover).html(a)},y=function(a){if(!b||a)w.call(this,!0),b=!0},w=function(a){var b=h(q),c=b.height()/2,d=b.width()/2,e=this.$popover.height()/2,f=this.$popover.width()/2,c=c-e;if(a||"fixed"!==this.$popover.css("position"))c+=b.scrollTop();a=Math.max(0,d-f);c=Math.max(0,c);this.$popover.css({top:c,left:a})};a.declarative("a-checkout-popover",["click","mouseenter","mouseleave","keyup","touchend"],function(a){a.data.showOnHover&&"touchend"!==
a.type?"mouseenter"===a.type||"click"===a.type?f(a,a.data):"mouseleave"===a.type&&l(a):("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&f(a,a.data)});a.declarative("a-checkout-modal-popover",["click","keyup","touchend"],function(a){("click"===a.type||"touchend"===a.type||"keyup"===a.type&&a.$event.manualTrigger)&&g(a,a.data)});a.on("checkout:reload",function(){a.defer(function(){0===h("#a-popover-modal").length&&h("body").append('\x3cdiv id\x3d"a-popover-modal" /\x3e')})});
return{hideById:function(a){m.hide(a)},createModal:g}});"use strict";(function(){var a=!1;r.when("A").register("page-detector",function(m){function k(){return c("checkout-as")}function c(a){e||(e={});e.hasOwnProperty(a)||(e[a]=0<l("div."+a).length);return e[a]}function f(){return c("checkout.pay")}function g(){return c("checkout.spc")}var l=m.$,e;m.on("checkout:reload",function(){e={};a||r.when("page-detector-current-initializer").execute(function(a){a.initializeDetectorWithCurrentPage(null)})});
return{isAddressSelect:k,isAddressTranslation:function(){return c("translate-address-form")},isDesktopPayment:function(){return f()&&c("pay-desktop")},isDesktopSpc:function(){return g()&&c("spc-desktop")},isMobileAddressSelect:function(){return k()&&c("checkout-as-mobile")},isMobilePayment:function(){return f()&&c("pay-mobile")},isMobileSpc:function(){return g()&&c("spc-mobile")},isTabletAddressSelect:function(){return k()&&c("checkout-as-tablet")},isTabletPayment:function(){return f()&&c("pay-tablet")},
isTabletSpc:function(){return g()&&c("spc-tablet")},isSpcLite:function(){return g()&&c("spclite")},isPayment:f,isSosp:function(){return c("checkout.sosp")},isSpc:g,isMobile:function(){return c("checkout.mobile")},isTablet:function(){return c("checkout.tablet")}}});r.register("page-detector-current-initializer",function(){return{initializeDetectorWithCurrentPage:function(m){if(!a){var k=m;r.register("page-detector-current-page",function(){return{getCurrentPage:function(){return k},setCurrentPage:function(a){var f=
k;k=a;r.when("A").execute(function(g){g.trigger("page-detector:page-changed",f,a)})}}});a=!0}}}})})();"use strict";r.when("jQuery","loading-spinner-controller").register("page-spinner-controller",function(a,m){function k(){"function"===typeof y.blockAllActions&&y.blockAllActions()}function c(){"function"===typeof y.unblockAllActions&&y.unblockAllActions()}function f(a){"function"===typeof y.showTransitionInContainer&&y.showTransitionInContainer(a)}function g(){var b=a(q).width(),c=a(q).height(),d=
a(q),e=0;null!==z&&(e=z.outerHeight()-a(q).scrollTop(),0>e&&(e=0));p.css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c);"1"!==a("input[name\x3dfromAnywhere]").val()&&a("#loading-spinner-blocker-doc").css("top",d.scrollTop()+e+"px").css("left",d.scrollLeft()+"px").width(b).height(c)}function l(){var b;b=document.activeElement?a(document.activeElement):a(":focus:first");b.is("button, a, input:enabled")&&b.blur()}function e(){if(w){k();r.when("spp-button-blocker").execute(function(a){a.hideContinueBtnBlocker()});
var c=a(".spp-panel.expanded");if(0<c.length&&c.is(":visible")){f(c,1);return}}if(t)return p.length&&p.find(".loading-spinner-inner").show(),!1;t=!0;l();p=a("#spinner-anchor");p.find(".loading-spinner-inner").show();a("#unblockHeader").length&&(z=a("#header"));d=p.css("z-index");a(q).unbind("scroll.checkout-page-spinner").bind("scroll.checkout-page-spinner",function(a){b&&q.clearTimeout(b);b=setTimeout(function(){g();b=null},50)});a(q).unbind("resize.checkout-page-spinner").bind("resize.checkout-page-spinner",
function(){g();m.adjustSize(p)});a(q).unbind("orientationchange.checkout-page-spinner").bind("orientationchange.checkout-page-spinner",function(){g();m.adjustSize(p)});g();p.show();p.css("z-index",2E3);m.showSpinner(p,!0);return!0}function h(){if(w)c(),"function"===typeof y.hideSpinner&&y.hideSpinner();else{a("#first-pipeline-load-page-spinner").remove();if(!t)return!1;t=!1;p.length&&p.find(".loading-spinner-inner").show();p&&(a(q).unbind(".checkout-page-spinner"),p.hide(),p.css("z-index",d),m.hideSpinner(p));
return!0}}var d,b=null,p,t=!1,z=null,y={},w=!1;return{show:e,showPageTransition:function(){return"0"===a("#showPageTransition").attr("content")?!1:e()},hide:h,hidePageTransition:function(){"0"===a("#showPageTransition").attr("content")&&h();return!0},hideAnimatedSpinnerImage:function(){p.length&&p.find(".loading-spinner-inner").hide()},initFunc:function(a){null!==a&&(y=a,w=!0)},blockAllActions:k,unblockAllActions:c,showTransitionInContainer:f,shrinkPanel:function(a,b,c){"function"===typeof y.shrinkPanel&&
y.shrinkPanel(a,b,c)},clearFocus:l}});"use strict";r.when("A").execute(function(a){a=a.$;var m="",m="mash-transitions"===a("input[name\x3dpageTransitionType]").val()?"page-mash-transition-controller":"page-spinner-controller";r.when(m).register("page-transition-controller",function(a){r.when("A").execute(function(c){c.declarative("page-spinner-show",["click"],{allowLinkDefault:!0},function(c){c=c.$target;c.hasClass("a-button-disabled")||c.closest(".a-button-disabled").length||a.showPageTransition()})});
r.when("A").execute(function(c){c.declarative("page-spinner-show-on-submit",["submit"],{allowLinkDefault:!0},function(c){a.showPageTransition()})});return{show:a.show,hide:a.hide,showPageTransition:a.showPageTransition,hidePageTransition:a.hidePageTransition,blockAllActions:a.blockAllActions,unblockAllActions:a.unblockAllActions,showTransitionInContainer:a.showTransitionInContainer,shrinkPanel:a.shrinkPanel}})});"use strict";r.when("A","page-conductor","client-side-metrics","page-detector-current-page",
"a-popover","ready").execute(function(a,m,k,c){function f(a,c,d){m.isSPP()&&k.setmarker&&k.setmarker("af");k.sendUEPageLoadStats()}var g=a.$,l=!1;a.on("a:popover:afterHide",function(a){a.popover&&(l=!1)});a.on("a:popover:beforeShow",function(a){var c=a.popover;c&&(l=!0,c.$trigger.find(".modal-parameters").each(function(){g.each(g(this).data(),function(a,b){c.attrs(a,b)})}))});a.on("a:popover:dismiss",function(a){a=a.popover;if(k.isTransitionLoggingEnabled()&&a&&l){l=!1;var h,d;"prime-acquisition-spc-popover"===
a.name&&(h="prime-acquisition",d=c.getCurrentPage());h||d||!a.attrs||(h=a.attrs("returnfrom"),d=a.attrs("returnto"));h&&d&&(k.resetMetrics(),k.logPageTransition(h,d,f))}})});"use strict";r.when("A","page-detector-current-page","checkout-general-utils","client-side-metrics").register("first-load-dependencies-base",function(a,m,k,c){function f(){"function"===typeof q.uet&&"function"===typeof q.uex&&(q.uet("cf","first-load-dependencies-ready",{wb:1}),q.uex("ld","first-load-dependencies-ready",{wb:1}));
c.startWidgetTiming("first-load-dependencies:checkout:beforeReload");a.trigger("checkout:beforeReload");c.finishWidgetTiming("first-load-dependencies:checkout:beforeReload");c.startWidgetTiming("first-load-dependencies:checkout:reload");a.trigger("checkout:reload");c.finishWidgetTiming("first-load-dependencies:checkout:reload");var e;l&&(e="spp-revieworder"===l?"spc":l);e&&(c.finishWidgetTiming("first-load-dependencies:checkout:reload:"+e),a.trigger("checkout:reload:"+e),c.finishWidgetTiming("first-load-dependencies:checkout:reload:"+
e));c.startWidgetTiming("first-load-dependencies:checkout:afterReload");a.trigger("checkout:afterReload");c.finishWidgetTiming("first-load-dependencies:checkout:afterReload");setTimeout(function(){var a=g("#first-pipeline-load-page-spinner");a.is(":visible")&&(a.remove(),c.increaseCount("checkout:pageload:timeout"),k.logError("The page has taken more than 90 seconds to load, or there was a JS error preventing it from loading, hiding page spinner."))},9E4)}var g=a.$,l=m.getCurrentPage();"function"===
typeof q.uet&&q.uet("bb","first-load-dependencies-ready",{wb:1});return{allDependenciesCheck:function(a){if(a&&a.length){var h=!1,d={};g.each(a,function(a,b){c.startWidgetTiming("checkout:dependency:"+b+":ready");d[b]=1;r.when(b).execute(function(){c.finishWidgetTiming("checkout:dependency:"+b+":ready");delete d[b]})});var b=function(a){a="Page ("+l+") is missing dependencies ["+a.join(", ")+"] after 5 secs.";c.increaseCount("checkout:dependency:missed:regular-page:error");k.logErrorOnLevel(a,"ERROR")},
p=setTimeout(function(){if(!h){var a=[];g.each(d,function(b){c.increaseCount("checkout:dependency:"+b+":missed");a.push(b)});c.increaseCount("checkout:dependency:missed");0<g("#assets-prefetch").length?c.increaseCount("checkout:dependency:missed:assets-prefetch"):(c.increaseCount("checkout:dependency:missed:regular-page"),b(a));f()}},5E3);r.when.apply(r,a).execute(function(){h=!0;q.clearTimeout&&p&&q.clearTimeout(p);f()})}else f()}}});"use strict";r.when("A","page-detector","client-side-metrics").register("gift-utility",
function(a,m,k){var c=a.$,f=/[^\s\u0020-\u007E\u00A0-\u00FF]/g,g=q.P&&q.P.AUI_BUILD_DATE,l=/((?:file|https?|ftps?|sip):\/\/)/im,e=/((?:\b|[\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?])www\.(?:(?:[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+\.[^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?]+))+)(?:[\s!@#$%^&*()_=+[\]{}\|;:'",<>\?]|$|\b)/im,h=/([^\s!@#$%^&*()_=+[\]{}\|;:'",.<>\?\/]+\.(?:[a-z][a-z]|aero|arpa|asia|biz|cat|com|coop|edu|gov|info|int|jobs|mil|mobi|museum|name|net|org|om|pro|qa|tel|travel|xxx)(?:\b|$))/im,d=/^\S+\@\S+\.\S+$/im;
return{getInput:function(a){return a.is("input")?a:a.find("input")},getCharCount:function(a,c){return c?q.unescape(encodeURIComponent(a)).length:a.length},getLineCount:function(a,c){var d=a.split("\n").length;c=Math.floor(c);a=a.split("\n");for(var e=0;e<a.length;e++)a[e].length>c&&(d+=Math.floor(a[e].length/c),0===a[e].length%c&&d--);return d},getNameWithNoTitle:function(a){var c=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&(c=!0);c&&a.shift();return a.join(" ")},
getFirstName:function(a){var c=!1;a=a.split(" ");/^(?:Dr|Mr|Mrs|Ms|Mme|Lt|Attn|Attn:|Prof|Pt|The)\.?$/i.test(a[0])&&(c=!0);c&&a.shift();return a.shift()},toggleGiftMessageWarning:function(a,d){var e=d.find(".gift-message-warning");if(f.test(a.val())){var h=d.find(".gift-message-preview-trigger"),l=a.val().replace(f,"?");g?r.when("a-popover").execute(function(a){var b=a.get(h);b?b.update({content:l}):a.create(h,{inlineContent:l,position:"triggerVertical",closeButton:"false"})}):(k.increaseCount("removeauijs13"),
h.unbind("click.preview").bind("click.preview",function(a){r.when("a-popover-base").execute(function(b){var d=c(a.target);d.data("popoverid")&&(b=b.get(d.data("popoverid")))&&(b.update(l),b.updatePosition())})}));a.addClass("a-form-error");e.show()}else a.removeClass("a-form-error"),e.hide()},valueContainsUrl:function(a){return l.test(a)||e.test(a)||h.test(a)},isValidEmail:function(a){return d.test(""+a)}}});"use strict";r.when("A","page-detector","safe-mash","client-side-metrics").register("help-popup",
function(a,m,k,c){function f(){if(g("div#help-popover").length){g(q).unbind("resize.checkout-help-popover");var a=g("#help-popover-frame")[0];g(a.contentWindow?a.contentWindow:a.contentDocument.defaultView).undelegate("a","click");g("div#help-popover").remove()}}var g=a.$;m=m.isMobile();c=g("input#isPipelinedPage");c=0<c.length&&"1"===c.val();var l=m&&c&&k&&k.navigate;a.declarative("help-popup",["click"],function(a){if(!g(".a-touch").length||l){a.$event.preventDefault();a.data&&"1"===a.data.stopPropagation&&
a.$event.stopPropagation();var c=a.$target.closest("a").attr("href");a=a.data;l?k.navigate({url:c,transitionEffect:"slide"}):(a.width||(a.width="340"),a.height||(a.height="340"),q.open(c,"AmazonHelp","width\x3d"+a.width+",height\x3d"+a.height+",left\x3d10,top\x3d10,resizable\x3dyes,scrollbars\x3dyes,menubar\x3dno,toolbar\x3dyes,location\x3dno,directories\x3dno,status\x3dyes"))}else q.open(a.$target.closest("a").attr("href"),"AmazonHelp")});if(l)a.on("checkout:reload",f)});"use strict";r.when("jQuery",
"page-conductor").register("quantity-service",function(a,m){function k(c,f){f=f||{};var g;f.additionalData&&(g=f.additionalData);var l="/gp/buy/pipeline/handlers/update-quantity.html",e={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};g&&g.deletePrimeMembership&&g.primeMembershipASIN&&(e.deletePrimeMembershipItemIn=g.deletePrimeMembership,e.deletedPrimeMembershipASINIn=g.primeMembershipASIN);f.ref&&(l+="/ref\x3d"+f.ref,delete f.ref);g=f.success;delete f.success;
var h=m.ajaxRedirect;f.error&&(h=f.error,delete f.error);a.extend(e,f);f=[];for(var d in c)c[d]!==D&&(f.push(d),e[d]=c[d]);e.entityids=f;c=m.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});a.ajax({type:"POST",url:l,data:a.param(e,!0),dataType:"text",async:!0,cache:!1,headers:c,success:g,error:h})}return{callBatch:function(a,f){k(a,f)},call:function(a,f,g){var l={};l[a]=f;k(l,g)}}});"use strict";r.when("jQuery").register("scroll-controller",function(a){return{scrollToTop:function(){a(q).scrollTop(0)},
toggleScrollOn:function(){a(document).unbind("touchmove")},toggleScrollOff:function(){a(document).bind("touchmove",function(a){a.preventDefault()})}}});"use strict";r.when("A","checkout-general-utils","ready").execute(function(a,m){a.$("#checkout-mash-will-load").length?r.when("mash").execute(function(a){var c;"object"===typeof a?c=a:q.amazon&&q.amazon.mash&&(c=q.amazon.mash);"object"!==typeof c?m.logError("MASH is expected but can't be found"):r.register("safe-mash",function(){return c})}):r.register("safe-mash",
function(){})});"use strict";r.when("A","scheduled-delivery-external-interface","shipping-speed-selection-controller","page-detector","ready").register("scheduled-delivery-controller",function(a,m,k,c){var f=a.$,g={};k=function(){g={};f("div.fake-label input[type\x3d'radio']:checked").each(function(){var a=f(this),c=a.closest("div.fake-label");(c=m.getSdWidgetRootId(c))&&(g[a.attr("name")]=c)})};a.on("checkout:reload:shipoptionselect",k);a.on("checkout:reload:spp-revieworder",k);c.isSosp()&&k();f(document).delegate("div.fake-label",
"click",function(){if(c.isSosp()){var l=f(this),e=l.find("input[type\x3d'radio']");e.attr("disabled")||(e=e.attr("name"),l=m.getSdWidgetRootId(l),a.trigger("scheduled-delivery:ship-option-changed",{current:l,previous:g[e]}),g[e]=l)}});f(document).delegate(".ship-option.is-scheduled-delivery","click",function(){if(c.isSpc()){var g=f(this);g.find("input[type\x3d'radio']").attr("disabled")||(g=m.getSdWidgetRootId(g))&&a.trigger("scheduled-delivery:ship-option-changed",{current:g,previous:null})}});a.on("scheduled-delivery:unblock-continue",
function(){r.when("button-blocker").execute(function(a){a.hide("scheduled-delivery")})});a.on("scheduled-delivery:block-continue",function(a){r.when("button-blocker").execute(function(c){c.show("scheduled-delivery",a)})});a.on("scheduled-delivery:disable-ship-option",function(a,e){var h;a=f("#"+a);if(0!==a.length){if(c.isSpc())a=a.closest(".shipping-speed");else if(c.isSosp())a=a.closest("div.fake-label.a-box");else return;h=a.find("input[type\x3d'radio']");h.attr("disabled",!0);h.is(":checked")&&
e&&(e=f("input[name\x3d"+h.attr("name")+"]:radio:not(:disabled):first"),e.prop("checked",!0),e.trigger("change"));a.addClass("sd-disabled")}});a.on("scheduled-delivery:enable-ship-option",function(a){var e;a=f("#"+a);if(0!==a.length){if(c.isSpc())a=a.closest(".shipping-speed");else if(c.isSosp())a=a.closest("div.fake-label.a-box");else return;e=a.find("input[type\x3d'radio']");e.removeAttr("disabled");a.removeClass("sd-disabled")}})});"use strict";r.when("A","ready").register("mobile-nav-bar-back-controller",
function(a){a.capabilities.history&&(a=a.$,a=a("#mobile-top-bar-navigation-back"),1<=a.length&&a.click(function(a){a.preventDefault();q.history.back()}))});"use strict";r.when("A","page-spinner-controller","page-detector","page-conductor","weblab-helper","ready").execute(function(a,m,k,c,f){function g(a,b){var c=[];a.addressId||c.push("addressId");a.slotKey||c.push("slotKey");a.shippingOfferingId||c.push("shippingOfferingId");a.conflictItems&&!p.isArray(a.conflictItems)&&c.push("conflictItems");if(0<
c.length){a="Error calling fresh widget callback on "+b+": Bad or Missing Input: "+c[0];for(b=1;b<c.length;b++)a+=", "+c[b];console.error(a);return 0}return 1}function l(){p("#freshSlotKey").val("");p("#freshAddressId").val("");p("#freshReservationToCancel").val("");p("#freshConflictingItems").val("");p("#freshShipOfferingId").val("")}function e(a){var b="",c=f.sospPartialAvailabilityWeblabOn();if(a&&p.isArray(a)&&0<a.length)for(var b=a[0].asin+":"+a[0].merchantId+(c?"|"+a[0].maxQtyAvailable:""),
d=1;d<a.length;d++)b+="-"+a[d].asin+":"+a[d].merchantId+(c?"|"+a[d].maxQtyAvailable:"");return b}function h(a){var b;b="page\x3dspc\x26returnFullHTML\x3d1\x26callSetters\x3d1\x26freshSlotKey\x3d"+a.addressId;b+="\x26freshAddressId\x3d"+a.slotKey;a.reservationToCancel&&(b+="\x26freshReservationToCancel\x3d"+a.reservationToCancel);(a=e(a.conflictItems))&&(b+="\x26freshConflictingItems\x3d"+a);a=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});m.show();p.ajax({type:"POST",url:"/gp/buy/shared/handlers/handle-fresh-widget-results.html/ref\x3dset-fresh-information",
data:b,dataType:"text",async:!0,cache:!1,headers:a,success:function(a,b,d){return d.getResponseHeader("x-amz-checkout-page")?c.ajaxUpdatePage(a,b,d):c.redirect(a)},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function d(){p(".sosp-continue-button").removeClass("js-hide").removeClass("aok-hidden");p(".continue-button-blocker").addClass("aok-hidden")}function b(){p(".sosp-continue-button").addClass("aok-hidden");p(".continue-button-blocker").removeClass("aok-hidden")}var p=a.$;a.on("handle-fresh-results",
function(a){if(p("#isfresh").val())if(a)if(k.isSosp())if(g(a,"sosp")){p("#freshSlotKey").val(a.slotKey);p("#freshAddressId").val(a.addressId);p("#freshReservationToCancel").val(a.reservationToCancel);var f=e(a.conflictItems);p("#freshConflictingItems").val(f);p("#freshShipOfferingId").val(a.shippingOfferingId);f&&0<f.length?p("input#block-prefetch").val(1):p("input#block-prefetch").val(0);f=p("#shippingOptionFormId");a.conflictItems&&0<a.conflictItems.length||c.makePrefetch(f);d()}else l(),b();else k.isSpc()?
g(a,"spc")&&h(a):console.error("remote fresh widget JS callback called on unsupported page.");else console.error("remote fresh widget JS callback called with empty data.");else console.error("remote fresh widget JS callback called without isfresh flag on page")});a.on("block-continue",function(a){p("#isfresh").val()?a?"undefined"===typeof a.blockContinue?console.error("block continue callback - missing blockContinue"):k.isSosp()?1===a.blockContinue?(b(),l()):0===a.blockContinue?d():console.error("block continue callback - invalid value"):
console.error("block continue callback called on unsupported page."):console.error("block continue callback called with no argument"):console.error("block continue callback called without isfresh flag on page")});a.on("confirm-and-continue",function(){p("div.sosp-fresh #shippingOptionFormId").submit()});a.on("redirect-to-spc",function(){c.redirect({conductoraction:{url:'/gp/buy/spc/handlers/display.html/ref\x3d"cancel-fresh-address-select"',type:"redirect"}})})});"use strict";r.when("A","ready").execute(function(a){function m(){(0<
k(".change-preference-block").length||0<k(".mobile-change-preference-block").length)&&!1===c&&(r.register("loadVasRcxCheckoutAsset",function(){}),c=!0)}var k=a.$,c=!1;m();a.on("checkout:reload:spc",m);a.on("checkout:reload:shipoptionselect",m);a.on("checkout:reload:spp-revieworder",m)});"use strict";r.register("time-left-formatter",function(){function a(a,c,f,g,l){return 0>=c?a:a+c+" "+(1===c?l.HOUR:l.HOURS)+(!g&&0<f?" "+l.AND+" ":"")}function m(a,c,f,g,l){return 0>=c?a:a+c+" "+(1===c?l.MINUTE:l.MINUTES)+
(!g&&1>f?" "+l.AND+" ":"")+(1===g&&1>f?" ":"")}return{getTimeLeftFormatted:function(k,c,f){var g="",l=86400<k?(k-k%86400)/86400:0,e=3600<k?(k-k%3600)/3600:0;k-=3600*e;var h=60<k?(k-k%60)/60:0;k-=60*h;if(c&&0<l)return g+l+" "+(1===l?f.DAY:f.DAYS);if(c&&0<e)return a(g,e,h,c,f);if(c&&5<=h)return m(g,h,e,c,f);g=a(g,e,h,c,f);g=m(g,h,e,c,f);1<=e||(g=g+k+" "+(1===k?f.SECOND:f.SECONDS));return g}}});"use strict";r.when("A","page-transition-controller","checkout-general-utils","page-detector","page-detector-current-page",
"safe-mash","loading-spinner-controller","weblab-helper").register("shipoptionselect-controller",function(a,m,k,c,f,g,l,e){function h(a){var b=w(".delivery-window-groups .more-window");l.showSpinner(b,!1);a=a.$currentTarget.closest(".delivery-window-groups").data("orderid");b=w("input[name\x3dlineItemEntityIds_"+a+"]").attr("value");w.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/long-calendar-content.html",data:"lineitemids\x3d"+b+"\x26orderid\x3d"+a+"\x26isMobile\x3d1\x26fromPage\x3dsosp",dataType:"json",
async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:function(a){l.hideSpinner();if(a&&a.deliveryWindowGroups){var b=w(".delivery-window-groups .a-box-group");b.empty();w.each(a.deliveryWindowGroups,function(a,c){b.append(c)});a=w(".delivery-window-groups .selected-group");a.length&&a.trigger("click")}}})}function d(a,b){var c=w("div.one-shipment:visible");a=A?w("div.one-shipment").slice(parseInt(a,10),parseInt(b,10)+1):w("div.one-shipment#"+a);n&&0!==a.size()&&c.last().attr("id")!==a.last().attr("id")&&
(c.hide(),a.show(),w(q).scrollTop(0))}function b(){if(n){var a=(location.hash?location.hash.replace("#",""):"0-"+K).split("-");2===a.length&&d(a[0],a[1])}}function p(){function h(a,b){w.ajax({type:"POST",url:"/gp/buy/gift/handlers/remove-gift-option.html",data:b,dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:a,error:function(a,b,c){m.hide()}})}function p(a){var b=a.closest("div."+k);a.is(":checked")?(b.siblings("div."+k+".selected").removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),
b.addClass("selected").find(".a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active")):b.removeClass("selected").find(".a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");z("triggerChangeEvent",[a])}0<w(".prime-calendar-container").length&&w(".prime-calendar-container").contents().each(function(a,b){8===b.nodeType&&w(b).replaceWith(b.nodeValue)});var l=w(".delivery-window-groups .selected-group");
l.length&&l.trigger("click");v=w(".sosp-continue-button");n="1"===w("#isClientSidePagingEnabled").val()?1:0;K=(w("div.one-shipment:visible").length-1).toString();u="1"===w("#useMashNavigateForClientSidePaging").val()?1:0;A="1"===w("#collapseDigitalShipmentsEnabled").val()?1:0;var k=(l=q.P&&q.P.AUI_BUILD_DATE)?"selectable-box":"fake-label";n&&(w(".one-shipment:gt("+K+")").hide(),b());v.bind("click",function(b){function n(a,b){var c=f.getCurrentPage();if(q.history&&q.history.pushState){var d=location.href;
0<d.indexOf("#")&&(d=d.substring(0,d.indexOf("#")));d+="#"+a.attr("id")+"-"+b.attr("id");history.pushState({page:c,id:a.attr("id")},w("title"),d)}}var h=!1;w("div.one-shipment:visible input[type\x3d'radio'][checked]").each(function(){if(w(this).data("blockingOn"))return alert(w(this).data("blockingOn")),b.preventDefault(),h=!0,!1});if(h)return!1;if(e.removesGiftOptionOnRush()&&c.isMobile()&&null!=L){var p=w("div.one-shipment:visible"),l=p.find("input[type\x3d'radio']:checked").closest(".shipping-option");
if("1"===p.find("input[type\x3dhidden][name\x3disGiftWrapped]").attr("value")&&1===l.data("nosupportforgiftoption"))return L.show(),!1}t();p=w("div.one-shipment:visible");l=p.nextAll("div.one-shipment:hidden");if(0<l.length){b.preventDefault();var k=l.first(),m=k;A&&(m=l.filter(".shipment-with-ship-options"),m=1<m.length?m.eq(1).prev():l.last());u&&g&&g.navigate?g.navigate({url:null,transitionEffect:"slide",successCallback:function(){n(k,m)},failCallback:function(a){}}):n(k,m);d(k.attr("id"),m.attr("id"));
a.trigger("active-shipment-changed")}y("logInlineCalMetrics",[p])});w(".gift-option-removal-cancel-button").bind("click",function(a){L.hide()});w(".gift-option-removal-confirm-button").bind("click",function(a){m.show();L.hide();a="lineItemsToRemoveGiftOptionFrom\x3d"+w("div.one-shipment:visible").find("input[name^\x3dlineItemEntityIds_]").attr("value");var b=w("div.one-shipment:visible"),c=b.nextAll("div.one-shipment:hidden");h(function(a,d,e){b.find("input[type\x3dhidden][name\x3disGiftWrapped]").each(function(){w(this).remove()});
0<c.length?(v.click(),m.hide()):w(".checkout-page-form").submit()},a)});w(q).bind("popstate",function(a){c.isSosp()&&b()});w(document).delegate("div."+k,"click",function(a){a=w(this);a.find("input[type\x3d'radio']").trigger("change",["setActive"]);a.parent().hasClass("timeslot-picker")&&(a=a.find(".a-button-selected").length,v&&v.length&&(a?v.removeClass("a-button-disabled").addClass("a-button-primary").find("input").prop("disabled",!1):v.removeClass("a-button-primary").addClass("a-button-disabled").find("input").prop("disabled",
!0)))});var r;a.declarative("faster-than-same-day-sosp-save",["click","submit"],function(){var b="lineItemsToRemoveGiftOptionFrom\x3d"+r.closest(".one-shipment").find("input[name^\x3dlineItemEntityIds_]").attr("value");a.$("div.a-popover button.a-button-close").trigger("click");m.show();h(function(a,b,c){r.closest(".one-shipment").find(".isGiftWrapped").each(function(){w(this).remove()});r.attr("checked",!0);p(r);m.hide()},b)});w(document).delegate("div."+k+" input[type\x3d'radio']","change",function(a,
b){a=w(this);if("setActive"===b&&!a.attr("disabled")&&e.removesGiftOptionOnRush()&&0<a.closest(".one-shipment").find(".isGiftWrapped").length&&1==a.data("nosupportforgiftoption"))r=a,a.is(":checked")&&(b=a.closest("div."+k).siblings("div."+k+".selected").find('input[type\x3d"radio"]'),r.attr("checked",!1),b.attr("checked",!0)),setTimeout(function(){w("#faster-than-same-day-sosp-popover").trigger("click")},10);else{if("setActive"===b){if(a.attr("disabled"))return;a.attr("checked",!0)}if("disabling"===
b)if(a.attr("disabled",!0),a.is(":checked"))a.removeAttr("checked");else return;p(a)}});w("div."+k+" input[type\x3d'radio']:checked").change();w("h3").children().removeAttr("style");0===w("div."+k+".scheduled-delivery").length&&w("form.checkout-page-form").data("checkoutFormReady",!0).change();l&&w(document).delegate(".a-touch-radio a","click",function(a){if(!e.isSOSPExclusiveJSHandlerWeblabOn()||c.isSosp())if(e.isSOSPLinkPatchEnabled()){var b=w(a.target).attr("href");!b||b.startsWith("#")||b.toLowerCase().startsWith("javascript:")||
(g&&g.navigate?g.navigate({url:b,transition:"slide"}):a.preventDefault=!1)}else g&&g.navigate?g.navigate({url:w(a.target).attr("href"),transition:"slide"}):a.preventDefault=!1})}function t(){if(1===w("div.store-upsell-ship-options").length){var a="/gp/buy/shared/handlers/store-upsell-async.html",b="ox_store_upsell_continue_",c=w("div.ship-speed, div.store-upsell-ship-options").find("input.shipping-option, input.store-upsell-ship-option"),d=[],e;w.each(c,function(a,c){a=w(c);c=a.attr("value");d.push(c.toLowerCase());
a.is(":checked")&&(e=a.attr("value"),b=a.hasClass("store-upsell-ship-option")?b+"success":b+"failure")});a=k.addQueryStringParameter(a,"ref",b);w.ajax({url:a,type:"POST",async:!0,data:{shown:d.toString(),clicked:e}})}}function z(a,b){r.when("checkout-federation-wrapper","shipspeed-provider").execute(function(c,d){c.wrap(function(){d&&!w.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"VasCheckoutShipSpeedProvider")})}function y(a,b){r.when("checkout-federation-wrapper","sd-methods").execute(function(c,
d){c.wrap(function(){d&&!w.isEmptyObject(d)&&"function"===typeof d[a]&&d[a].apply(this,b)},"CricketInlineCalendarHeavyBulkyIN")})}var w=a.$,v,n,u,K,A=0,L;a.declarative("sosp-change-quantity-link",["click"],function(a){var b=a.$currentTarget,c=w("\x3cinput type\x3d'hidden' /\x3e").attr("name","change-quantities-or-delete").val("1");b.hasClass("pipeline-link")?(a.$event.preventDefault(),b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click")):
b.closest("form").removeClass("checkout-page-form").append(c).find(".sosp-continue-button:first").trigger("click").end().trigger("submit")});r.when("A","a-sheet").register("shipoptionselect-gift-removal-controller-mobile",function(a,b){L=b.create({name:"gift-removal-popover",height:220,preloadDomId:"gift-option-removal-message",closeType:"icon",sheetType:"web"})});a.declarative("sosp-extender-toggle",["click","touchend"],function(a){if(!k.protectAgainstDoubleAction("sosp-extender-toggle")){var b=
a.$target.closest("a"),c=w(".delivery-window-groups .a-box-group").find(".lazy-loaded");if(b.hasClass("aui-extender"))c.length?c.remove():h(a);else{var d=b.find("i"),b=b.closest("div.extender-section");d.hasClass("a-icon-extender-expand")?(b.find(".collapsed").hide(),b.find(".expanded").slideDown("fast"),d.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse"),h(a)):(b.find(".collapsed").show(),b.find(".expanded").slideUp("fast"),d.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"),
c.length&&c.remove())}}});a.declarative("sosp-select-prime-slot",["click","touchend"],function(a){if(!k.protectAgainstDoubleAction("sosp-select-prime-slot")){a=a.$currentTarget;var b=a.closest(".valid-slot");if(b.closest(".prime-calendar").hasClass("long-calendar")){var c=b.closest(".prime-calendar").data("orderid"),d=w("#calendar-"+c),c=w("#calendar-delivery-message-"+c),e=a.closest(".long-calendar");e.find(".selected-slot").removeClass("selected-slot");0<b.length&&b.addClass("selected-slot");w(".a-button-close").trigger("click");
b=a.data("slotid");b=d.find(".slot-"+b);if(0<b.length)d.show(),c.parent().hide(),b.closest(".prime-calendar").find(".selected-slot").removeClass("selected-slot"),b.closest(".valid-slot").addClass("selected-slot");else{var f=a.parent()[0],n=a.parent().parent().find(".rhead")[0],b=n.innerText;b||(b=n.textContent);f=f.cellIndex;e=e.find("th")[f];f=e.innerText;f||(f=e.textContent);c.text(f+" "+b);d.hide();c.parent().show()}}else c=b.closest(".prime-calendar-container").data("orderid"),d=w("#calendar-"+
c).find(".selected-slot"),0<d.length&&(d.removeClass("selected-slot"),0<b.length&&b.addClass("selected-slot"));d=a.closest(".prime-calendar-container").data("orderid");a.data("key")&&w("#order_"+d+"_ShippingSpeed").val(a.data("key"));a.data("isscheduleddeliveryslot")&&w("#sdData"+d).val(a.data("sddatastring"))}});a.declarative("sosp-select-delivery-window",["click","touchend"],function(a){if(!k.protectAgainstDoubleAction("sosp-select-delivery-window")){a=a.$currentTarget;a.length&&!a.hasClass("dwg-button")&&
(a=a.find(".dwg-button"));w(".dwg-button").removeClass("selected-dwg-button");a.addClass("selected-dwg-button");var b=a.closest(".delivery-window-groups").data("orderid"),c=a.data("key");!c&&a.find("button").length&&(c=a.find("button").data("key"));c&&w("#order_"+b+"_ShippingSpeed").val(c);c=a.data("isscheduleddeliveryslot");!c&&a.find("button").length&&(c=a.find("button").data("isscheduleddeliveryslot"));c&&(c=a.data("sddatastring"),!c&&a.find("button").length&&(c=a.find("button").data("sddatastring")),
w("#sdData"+b).val(c))}});a.on("checkout:reload:shipoptionselect",p);a.on("checkout:reload:spp-shipoption",p)});r.when("jQuery","page-detector").register("deliv-prefs-sosp",function(a,m){function k(){a(".sosp .order-delivery-time-preference").each(function(){var c=a(this);c.bind("selectionChanged",function(){0===c.find(".delivery-time-preference-group").length?c.hide():(c.show(),0===c.find("input:checked").length&&c.find("input:first").trigger("change",["setActive"]))}).bind("empty",function(){c.find(".delivery-time-preference-group").detach()});
var f=c.closest(".one-shipment").find("input.shipping-option");c.find(".delivery-time-preference-group").each(function(){var f=a(this),l=f.data("shippingoptionid"),l=a("#"+l);f.is(".template")&&f.detach().removeClass("template");l.change(function(){c.trigger("empty");f.appendTo(c);c.trigger("selectionChanged")}).addClass("hasDeliveryTimePreference")});f.not(".hasDeliveryTimePreference").change(function(f,l){"disabling"===l||a(this).is(":disabled")||(c.trigger("empty"),c.trigger("selectionChanged"))});
c.trigger("selectionChanged")})}r.when("A").execute(function(a){a.on("checkout:reload:shipoptionselect",k)})});r.when("A","shipoptionselect-controller").execute(function(a){var m=a.$,k={},c={};a.on("checkout:reload:shipoptionselect",function(){var a=m("#shippingOptionFormId"),g=a.find("input[name\x3dtrialKey]");if(1===g.length){for(var l in k)k.hasOwnProperty(l)&&(k[l].abort(),delete k[l]);k={};c={};var e=function(a){return a.join("::").replace(/\s+/g,"_")},h=function(){return m.map(a.find("input[type\x3dradio]:checked"),
function(a){return a.name})},d=function(){return m.map(a.find("input[type\x3dradio]:checked"),function(a){return a.value})},b=function(a,b){if(k.hasOwnProperty(a)||c.hasOwnProperty(a))return!1;console.debug('initiating ajax call for trial key "'+a+'"');b=m.ajax({type:"POST",url:"/gp/buy/shipoptionselect/handlers/launch-delivery-trial.html",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:{"x-amz-checkout-transition":"ajax"},data:b,dataType:"json",async:!0,success:function(b){b?
console.debug('trial "'+a+'" success'):console.debug('trial "'+a+'" failed');c[a]=b;delete k[a]},error:function(b,c,d){delete k[a];"abort"!==d&&(console.debug("trial "+a+" error"),r.error("issue with set-delivery-options trial: "+c,d))},cache:!1});k[a]=b;return!0},p=function(){for(var a=d(),a=e(a),b=Object.keys(k),c=0;c<b.length;++c){var f=b[c];f!==a&&(console.debug('removing ajax call for trial key "'+f+'"'),k[f].abort(),delete k[f])}};m(document).delegate("#shippingOptionFormId","change",function(c){c=
d();if(e(c)!==g.val())a:{p(),c=h();var l=d(),k=e(l);g.val(k);var w=b(k,a.serialize()),k=0;w&&++k;for(var v=0;v<c.length;++v)for(var n=a.find('input[type\x3dradio][name\x3d"'+c[v]+'"][value!\x3d"'+l[v]+'"]'),u=0;u<n.length;++u){var K=n[u],w=l.slice(0);w[v]=K.value;for(var w=e(w),A=K.name,K=K.value,q=a.serializeArray(),C=0;C<q.length;++C)q[C].name===A&&(q[C].value=K),"trialKey"===q[C].name&&(q[C].value=w);A=m.param(q);if((w=b(w,A))&&5===++k)break a}}});m(document).delegate("#shippingOptionFormId","submit",
function(a){p()})}})});r.when("A","button-blocker","page-detector").register("scheduled-delivery-readiness-checker",function(a,m,k){function c(){k.isMobile()&&k.isSosp()&&l("div.scheduled-delivery").length&&(l(document).delegate("div."+h+":visible input[type\x3d'radio'].shipping-option","change",function(){g(l(this).closest("div."+h))}),a.on("active-shipment-changed",g))}function f(a){e||(a.hasClass("scheduled-delivery-loading")?e=a.find(".loading-tooltip").text():a.hasClass("scheduled-delivery-picking")&&
(e=a.find(".picking-tooltip").text()))}function g(a){e=null;a?f(a):l("div.one-shipment:visible div."+h+".scheduled-delivery").each(function(){var a=l(this);a.find("input").is(":checked")&&f(a)});e?m.show("scheduled-delivery",e):m.hide("scheduled-delivery")}var l=a.$,e,h=q.P&&q.P.AUI_BUILD_DATE?"selectable-box":"fake-label";if(k.isMobile())a.on("checkout:reload:shipoptionselect",c);return{check:g}});"use strict";r.when("A","quantity-service","page-conductor","page-detector","ajax-utility","page-transition-controller",
"gift-utility","client-side-metrics","weblab-helper").register("gift-form-base-controller",function(a,m,k,c,f,g,l,e,h){function d(a){a.is(":checked")||(ha?a.is(":checked")||a.closest("label").click():(e.increaseCount("removeauijs4"),a.attr("checked",!0).trigger("change")))}function b(a){a.attr("disabled","disabled");ha&&a.closest("div").bind("click.disable",function(a){a.stopPropagation()})}function p(a){a.removeAttr("disabled");ha&&a.closest("div").unbind("click.disable")}function t(){r.when("a-dropdown").execute(function(a){var b=
x(".select-recipient");b.empty();for(var c=0;c<R.length;c++){var d=x("\x3coption/\x3e").attr({value:R[c].value}).text(R[c].text);b.append(d)}b.each(function(){var b=x(this).closest(".gift-connection-section"),c=b.find(".include-gift-connection-checkbox").is(":checked"),d=b.find(".item-id").val(),e=b.find(".item-giftlist-type-id").val(),f;!e||"0"!==e&&"1"!==e&&"2"!==e?e&&"3"===e&&(f=b.find(".item-giftlist-id").val()):f=e;!f&&c&&(c=b.find(".item-registry-id").val())&&ga&&ga[c]&&(f=ga[c]);f&&(a.setValue(x(this).attr("id"),
f),(e&&"1"===e||"2"===e)&&b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show(),A(d))})})}function z(){x(".gift-connection-recipient-section").unbind("click").bind("click",function(){if(!ba)return x(this).find(".select-recipient-spinner").removeClass("aok-hidden").show(),!1});x(".select-recipient").each(function(){x(this).unbind("change").bind("change",function(){var a=x(this),b=a.next().find(".a-dropdown-prompt"),c=x("\x3cdiv/\x3e").html(a.find(":selected").text()).clone().html();
setTimeout(function(){b.html(c)},0)})});r.when("a-dropdown").execute(function(a){x(".gift-connection-section").each(function(){var b=x(this),c=b.find(".item-id").val(),d=b.find(".item-giftlist-type-id").val();b.find(".item-giftlist-id").val();var e=b.find(".item-occasion-id").val(),f=b.find(".item-occasion-month").val(),n=b.find(".item-occasion-day").val(),h=b.find(".item-age").val();b.find("#input-recipient-first-name-"+c).unbind("keyup").keyup(function(){A(c)});b.find("#input-recipient-last-name-"+
c).unbind("keyup").keyup(function(){A(c)});if("1"===d||"2"===d)a.setValue(b.find(".select-recipient").attr("id"),d),b.find(".gift-connection-recipient-extra").removeClass("aok-hidden").show();a.setValue(b.find(".select-occasion").attr("id"),e);a.setValue(b.find(".select-occasion-month").attr("id"),f);a.setValue(b.find(".select-occasion-day").attr("id"),n);a.setValue(b.find(".select-occasion-age").attr("id"),h);if("1"===e||"2"===e)b.find(".gift-connection-occasion-extra").removeClass("aok-hidden").show(),
"2"===d&&b.find(".select-occasion-age-row").removeClass("aok-hidden").show();"1"!==e&&"2"!==e&&"3"!==e&&A(c)})});var a="/gp/buy/pipeline/handlers/list-of-giftlists.html",b=x(".item-registry-id").map(function(){if(x(this).val())return x(this).val()}).get().join();b&&(a+="?fromRegistryIds\x3d"+b);R?(t(),x(".select-recipient-spinner").hide(),ba=!0):(ba=!1,x.ajax({type:"POST",url:a,dataType:"json",async:!0,cache:!1,timeout:5E3,success:function(a){!R&&a.options&&0<a.options.length&&(R=a.options);a.registryIdMapping&&
(ga=a.registryIdMapping);R&&t();x(".select-recipient-spinner").hide();ba=!0},error:function(a,b,c){x(".select-recipient-spinner").hide();ba=!0}}))}function y(){Y=[];a.state("giftNotificationEmailConstraints",[]);a.state("giftDeliveryDateConstraints",[]);x('[data-action\x3d"gift-form-element"]').each(function(){var a=x(this);a.is("span")?a.find("input, textarea, select:first").trigger({type:"change",isInit:!0}):a.trigger({type:"change",isInit:!0})});x("textarea").unbind("keyup.gift-textarea click.gift-textarea").bind("keyup.gift-textarea click.gift-textarea",
function(){x(this).trigger("change")});0<x(".enable-gift-connections").length&&z()}function w(a,b){var c=31;if("1"===b)c=0===a%4&&0!==a%100||0===a%400?29:28;else if("3"===b||"5"===b||"8"===b||"10"===b)c=30;return c}function v(a,b,c){a=f.jsonify(a);k.redirect(a)}function n(a){r.when("a-dropdown").execute(function(b){x(".gift-connection-recipient-extra-"+a).hide();b.setValue("select-recipient-"+a,"0");x("#input-recipient-first-name-"+a).val("");x("#input-recipient-last-name-"+a).val("")})}function u(a){r.when("a-dropdown").execute(function(b){x(".gift-connection-occasion-extra-"+
a).hide();b.setValue("select-occasion-"+a,"0");b.setValue("select-occasion-month-"+a,"0");b.setValue("select-occasion-day-"+a,"0");b.setValue("select-occasion-age-"+a,"-1");x("#occasion-has-reminder-checkbox-"+a).attr("checked",!0)})}function K(a,b){r.when("a-dropdown").execute(function(c){for(var d=0;d<R.length;d++)b&&b===R[d].value&&R[d].bMonth&&R[d].bDay&&(c.setValue("select-occasion-month-"+a,R[d].bMonth),c.setValue("select-occasion-day-"+a,R[d].bDay))})}function A(a){r.when("a-dropdown").execute(function(b){var c=
x("#select-recipient-"+a).find(":selected").val();"0"!==c&&("1"!==c&&"2"!==c||x("#input-recipient-first-name-"+a).val()||x("#input-recipient-last-name-"+a).val())?b.updateSelect("select-occasion-"+a,{status:"enabled"}):(u(a),b.updateSelect("select-occasion-"+a,{status:"disabled"}))})}function L(a,b,c){"1"===b&&"2"===c?x("#select-occasion-age-row-"+a).removeClass("aok-hidden").show():x("#select-occasion-age-row-"+a).hide()}function C(){var a=x("#hidePricesCheckbox"),b=x("#kindle-reg-radio-your-account");
ha?b.is(":checked")?x("#kindle-reg-radio-another-account").closest("label").click():a.is(":checked")||a.closest("label").click():(e.increaseCount("removeauijs6"),a.is(":checked")||a.attr("checked","checked").trigger("change"),b.is(":checked")&&(b.removeAttr("checked").trigger("change"),x("#kindle-reg-radio-another-account").attr("checked","checked").trigger("change")))}function H(){var a=x("#hidePricesCheckbox"),b=x("#kindle-reg-radio-another-account");ha?b.is(":checked")?x("#kindle-reg-radio-your-account").closest("label").click():
a.is(":checked")&&a.closest("label").click():(e.increaseCount("removeauijs7"),a.is(":checked")&&a.removeAttr("checked").trigger("change"),b.is(":checked")&&(b.removeAttr("checked").trigger("change"),x("#kindle-reg-radio-your-account").attr("checked","checked").trigger("change")))}function N(){x("#hidePricesCheckboxLabel").hide();var a=x("#hidePricesCheckbox");ha&&(a.is(":checked")||a.closest("label").click());a.attr("disabled",!0).hide().trigger("change");x("#kindle-reg-radio-another-account").attr("disabled",
!0).trigger("change");x("#kindle-reg-radio-your-account").attr("disabled",!0).trigger("change");x("#hidePricesDisabledMessage").show();x("#hidePricesDisabledMessage").removeClass("aok-hidden");ha&&(x("label.a-touch-checkbox.hide-prices-checkbox").addClass("a-touch-selector-disabled").bind("click.disable",function(a){a.stopPropagation()}),x("label.a-touch-radio.kindle-reg-option").addClass("a-touch-selector-disabled").bind("click.disable",function(a){a.stopPropagation()}))}function P(a){var b=!1;x(".afn-wrap-checkbox").each(function(){var a=
x(this),a=a.is("input")?a:a.find("input");if(a.is(":checked"))return b=!0,!1});x(".mfn-no-wrap-radio").each(function(){var a=x(this),a=a.is("input")?a:a.find("input");if(!a.is(":checked"))return b=!0,!1});if(b)C(),N();else if(x("#hidePricesCheckbox").is(":disabled"))x("#hidePricesCheckboxLabel").show(),x("#hidePricesCheckbox").removeAttr("disabled").show().trigger("change"),x("#kindle-reg-radio-another-account").removeAttr("disabled").trigger("change"),x("#kindle-reg-radio-your-account").removeAttr("disabled").trigger("change"),
x("#hidePricesDisabledMessage").hide(),ha&&(x("label.a-touch-checkbox.hide-prices-checkbox").removeClass("a-touch-selector-disabled").unbind("click.disable"),x("label.a-touch-radio.kindle-reg-option").removeClass("a-touch-selector-disabled").unbind("click.disable"));else if(a.is("input")||(a=a.find("input")),"hidePricesCheckbox"===a.attr("id"))a.is(":checked")?C():H();else if("kindle-reg-radio-another-account"===a.attr("id")||"kindle-reg-radio-your-account"===a.attr("id"))x("#kindle-reg-radio-your-account").is(":checked")?
H():C()}function G(a){var b=x("#giftwrap-carousel-wrap-pane-"+a+" ul li").size();b&&(x("#giftwrap-carousel-wrap-holder-"+a).css("width",90*b),x("#giftwrap-carousel-wrap-pane-"+a).css("width",360));M(a)}function M(a){x("#giftwrap-carousel-wrap-holder-"+a).find("ul li, ol li").each(function(b,c){b=x(c);b.find("input").is(":checked")&&Q(b,{itemId:a})})}function Q(a,b){a.parent().find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".giftwrap-carousel-item-image").addClass("selected-giftwrap-image");
a.parent().find(".wrap.a-button-selected").removeClass("a-button-selected");a.addClass("a-button-selected");var c=b.itemId;b=b.wrapNo;var d=k.isSPP();if(!h.isNoshiGiftMessageEnabled())if(a.hasClass("noshi-wrap")&&!a.hasClass("none-wrap")){k.isSPP();var e="#item-"+c;x("#gift-message-noshi-warning-"+c).removeClass("aok-hidden");x("#includeMessageCheckbox-"+c).attr("disabled","disabled");Z()?(x("#afn-message-span-"+c,x(e)).addClass("aok-hidden"),x("#gift-message-"+c).addClass("aok-hidden")):(x("#afn-message-span",
x(e)).removeClass("enable-message-area").addClass("disable-message-area"),x("#message-area-"+c).attr("disabled","disabled"))}else e="#item-"+c,Z()&&(x("#afn-message-span-"+c,x(e)).removeClass("aok-hidden"),x("#gift-message-"+c).removeClass("aok-hidden")),x("#gift-message-noshi-warning-"+c).addClass("aok-hidden"),x("#afn-message-span",x(e)).removeClass("disable-message-area").addClass("enable-message-area"),x("#includeMessageCheckbox-"+c).removeAttr("disabled"),x("#message-area-"+c).removeAttr("disabled");
e=a.find("input[type\x3dradio]");e.attr("checked",!0);d||(d=a.data("giftwrap-id"),e.val(d).change());var d=a.data("wrap-no"),e=x("#giftwrap-option-preview-imagearea-default-"+c),f=x("#giftwrap-option-preview-imagearea-image-"+c),n=x(".selectedWrapLargeLink","#item-"+c),c=x(".wrapNo-"+c+"-"+b);a.hasClass("none-wrap")?(e.removeClass("aok-hidden"),f.addClass("aok-hidden"),n.length&&(n.addClass("aok-hidden"),n.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),f.find("img").attr("src",
a),e.addClass("aok-hidden"),f.removeClass("aok-hidden"),n.length&&(n.addClass("aok-hidden"),n.removeClass("selectedWrapLargeLink")),c.length&&(c.addClass("selectedWrapLargeLink"),c.removeClass("aok-hidden")));a=x(".selectedWrapLargeLink");c=x(".larger-image-link-carousel-"+d);a.removeClass("selectedWrapLargeLink").addClass("aok-hidden");c.removeClass("aok-hidden").addClass("selectedWrapLargeLink")}function E(a,b){var c;c=b.itemId;b=x("#giftwrap-option-preview-imagearea-default-"+c);c=x("#giftwrap-option-preview-imagearea-image-"+
c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),c.addClass("aok-hidden")):(a=a.find("img").attr("src"),c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))}function F(a,b){var c=b.itemId;b=x("#giftwrap-option-preview-imagearea-default-"+c);c=x("#giftwrap-option-preview-imagearea-image-"+c);if(a.parent().find(".selected-giftwrap-image").parents("li").hasClass("none-wrap"))b.removeClass("aok-hidden"),c.addClass("aok-hidden");else{var d=".selected-giftwrap-image img";
k.isSPP()&&(d="img.selected-giftwrap-image");a=a.parent().find(d).attr("src");c.find("img").attr("src",a);b.addClass("aok-hidden");c.removeClass("aok-hidden")}}function D(a,b){var c=a.find(".empty-message-warning"),d=a.find(".no-receipt-warning"),e=a.find("textarea");a=a.find(".message-counter");b&&!d.is(":visible")?(a.hide(),c.show(),e.addClass("gift-warning")):(c.hide(),e.removeClass("gift-warning"),a.show())}function X(a){var b=x("#"+a.id),c=l.getCharCount(b.val(),a.useByteSize),b=l.getLineCount(b.val(),
a.maxChars/a.maxLines);return{length:c,charDelta:a.maxChars-c,lineDelta:a.maxLines-b}}function aa(a,b){b=x("#item-"+b.itemId);var c=a.is(":checked")&&!a.hasClass("mfn-no-wrap-radio");Z()&&(c=!a.hasClass("mfn-no-wrap-radio"));c?(b.find(".gift-message-pslip").hide(),b.find(".gift-message-card").show()):(b.find(".gift-message-card").hide(),b.find(".gift-message-pslip").show())}function Z(){return k.isSPP()&&x("#carouselGiftWrap").length}function fa(b,c){var d=c.itemId;c=k.isSPP()?c.currentTab:b.data("current-tab");
var e=x("#afn-gift-options-wrapper-"+d).data("active-tab");c!==e&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),b.addClass("selected-giftwrap-tab"),x("#afn-gift-options-wrapper-"+d).data("active-tab",c),b="#item-"+d,e=k.isSPP()?x("#giftwrap-carousel-wrap-holder-"+d,b):b,e.length&&a.trigger("checkout:gift:changeCarouselWrapOptions",e,c,d),c=x(".none-wrap",x(b)).find("input"),c.prop("checked",!0),c.val("").change(),k.isSPP()?(c=x("#afn-gift-options-wrapper-"+d),c.length&&
(c=c.data("active-tab"),a.trigger("checkout:gift:adaptCarouselGiftPanel",d,c))):a.trigger("checkout:gift:adaptCarousel",d),x("#giftwrap-carousel-wrap-holder-"+d).removeClass("a-button-selected").find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),x("#giftwrap-carousel-item-image-"+d).addClass("selected-giftwrap-image").parents(".wrap").addClass("a-button-selected"),x("#giftwrap-option-preview-imagearea-default-"+d).removeClass("aok-hidden"),x("#giftwrap-option-preview-imagearea-image-"+
d).addClass("aok-hidden"),c=x(".selectedWrapLargeLink"),c.length&&(c.addClass("aok-hidden"),c.removeClass("selectedWrapLargeLink")),c=k.isSPP(),b="#item-"+d,x("#gift-message-noshi-warning-"+d).addClass("aok-hidden"),x("#includeMessageCheckbox-"+d).removeAttr("disabled"),c?x("#afn-message-span-"+d,x(b)).removeClass("aok-hidden"):(x("#afn-message-span",x(b)).removeClass("disable-message-area").addClass("enable-message-area"),x("#gift-message-heading-"+d).removeClass("disable-message-area").addClass("enable-message-area"),
x("#message-area-"+d).removeAttr("disabled")))}var Y,R,ba=!1,ga,x=a.$,ha=q.P&&q.P.AUI_BUILD_DATE&&c.isMobile(),da=l.getInput;a.declarative("save-gift-for-later",["click"],function(a){g.show();a=a.$currentTarget.data("entityId")||a.data.entityId;m.call(a,0,{success:v})});var ma={toggleGiftDataAndDeliveryOptions:function(a){a=a.closest(".gift-options-wrapper");var b=da(a.find(".includeMessageCheckbox"));b&&b.is(":checked")?(a.find(".gift-delivery-option").show(),a.find(".item-wrap-span").show(),a.find(".item-wrap-row").show(),
a.find(".item-gift-message-span").show()):(a.find(".gift-delivery-option").hide(),a.find(".item-wrap-span").hide(),a.find(".item-wrap-row").hide(),a.find(".item-gift-message-span").hide())},toggleGiftDeliveryOptions:function(a){var b=a.closest(".gift-options-wrapper");a.is("input[type\x3dcheckbox]")?a.is(":checked")?b.find(".gift-notification-email").removeClass("a-form-disabled"):b.find(".gift-notification-email").addClass("a-form-disabled"):(b.find(".gift-notification-email").removeClass("a-form-disabled"),
a=b.find(".includeMessageCheckbox"),d(a.find("input[type\x3dcheckbox]")),ha&&(a=a.find("i.a-icon"),a.length&&(a.removeClass("a-icon-checkbox-inactive"),a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-checkbox-active"),a.addClass("a-icon-touch-checkbox-active"))))},initGiftNotificationEmail:function(b){var c=a.state("giftNotificationEmailConstraints");c.push({id:b.attr("id")});a.state("giftNotificationEmailConstraints",c)},initGiftDeliveryDate:function(b){var c=a.state("giftDeliveryDateConstraints");
b.hasClass("year-select")||(b=b.parents("div.del-opt-date-section").find("select.year-select:first"));c.push({id:b.attr("id")});a.state("giftDeliveryDateConstraints",c)},updateDateDropdown:function(a){var b=a.closest(".gift-options-wrapper");a=b.find(".month-select").val();var c=b.find(".day-select");c.val();var b=b.find(".year-select").val(),d=w(b,a);if(c.hasClass("a-native-dropdown"))r.when("a-dropdown").execute(function(a){a=a.getSelect(c);if(a.getOptions().size()>d)for(var b=a.getOptions().size()-
1;b>=d;b--)a.removeOption(b);else for(b=a.getOptions().size();b<d;b++)a.addOption({text:b+1,value:b+1},b)});else{if(c.find("option").length>d)c.find("option:gt("+(d-1)+")").remove();else for(a=c.find("option").length+1;a<=d;a++)c.append(x("\x3coption\x3e",{value:a}).text(a));c.trigger("change")}},initSelectedTabAndWrapHolderWidth:G,initGiftMessage:function(a,b){ha&&!a.is("textarea")&&(a=a.find("textarea"));Y.push({id:a.attr("id"),maxChars:parseInt(b.maxChars,10),maxLines:parseInt(b.maxLines,10),useByteSize:b.useByteSize});
da(a.closest(".gift-options-wrapper").find(".includeMessageCheckbox")).is(":checked")||a.addClass("a-form-disabled");"1"===x("#multipleAFNGiftWrapOption").val()&&(a=a.attr("id").substring(a.attr("id").lastIndexOf("-")+1,a.attr("id").size),G(a))},enforceSelectorParity:P,enforceGiftReceiptParity:function(a,c){a=x("#item-"+c.itemId);if(0!==a.length){c=a.find(".item-receipt-row label");var e=da(a.find(".includeReceiptCheckbox")),f=a.find(".mfn-hide-price-row label"),n=da(a.find(".mfnHidePriceCheckbox")),
h=a.find(".item-message-row label"),g=da(a.find(".includeMessageCheckbox")).is(":checked"),l=!1;0<a.find(".afn-wrap-checkbox").length?da(a.find(".afn-wrap-checkbox")).is(":checked")&&(l=!0):0<a.find(".mfn-no-wrap-radio").length&&(da(a.find(".mfn-no-wrap-radio")).is(":checked")||(l=!0));if(l||g)d(e),d(n);l||g&&h.is(":visible")?(b(e),c.addClass("checkout-gift-option-disabled"),b(n),f.addClass("checkout-gift-option-disabled")):(p(e),p(n),c.removeClass("checkout-gift-option-disabled"),f.removeClass("checkout-gift-option-disabled"))}},
enforceHidePriceParity:function(a){var b=!1;x(".includeReceiptCheckbox").each(function(){if(da(x(this)).is(":checked"))return b=!0,!1});var c=!1;x(".mfnHidePriceCheckbox").each(function(){if(da(x(this)).is(":checked"))return c=!0,!1});b||c?(C(),x(".kindle-reg-msg-your-account").hide(),x(".kindle-reg-msg-another-account").show()):(H(),x(".kindle-reg-msg-another-account").hide(),x(".kindle-reg-msg-your-account").show())},toggleNoReceiptWarning:function(a){var b=da(a).is(":checked"),c=a.closest(".gift-options-wrapper");
a=c.find(".no-receipt-warning");var f=c.find(".empty-message-warning"),c=c.find(".item-message-row").find(".includeMessageCheckbox"),n=da(c);b?(a.hide(),c.is(":visible")||d(n)):(f.hide(),a.show(),n.is(":checked")&&(ha?n.is(":checked")&&n.closest("label").click():(e.increaseCount("removeauijs5"),n.removeAttr("checked").trigger("change"))))},toggleMessageArea:function(a){var b=a.closest(".gift-options-wrapper");if(a.is("textarea"))b=da(b.find(".includeMessageCheckbox")),d(b);else{a=da(b.find(".includeMessageCheckbox")).is(":checked");
var c=b.find(".item-message-row label").is(":visible"),e=0<b.find(".empty-message-warning").length,f=b.find("textarea"),n=f.data("default-text"),h=0<f.val().length;a?(b.find(".gift-message-edit").show(),b.find(".gift-message-label").removeClass("a-color-secondary"),f.removeClass("a-form-disabled"),n&&f.val(n)):(c&&b.find(".gift-message-edit").hide(),b.find(".gift-message-label").addClass("a-color-secondary"),f.addClass("a-form-disabled"),n&&f.val(""));e&&(a&&h?D(b,!1):D(b,!0))}},toggleMessageLocationText:aa,
toggleMessageBoxDisplay:function(c,e){var f=x("#item-"+e.itemId);if(0!==f.length){var n=f.find(".item-message-row");e=f.find(".item-receipt-row");var h=f.find(".gift-message-on-card"),g=f.find(".gift-message-on-receipt"),l=n.find("label"),n=da(n.find(".includeMessageCheckbox")),k=a.trim(f.find(".gift-message-default-placeholder").text()),m=a.trim(f.find(".gift-message-with-wrap-placeholder").text()),f=f.find("textarea"),u=c.hasClass("mfn-no-wrap-radio")||c.closest("div").hasClass("mfn-no-wrap-radio");
da(c).is(":checked")&&!u?(g.hide(),h.show(),f.attr("placeholder",m),e.is(":visible")&&(d(n),l.is(":visible")&&(b(n),l.addClass("checkout-gift-option-disabled")))):(h.hide(),g.show(),f.attr("placeholder",k),p(n),l.removeClass("checkout-gift-option-disabled"))}},updateContinueButtons:function(){for(var b=!0,c,d=0;d<Y.length;d++)if(c=x("#"+Y[d].id),c.closest(".gift-options-wrapper").find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]').is(":checked")&&(c=X(Y[d]),0>c.charDelta||0>c.lineDelta))b=
!1;b?(x(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").show(),x(".save-gift-button-box span.a-button-disabled").hide()):(x(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").hide(),b=x(".save-gift-button-box span.a-button-disabled"),b.removeClass("aok-hidden"),b.show());a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")},updateMessageCounter:function(a){ha&&!a.is("textarea")&&(a=a.find("textarea"));for(var b,c=0;c<Y.length;c++)a.attr("id")===
Y[c].id&&(b=X(Y[c]));if(b){a=a.closest(".gift-options-wrapper");c=a.find(".message-counter");c.find(".remaining-count").hide();if(0<a.find(".empty-message-warning").length){if(0===b.length){D(a,!0);return}D(a,!1)}(-1>b.charDelta?c.find(".remaining-char-over-multiple").show():0>b.charDelta?c.find(".remaining-char-over-single").show():1===b.charDelta?c.find(".remaining-char-single").show():c.find(".remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(b.charDelta));(-1>b.lineDelta?
c.find(".remaining-line-over-multiple").show():0>b.lineDelta?c.find(".remaining-line-over-single").show():1===b.lineDelta?c.find(".remaining-line-single").show():c.find(".remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(b.lineDelta));c.show()}},updateSelectedGiftWrap:Q,clearGiftConnection:function(a,b){x("#include-gift-connection-checkbox-"+b.itemId).is(":checked")||(n(b.itemId),A(b.itemId))},toggleGiftConnectionAgeDropdown:L,toggleGiftConnectionRecipientArea:function(a,b){a=
x("#select-recipient-"+b.itemId).find(":selected").val();var c=x("#select-occasion-"+b.itemId).find(":selected").val();!a||"1"!==a&&"2"!==a?(x(".gift-connection-recipient-extra-"+b.itemId).hide(),"1"===c&&a&&K(b.itemId,a)):x(".gift-connection-recipient-extra-"+b.itemId).removeClass("aok-hidden").show();L(b.itemId,c,a);A(b.itemId)},toggleGiftConnectionOccasionArea:function(a,b){a=x("#select-occasion-"+b.itemId).find(":selected").val();var c=x("#select-recipient-"+b.itemId).find(":selected").val();
!a||"1"!==a&&"2"!==a?x(".gift-connection-occasion-extra-"+b.itemId).hide():("1"===a&&c&&"1"!==c&&"2"!==c&&K(b.itemId,c),x(".gift-connection-occasion-extra-"+b.itemId).removeClass("aok-hidden").show());L(b.itemId,a,c)},includeGiftConnection:function(a,b){(a=x("#select-recipient-"+b.itemId).find(":selected").val())&&"0"===a||x("#include-gift-connection-checkbox-"+b.itemId).attr("checked",!0)},updateGiftOptionsTabSelection:fa,updatePreviewImageOnMouseEnter:E,updatePreviewImageOnMouseLeave:F,toggleGiftMessageWarning:function(a){var b=
x("#"+a.attr("id"));l.toggleGiftMessageWarning(b,a.closest(".item-gift-message-span"))}};a.declarative("gift-form-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(ma[b[c]])ma[b[c]](a.$target,a.data)});a.declarative("gift-form-element","click mouseenter mouseleave",function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(ma[b[c]])ma[b[c]](a.$currentTarget,
a.data,a)});a.declarative("select-gift-wrap","click",function(a){Q(a.$target.parents("li"),{itemId:a.data.itemId,wrapNo:a.data.wrapNo});P(a.$target);var b=a.$target.parents("li").find(".gift-hidden-radio");aa(b,{itemId:a.data.itemId})});a.declarative("select-gift-wrap","mouseenter",function(a){E(a.$target.parents("li"),a.data)});a.declarative("select-gift-wrap","mouseleave",function(a){F(a.$target.parents("li"),a.data)});a.declarative("update-gift-options-tab-selection",["click"],function(a){var b=
a.$target.parents("li");b.attr("data",a.data);fa(b,a.data)});a.on("checkout:reload:giftselect",y);a.on("checkout:reload:spp-giftoptions",y);return{extendFunctions:function(a){x.extend(ma,a)}}});"use strict";r.when("A","page-transition-controller","page-conductor").register("gift-form-del-opt-controller",function(a,m,k){function c(a){var c=a.closest(".expando-box");c&&(c=c.find(".a-expander-header"),a.closest(".expando-content").is(":hidden")&&c.click())}function f(a){var c=a.closest(".gift-options-wrapper"),
b=c.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(b&&!b.is(":checked"))return!0;b=c.find(".email-error-selector");c.find(".gift-notification-email-error").hide();b.removeClass("a-form-error");if(64<q.unescape(encodeURIComponent(a.val())).length)return b.addClass("a-form-error"),c.find(".gift-notification-email-length-exceeded-error").removeClass("aok-hidden").show(),!1;if(/^\S+[@]\S+[.]\S+$/.test(a.val()))return!0;b.addClass("a-form-error");c.find(".gift-notification-invalid-email-error").removeClass("aok-hidden").show();
return!1}function g(){e("#giftForm").find(".save-gift-button-box span.a-button-primary:not(.a-button-disabled)").unbind("click").bind("click",function(a){a.preventDefault();l(a)});e(".checkout-gift-image-preview-trigger \x3e a").show();e("#gift-kindle-imb").show()}function l(h){h=e("#giftForm");var d=h.find('input[name\x3d"hidePrices"]'),b=d.is(":disabled");b&&d.removeAttr("disabled");for(var p=!0,g=a.state("giftNotificationEmailConstraints"),l=a.state("giftDeliveryDateConstraints"),y=0;y<g.length;y++){var w=
e("#"+g[y].id);f(w)||(p=!1,c(w))}for(g=0;g<l.length;g++){y=e("#"+l[g].id);var w=y.closest(".gift-options-wrapper"),v=w.find(".includeMessageCheckbox").find('input[type\x3d"checkbox"]');if(v&&!v.is(":checked"))w=!0;else{var n=w.find(".month-select").val(),u=w.find(".day-select").val(),v=w.find(".year-select"),K=v.val(),A=w.find("#current-date").val().split("-"),n=new Date(K,n,u),A=new Date(A[0],A[1]-1,A[2]),u=new Date(A.getTime());u.setMonth(u.getMonth()+12);w.find(".gift-delivery-date-error").hide();
K=w.find(".date-error-selector");v=v.hasClass("a-native-dropdown")?"error-border a-form-error":"a-form-error";K.removeClass(v);n>=u||n<A?(w.find(".gift-delivery-date-error").removeClass("aok-hidden").show(),K.addClass(v),w=!1):w=!0}w||(p=!1,c(y))}a.state("continueAction",{enable:p});if(a.state("continueAction").enable)k.isSPP()||m.showPageTransition(),h.submit();else return e("html, body").animate({scrollTop:e(".a-form-error").closest("div").offset().top},500),!1;b&&d.attr("disabled",!0)}var e=a.$;
a.declarative("submit-gift-options","click",function(a){l(a)});a.declarative("discard-gift-options","click",function(a){e('#giftForm input[type\x3d"checkbox"]').prop("checked",!1);e("#giftForm textarea").addClass("a-form-disabled");l(a)});a.on("checkout:reload:giftselect",g);a.on("checkout:reload:spp-giftoptions",g)});"use strict";r.when("A").register("teen-message-controller",function(a){var m=a.$;a.declarative("teen-message-form-element","click keyup",function(a){a=a.data.maxChars;var c=m("#teen-message-box").val(),
f=c.match(/(\r\n|\n|\r)/g),g=0;f&&(g=f.length);c=c.length+g;m(".remaining-char").text(Math.max(a-c,0))});m("#aui-teen-message-box").length&&m(".remaining-char").length&&r.when("A").execute(function(a){function c(a){a=a.val();var c=(a.match(/(\r\n|\n|\r|\n\r)/g)||{}).length||0;return a.length+c}a=a.$;var f,g,l;f=a("#aui-teen-message-box");f.bind("change keypress",function(a){return c(f)>=l?(a.preventDefault(),!1):!0});f.bind("paste",function(a){if(a&&a.originalEvent&&a.originalEvent.clipboardData&&
a.originalEvent.clipboardData.getData("Text")){var h=a.originalEvent.clipboardData.getData("Text"),d=c(f);if(d+h.length>=l)return h=h.substring(0,l-d),h=f.val()+h,f.attr("value",h),a.preventDefault(),!1}return!0});f.bind("click keyup",function(){var a=Math.max(l-c(f),0);g.text(a)});g=a(".remaining-char");l=f.parent().data("maxchars")})});"use strict";r.when("A","page-transition-controller","page-conductor","loading-spinner-controller","client-side-metrics").register("concealment-form-del-opt-controller",
function(a,m,k,c,f){function g(a){var c=e("#concealmentForm");c.find("input:checked").length?(a=a.data.saveConcealmentRefTag,f.increaseCount("CPEX.Checkout.Select.Concealment",1)):(a=a.data.cancelConcealmentRefTag,f.increaseCount("CPEX.Checkout.Cancel.Concealment",1));c.find("input[name\x3dref]").val(a);c.attr("action",c.attr("action")+"/ref\x3d"+a)}function l(a){a=e("#concealmentForm");k.isSPP()||m.showPageTransition();a.submit()}var e=a.$;a.declarative("submit-concealment-options","click",function(a){g(a);
l(a)});a.declarative("discard-concealment-options","click",function(a){e('#concealmentForm input[type\x3d"checkbox"]').prop("checked",!1);g(a);l(a)});a.declarative("submit-concealment-form","click",function(a){g(a);a.$target.closest(".a-button").addClass("a-button-disabled");c.showSpinner(a.$target.closest("form"))})});"use strict";r.when("A","page-transition-controller","page-conductor","address-popovers","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("itemselect-address-controller",
function(a,m,k,c,f,g,l,e){function h(){t(".lineitem").each(function(a,b){a=t(b);a.find(".no-js-address-dropdown").remove();a.find(".no-js-address-select").remove();a.find(".js-address-dropdown").prop("disabled",!1);a.find(".address-dropdown").removeClass("a-button-disabled")});t("#suppressAddAddressPopover").val()&&t('select[name^\x3d"addressID."]').find("option").each(function(){var a=t(this);"New"===a.val()&&a.closest("optgroup").remove()})}function d(a){var c=(new Date).getTime(),d=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});
t.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+c,data:a,dataType:"text",headers:d,error:k.ajaxRedirect,success:function(a,c,d){var e=d.getResponseHeader("x-amz-checkout-fatal-error");if(null!==e&&e!==D)q.location=e;else if(b(d)){p(a,d);var n;a=v.find('input[name^\x3d"previousAddress."]');if(null!==a||a!==D)n=y||a.val();var h=v.find('select[name^\x3d"addressID."]');null===h&&h===D||r.when("a-dropdown").execute(function(a){a.setValue(h.attr("id").replace(/\./g,
"\\."),n);h.find("option").removeAttr("selected");h.find('option[value\x3d"'+n+'"]').attr("selected","selected")});m.hide()}else k.ajaxUpdatePage(a,c,d),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")}})}function b(a){a=a.getResponseHeader("x-amz-checkout-show-addon-warning");return null!==a&&a!==D}function p(a,b){b=b.getResponseHeader("x-amz-checkout-show-addon-warning");t(".item-list").hide();a.trim().split(",").forEach(function(a){t('[data-asin\x3d"'+a+'"]').show()});a=t("#addon-warning-"+
b+"-launcher");a.length&&(t(".delete-title").hide(),t(".reduce-title").hide(),t(".select-address-title").show(),t("input[name\x3duseLiveAUI]").length?g.get(a).attrs({$trigger:w,position:"triggerHorizontal"}).show():(b=t.Event("keyup",{triggerPositioningElement:w,manualTrigger:!0}),a.trigger(b)))}var t=a.$,z,y,w,v;a.declarative("itemselect-get-address",["click","touchend"],function(a){f.protectAgainstDoubleAction("itemselect-get-address",200)||(y=a.$currentTarget.find(".js-address-dropdown").val())});
a.declarative("itemselect-update-address",["change"],function(a){if(!f.protectAgainstDoubleAction("itemselect-update-address",200)){l.resetMetrics();var b=a.$currentTarget.is("select")?a.$currentTarget:a.$currentTarget.find("select");z=b.val();if("New"===z)c.actionTriggerPopoverFromDropdown(a),r.when("a-dropdown").execute(function(a){a.setValue(b.attr("id").replace(/\./g,"\\."),y)});else{m.show();v=b.closest(".lineitem");var e,h;if(v){var p=v.find('input[name^\x3d"lineItemEntityID."]');p&&(e=p.val());
(p=v.find('input[name^\x3d"quantity."]'))&&(h=p.val());(p=v.find(".js-address-dropdown"))&&(z=p.val())}w=a.$currentTarget.is("select")?a.$currentTarget.closest(".address-dropdown"):a.$currentTarget;a=0;p=t("#addon-indicator");p.length&&"true"===p.attr("data-has-addon-items")&&(a=1);d({lineitems:e,addresses:z,quantities:h,isTrial:a})}}});a.declarative("itemselect-update-pantry-address",["change"],function(a){if(!f.protectAgainstDoubleAction("itemselect-update-pantry-address",200)){z=a.$currentTarget.val();
m.show();var b="";a=a.$currentTarget.closest(".pantry-row");t(a).find(".pantry-item").each(function(a,c){a=t(c);b+="lineitems\x3d"+a.find('input[name^\x3d"lineItemEntityID."]').val()+"\x26";b+="addresses\x3d"+z+"\x26";b+="quantities\x3d"+a.find('input[name^\x3d"quantity."]').val()+"\x26"});d(b)}});a.declarative("addon-delete-items",["click","touchend"],function(a){if(w!==D&&null!==w&&!f.protectAgainstDoubleAction("itemselect-delete-addons",200)){t(".a-button-close").trigger("click");m.show();a=(new Date).getTime();
var b=t("#useCase").val(),c=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"}),d=v.find('input[name^\x3d"lineItemEntityID."]').val(),e=v.find('input[name^\x3d"quantity."]').val();t.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-address\x26cachebuster\x3d"+a,data:{lineitems:d,addresses:z,quantities:e,isTrial:0,deleteAddons:1,returnHTML:1,useCase:b},headers:c,error:k.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-redirect-to-cart");
null!==d&&d!==D?q.location=d:(d=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==d&&d!==D?q.location=d:(k.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});a.on("checkout:reload:itemselect",h);a.on("checkout:reload:spp-itemselect",h)});"use strict";r.when("A","page-transition-controller","page-conductor","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("itemselect-delete-controller",function(a,m,k,c,f,g,l){function e(a,
b){h(a,null===b||b===D?a.$currentTarget.closest(".lineitem"):b)}function h(a,d){a.$event.preventDefault();if(!c.protectAgainstDoubleAction("itemselect-delete-single-item",200)){g.resetMetrics();m.show();y=d;v=a.$currentTarget.is("select")?a.$currentTarget.closest(".quantity-dropdown"):a.$currentTarget;a=y.find('input[name^\x3d"lineItemEntityID."]').val();d=0;(new Date).getTime();var e=z("#addon-indicator");e.length&&"true"===e.attr("data-has-addon-items")&&(d=1);b({lineitems:a,isTrial:d})}}function d(a,
d){a.$event.preventDefault();if(!c.protectAgainstDoubleAction("itemselect-delete-multiple-items",200)){m.show();w=d;v=a.$currentTarget;var e="";a=0;d=z("#addon-indicator");d.length&&"true"===d.attr("data-has-addon-items")&&(a=1);d=w.hasClass("pantry-row")?!0:!1;w.find(d?".pantry-item":".lineitem").each(function(a,b){e+="lineitems\x3d"+z(b).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"});b(e+"isTrial\x3d"+a)}}function b(a){var b=(new Date).getTime(),c=z('input[name\x3d"useCase"]').val(),
d=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});z.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3ddelete\x26useCase\x3d"+c+"\x26cachebuster\x3d"+b,data:a,dataType:"text",headers:d,error:k.ajaxRedirect,success:p})}function p(a,b,d){var e;e=d.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==e&&e!==D?(q.location=e,e=!0):e=!1;e||(e=d.getResponseHeader("x-amz-checkout-fatal-error"),null!==e&&e!==D?q.location=e:(e=d.getResponseHeader("x-amz-checkout-show-addon-warning"),
e=null!==e&&e!==D?!0:!1,e?(t(a,d),m.hide()):(k.ajaxUpdatePage(a,b,d),c.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))))}function t(a,b){b=b.getResponseHeader("x-amz-checkout-show-addon-warning");z(".item-list").hide();a.trim().split(",").forEach(function(a){z('[data-asin\x3d"'+a+'"]').show()});a=z("#addon-warning-"+b+"-launcher");a.length&&(z(".delete-title").show(),z(".reduce-title").hide(),z(".select-address-title").hide(),z("input[name\x3duseLiveAUI]").length?f.get(a).attrs({$trigger:v,
position:"triggerHorizontal"}).show():(b=z.Event("keyup",{triggerPositioningElement:v,manualTrigger:!0}),a.trigger(b)))}var z=a.$,y,w,v;a.declarative("itemselect-delete-item",["click","touchend"],e);a.declarative("itemselect-delete-item-row",["click","touchend"],function(a){d(a,a.$currentTarget.closest(".item-row"))});a.declarative("addon-delete-items",["click","touchend"],function(a){if(v!==D&&!c.protectAgainstDoubleAction("itemselect-delete-addons",200)){z(".a-button-close").trigger("click");m.show();
var d="";null!==w&&w!==D?(a=w.hasClass("pantry-row")?w.find(".pantry-item"):w.find(".lineitem"),z(a).each(function(a,b){d+="lineitems\x3d"+z(b).find('input[name^\x3d"lineItemEntityID."]').val()+"\x26"})):null!==y&&y!==D&&(d+="lineitems\x3d"+y.find('input[name^\x3d"lineItemEntityID."]').val()+"\x26");b(d+"isTrial\x3d0\x26deleteAddons\x3d1")}});a.declarative("itemselect-delete-pantry-item",["click","touchend"],function(a){h(a,a.$currentTarget.closest(".pantry-item"))});a.declarative("itemselect-delete-pantry",
["click","touchend"],function(a){d(a,a.$currentTarget.closest(".pantry-row"))});a.declarative("itemselect-delete-popover-item",["click","touchend"],function(a){var b=a.$currentTarget.data("entityidtodelete");d(a,z('a[data-entityid\x3d"'+b+'"]').closest(".item-row"))});return{actionDeleteItem:e}});"use strict";r.when("A","page-transition-controller","page-conductor","itemselect-delete-controller","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("itemselect-quantity-controller",
function(a,m,k,c,f,g,l,e){function h(){y(".lineitem, .pantry-item").each(function(a,b){a=y(b);a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))})}function d(a){a.find(".quantity-input").val(a.find('input[name^\x3d"previousQuantity."]').val())}function b(a){var b=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),
c=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),e;e="itemselect-show-update-pantry-button"===a.action?".pantry-item":".lineitem";0===parseInt(c,10)||""===c?("change"===a.type&&d(a.$currentTarget.closest(e)),b.hide()):(a=a.$currentTarget.closest(e).find('input[name^\x3d"previousQuantity."]').val(),c!==a?b.show():b.hide())}function p(a){a.$event.preventDefault();if(!f.protectAgainstDoubleAction("itemselect-update-quantity",200)){l.resetMetrics();n=a.$currentTarget.closest("itemselect-update-pantry-quantity"===
a.action||"itemselect-update-pantry-quantity-text-field"===a.action?".pantry-item":".lineitem");var b=n.find(".js-address-dropdown").val(),e=a.$currentTarget.find("select"),p=e.length?e:a.$currentTarget;w=p.is("select")?p.val():n.find(".quantity-input").val();if(0===parseInt(w,10)||""===w)d(n);else if("Delete"===w)r.when("a-dropdown").execute(function(a){a.setValue(p.attr("id").replace(/\./g,"\\."),v)}),c.actionDeleteItem(a,n);else{m.show();a=n.find('input[name^\x3d"lineItemEntityID."]').val();var e=
0,h=(new Date).getTime(),g=y("#useCase").val(),P=y("#addon-indicator");u=p.is("select")?p.parent():n.find(".quantity-input");P.length&&"true"===P.attr("data-has-addon-items")&&(e=1);P=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});y.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+h,data:{lineitems:a,quantities:w,address:b,isTrial:e,returnHTML:1,useCase:g},dataType:"text",headers:P,error:k.ajaxRedirect,success:function(a,
b,c){var d=c.getResponseHeader("x-amz-checkout-fatal-error");null!==d&&d!==D?q.location=d:(d=c.getResponseHeader("x-amz-checkout-show-addon-warning"),d=null!==d&&d!==D?!0:!1,d?(z(a,c),t(v===D?n.find('input[name^\x3d"previousQuantity."]').val():v,c),m.hide()):(k.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}}}function t(a,b){10>a?(r.when("a-dropdown").execute(function(b){var c=n.find('select[name^\x3d"quantity."]');b.setValue(c.attr("id").replace(/\./g,
"\\."),a);c.find("option").removeAttr("selected");c.find('option[value\x3d"'+a+'"]').attr("selected","selected")}),n.find(".quantity-dropdown").show(),n.find(".quantity-text-field").hide(),n.find(".js-select").prop("disabled",!1),n.find(".quantity-input").prop("disabled",!0)):(n.find(".quantity-dropdown").hide(),n.find(".quantity-text-field").show(),n.find(".update-quantity-link").hide(),n.find(".js-select").prop("disabled",!0),n.find(".quantity-input").prop("disabled",!1));n.find(".quantity-input").val(a);
n.find('input[name^\x3d"previousQuantity."]').val(a)}function z(a,b){b=b.getResponseHeader("x-amz-checkout-show-addon-warning");y(".item-list").hide();a.trim().split(",").forEach(function(a){y('[data-asin\x3d"'+a+'"]').show()});a=y("#addon-warning-"+b+"-launcher");a.length&&0<a.length&&(y(".reduce-title").show(),y(".delete-title").hide(),y(".select-address-title").hide(),y("input[name\x3duseLiveAUI]").length?g.get(a).attrs({$trigger:u}).show():(b=y.Event("keyup",{triggerPositioningElement:u,manualTrigger:!0}),
a.trigger(b)))}var y=a.$,w,v,n,u;a.declarative("itemselect-get-quantity",["click","touchend"],function(a){f.protectAgainstDoubleAction("itemselect-get-quantity",200)||a.$currentTarget.find("select").length&&(v=a.$currentTarget.find("select").val())});a.declarative("itemselect-update-quantity",["change"],p);a.declarative("itemselect-update-pantry-quantity",["change"],p);a.declarative("addon-delete-items",["click","touchend"],function(a){if(u!==D&&!f.protectAgainstDoubleAction("itemselect-delete-addons",
200)){y(".a-button-close").trigger("click");m.show();a=n.find('input[name^\x3d"lineItemEntityID."]').val();var b=(new Date).getTime(),c=y("#useCase").val(),d=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});y.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dupdate-quantity\x26cachebuster\x3d"+b,data:{lineitems:a,quantities:w,isTrial:0,deleteAddons:1,returnHTML:1,useCase:c},headers:d,error:k.ajaxRedirect,success:function(a,b,c){var d=c.getResponseHeader("x-amz-checkout-redirect-to-cart");
null!==d&&d!==D?q.location=d:(d=c.getResponseHeader("x-amz-checkout-fatal-error"),null!==d&&d!==D?q.location=d:(k.ajaxUpdatePage(a,b,c),f.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select")))}})}});a.declarative("itemselect-sanitize-input",["keydown"],function(a){f.limitInputToNumbers(a)});a.declarative("itemselect-update-quantity-text-field",["click","touchend"],p);a.declarative("itemselect-update-pantry-quantity-text-field",["click","touchend"],p);a.declarative("itemselect-show-update-button",
["change","keyup"],b);a.declarative("itemselect-show-update-pantry-button",["change","keyup"],b);a.on("checkout:reload:itemselect",h);a.on("checkout:reload:spp-itemselect",h)});"use strict";r.when("A","page-transition-controller","page-conductor","checkout-general-utils","client-side-metrics").register("itemselect-ship-to-multiple-controller",function(a,m,k,c,f){var g=a.$;a.declarative("itemselect-ship-to-multiple",["click","touchend"],function(a){a.$event.preventDefault();f.resetMetrics();if(!c.protectAgainstDoubleAction("itemselect-ship-to-multiple",
200)){m.show();var e=null,h=null,d=null;a.$currentTarget.closest(".item-row").find(".lineitem").each(function(a,b){a=g(b);b=a.find('select[name^\x3d"quantity."]');var c=a.find('input[type\x3d"number"]');if(a.find(".quantity-dropdown").is(":visible")&&1<b.val())return e=a.find('input[name^\x3d"lineItemEntityID."]').val(),h=b.val(),d=a.find(".js-address-dropdown").val(),!1;if(a.find(".quantity-text-field").is(":visible")&&1<c.val())return e=a.find('input[name^\x3d"lineItemEntityID."]').val(),h=c.val(),
d=a.find(".js-address-dropdown").val(),!1});if(null!==e){a=(new Date).getTime();var b=k.setAjaxTransitionHeader({"x-amz-checkout-page":"itemselect"});g.ajax({type:"POST",url:"/gp/buy/itemselect/handlers/continue.html/?action\x3dship-to-multiple\x26cachebuster\x3d"+a,data:{lineitem:e,quantity:h,address:d},headers:b,dataType:"text",error:k.ajaxRedirect,success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-fatal-error");null!==e&&e!==D?q.location=e:(k.ajaxUpdatePage(a,b,d),c.nukeDropdowns(".js-address-dropdown, .quantity-dropdown-select"))}})}}})});
"use strict";r.when("A").register("safe-apx-helper",function(a){var m={},k=a.$;return{get:function(a){return m[a]},set:function(){1===arguments.length?m=k.extend(m,arguments[0]):2===arguments.length?m[arguments[0]]=arguments[1]:q.console&&q.console.error&&q.console.error("Unexpected number of arguments: %d. Expected 1 or 2.",arguments.length)}}});"use strict";r.when("A","weblab-helper").register("mobile-carrier-billing-util",function(a,m){var k=!1;return{determineIsMCBEnabled:function(a){k=0<a.paymentRows.find('input[type\x3d"radio"][name\x3dpaymentMethod]').filter("[value^\x3dMCB]").size()},
toggleGCForMCB:function(a,f){if(!m.isMCBMultiTenderWeblabEnabled()&&k&&(a=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]'),a.length)){var g=f.paymentRows.find('input[type\x3d"checkbox"][name\x3duseAvailableBalance]'),g=f.existingBalance||g,l=0<f.paymentRows.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,e="paymentsForm"in f&&0<f.paymentsForm.find('input[type\x3d"hidden"][name\x3d"gcBalance"]').length,l=l||e;0<a.filter("[value^\x3dMCB]").size()&&l?(g.length&&(g.prop("checked",!1),
g.prop("disabled",!0)),f.mcbBalanceWarning&&f.mcbBalanceWarning.show()):(g.length&&g.prop("disabled",!1),f.mcbBalanceWarning&&f.mcbBalanceWarning.hide())}},showMCBWarningMessageForPoints:function(a){k&&a.mcbPointsWarning&&a.mcbPointsWarning.show()},hideMCBWarningMessageForPoints:function(a){k&&a.mcbPointsWarning&&a.mcbPointsWarning.hide()}}});"use strict";r.when("A").register("emi-utils",function(a){return{}});"use strict";r.when("A").register("emi-helper",function(a){return{}});"use strict";r.when().register("instant-bank-discount-helper",
function(){return{showInstantBankDiscountAmazonPayDeselected:function(){},showInstantBankDiscountAmazonPaySelected:function(){}}});"use strict";r.when("A","page-detector","checkout-general-utils").register("pay-common-lib",function(a,m,k){function c(a,b){b.attr("name")&&(a[b.attr("name")]=b.val());b.attr("id")&&(a[b.attr("id")]=b.val())}function f(a,b){if(!b)return a;for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function g(a,b,c){l.each(b,function(b,e){a[b]=c?c.find(e):l(e)})}var l=a.$,
e="checkbox hidden password radio text number tel month".split(" "),h={};a.declarative("move-to-next-field",["keypress"],function(a){13===a.$event.charCode&&(k.moveToNextInput(a.$declarativeParent),a.$event.preventDefault())});a.declarative("scroll-to-input",["keypress"],function(a){13===a.$event.charCode&&(l(q).scrollTop(a.$declarativeParent.offset().top),a.$event.preventDefault())});return{getAttributeData:function(a,b){if(a)return a.attr(b)||a.attr("data-"+b)||a.data(b)},getElements:function(a,
b){var c={};g(c,a,b);return c},getInputValues:function(a){var b=a.find(".data-row").data()||{};a.find("input").each(function(){var a=l(this),d=a.attr("type");("radio"!==d&&"checkbox"!==d||a.is(":checked"))&&-1<l.inArray(d,e)&&c(b,a)});a.find("select").each(function(){c(b,l(this))});return b},isDesktopCX:m.isDesktopPayment,isMobileCX:m.isMobilePayment,isPayPage:m.isPayment,isTouchCX:m.isTabletPayment,mergeFrom:function(a,b){b=f({},b);return f(b,a)},prop:function(a,b,c){if(a){if(1<arguments.length)return b===
D?delete h[a]:h[a]={isOneTime:c?1:0,value:b},b;var e=h[a];if(e)return e.isOneTime&&delete h[a],e.value}},refreshElements:g,scrollTopTo:function(a){a&&a.length&&l("html,body").animate({scrollTop:a.offset().top-20},"fast")},selectDefaultPaymentMethodIfNotSelected:function(){var a=l("#existing-payment-methods .payment-row").find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),b=a.closest("div.payment-selected");b&&0<b.length||(a=a.closest("div.default-payment-marker"))&&a.length&&(a.addClass("payment-selected"),
a.find("[name\x3dpaymentMethod]").attr("checked",!0))},processSubmissionParameters:function(a){for(var b={},c=0;c<a.length;c++)b[a[c].name]=a[c].value;return b}}});"use strict";r.when("A","pay-common-lib","a-popover-base","ajax-utility","loading-spinner-controller","page-conductor","page-transition-controller").register("pay-desktop-util",function(a,m,k,c,f,g,l){function e(a){a.$event.preventDefault();a.$target.closest(".a-popover").hide();a.$target.siblings("span.error-message").hide()}function h(a){a.preventDefault();
var b=u(a.currentTarget),c=b.closest("div.expando-section");a=c.find("div.expando-content");var c=c.find("div.expando-reverse-content"),d=a.is(":visible"),e=function(){var a=b.find("i");a.hasClass("a-icon-collapse")||a.hasClass("a-icon-expand")?d?(a.removeClass("a-icon-collapse").addClass("a-icon-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):(a.removeClass("a-icon-expand").addClass("a-icon-collapse"),b.find("div.expando-toggle-text-show").hide(),
b.find("div.expando-toggle-text-hide").show()):d?(a.removeClass("a-icon-section-collapse").addClass("a-icon-section-expand"),b.find("div.expando-toggle-text-show").show(),b.find("div.expando-toggle-text-hide").hide()):(a.removeClass("a-icon-section-expand").addClass("a-icon-section-collapse"),b.find("div.expando-toggle-text-show").hide(),b.find("div.expando-toggle-text-hide").show())};d?(c.slideDown("fast"),a.slideUp("fast",e)):(c.slideUp("fast"),a.slideDown("fast",e))}function d(a){var b=a.$target.closest("a");
a=b.closest("div.extender-section");b=b.find("i");b.hasClass("a-icon-extender-expand")?(a.find(".collapsed").hide(),a.find(".expanded").slideDown("fast"),b.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse")):(a.find(".collapsed").show(),a.find(".expanded").slideUp("fast"),b.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"))}function b(a){H.msgPopovers.filter(":visible").hide();a.$event.preventDefault();a.$event.stopPropagation();a=a.$target.parent().find(".a-popover");
a.is(":visible")||a.show()}function p(a,b,c){var d=a||{},e="string"===typeof a;c=c&&c.useSif?u('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():0;e?(d+="\x26ajaxResponse\x3d1\x26returnjson\x3d1",c&&(d+="\x26isAmazonApp\x3d1")):(d.ajaxResponse=1,d.returnjson=1,c&&(d.isAmazonApp=1));for(c=0;c<C.length;c++){var f=C[c],h=u("input[name\x3d"+f+"]").val();e?-1===b.search(f)&&-1===a.search(f)&&(d=d+"\x26"+f+"\x3d"+h):d[f]=h}return d}function t(a,b){if(0>a)return 0;isNaN(b)||(a=Number(a).toFixed(b));
a=a.toString();b=0<=a.lastIndexOf(".")?a.lastIndexOf("."):a.length;return 3>=b?a:t(a.substring(0,b-3),0)+","+a.substring(b-3)}function z(a,b,c,d){a="timeout"===b?"pay-ajax-timeout":"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":500===a.status?"pay-ajax-500":"pay-ajax-error";if(c){a=c=-1===c.lastIndexOf(".html?")?c+("?ref\x3d"+a):c+("\x26ref\x3d"+a);H.pageContainer.find("#tempForm").remove();c=u('\x3cform id\x3d"#tempForm" method\x3d"post"\x3e\x3c/form\x3e');
c.attr("action",a);if("string"===typeof d){a={};b=d.split("\x26");for(var e=0;e<b.length;e++){var f=b[e].split("\x3d");2===f.length&&(a[f[0]]=f[1])}}else a=d;for(var h in a)"ajaxResponse"!==h&&"returnjson"!==h&&(a=u('\x3cinput type\x3d"hidden"/\x3e').attr("name",h).val(d[h]),c.append(a));H.pageContainer.append(c);c.submit()}}function y(a,b,d,e){var f=g.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"}),f={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:p(b,a,e),dataType:"text",
headers:f,timeout:A,type:"POST",url:a,beforeSend:function(a,b){d&&d.beforeHandler&&d.beforeHandler(a,b)},complete:function(a,b){d&&d.completeHandler&&d.completeHandler(a,b)},error:function(c,e){d&&d.errorHandler?d.errorHandler(c,e):z(c,e,a,b)},success:function(a,b,e){var f=e.getResponseHeader("x-amz-checkout-page");if("payselect"!==f&&"spp-payment"!==f)return a=c.jsonify(a),g.redirect(a);d&&d.successHandler?d.successHandler(a,b,e):g.ajaxUpdatePage(a,b,e)}};u.extend(f,e);q.push(u.ajax(f))}function w(a,
b,c,d){var e=g.setAjaxTransitionHeader({"x-amz-checkout-page":"payselect"}),e={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:p(b,a,d),dataType:"text",headers:e,timeout:A,type:"POST",url:a,error:function(d,e){c&&c.errorHandler?c.errorHandler(d,e):z(d,e,a,b)},success:function(a,b,d){var e=d.getResponseHeader("x-amz-checkout-page");"payselect"!==e&&"spp-payment"!==e&&c&&c.pageUpdater?c.pageUpdater(a):g.ajaxUpdatePage(a,b,d)}};u.extend(e,d);q.push(u.ajax(e))}function v(){A=parseInt(u("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),
10);A=isNaN(A)?1E4:A;m.isMobileCX()?K&&(K=!1):(H=m.getElements(r),K&&(a.declarative("close-popover",["click"],e),a.declarative("toggle-msg-popover",["click"],b),a.declarative("a-extender-toggle",["click"],d),K=!1),H.pageContainer.undelegate(".expando-link","click").delegate(".expando-link","click",h),H.pageContainer.find("form select.a-touch-select-input").unbind("change",n).bind("change",n),u(".a-dropdown-container").each(function(){k.remove(u(this).find("select").attr("name"))}),u(document).bind("click",
function(a){a.isPropagationStopped()||0===u(a.target).closest(".pay-popover-msg").length&&H.msgPopovers.filter(":visible").hide()}))}function n(a){var b=u(a.currentTarget);a=b.siblings("a.a-placeholder");b=b.find(":selected").text();a.html(b);return!1}var u=a.$,K=!0,A,q=[],C=["forceResponsive","fromAnywhere","hasWorkingJavascript"],H={},r={msgPopovers:"div.pay-popover-msg",pageContainer:"div.a-container"};a.on("checkout:reload:payselect",v);a.on("checkout:reload:spp-payment",v);return m.mergeFrom({decodeJSONResponse:function(a){var b=
new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:H,getNumberWithSeparators:t,handleForm:function(a,b,c){a.$event.preventDefault();var d=a.$declarativeParent;d.is("span")&&(d=d.find("form"));d=d.serializeArray();d=m.processSubmissionParameters(d);y(a.data.action,d,b,c)},
makeAjaxCall:y,handleAjaxError:z,handlePaymentsPortalForm:function(a,b,c,d){a=m.processSubmissionParameters(a.submissionParameters);y(b,a,c,d)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,b,c,d){a=m.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;w(b,a,c,d)}},m)});"use strict";r.when("A","pay-common-lib","page-transition-controller").register("pay-mobile-util",function(a,m,k){function c(a,b,c){a=a||{};var d=y.fromAnywhereField.val(),e=c&&c.useSif?p('input[type\x3d"hidden"][name\x3d"isAmazonApp"]').val():
0,f=l();"string"===typeof a?(a=a+"\x26ajaxResponse\x3d1\x26currentPage\x3d"+f,-1===b.search("fromAnywhere")&&-1===a.search("fromAnywhere")&&(a=a+"\x26fromAnywhere\x3d"+d),e&&(a+="\x26isAmazonApp\x3d1")):(a.ajaxResponse=1,a.currentPage=f,-1===b.search("fromAnywhere")&&(a.fromAnywhere=d),e&&(a.isAmazonApp=1),c&&c.isAddCardAndContinueEnabled&&(a.isHideSpinnerDisabled=!0));return a}function f(){t&&t.abort("abort-for-cleanup");t=null}function g(a,b,c,e){a=a&&a.status;b="timeout"===b?"pay-ajax-timeout":
"abort"===b?"pay-ajax-abort":"abort-for-cleanup"===b?"pay-ajax-abort-for-cleanup":"parsererror"===b?"pay-ajax-parsererror":500===a?"pay-ajax-500":"unknown"===a?"pay-unknown-page":"pay-ajax-error";c&&(c=-1===c.lastIndexOf(".html?")?c+("?ref\x3d"+b):c+("\x26ref\x3d"+b),d(c,e))}function l(){var a;p.each(z,function(b,c){if(c.pageId&&p(c.pageId).is(":visible"))return a=b,!1});return a}function e(a){(a=z[a]&&z[a].componentId)&&r.when(a).execute(function(a){a.init&&a.init()})}function h(a,b,d,f,h){h&&h.suppressSpinner||
k.show();h={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:c(b,a,f),dataType:"text",timeout:n,type:"POST",url:a,beforeSend:function(a,b){d&&d.beforeHandler&&d.beforeHandler(a,b)},complete:function(a,c){d&&d.completeHandler&&d.completeHandler(a,c);b&&b.isHideSpinnerDisabled||k.hide()},error:function(c,e){d&&d.errorHandler?d.errorHandler(c,e):g(c,e,a,b)},success:function(c,f,h){var n=h.getResponseHeader("x-amz-checkout-pay-page-name");if(n){var p=h.getResponseHeader("x-amz-checkout-pay-page-title");
p&&y.pageTitle.text(decodeURIComponent(p));d&&d.successHandler?d.successHandler(c,f,h):y.pageContainer.html(c);e(n)}else g(null,"unknown",a,b)}};p.extend(h,f);t=p.ajax(h)}function d(a,b,c){var d=p("#tempForm",y.pageContainer);0<d.length&&d.remove();d=p('\x3cform method\x3d"post"\x3e\x3c/form\x3e');d.attr("action",a);c&&c.target&&d.attr("target",c.target);if("string"===typeof b)for(a=b.split("\x26"),b=0;b<a.length;b++)c=a[b].split("\x3d"),2===c.length&&"ajaxResponse"!==c[0]&&(c=p('\x3cinput type\x3d"hidden"/\x3e').attr("name",
c[0]).val(c[1]),d.append(c));else for(var e in b)"ajaxResponse"!==e&&d.append(p('\x3cinput type\x3d"hidden"/\x3e').attr("name",e).val(b[e]));y.pageContainer.append(d);d.submit()}function b(a,b,d,f,h){h&&h.suppressSpinner||k.show();h={contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",data:c(b,a,f),dataType:"text",timeout:n,type:"POST",url:a,complete:function(a,b){d&&d.completeHandler&&d.completeHandler(a,b);k.hide()},error:function(c,e){d&&d.errorHandler?d.errorHandler(c,e):g(c,e,
a,b)},success:function(a,b,c){var f=c.getResponseHeader("x-amz-checkout-pay-page-name");if(!f&&d&&d.pageUpdater)d.pageUpdater(a);else{var h=c.getResponseHeader("x-amz-checkout-pay-page-title");h&&y.pageTitle.text(decodeURIComponent(h));d&&d.successHandler?d.successHandler(a,b,c):y.pageContainer.html(a);e(f)}}};p.extend(h,f);t=p.ajax(h)}var p=a.$,t=null,z={main:{componentId:"page-main",pageId:"#select-payments-view"},"credit-card-rewards":{componentId:"page-rewards",pageId:"#select-payment-rewards-view"},
"financial-offer":{componentId:"page-financial-offer",pageId:"#select-payment-financial-offer-view"},"new-payment-methods":{pageId:"#new-payments-view"},"gil-estimates":{pageId:"#gil-estimates-subpage"}},y={},w={cvvHelper:"div#cvv-help-popover",fromAnywhereField:"input[name\x3dfromAnywhere]",jppoints:"div#jppoints",pageContainer:"div#page-container",pageTitle:"head title"},v=!0,n;return m.mergeFrom({decodeJSonResponse:function(a){var b=new RegExp(String.fromCharCode(65340),"g"),c=new RegExp(String.fromCharCode(92,
92,92,92),"g");a=a.replace(b,String.fromCharCode(92),"g");a=a.replace(c,String.fromCharCode(92));a=a.replace(/\\1/g,String.fromCharCode(34));return a=a.replace(/\\2/g,String.fromCharCode(10))},elements:y,getCurrentPage:function(){return y.pageContainer.children("div.page").filter(":visible")},getCurrentPageName:l,getPageId:function(a){a=a.getResponseHeader("x-amz-checkout-pay-page-name");return z[a]&&z[a].pageId},handleForm:function(a,b,c){a.$event.preventDefault();h(a.data.action,a.$target.serialize(),
{successHandler:function(a,c,d){b(a,c,d)}},c)},submitFormRequest:d,init:function(){m.isMobileCX()&&(q.onbeforeunload=f,m.refreshElements(y,w),n=parseInt(p("input[type\x3d'hidden'][name\x3d'paypageTimeoutValue']").val(),10),n=isNaN(n)?1E4:n,v&&(v=!1,p("div.pay-mobile").bind("keypress",function(a){m.prop("activeGoElement",13===a.keyCode?document.activeElement:null,!0)})))},makeAjaxCall:h,handleAjaxError:g,pages:z,handlePaymentsPortalForm:function(a,b,c,d){a=m.processSubmissionParameters(a.submissionParameters);
h(b,a,c,d)},handlePaymentsPortalRedeemClaimCodeTransition:function(a,c,d,e){a=m.processSubmissionParameters(a.submissionParameters);a.embedOnlyData=1;b(c,a,d,e)}},m)});"use strict";r.when("page-detector","pay-desktop-util","pay-mobile-util").register("pay-common-util",function(a,m,k){return a.isMobile()?k:m});"use strict";r.when("A","pay-common-util","pay-rewards-currency","checkout-federation-wrapper","safe-apx-helper","weblab-helper").register("pay-validator",function(a,m,k,c,f,g){function l(){function a(b,
c,d,e){R.push({identifier:b,priority:d||100,target:c,isPincodeError:e})}function p(a){if(!a)return null;var b=new RegExp(String.fromCharCode(32),"g"),c=new RegExp(String.fromCharCode(45),"g");return a.replace(b,"").replace(c,"")}function l(){return 0<R.length}function z(a){if(!a||0===a.length)return!1;for(var b=0,c=!1,d=a.length-1;0<=d;--d){var e=a.charAt(d);c&&(e*=2,9<e&&(e-=9));b+=parseInt(e,10);c=!c}return 0===b%10}function y(a,b){return a&&a.match(/^[0-9]+$/)&&a.length===b}function w(a,b,c){return a&&
a.match(/^[0-9A-Za-z]+$/)&&a.length>=b&&a.length<=c}function v(a,b){if(!a||!b)return!1;a=parseInt(a,10);b=parseInt(b,10);return n(a,b)}function n(a,b){var c=new Date,d=c.getFullYear();return b>d||b===d&&a>=c.getMonth()+1}function u(a){a=a.val();return!a||0===a.length}function q(){var c=e("#pm_pay_by_check").is(":checked"),d=e("#existing-balance [paymentmethodid\x3d'availablebalance'] input").is(":checked");c&&d&&a("continue_BadCombinationCheckExistingBalance")}function A(c){if(e("#jppoints").length){var d,
f=!1;1===c.length&&"jppoints"===c.attr("id")?(d=c,f=!0):d=c.filter("#jppoints");if(d&&d.find("#redeemPoints").is(":checked")){c=d.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val();c=parseInt(c,10);e('input[type\x3d"checkbox"][name\x3d"useAvailableBalance"]').is(":checked")&&(c-=parseInt(d.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),10));var h=parseInt(d.find("#redeemableAmount").text(),10),n=d.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');
d.find("#jpPointsMax").is(":checked")?d=h:(d=parseInt(n.val(),10))||(d=0);d>h?a("continue_jpPointsExceedsRedeemableAmount",n):f&&d<c?a("continue_notEnoughJPPoints"):d>c&&a("continue_jpPointsExceedsTotalPurchase")}}}function L(c){c&&(c=c.find(".pci-blocking-cvv"),c.length&&c.is(":visible")&&a("PCI_Block_CVV"))}function C(c){var d=c.find(".currency-list");d.length&&d.is(":visible")&&(c=d.find("[type\x3dradio]:checked").val(),d=d.find("#cardCurrencyDropDown option:selected").val(),c&&("Other"!==c||"-1"!==
d&&"-2"!==d)||a("continue_SelectCardCurrency"))}function H(c){var d=c.find("#existingCvvNum");if(0!==d.length){var e=d.val();c=h?c.data("validcvvlength"):c.attr("validcvvlength");y(e,parseInt(c,10))||a("continue_BadSecurityCode",d)}}function N(c){var d=c.find('input[name\x3d"paymentMethod"]').val();/^creditCard/.test(d)&&c.find("#savedCardSuppressed").length&&a("continue_BankTemporarilyNotAvailable")}function P(c){c=c.find("#existingPincodeNum");if(0!==c.length){var d=c.val();d?w(d,4,8)||a("existingCreditCard_PincodeInvalid",
c,null,!m.isMobileCX()):a("continue_EmptyPincode",c)}}function G(c){if(c&&c.length)for(var d=0;d<c.length;d++){var f=e(c[d]);L(f.parent());H(f);P(f);"netBanking"===f.find('input[name\x3d"paymentMethod"]').val()&&(e("#netBanking_select").val(),e("#net-banking-list").find("option:selected").data("isdisabled")&&a("continue_BankTemporarilyNotAvailable"));N(f);var h=f;h.find('input[name\x3d"paymentMethod"]').val();h.find("#vdcBanksSelect").val();e("#vdcBanksSelect").find("option:selected").data("isdisabled")&&
a("continue_BankTemporarilyNotAvailable");Y(f);f=f.siblings("#upi-acceptance-input").find("#vpaCollect");if(!f||f.length)(h=f.val())&&h.match(/.+@.+/)||a("continue_BadVpaForUpi",f)}}function M(c){var d=c.find("#newMonth"),e=c.find("#newYear");c=c.find("#newExpDate");!(d=d.length&&!v(d.val(),e.val()))&&(d=c.length)&&((c=c.val())?(d=c.split("-"),c=parseInt(d[0],10),d=parseInt(d[1],10),c=n(d,c)):c=!1,d=!c);d&&a("continue_BadExpiration")}function Q(c){"domesticCards"===c.find('input[name\x3d"paymentMethod"]').val()&&
((c=c.find("select").val())&&c.match(/^[0-9]*$/)||a("continue_BlankSlate"))}function E(c){var d=e("#existing-balance input[name\x3duseFlexiblePayments]").is(":checked");c=m.getAttributeData(c,"paymentmethodtype");d&&"creditCard"!==c&&a("continue_FlexiblePaymentsNeedsCreditCard")}function F(c){"thirdPartyAccounts"===c.find('input[name\x3d"paymentMethod"]').val()&&((c=c.find("select").val())&&0!==c.length||a("continue_BlankSlate"))}function V(c){var d=c.find(".rewards-list");if(d.length&&d.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")){c=
d.find("input.custom-rewards-input");var e=c.val();if(d.hasClass("show-currency-input-widget-new")){var d=c.data("country-code"),f=k.getCurrencyFormatByCountryCode(d),d=c.data("min"),e=k.getAmount(e,f.decimalPlace);e<d&&a("continue_BadRewardsMin")}else/^\s*$/.test(e)||isNaN(e)?a("continue_BadRewardsValue"):(e=parseFloat(c.val()),d=c.data("min"),0>=e||e<d?a("continue_BadRewardsMin"):e>c.data().max&&a("continue_BadRewardsMax"))}}function X(c){var d=c.find('input[name\x3d"paymentMethod"]').val();"verifiedCreditCard"===
d?a("continue_BlankSlate"):"verifiedDebitCard"===d&&(d=c.find("#vdcBanksSelect").val(),(""===d||"OtherBanks"===d||"1"===e("#save_citi_card").val()&&"CIT"===d)&&a("continue_BlankSlate"),c.find("option:selected").prop("disabled")&&a("continue_BankTemporarilyNotAvailable"))}function aa(c){"cashOnDeliveryCash"===c.find('input[name\x3d"paymentMethod"]').val()&&c.find(".phonenumberNotVerified").length&&a("continue_OTPforCOD")}function Z(c){if("netBanking"===c.find('input[name\x3d"paymentMethod"]').val()){var d=
c.find("#net-banking-select-list").val();c=c.find("option:selected").prop("disabled");""===d&&a("continue_BlankSlate");c&&a("continue_BankTemporarilyNotAvailable")}}function fa(c){"morePaymentMethod"===c.find('input[name\x3d"paymentMethod"]').val()&&""===c.find("#more-payment-methods-select-list").val()&&a("continue_BlankSlate")}function Y(c){var d=c.find('input[name\x3d"paymentMethod"]').val();if("StandaloneInstallment"===d||"StandaloneCreditCardInstallment"===d||"StandaloneReusableCreditLineInstallment"===
d)c.find('input[name\x3d"gilShowContinueBlocker"]').val()&&("StandaloneCreditCardInstallment"===d?a("continue_GilCCContinueError"):"StandaloneReusableCreditLineInstallment"===d?a("continue_GilRCLContinueError"):a("continue_GilContinueError")),c.find('input[name\x3d"showIneligibleItemSubpage"]').val()&&("StandaloneCreditCardInstallment"===d?a("continue_GilCCContinueErrorIneligibleItems"):"StandaloneReusableCreditLineInstallment"===d?a("continue_GilRCLContinueErrorIneligibleItems"):a("continue_GilContinueErrorIneligibleItems")),
c.find('input[name\x3d"gilShowContinueBlockerIfPromotions"]').val()&&0<e("#existing-balance input[name\x3duseAvailableBalance]:checked").length&&("StandaloneCreditCardInstallment"===d?a("continue_GilCCContinueErrorPromotions"):"StandaloneReusableCreditLineInstallment"===d?a("continue_GilRCLContinueErrorPromotions"):a("continue_GilContinueErrorPromotions"))}var R=[],ba=null,ga=null,x=function(a){d=a};d||(m.isMobileCX()?r.when("rewards-section-mobile").execute(x):r.when("rewards-section-desktop").execute(x));
return{displayErrors:function(a,b){(ba=a)&&ba.hide().find(".error-message").hide().addClass("hidden");(ga=b)&&ga.find(".a-form-error").removeClass("a-form-error");if(l()){for(a=0;a<R.length;a++){b=R[a];if(b.target){var c=b.target.parent();c.hasClass("a-input-text-wrapper")&&!c.hasClass("a-form-error")?c.addClass("a-form-error"):b.target.hasClass("a-form-error")||b.target.addClass("a-form-error")}b=b.identifier;(ba&&ba.length?ba.find("#"+b):e("#"+b)).show().removeClass("hidden")}ba&&ba.length&&ba.show()}},
getHighestErrorId:function(){for(var a={priority:100},b=0;b<R.length;b++){var c=R[b],d;(d=c.identifier)?(d=ba&&ba.length?ba.find("#"+d):e("#"+d),d=parseInt(m.getAttributeData(d,"priority"),10),d=isNaN(d)?100:d):d=100;d<=a.priority&&(a={identifier:c.identifier,priority:d,isPincodeError:c.isPincodeError,target:c.target})}return a},hasErrors:l,isValidCardCVV:y,isValidCardPincode:w,validateBankAccountNum:function(c,d){u(c)&&a("addBankAccount_NoAccountNumber",d)},validateBankAccountNumConfirm:function(c,
d,e){c.val()!==d.val()&&a("addBankAccount_AccountNumberMismatch",e)},validateBankDriverLicense:function(c,d){u(c)&&a("addBankAccount_NoDLNumber",d)},validateBankDriverLicenseState:function(c,d){c.val()!==D&&""!==c.val()&&"0"!==c.val()||a("addBankAccount_NoDLState",d)},validateBankHolderName:function(c,d){u(c)&&a("addBankAccount_NoName",d)},validateBankRoutingNum:function(c,d){9!==c.val().length&&a("addBankAccount_ShortRoutingNumber",d)},validateCreditCardCVV2:function(c,d,e){e="true"===c.attr("isaddresschallenge")?
c.attr("issuer"):e&&e.charAt(0);"R"!==e&&(c=c.val(),y(c,"A"===e?4:3)||a("addCreditCard_BadSecurityCode",d))},validateCreditCardDate:function(c,d,e,f){v(c.val(),e.val())||(a("addCreditCard_BadExpiration",d),a("addCreditCard_BadExpiration",f))},validateCreditCardMobile:function(c,d){c=c.val();g.isUpdateMobileNumberEnabled()?c&&c.replace(/[^0-9]/g,"").match(/^1[0-9]{10}$/)||a("addCreditCard_BadMobileNumber",d):c&&c.replace(/[^0-9]/g,"").match(/^1[34578]{1}[0-9]{9}$/)||a("addCreditCard_BadMobileNumber",
d)},validateCreditCardPincode:function(c,d){(c=c.val())&&c.match(/^[a-zA-Z0-9]{4,8}$/)||a("addCreditCard_BadPincode",d)},validateCreditCardName:function(c,d){u(c)&&a("addCreditCard_NoName",d)},validateCreditCardNumber:function(c,d){var f=p(c.val());f&&10<f.length&&z(f)||a("addCreditCard_BadNumber",d);f=e("#creditCardIssuersBlocked").val();c=c.data("issuer");f&&""!==f&&c&&""!==c&&-1<e.inArray(c,f.split(","))&&a("addCreditCard_IssuerUnsupported",d)},validateSBIMaestroCardNumberLength:function(c,d){19!==
p(c.val()).length&&a("addCreditCard_SBIMaestro_BadNumberLength",d)},isAMEXCreditCard:function(a){a=p(a.val());return null!==a?0===a.indexOf("37")||0===a.indexOf("34"):!1},validateCreditCardTail:function(c,d){var e=p(c.val());e&&10<e.length&&z(e)?(c=(m.isMobileCX()&&h?c.parent().data():c.data()).tail+"",e.substr(e.length-c.length)!==c&&a("addCreditCard_NotMatch",d)):a("addCreditCard_NotMatch",d)},validateCreditCardType:function(c,d){c.is(":visible")&&((c=c.val())&&c.match(/^[A-Z][0-9]*$/)||a("addCreditCard_NoType",
d))},validateRegistrationResult:function(c){c.cardStatus?1===c.checkStatusCount&&a("addCreditCard_RegisterFailed"):0<c.errors.length&&a("addCreditCard_RegisterFailed")},validateDirectDebitAccountName:function(c,d){u(c)&&a("addDirectDebit_NoAccountOwnerName",d)},validateDirectDebitAccountNum:function(c,d){u(c)&&a("addDirectDebit_NoAccountNumber",d)},validateDirectDebitRoutingNum:function(c,d){u(c)&&a("addDirectDebit_NoRoutingNumber",d)},validateInvoiceFirstName:function(c,d){u(c)&&a("addInvoiceAccount_NoFirstName",
d)},validateInvoiceLastName:function(c,d){u(c)&&a("addInvoiceAccount_NoLastName",d)},validateLocName:function(c,d){u(c)&&a("addLoc_NoName",d)},validateLocNumber:function(c,d){u(c)&&a("addLoc_BadNumber",d)},validateNewGiftPromotion:function(c,d){u(c)&&a("addGiftCardOrPromo_NoCode",d)},validatePayment:function(f){if(m.isMobileCX())G(f),d&&c.wrap(function(){d.validatePaymentRewardsInRewardsSection(a)},"shopwithpointsmobile");else if(q(),f&&f.length){for(var h=0;h<f.length;h++){var n=e(f[h]);"true"===
m.getAttributeData(n,"isaddresschallenge")&&a("continue_AddressChallenge");"true"===m.getAttributeData(n,"isverifiedfail")&&a("continue_VerifiedFail");"true"===m.getAttributeData(n,"iscupcardexpired")&&a("continue_CUPExpired");L(n);C(n);H(n);P(n);M(n);Q(n);E(n);F(n);V(n);X(n);Z(n);fa(n);Y(n);aa(n);N(n)}d&&c.wrap(function(){d.validatePaymentRewardsInRewardsSection(a)},"shopwithpoints");A(f)}else a("continue_BlankSlate")},validateGetCreditCardTypeResult:function(c){if(c.errors&&0<c.errors.length)for(var d=
0;d<c.errors.length;d++)a(c.errors[d])},validateEMIMenuForContinueButton:function(c){var d=c.find("#emiPaymentMethodsSelectList").find("option:selected").val();if("CreditCard"===d||"SelectOption"===d)a("continue_BlankSlate");else if(d=d.split("."),1<d.length){var e=d[0];if("emiCreditCard"===e||"netbankingEMI"===e)c=c.find("."+d[1]),c=c.find(".emiMenuTenuresDropDown"),c.length&&!c.find("option:selected").val()&&a("continue_BlankSlate")}},apxValidatePayment:function(a,b){var c=f.get("payselect");c&&
c.validatePayments(this,b,a)},addError:a,errors:R,validatePCICVVBlock:L}}var e=a.$,h=q.P&&q.P.AUI_BUILD_DATE,d=D;return{create:function(){return new l}}});"use strict";r.when("A","ajax-utility","pay-common-util","pay-validator").register("pay-credit-card",function(a,m,k,c){function f(a,c,b,e){a&&a.length&&(c=b+"-"+c,(b=k.prop(c))&&(a=a.find(e).val(b))&&a.length&&(k.isMobileCX()?a.closest(".card-cvv-field").hide().data("isHidden",1):a.closest(".a-column").hide(),k.prop(c,D)))}var g=a.$,l={cc:!1,vcc:!1,
vdc:!1},e=q.P&&q.P.AUI_BUILD_DATE;return{confirmCreditCard:function(a,c,b){a.currentPaymentInstrumentID=a.paymentmethodid;a.recommendedPaymentMethodId=a.paymentmethodid;if(a.newMonth&&a.newYear)a.month=a.newMonth,a.year=a.newYear;else if(a.newExpDate){var e=a.newExpDate.split("-");a.year=parseInt(e[0],10);a.month=parseInt(e[1],10)}else a.expmonth&&a.expyear&&(a.month=a.expmonth,a.year=a.expyear);(e="existingCvvNum"in a?a.addCreditCardVerificationNumber=a.existingCvvNum:a.addCreditCardVerificationNumber)&&
k.prop("cvv-"+a.paymentmethodid,e);(e="existingPincodeNum"in a?a.addCreditCardPincode=a.existingPincodeNum:a.addCreditCardPincode)&&k.prop("pincode-"+a.paymentmethodid,e);k.makeAjaxCall(b,a,{successHandler:c,errorHandler:function(b,c){a.handler="confirm-credit-card";k.handleAjaxError(b,c,"/gp/buy/payselect/handlers/submit.html",a)}},{useSif:!0})},handleCreditCardType:function(a,d){var b=a.$target,e=a.data.type,f=c.create();a.$currentTarget.data("issuer","");f.validateCreditCardNumber(b,b);f.hasErrors()||
(l[e]=!0,k.makeAjaxCall(a.data.url,{addCreditCardNumber:b.val(),returnjson:1},{completeHandler:function(){l[e]=!1},successHandler:function(b){b=m.jsonify(b);d(b,e);a.$currentTarget.data("issuer",b.issuer)}},{useSif:!0},{suppressSpinner:!0}))},isWaitingForType:function(a){return l[a]},runConfirmCardValidator:function(a,d){var b=a.find("#existingCvvNum"),b=b.length?b:a.find("#addCreditCardVerificationNumber"),e=a.find("#addCreditCardNumber"),f=a.find("#newMonth"),g=a.find("#newYear"),l=c.create();l.validateCreditCardTail(e,
e);f.length&&g.length&&l.validateCreditCardDate(f,f.closest(".card-date").find(".a-button"),g,g.closest(".card-date").find(".a-button"));b.length&&(e=(e=a.find("#issuer"))&&e.val(),l.validateCreditCardCVV2(b,b,e));l.displayErrors(d,a);return l.hasErrors()},setDateSelectorStatus:function(a,c){var b=c.find(".card-date").find("select");b&&b.length&&r.when("a-dropdown").execute(function(c){b.each(function(){var b=g(this).attr("id");c.updateSelect(b,{status:"21"===a.brand&&"G"===a.issuer?"disabled":"enabled"})})})},
setNewCardCVVInputStatus:function(a){(k.prop("cvv-newcard")||k.prop("pincode-newcard"))&&a.each(function(){var a=g(this);if("1"===(e?a.data("isnewcard")+"":a.attr("isnewcard")))return f(a,"newcard","cvv","#existingCvvNum"),f(a,"newcard","pincode","#existingPincodeNum"),!1})},setCardPasswordInputStatus:f}});"use strict";r.when("A","ajax-utility","pay-common-util","pay-validator","page-transition-controller","page-conductor","pay-credit-card").register("pay-credit-card-reregistration",function(a,m,
k,c,f,g,l){function e(a,e){var f=c.create(),g=d("#cupMobileNumber-"+a),h=d("#cupSecurityCode-"+a),l=d("#reRegisterCCErrors-"+a);a=d("#reRegisterCCInputs-"+a);f.validateCreditCardCVV2(h,h,e);f.validateCreditCardMobile(g,g);f.displayErrors(l,a);return f.hasErrors()}function h(a,c,d){g.ajaxUpdatePage(a,c,d)}var d=a.$;return{actionReregisterCardInBox:function(a){a.$event.preventDefault();f.show();var c=a.data.type,g=d("#cupMobileNumber-"+a.data.paymentMethodID).val(),z=d("#cupSecurityCode-"+a.data.paymentMethodID).val();
e(a.data.paymentMethodID,c)?f.hide():(c={isReregistering:a.data.isReregistering,currentPaymentInstrumentID:a.data.paymentMethodID,name:a.data.holderName,year:a.data.expiredYear,month:a.data.expiredMonth,addCreditCardMobileNumber:g,addCreditCardVerificationNumber:z},g={useSif:k.isMobileCX()?!0:!1,success:function(a,c,b){a=m.jsonify(a);c=d("#reRegisterCCErrors-"+a.paymentInstrumentId);l.waitForCreditCardStatus(a,h,c)}},a.$event.preventDefault(),k.makeAjaxCall(a.data.url,c,null,g))}}});"use strict";
r.when("A","client-side-metrics","ajax-utility","pay-common-util","pay-validator","existing-payments","page-conductor","checkout-modal-popover","page-transition-controller","pay-credit-card","pay-gil","new-verified-debit-card","emi-helper").register("new-payments",function(a,m,k,c,f,g,l,e,h,d,b,p,t){function z(a){a.$event.preventDefault();var b=a.data.type;if(d.isWaitingForType(b))h.show(),setTimeout(function(){z(a)},50);else{var e;e="vdc"===b?W.newVDC:"emi"===b?W.newEMI:W.newVCC;if(da(e,b))h.hide();
else{h.show();var f=c.getInputValues(e),n="vdc"===b?"_VDC":"_VCC";e=f["addCreditCardVerificationNumber"+n];var g=f["addCreditCardPincode"+n],b={addCreditCardNumber:f["addCreditCardNumber"+n],addCreditCardVerificationNumber:e,addCreditCardPincode:g,handler:f["handler"+n],month:f["month"+n],name:f["name"+n],newPaymentType:b,year:f["year"+n],cctype:f["cctype"+n],isSBIInternationalMaestroSelected:f["isSBIInternationalMaestroSelected"+n],isCardSavedFromEMIMenu:f["isCardSavedFromEMIMenu"+n]};c.prop("cvv-newcard",
e);g&&c.prop("pincode-newcard",g);c.makeAjaxCall(a.data.url,b,{successHandler:function(a,c,b){H(a,c,b);d.setNewCardCVVInputStatus(W.paymentRows)}},{useSif:!0})}}}function y(a){a.$event.preventDefault();var b=a.data.type;if(d.isWaitingForType(b))h.show(),setTimeout(function(){y(a)},50);else{var e=W.newCCFormContent;if(da(e,b))h.hide();else{h.show();b=c.getInputValues(e);b.handler=b.handler_addCCInBox;var e=a.data.url,f={};O("#cupSecurityCode").is(":visible")&&O("#cupMobileNumber").is(":visible")?(e=
"/gp/buy/payselect/handlers/add-credit-card.html",f={successHandler:function(a){a=k.jsonify(a);P(a)}}):f={successHandler:H};c.makeAjaxCall(e,b,f,{useSif:!0})}}}function w(a){a.$event.preventDefault();var b=O("#new-giftcard-promotion"),b=c.getInputValues(b);O("input[name\x3disUnifiedActionsDesignEnabled]").length&&v(a)||(b.handler=b.handler_addGCInBox,a=a.data.url,h.show(),c.makeAjaxCall(a,b,{successHandler:function(a,b,d){l.ajaxUpdatePage(a,b,d);ta||c.scrollTopTo(O("#existing-balance"))}},{useSif:!0}))}
function v(a){a=a.$declarativeParent;var b=O("#gcpromoinput"),c=f.create();c.validateNewGiftPromotion(b,b);c.displayErrors(W.newGCErrors,a);return c.hasErrors()}function n(a){var b=O(a.currentTarget).parents("div.new-payment-line").find(".card-date select");if(b&&b.length){var c=O(a.currentTarget).val();r.when("a-dropdown").execute(function(a){b.each(function(){var b=O(this).attr("id");a.updateSelect(b,{status:"G21"===c?"disabled":"enabled"})})})}}function u(a){var b=W.newVDC.find(".vdc-form-fields"),
c=W.newVDC.find("#vdc-logo-prompt"),d=W.newVDC.find(".top-cell");a?b.show():b.hide();a?c.show():c.hide();a?d.addClass():d.removeClass()}function q(a){var b=O(a.currentTarget).val(),c=W.newVDC.find("#suppressedVerifiedDebitCard").hide(),d=W.newVDC.find(".vdc-selected-bank-prompt").hide();u(!1);var e="1"===W.newVDC.find("#isRupayAsSavedCardEnabled").val()&&"URP"===b;"OtherBanks"===b||"1"===O("#save_citi_card").val()&&"CIT"===b||e?(u(!0),O.isEmptyObject(p)||p.showExpiryDateAndCvv()):"SMP"!==b||O.isEmptyObject(p)?
""!==b&&(b=O(a.currentTarget).find("option:selected").prop("disabled"),a=O(a.currentTarget).find("option:selected").text(),b?c.show().find(".suppressed-card-text").html(a):d.show().find(".bank-name-text").html(a)):(u(!0),p.hideExpiryDateAndCvv())}function A(a,b){if(!O.isEmptyObject(t)&&a)return a(b)}function L(a){A(t.removeEMIMenuSelectionAttributes);W.newEMI.find(".emi-group").hide();a=O(a.currentTarget).find("option:selected").val();W.newEMI.find("#emiMenuErrors_VCC").length&&W.newEMI.find("#emiMenuErrors_VCC").hide();
if(a=A(t.showPaymentOptionBlock,a))A(t.addEMIMenuSelectionAttributes),a.show()}function C(a){d.handleCreditCardType(a,ma)}function H(a,b,d){l.ajaxUpdatePage(a,b,d);ta||c.scrollTopTo(g.getSelectedPayment())}function N(a){a.$event.preventDefault();var b=a.data.type;d.isWaitingForType(b)?(h.show(),setTimeout(function(){N(a)},50)):da(a.$declarativeParent,b)?h.hide():(ka&&ka.hide(),S&&S.hide(),h.show(),O("#cupSecurityCode").is(":visible")&&O("#cupMobileNumber").is(":visible")?(b=a.$declarativeParent.serializeArray(),
b=c.processSubmissionParameters(b),c.makeAjaxCall("/gp/buy/payselect/handlers/add-credit-card.html",b,{successHandler:function(a){a=k.jsonify(a);P(a)}},{useSif:!0})):c.handleForm(a,{successHandler:H},{useSif:!0}))}function P(a){var b={};b.paymentInstrumentId=a.paymentInstrumentId;a.checkStatusCount&&(b.checkStatusCount=a.checkStatusCount);var d={successHandler:function(a){a=k.jsonify(a);var b=f.create();"VERIFIED"===a.cardStatus?c.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{newPaymentMethodId:a.paymentInstrumentId},
{successHandler:H}):"PENDING"===a.cardStatus?(a.checkStatusCount?(a.checkStatusCount=parseInt(a.checkStatusCount,10),isNaN(a.checkStatusCount)&&(a.checkStatusCount=1)):a.checkStatusCount=3,b.validateRegistrationResult(a),1===a.checkStatusCount?(h.hide(),b.displayErrors(W.newCCErrors)):(--a.checkStatusCount,P(a))):(b.validateRegistrationResult(a),h.hide(),b.displayErrors(W.newCCErrors))}};setTimeout(function(){c.makeAjaxCall("/gp/buy/payselect/handlers/check-credit-card-status.html",b,d)},2500)}function G(a){a.$event.preventDefault();
var b=a.$declarativeParent,d=b.find("#loc-name"),e=b.find("#loc-number"),n=f.create();n.validateLocName(d,d);n.validateLocNumber(e,e);n.displayErrors(b.find("#error-box-new-loc"),b);n.hasErrors()||(ra&&ra.hide(),h.show(),c.handleForm(a,{successHandler:H}))}function D(a){a.$event.preventDefault();var b=a.$declarativeParent,d=b.find("#gcpromoinput");b.find("#gcpromosuccessblock").hide();var e=f.create();e.validateNewGiftPromotion(d,d);e.displayErrors(W.newGCErrors,b);e.hasErrors()||(h.show(),c.handleForm(a,
{successHandler:function(a,b,d){l.ajaxUpdatePage(a,b,d);ta?W.newGCErrors.is(":visible")&&O("#gc-link-expander").trigger("click"):c.scrollTopTo(O("#existing-balance"))}}))}function Q(a){a.$event.preventDefault();O("#ccAddCard").trigger("submit")}function E(a){a.$event.preventDefault();O("#bank-address-popover-submit").trigger("submit")}function F(a){a.$event.preventDefault();O("#direct-debit-popover-submit").trigger("submit")}function V(a){a.$event.preventDefault();O("#new-loc-popover-submit").trigger("submit")}
function X(a){a.$event.preventDefault();O("#new-invoice-popover-submit").trigger("submit")}function aa(a){a.$event.preventDefault();O("#brdcAddCard").trigger("submit")}function Z(a){a.$event.preventDefault();var b=a.$declarativeParent,d=f.create(),e=b.find("#bank-name"),n=b.find("#bank-routing-number"),g=b.find("#bank-account-number"),p=b.find("#bank-account-number-confirm"),l=b.find("#bank-dl"),k=b.find("#bank-dl-state");d.validateBankHolderName(e,e);d.validateBankRoutingNum(n,n);d.validateBankAccountNum(g,
g);d.validateBankAccountNumConfirm(g,p,p);d.validateBankDriverLicense(l,l);d.validateBankDriverLicenseState(k,k.parents("div.a-button-dropdown"));d.displayErrors(b.find("#new-bank-error-box"),b);d.hasErrors()||(oa&&oa.hide(),h.show(),c.handleForm(a,{successHandler:H}))}function fa(a){a.$event.preventDefault();var b=a.$declarativeParent,d=f.create(),e=b.find("#debit-bank-routing-number"),n=b.find("#debit-account-number"),g=b.find("#debit-account-name");d.validateDirectDebitRoutingNum(e,e);d.validateDirectDebitAccountNum(n,
n);d.validateDirectDebitAccountName(g,g);d.displayErrors(b.find("#new-direct-debit-error"),b);d.hasErrors()||(ca&&ca.hide(),h.show(),c.handleForm(a,{successHandler:H}))}function Y(a){a.$event.preventDefault();var b=a.$declarativeParent,d=f.create(),e=b.find("#invoice-first-name"),n=b.find("#invoice-last-name");d.validateInvoiceFirstName(e,e);d.validateInvoiceLastName(n,n);d.displayErrors(b.find("#new-invoice-error-box"),b);d.hasErrors()||(wa&&wa.hide(),h.show(),c.handleForm(a,{successHandler:H}))}
function R(a){a=O("#order-summary-total");var b=O("#order-summary-container");a.prev().addClass("a-first");b.addClass("a-box-group");a.show();c.isTouchCX()&&b.parent().find(".bottom-order-summary").show();W.newCCFormContent.is(":visible")||O("#wrapper-new-cc").find("a.a-link-expander").trigger("click");O("#ecard-help-link").show()}function ba(a){var b="Unknown";c.isDesktopCX()?b="Desktop":c.isMobileCX()?b="Mobile":c.isTouchCX()&&(b="Tablet");m.increaseCount("PayPage-ClientSide-AddCupClick-"+b,1);
b=O("#cupForm");if(0<b.length)b.submit();else{var d=O("\x3cform\x3e\x3c/form\x3e");d.attr({target:"_blank",method:"POST",action:a.data.url});O("#cup-dc").find("input").each(function(){var a=O(this);"hidden"===a.attr("type")&&a.clone().appendTo(d)});O("body").append(d);d.submit();d.remove()}}function ga(b){var d=b.$target.closest(".a-popover"),f=d.data("a-popover-id");e.hideById(f);d.hide();O("#a-popover-modal").hide();h.show();c.makeAjaxCall(b.data.url,void 0,{successHandler:function(b){O("#existing-payment-methods").replaceWith(O(b).find("#existing-payment-methods"));
a.trigger("checkout:reload:payselect");h.hide()}})}function x(a){a.$event.preventDefault();a=a.data;h.show();b.submitNewGilPayment(a.subtype)}function ha(){if(!c.isMobileCX()){0===O("#form-add-credit-card").length&&(O("#ccAddCard").parents("div.cc-submit").hide(),O("#ccAddCardWithButton").parents("div.cc-submit").show());O("html").hasClass("a-ie6")&&(O("#cup-mbdc").show(),O(".mbdc-link").attr("data-action","redirect-cup"));W=c.getElements(Ca);W.bankNumberConfirm.show();W.newVDC.find(".payment-row").data("hasstatus")||
W.newVDC.find(".vdc-form-fields").hide();W.newVDC.find("#suppressedVerifiedDebitCard").hide();W.newCCFormContent.find(".cup-card-field").hide();W.newPayments.find("#cupInfoMessage").hide();W.newPayments.find("#use-ecard-link").show();W.newPayments.find(".mbdc-link").show();W.newPayments.find(".mbdc-button").hide();ta=!1;W.newPayments.each(function(){var a=O(this),b=a.data();b&&0===b.hasstatus?(a.find("a.a-link-expander i.js-hide").remove(),a.find("a.a-link-section-expander i.js-hide").remove()):b&&
1===b.hasstatus&&!ta&&(c.scrollTopTo(a),ta=!0)});var b=W.newVCC.find("#requireCVVOrPincode");b&&b.length&&b.val("1");sa&&(a.declarative("new-cc",["submit"],N),a.declarative("new-brdc",["submit"],N),a.declarative("new-loc",["submit"],G),a.declarative("show-card-image",["change"],C),a.declarative("new-giftcard-promotion",["submit"],D),a.declarative("new-verified-card",["click"],z),a.declarative("new-cc-in-dashboard",["click"],y),a.declarative("new-gc-in-dashboard",["click"],w),a.declarative("add-bank-account",
["submit"],Z),a.declarative("add-direct-debit",["submit"],fa),a.declarative("add-invoice",["submit"],Y),a.declarative("show-order-summary",["click"],R),a.declarative("redirect-cup",["click"],ba),a.declarative("cup-popover-close",["click"],ga),a.declarative("add-new-debit-and-cc-popover-submit",["click"],Q),a.declarative("add-bank-account-popover-submit",["click"],E),a.declarative("add-loc-account-popover-submit",["click"],V),a.declarative("new-gil-payment",["click"],x),a.declarative("add-direct-debit-popover-submit",
["click"],F),a.declarative("add-invoice-account-popover-submit",["click"],X),a.declarative("add-new-br-debit-card-popover-submit",["click"],aa),sa=!1);W.cardTypeDropdown.unbind("change",n).bind("change",n);W.vdcBankDropdown.unbind("change",q).bind("change",q);W.emiCardsDropdown.unbind("change",L).bind("change",L);O("div.pay-desktop a.a-link-expander").unbind("keypress");O("div.pay-desktop .a-declarative, div.pay-desktop .a-button").filter("[data-action\x3da-checkout-modal-popover]").unbind("keypress");
a.on("a:popover:show:add-new-debit-cc-modal",function(a){S=a.popover});a.on("a:popover:show:add-new-bank-account-modal",function(a){oa=a.popover});a.on("a:popover:show:add-new-direct-debit-modal",function(a){ca=a.popover});a.on("a:popover:show:add-new-loc-account-modal",function(a){ra=a.popover});a.on("a:popover:show:add-invoice-account-modal",function(a){wa=a.popover});a.on("a:popover:show:add-br-debit-card-modal",function(a){ka=a.popover})}}function da(a,b){var c,d,e,n,g,h,p,l,k,m,t;"vcc"===b?(c=
"#vccCVVNum",b="#newVCCErrors",d="#vccMonth",e="#vccName",n="#newVerifiedCreditCardNumber",g="#vccType",h="#vccYear",p="#vccPincode",t=m=k=l=void 0):"vdc"===b?(c="#vdcCVVNum",b="#newVDCErrors",d="#vdcMonth",e="#vdcName",n="#newVerifiedDebitCardNumber",g="#vdcType",h="#vdcYear",l="#isSBIMaestroAsSavedCardEnabled",k="#isSBIInternationalMaestroSelected",t=m=p=void 0):"emi"===b?(c="#vccCVVNum",b="#newEMIErrors",d="#vccMonth",e="#vccName",n="#newVerifiedCreditCardNumber",g="#vccType",h="#vccYear",p="#vccPincode",
t=m=k=l=void 0):"brdc"===b?(b="#newBRDCErrors",d="#brdcMonth",e="#brdcName",n="#addCreditCardNumber_BRDC",h="#brdcYear",t=m=k=l=p=g=c=void 0):(m="#cupSecurityCode",t="#cupMobileNumber",c="#ccCVVNum",b="#newCCErrors",d="#ccMonth",e="#ccName",n="#addCreditCardNumber",g="#ccType",h="#ccYear",k=l=p=void 0);c=a.find(c);m&&0===c.length&&a.find(m).is(":visible")&&(c=a.find(m));l="1"===a.find(l).val()&&"1"===a.find(k).val();e=a.find(e);n=a.find(n);t=t?a.find(t):null;d=a.find(d);g=a.find(g);h=a.find(h);var u;
p&&a.find(p).is(":visible")&&(u=a.find(p));p=g.val();k=f.create();k.validateCreditCardName(e,e);k.validateCreditCardNumber(n,n);l&&k.validateSBIMaestroCardNumberLength(n,n);l=d.parent();l=l.hasClass("a-button")?l:l.find(".a-button");e=h.parent();e=e.hasClass("a-button")?e:e.find(".a-button");"G21"!==p&&k.validateCreditCardDate(d,l,h,e);k.validateCreditCardType(g,g.closest(".card-type-field").find(".a-button"));h=p?p.substr(0,1):"";c.length&&"R"!==h&&c.is(":visible")&&k.validateCreditCardCVV2(c,c,
p);t&&t.length&&t.is(":visible")&&k.validateCreditCardMobile(t,t);u&&u.length&&k.validateCreditCardPincode(u,u);k.displayErrors(O(b),a);return k.hasErrors()}function ma(a,b){if(a){"1"===a.isDebitCard?W.newCCWarnings.show().removeClass("hidden"):W.newCCWarnings.hide().addClass("hidden");if("1"===a.hasErrors){var e=f.create();e.validateGetCreditCardTypeResult(a);if(e.hasErrors()){e.displayErrors(W.newCCErrors);return}}b="vcc"===b?W.newVCC:"vdc"===b?W.newVDC:"emi"===b?W.newEMI:"brdc"===b?W.newBRDCFormContent:
W.newCCFormContent;var e=a.specificFields,n=b.find(".cup-card-field");0!==n.length&&(e&&1===e.securityCode&&1===e.mobileNumber?(c.isTouchCX()&&b.find("#addCreditCardNumber").closest(".a-input-text-wrapper").removeClass("last-child"),n.show()):n.hide());e=a.specificFields;n=b.find(".amex-field");if(0!==n.length){var g=b.find(".cvv-field");0!==g.length&&(e&&1===e.pincode?(g.hide(),n.show()):e&&0===e.pincode&&0===e.securityCode?(n.hide(),g.hide()):(n.hide(),g.show()))}e=b.find(".card-images");e.find("img").hide();
g=a.installmentProgram;n=!1;g&&(g=e.find('img[data-installmentprogram\x3d"'+g+'"]'),0!==g.length&&(g.show(),n=!0));n||(a.issuerdisplayimage?e.find("img[data-issuer\x3dATM]").attr("src",a.issuerdisplayimage).show():(n=a.issuer+a.brand,e.find("img[data-issuer\x3d"+n+"]").show(),b.find(Ca.cardTypeDropdown).val(n).trigger("change")));d.setDateSelectorStatus(a,b)}}var O=a.$,sa=!0,ta=!1,W={},Ca={bankNumberConfirm:"#wrapper-bank-account-number-confirm",btnAddCard:"#ccAddCard",btnAddLoc:"#button-new-loc",
btnAddGC:"#button-add-gcpromo",btnAddBank:"#button-add-bank-account",btnAddDirectDebit:"#button-add-direct-debit",btnAddInvoice:"#button-add-invoice",cardImages:"#newCreditCardImages",cardTypeDropdown:".card-type-dropdown select",newCCFormContent:"#new-cc",newBRDCFormContent:"#new-brdc",newGCErrors:"#gcpromoerrorblock",newGCFormContent:"#gc_entry",newPayments:"div.new-payment-line",newVCC:"#new-verified-credit-cards-table",newVDC:"#new-verified-debit-cards-table",newEMI:"#newEmiCard",paymentRows:"#existing-payment-methods .payment-row",
vdcBankDropdown:"#vdcBanksSelect",emiCardsDropdown:"#emiPaymentMethodsSelectList",cardList:"#existing-credit-cards-box",newCCErrors:"#newCCErrors",newCCWarnings:"#newCCWarnings"},S,oa,ra,ca,wa,ka;a.on("checkout:reload:payselect",ha);a.on("checkout:reload:spp-payment",ha);return{actionShowOrderSummary:R,handleFormHandlerScrollToSelected:H}});r.when("A","page-detector","client-side-metrics","ready").execute(function(a,m,k){function c(a,c,e,h){a=f(c).is(":checked");q.P&&q.P.AUI_BUILD_DATE?a?f(e).val(f(e).parent().data("account-name")):
f(e).val(""):(k.increaseCount("removeauijs8"),a?(f(h).removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active"),f(e).val(f(e).data("account-name"))):(f(h).removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),f(e).val("")));e="undefined"!==typeof q.ue&&"undefined"!==typeof q.ue.count;h=m.isMobilePayment()?"mobile":"tablet";a=f("#showNameOnCardCheckbox").is(":checked");e&&q.ue.count(h+"NameOnCardCheckBox"+(a?"Checked":"Unchecked"),1)}var f=
a.$;a.declarative("show-card-name",["click"],function(a){c(a,"#showNameOnCardCheckbox","#ccName","#showNameOnCardIcon")});a.declarative("show-br-debit-card-name",["click"],function(a){c(a,"#showNameOnCardCheckbox_BRDC","#brdcName","#showNameOnCardIcon_BRDC")})});"use strict";r.when("A").register("pay-rewards-currency",function(a){var m=function(a,c){c=Math.pow(10,c);a=a.replace(/[^0-9]/g,"");return parseFloat(a)/c},k={CA:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},DE:{groupingSeparator:".",
decimalSeparator:",",decimalPlace:2},GB:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2},JP:{groupingSeparator:",",decimalSeparator:".",decimalPlace:0},US:{groupingSeparator:",",decimalSeparator:".",decimalPlace:2}},c=function(a,c,e,f,d){this.groupingSeparator=a;this.decimalSeparator=c;this.currencyDecimalPlace=e;this.pointsDecimalPlace=f;this.ratio=d;this.getCurrencyAmount=function(a){return m(a,this.currencyDecimalPlace)};this.getPointsAmount=function(a){return this.getCurrencyAmount(a)/
this.ratio};this.format=function(a,c){var d=parseInt(a,10);a=parseFloat(a-d).toFixed(c);a=this.decimalSeparator+a.slice(2);d=d.toString();c=3<d.length?d.length%3:0;d=(0<c?d.substr(0,c)+this.groupingSeparator:"")+d.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+this.groupingSeparator);return a===D||a===this.decimalSeparator?d:d+a};this.formatCurrency=function(a){return this.format(a,e)};this.formatPoints=function(a){return this.format(a,f)}},f=function(c,f,e,h){this.maxAmount=h;this.rewardsFormatter=e;this.currencyElement=
c;this.pointElement=f;var d=this;this.isControlKey=function(a){switch(a.which){case 8:case 46:return!0;case 86:case 88:return a.ctrlKey;default:return!1}};this.isNavigationKey=function(a){switch(a.which){case 9:case 16:case 17:case 35:case 36:case 37:case 39:return!0;case 65:case 67:return a.ctrlKey;default:return!1}};this.isValidKey=function(a){var c=a.which;return 48<=c&&57>=c||96<=c&&105>=c||8===a.which||46===a.which};this.getCaret=function(){var a=d.currencyElement,c=a.get(0),e=0,f=0;if("number"===
typeof c.selectionStart&&"number"===typeof c.selectionEnd)e=c.selectionStart,f=c.selectionEnd;else{var g=document.selection.createRange();if(g!==D&&g.parentElement()===c){var a=a.val(),f=a.length,h=c.createTextRange();h.moveToBookmark(g.getBookmark());c=c.createTextRange();c.collapse(!1);-1<h.compareEndPoints("StartToEnd",c)?e=f:(e=-h.moveStart("character",-f),e+=a.slice(0,e).length-1,-1<h.compareEndPoints("EndToEnd",c)||(f=-h.moveEnd("character",-f),f+=a.slice(0,f).length-1))}}return{start:e,end:f}};
this.setCaret=function(a){var c=d.currencyElement.get(0);c.setSelectionRange?c.setSelectionRange(a,a):c.createTextRange&&(c=c.createTextRange(),c.collapse(!0),c.moveStart("character",a),c.moveEnd("character",a),c.select())};this.bind=function(){d.currencyElement.unbind();d.currencyElement.bind("keydown",function(a){d.isNavigationKey(a)||d.isControlKey(a)||d.isValidKey(a)||a.preventDefault()});d.currencyElement.bind("keyup",function(b){if(!d.isNavigationKey(b)){b=d.getCaret();var c=d.currencyElement.val().length;
d.format();var e=d.currencyElement.val().length;b.start===b.end&&d.setCaret(Math.min(b.start+(e-c),e));a.trigger("inlineFormatter:formattingCompleted",d)}})};this.unbind=function(){d.currencyElement.unbind("keydown keyup")};this.format=function(a){a=d.currencyElement.val();a=d.rewardsFormatter.getCurrencyAmount(a);isNaN(a)&&(a=0);a>d.maxAmount&&(a=d.maxAmount);a=d.rewardsFormatter.formatCurrency(a);d.currencyElement.val(a)}};a.on("inlineFormatter:formattingCompleted",function(a){var c=a.pointElement,
e=a.currencyElement.val(),e=a.rewardsFormatter.getPointsAmount(e);a=a.rewardsFormatter.formatPoints(Math.round(e));c.html(a)});return{getCurrencyFormatByCountryCode:function(a){(a=k[a])||(a=k["default"]);return a},getAmount:m,initializeInlineFormatting:function(g,l,e){var h=g.maxAmount;e=new c(e.groupingSeparator,e.decimalSeparator,e.decimalPlace,l.decimalPlace,l.ratio);g=new f(g.$element,l.$element,e,h);g.bind();g.format(0);a.trigger("inlineFormatter:formattingCompleted",g)}}});"use strict";r.when("A",
"pay-common-util","pay-validator","page-conductor","mobile-carrier-billing-util","weblab-helper").register("jppoints",function(a,m,k,c,f,g){function l(){!m.isMobileCX()&&q("#jppoints").length&&(A=m.getElements(L),p())}function e(){var a=A.paymentRows.find('input[type\x3d"radio"][name\x3d"paymentMethod"]');a.closest("div.payment-selected").removeClass("payment-selected");a.attr("checked",!1);m.isTouchCX()&&h(a,"radio")}function h(a,b){a.siblings("i").removeClass("a-icon-touch-"+b+"-active").addClass("a-icon-touch-"+
b+"-inactive")}function d(a,b){a.is(":disabled")||a.siblings("i").removeClass("a-icon-touch-"+b+"-inactive").addClass("a-icon-touch-"+b+"-active")}function b(){return q('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]').is(":checked")}function p(){if(A.jppoints&&A.jppoints.length){b()&&t();A.jppoints.show();var a=A.jppoints.find("#redeemPoints");m.isTouchCX()?a.parents("label").bind("click",w):a.bind("click",w);A.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("click",
function(){var a=A.jppoints.find("#jpPointsCustom");a.attr("checked",!0);var b=A.jppoints.find("#redeemPoints");b.attr("checked",!0);m.isTouchCX()&&(d(a,"radio"),h(A.jppoints.find("#jpPointsMax"),"radio"),d(b,"checkbox"))});A.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]').bind("click",z);A.jppoints.find("#jpPointsCustom").bind("click",function(){A.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').focus()});A.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').bind("keyup",
u)}}function t(){var a=A.jppoints.find("#redeemPoints"),b=A.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),d=A.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),e=A.jppoints.find("#redeemableAmount"),f=A.jppoints.find("#redeemableValue");a.attr("checked",!1);a.attr("disabled",!0);b.attr("checked",!1);b.attr("disabled",!0);A.jppoints.find("#jpPointsError").hide();d.val("");d.removeClass("a-form-error");d.attr("disabled",!0);f.text(A.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val());
e.text(A.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val());c.isSPP()&&(A.jppoints.find("label").addClass("disabled-color"),A.jppoints.removeClass("payment-selected"));m.isTouchCX()&&(h(a,"checkbox"),h(b,"radio"),a.siblings("i").addClass("a-button-disabled"),b.siblings("i").addClass("a-button-disabled"))}function z(b){var c=b.currentTarget,f=A.jppoints.find("#redeemPoints");f.attr("checked",!0);if(m.isTouchCX()){d(q("#"+c.id),"radio");var n;n="jpPointsMax"===c.id?A.jppoints.find("#jpPointsCustom"):
A.jppoints.find("#jpPointsMax");h(n,"radio");d(f,"checkbox")}"true"===c.value&&(A.jppoints.find("#jpPointsError").hide(),c=A.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),c.removeClass("a-form-error"),c.val(""),f=A.jppoints.find("#redeemableAmount"),n=parseInt(A.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10),c=parseInt(A.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),f=parseInt(f.text(),10)*n,q('input[name\x3d"useAvailableBalance"]').is(":checked")&&
(n=A.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),c-=parseInt(n.val(),10)),f>=c&&e());r.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",q(b.currentTarget))})}function y(a){var b=A.jppoints.find("#redeemableAmount"),c=A.jppoints.find("#redeemableValue"),d=parseInt(A.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),f;a.is(":checked")?(a=A.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]').val(),
f=A.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]').val(),d-=parseInt(A.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]').val(),10)):(a=A.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),f=A.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val());var n=parseInt(A.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),10)*a;b.text(a);c.text(f);0>=parseInt(a,10)?
(b=A.jppoints.find("#redeemPoints"),b.attr("checked",!1),c=A.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),c.attr("checked",!1),m.isTouchCX()&&(h(b,"checkbox"),h(c,"radio"))):A.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"][value\x3d"true"]').is(":checked")?n>=d&&e():u()}function w(){var e=A.jppoints.find("#redeemPoints");if(!e.is(":disabled")){e=e.is(":checked");if(m.isTouchCX())e?(h(A.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),
n()):(d(A.jppoints.find("#jpPointsMax"),"radio"),h(A.jppoints.find("#jpPointsCustom"),"radio"),v());else if(e)v(),c.isSPP()&&A.jppoints.addClass("payment-selected");else if(n(),c.isSPP()){A.jppoints.removeClass("payment-selected");if(b())return;m.selectDefaultPaymentMethodIfNotSelected()}r.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:toggleJPPointsInstallmentEligibility",A.jppoints)})}}function v(){var a=A.jppoints.find("#jpPointsMax");a.attr("checked",!0);
var b=parseInt(A.jppoints.find("#redeemableAmount").text(),10),f=A.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val(),n=parseInt(A.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10);m.isTouchCX()&&(h(A.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]'),"radio"),d(a,"radio"));A.jppoints.find("#jpPointsMax").is(":checked")&&(b>=n?e():c.isSPP()&&A.paymentRows.find("#gcPromo, input[name\x3d'useAvailableBalance']").is(":checked")&&(a=A.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]'),
n-=parseInt(a.val(),10),f>=n&&e()))}function n(){var a=A.jppoints.find('input[name\x3d"jpPointsUseMaxPoints"]');a.attr("checked",!1);var b=A.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]');b.val("");b.removeClass("a-form-error");A.jppoints.find("#jpPointsError").hide();m.isTouchCX()&&h(a,"radio")}function u(){var b=A.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),c=parseInt(b.val(),10);!c||0>c?(b.val(""),A.jppoints.find("#jpPointsError").hide(),A.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error")):
(b.val(c),parseInt(A.jppoints.find("#redeemableAmount").text(),10)<c?(A.jppoints.find("#jpPointsError").show(),A.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').addClass("a-form-error")):(A.jppoints.find("#jpPointsError").hide(),A.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]').removeClass("a-form-error"),b=parseInt(A.jppoints.find('input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]').val(),10),parseInt(A.jppoints.find('input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]').val(),
10),c>=b&&e(),r.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleJPPointsSection",c)})))}var q=a.$,A={},L={paymentRows:"#existing-payment-methods .payment-row",jppoints:"#jppoints",mcbPointsWarning:"#mcbPointsWarning"};a.on("checkout:reload:payselect",l);a.on("checkout:reload:spp-payment",l);return{handleJPPointsOnPaymentRows:function(a){a=q(a.currentTarget);if("jppoints"!==a.attr("id"))if("useAvailableBalance"===a.attr("name"))y(a);else{g.isMCBMultiTenderWeblabEnabled()||
f.hideMCBWarningMessageForPoints(A);var b=a.find('input[type\x3d"radio"][name\x3dpaymentMethod]');if(!g.isMCBMultiTenderWeblabEnabled()&&b.length&&0<b.filter("[value^\x3dMCB]").size())f.showMCBWarningMessageForPoints(A),t();else if("availablebalance"===a.attr("value")||a.find("#pm_300")&&"availablebalance"===a.find("#pm_300").attr("value"))t();else{a=A.jppoints.find("#redeemPoints");var b=A.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]'),d=A.jppoints.find('input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]'),
e=A.jppoints.find("#redeemableAmount"),n=A.jppoints.find("#redeemableValue");c.isSPP()&&A.jppoints.find("label").removeClass("disabled-color");a.attr("disabled",!1);b.attr("disabled",!1);d.attr("disabled",!1);q('#existing-balance input[type\x3d"radio"][value\x3d"availablebalance"]').length&&(e.text(A.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]').val()),n.text(A.jppoints.find('input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]').val()));m.isTouchCX()&&(a.siblings("i").removeClass("a-button-disabled"),
b.siblings("i").removeClass("a-button-disabled"))}}},handleJPPointsWithGC:y}});"use strict";r.when("A","ajax-utility","client-side-metrics","pay-common-util","pay-validator","page-transition-controller","page-conductor","a-popover-position","inline-points-register-controller","jppoints","pay-credit-card","checkout-general-utils","a-popover-base","a-dropdown","pay-rewards-currency","cache-page-data-controller","pay-credit-card-reregistration","mobile-carrier-billing-util","emi-helper","instant-bank-discount-helper",
"recommendation-helper","safe-apx-helper","apb-limit-messaging-helper").register("existing-payments",function(a,m,k,c,f,g,l,e,h,d,b,p,t,z,y,w,v,n,u,K,A,L,C){function H(){return B.paymentRows.filter(function(){return I(this).hasClass("payment-selected")||I(this).find("#redeemPoints").is(":checked")})}function N(a){g.show();a.$event.preventDefault();var b=H().find(".card-unreg-rewards").data();b.recommendedPaymentMethodId=b.paymentinstrumentid;c.makeAjaxCall(a.$target.attr("href"),b)}function P(b){b=
I(b.currentTarget);var d=b.data();if(!(0>=d.ratio)){var e=b.val()/d.ratio;if(!isNaN(e)){var f=b.val();f<d.min&&(e=0);b=c.getNumberWithSeparators(e,d.decimalplaces);H().find(".custom-reward-points").html(b);r.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:actionToggleRewardsSection",f)})}}}function G(a){1===a.data.refresh&&(g.show(),c.makeAjaxCall(a.data.url))}function D(a){Ea(a)?(a=B.continueBtns,a.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),
a.find(".a-button-disabled").removeClass("aok-hidden")):I("#payPageContinueBtnStateFixEnabled").length&&aa(a)}function Q(a){c.isTouchCX()&&(Ea()?a.$event.preventDefault():(B.continueErrPopover.hide().find(".error-message").hide(),g.show()))}function E(a){c.isTouchCX()&&(Ea()||B.continueErrPopover.hide().find(".error-message").hide())}function F(a){a=I(a.currentTarget);a.click();a=a.closest(".payment-container");a.find("#cc-errors").is(":visible")?a.find(".tv-update .a-button-primary").focus():a.click()}
function V(a){a.$event.preventDefault();var d=H();if(!b.runConfirmCardValidator(d,d.find("#cc-errors"))){g.show();var e=(d=c.getInputValues(d))||{},f=c.getInputValues(B.hiddenFormFields),n;for(n in f)f.hasOwnProperty(n)&&(e[n]=f[n]);b.confirmCreditCard(d,wa,a.data.url)}}function X(){B.continueErrPopover.filter(":visible").length&&B.continueErrPopover.hide()}function aa(){B.continueErrPopover.filter(":visible").length&&B.continueErrPopover.hide().find(".error-message").hide();var a=H();B.disableSubmitButtons.length?
a.find(".no-address").length||(a.find(".continue-center").removeClass("aok-hidden"),a.find(".a-button-disabled").addClass("aok-hidden")):(B.continueBtns.find(".a-button-primary:not(.a-button-disabled)").removeClass("aok-hidden"),B.continueBtns.find(".a-button-disabled").addClass("aok-hidden"));if(a){var b=a.find(".a-form-error");b&&b.length&&(b.removeClass("a-form-error"),(a=a.find(".pincode-err-block").filter(":visible"))&&a.length&&(B.continueErrPopover.hide().find(".error-message").hide(),B.continueBtns.find(".a-button-primary").removeClass("aok-hidden"),
B.continueBtns.find(".a-button-disabled").addClass("aok-hidden"),a.hide()))}}function Z(){B.continueErrPopover.filter(":visible").length||B.continueBtnTop.trigger("click")}function fa(a){if(13===a.which){var b=I(document.activeElement),d=b.closest("div.payment-row"),e=b.closest(".a-button"),b=b.get(0).tagName;if(d.length&&!e.length&&"A"!==b&&"a"!==b)return d=d.find('input[type\x3d"submit"]'),d.length?d.trigger("click"):(B.continueErrPopover.filter(":visible").length&&B.continueErrPopover.hide(),Ea(a)?
(c.isTouchCX()||(B.continueBtns.find(".a-button-primary").addClass("aok-hidden"),B.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")),a.preventDefault()):B.continueBtnTop.trigger("click")),!1}}function Y(a){g.show();var b=H(),d=b.find("input[type\x3dradio][name\x3dpaymentMethod]").val(),e=b.find(".card-unreg-rewards").data(),b=c.isTouchCX()?b.find(".flag-register-rewards"):B.rewardsRegister,b=c.getInputValues(b);b.programid=e.programid;b.paymentinstrumentid=e.paymentinstrumentid;b.CARD_EXPIRATION_DATE=
e.expiredate;b.CARD_HOLDER_NAME=e.holdername;b.returnRefreshedPage=a.data.returnRefreshedPage;b.rewardsdateofbirthmonth&&b.rewardsdateofbirthday&&(b.DATE_OF_BIRTH=b.rewardsdateofbirthmonth+b.rewardsdateofbirthday);-1===a.data.url.toLowerCase().indexOf("cachebuster")&&(a.data.url=p.addQueryStringParameter(a.data.url,"cacheBuster",(new Date).getTime()));c.makeAjaxCall(a.data.url,b,{successHandler:function(a,b,e){g.hide();if(a){a=m.jsonify(a);B.rewardsRegister.find(".register-content").hide();var f=
c.isTouchCX()?H().find(".register-error"):B.rewardsRegister.find(".register-error");f.hide();a.error?f.show().find(".error-message").hide().filter("#"+a.error).show():(l.ajaxUpdatePage(a.refreshedPage,b,e),b=B.paymentRows.find('input[type\x3dradio][name\x3dpaymentMethod][value\x3d"'+d+'"]').closest(".payment-row"),b.trigger("click"),c.scrollTopTo(b))}}})}function R(a){a=I(a.currentTarget).parents("div.currency-list");var b=a.find("label.a-touch-radio");b.length?b.trigger("click"):a.find("input[type\x3dradio][value\x3dOther]").trigger("click")}
function ba(a){a=a.$target.closest("div.payment-row");var b=a.find(".currency-list");if(l.isSPP()){var d=z.getSelect(b.find("select"));null!==d&&d.setValue("")}a.find(".change-currency").hide();b.show();c.isTouchCX()&&(a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"),a.find(".bottom-cell").show());ka();Ba()}function ga(a){a=a.$target.closest("div.payment-row");a.find(".expire-info, .expire-date").hide();a.find(".enter-date, .expire-date-fields").show();ka();J()}function x(a){var b=
a.$target.closest("div.payment-row"),d="true"===c.getAttributeData(b,"isaddresschallenge")?1:0;b.find(".expire-date-fields").length?(ga(a),b.find("#newExpDate").focus()):d&&b.find("#addCreditCardNumber").focus()}function ha(a){setTimeout(function(a){var b=I(a.target);a=document.createEvent("UIEvents");a.initUIEvent("DOMActivate",!0,!0,q,1);b.get(0).dispatchEvent(a)},0,a)}function da(a){var b=I(a.target).closest("div.payment-row");""!==I(a.target).val()&&("true"===c.getAttributeData(b,"isaddresschallenge")?
b.find("#addCreditCardNumber").focus():Z())}function ma(){var a=H();a.find("div.flag-register-rewards").is(":visible")?(a.find(".bottom-cell").hide(),a.find(".top-cell").removeClass("bottom-line"),a.find(".card-unreg-rewards").show()):(a.find(".card-unreg-rewards").hide(),a.find(".bottom-cell").show(),a.find(".top-cell").removeClass("bottom-line").addClass("bottom-line"))}function O(){ma()}function sa(a){a.$event.preventDefault();if("1"===H().find("div.flag-register-rewards").attr("cached"))ma();
else{var b=a.$target.attr("href");-1===b.toLowerCase().indexOf("cachebuster")&&(b=p.addQueryStringParameter(b,"cacheBuster",(new Date).getTime()));g.show();c.makeAjaxCall(b,a.data,{successHandler:function(a){g.hide();var b=m.jsonify(a);a=c.decodeJSONResponse(b.widgetHTML);var d=H();d.find("div.flag-register-rewards").html(a);d.find("div.flag-register-rewards").attr("cached",1);d.find("div.flag-register-rewards .error-message").each(function(){var a=I(this),c=a.data("errorid");a.html(b.displaydata[c])});
ma()}})}}function ta(b){var e=I(b.target);if(!e.is(":visible"))return b.preventDefault(),b.stopPropagation(),!1;l.isSPP()&&(l.isPrefetchFromAddressEnabled()?l.disablePageNoUpdateTransition():I("#payment").find(".panel-cancel-row").hide(),w.clearCache());var f=I(b.currentTarget);B.jppoints.length&&d.handleJPPointsOnPaymentRows(b);var h=f.find("[name\x3duseAvailableBalance]");if("useAvailableBalance"!==b.target.name&&!h.length)if(Ca(f),n.toggleGCForMCB(f,B),W(f),f.hasClass("payment-selected")||f.hasClass("payment-label"))B.disableSubmitButtons.length&&
(oa(f,f,!1),!e.hasClass("continue-center")&&f.find(".continue-center").length||Z());else if(b=f.find('input[type\x3d"radio"][name\x3d"paymentMethod"]'),b.length&&"disabled"!==b.attr("disabled")){bb();b=H();l.isSPP()?b.filter(function(){var a=I(this).attr("id");return"gcPromo"===a?(a=I(this).find('input[type\x3d"radio"][name\x3d"paymentMethod"][value\x3d"availablebalance"]'))&&a.length:"jppoints"!==a}).removeClass("payment-selected"):b.removeClass("payment-selected");b.find("[name\x3dpaymentMethod]").attr("checked",
!1);b.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");b.find(".top-cell").removeClass("bottom-line");za(b);c.isTouchCX()&&(b.find(".bottom-cell").hide(),b.find(".card-unreg-rewards").show());f.addClass("payment-selected");f.find("[name\x3dpaymentMethod]").attr("checked",!0);f.find("i[data-a-input-name\x3dpaymentMethod]").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active");var e="true"===c.getAttributeData(f,
"isaddresschallenge")?1:0,h=f.find('.rewards-list input[type\x3d"radio"]').length,g="1"===c.getAttributeData(f,"hasDerivedCurrency")?1:0,p=f.find(".vcc-form-fields").length,k=f.find(".card-ref-num").length;c.isTouchCX()&&(e||h||p||k||g)&&(f.find(".top-cell").removeClass("align-top bottom-line").addClass("bottom-line"),f.find(".bottom-cell").show());r.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:select-payment-row",f,Ba)});Oa(f);Pa(f);Qa(f);Ra(f);cb(f);"1"===
I("#suppressionMessageFixEnabledStatus").val()&&db(f);eb(f);Sa(f);Ta(f);Ua(f);fb(f);gb(f);Va(f);Ha(u,u.toggleEMIMenu,f);Wa(f);hb();ra(f);pa();ka();J();E();qa();ca(f,b);Xa();I.isEmptyObject(A)||A.toggleCustomerNudgingMessage(f);B.hideInputBoxes.length&&(Ya(f,b),Na(f));B.disableSubmitButtons.length&&oa(f,b,!0);Ka();Ba();B.disableSubmitButtons.length&&!f.find(".continue-center").length&&Z()}}function W(a){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=I("input[type\x3d'hidden'][name\x3d'paySelectLocale']");
b.length&&"IN"===b.val()&&a.length&&r.when("client-side-metrics").execute(function(a){a.increaseCount("PayPage-COD-NonMobile",1)})}function Ca(a){var b=I("#isGlobalCODEligible").val();if(b&&"0"!==b){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=I("#button-add-gcpromo"),c=I("#button-add-gcpromo").parent().parent();a.length?(c.addClass("a-button-disabled"),b.attr("disabled","disabled")):(c.removeClass("a-button-disabled"),b.removeAttr("disabled"))}}function S(a){r.when("A",
"a-tv").execute(function(b,c){b=b.$;var d=b(a);d.length&&(b(".tv-lastSelected").removeClass("tv-lastSelected"),d.addClass("tv-lastSelected"),c.select(d))})}function oa(a,b,c){c&&b.find(".billing-address, .cc-continue-button").hide();if(a.find(".tv-update").length)Ya(a,b),Na(a);else{var d=a.find(".billing-address, .cc-continue-button");if(d.length&&!d.is(":visible")){var e=!1;a.find(".no-address").length&&(e=!0,a.find(".a-button-primary").addClass("aok-hidden"),a.find(".a-button-disabled").removeClass("aok-hidden"));
r.when("a-tv").execute(function(f){c&&(b.find(".payment-container").hasClass(".a-tv-navigate")||f.add(b.find(".payment-container")));f.remove(a.find(".payment-container"));f=e?a.find(".billing-address-link"):d.find(".continue-center");S(f)});d.show()}}}function ra(a){var b=I("#one-click-final-review-message");b.length&&(a.find("#canTryTFX").length?b.removeClass("aok-hidden"):b.addClass("aok-hidden"))}function ca(a,b){if(c.isTouchCX()&&(b&&b.find(".top-cell .data-row").children(".a-column").height("auto"),
a)){a=a.find(".top-cell .data-row");var d=a.find(".addr-challenge-card-scan .a-box");if(d.length){b=a.height();var d=d.height(),e=a.children(".a-column:first");a.children(".a-column").height(d);e.height(b);e.children(".vertical-center-grid:first").height(d)}else a.children(".a-column").height(a.height())}}function wa(d){g.hide();var e=m.jsonify(d);e.imbWidgetHTML&&I("#imb-wrapper").html(c.decodeJSONResponse(e.imbWidgetHTML));if(e.cardWidgetHTML&&(d=H(),d.replaceWith(c.decodeJSONResponse(e.cardWidgetHTML)),
null!=e.rewardsAccountsWidgetHTML&&r.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:refresh-rewards-section",c.decodeJSONResponse(e.rewardsAccountsWidgetHTML))}),a.trigger("checkout:reload"),a.trigger("checkout:reload:payselect"),d=H(),"true"!==c.getAttributeData(d,"isaddresschallenge"))){b.setCardPasswordInputStatus(d,e.newpaymentmethodid,"cvv","#existingCvvNum");b.setCardPasswordInputStatus(d,e.newpaymentmethodid,"pincode","#existingPincodeNum");if(B.cvvColumnLabel.length){var f=
!1;B.paymentRows.each(function(){if("true"===c.getAttributeData(I(this),"isaddresschallenge"))return f=!0,!1});f||B.cvvColumnLabel.hide()}B.disableSubmitButtons.length&&Z()}}function ka(){B.paymentRows.each(function(){var a=I(this),b=a.find('.currency-list input[type\x3d"radio"]').length,d=a.find('.rewards-list input[type\x3d"radio"]').length,e=a.find(".card-reg-info").is(":visible"),f=a.find(".expire-date-fields").is(":visible"),n=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),
h=a.find(".bottom-cell .inner-grid-left"),g=a.find(".bottom-cell .inner-grid-right");f?b||d||e?(h.removeClass("hidden a-span10 a-span12").addClass("a-span8"),g.removeClass("a-span12 a-span2 hidden").addClass("a-span4")):(h.removeClass("a-span8 a-span10 a-span12").addClass("hidden"),g.removeClass("a-span4 a-span2 hidden").addClass("a-span12")):n?(h.removeClass("a-span12 a-span8 hidden").addClass("a-span10"),g.removeClass("hidden a-span4 a-span12").addClass("a-span2")):(h.removeClass("a-span10 a-span8 hidden").addClass("a-span12"),
g.removeClass("a-span2 a-span4 a-span12").addClass("hidden"));!c.isTouchCX()&&n&&(b||d||e)&&a.find(".bottom-cell").removeClass("align-top").addClass("align-top")});var a=H(),b=a.find("a[data-action\x3dshow-expire-date-fields]").filter(":visible").length,d=a.find(".top-cell.bottom-line").length;b&&!d||a.find(".bottom-cell").removeClass("align-top")}function J(){c.isTouchCX()&&B.paymentRows.each(function(){var a=I(this),b="true"===c.getAttributeData(a,"isaddresschallenge")?1:0,d=a.find("a[data-action\x3dshow-expire-date-fields]").is(":visible"),
e=a.find(".expire-date-fields").is(":visible"),f=a.find(".card-reg-info").is(":visible"),n=a.find(".rewards-info").is(":visible"),h=a.find(".change-currency").is(":visible");d?a.find(".top-cell .second-row").addClass("align-top"):a.find(".top-cell .second-row").removeClass("align-top");b=b||h||f||n;f=e||d;n=a.find(".top-cell .inner-grid-left");a=a.find(".top-cell .inner-grid-right");b||(n.removeClass("a-span6 a-span8 a-span12").addClass("hidden"),a.removeClass("a-span4 a-span6 hidden").addClass("a-span12"));
f||(n.removeClass("a-span6 a-span8 hidden").addClass("a-span12"),a.removeClass("a-span4 a-span6 a-span12").addClass("hidden"));b&&d&&(n.removeClass("a-span6 a-span12 hidden").addClass("a-span8"),a.removeClass("a-span6 a-span12 hidden").addClass("a-span4"));b&&e&&(n.removeClass("a-span6 a-span8 hidden").addClass("a-span6"),a.removeClass("a-span4 a-span12 hidden").addClass("a-span6"))})}function za(a){var b=a.find(".currency-list");if(b.length){var c=b.find("[type\x3dradio]:checked").val(),b=b.find("#cardCurrencyDropDown option:selected").val();
"Other"!==c||"-1"!==b&&"-2"!==b||a.find(".currency-list input[type\x3dradio][value!\x3dOther]").attr("checked",!0)}}function Fa(a){var b=I(a.currentTarget);a=b.find("option:selected");if(""===a.val())b.parents("div.selected-section").find(".selected-note-content").hide();else{var c=a.prop("disabled"),b=b.parents("div.selected-section"),d=b.find("#active-bank-content"),e=b.find("#disable-bank-content");c?(e.show(),d.hide()):(d.show(),e.hide());b.find("span.selected-note-bank").text(a.text()).show()}}
function U(a){var b=I(a.currentTarget);a=b.find("option:selected");""===a.val()?b.parents("div.selected-section-more-payment-method").find(".selected-more-payment-content").hide():(b=b.parents("div.selected-section-more-payment-method"),b.find("span.selected-payment-option").text(a.text()).show(),b.find("span.selected-more-payment-content").show())}function ya(a){(B.continueErrPopover.filter(":visible").length||Ea())&&a.$event.preventDefault()}function Aa(b){b=I(b.currentTarget);var c=b.find("input[type\x3dcheckbox]");
c.attr("checked")?(c.attr("checked",!1),b.find(".checked-checkbox").addClass("aok-hidden"),b.find(".empty-checkbox").removeClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").addClass("aok-hidden")):(c.attr("checked",!0),b.find(".checked-checkbox").removeClass("aok-hidden"),b.find(".empty-checkbox").addClass("aok-hidden"),b.find(".gc-balance-insufficient-msg").removeClass("aok-hidden"));r.when("a-tv").execute(function(b){setTimeout(function(){b.select(".tv-lastSelected")},500);a.trigger("a:tv:resize")})}
function ea(a){a=I(a.currentTarget);"1"===a.attr("isclicked")?a.attr("isclicked",0):a.attr("isclicked",1);qa()}function qa(a){var b=I("#pm_promo");a=I("#pm_gc_radio");var d=I("#pm_gc_checkbox"),e;I("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").length&&(e=I("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").val());if(a&&a.length||d&&d.length){var f=I("input[name\x3dgcBalanceRaw]").val();I("input[name\x3damBalanceRaw]").length&&(f=I("input[name\x3damBalanceRaw]").val());
var n=I("input[name\x3disAPBLimitMessagingLaunchWeblabEnabled]").val(),h=I("input[name\x3dhasAPBRedeemableLimitExhausted]").val(),g=I("input[name\x3damAvailableBalanceRaw]").val(),l=I("input[name\x3dremainingBalanceRaw]").val(),p=I("input[name\x3dpurchaseTotalRaw]").val(),k,m,la=I(".purchase-total").length;la?(m=I(".purchase-total").html(),k=I(".remaining-balance").html()):(m=I("input[name\x3dpurchaseTotal]").val(),k=I("input[name\x3dremainingBalance]").val());var pa=I(".balance-applied");la?pa.html(m):
pa.text(m);(c.isTouchCX()&&"checkbox"===b.attr("type")?"1"===b.closest(".a-control-row").attr("isclicked"):b.is(":checked"))?(b=l,0<b&&(la?pa.html(k):pa.text(k))):b=p;n&&C.renderAPBMessagingRemainingBalance({purchaseTotal:m,remainingBalance:k,balanceApplied:pa,isPurchaseTotalInSpan:la},f,p,g);k=a.closest(".radio-col");m=d.closest(".radio-col");l=I(".amazon-money-limit-breached");la=I(".long");pa=I(".short");"1"===n&&"1"===h?C.displayAPBRedeemableLimitExhaustedMessaging({gcRadioContainer:k,gcCheckboxContainer:m,
gcCheckbox:d,gcRadio:a,shortMsg:pa,longMsg:la,amazonMoneyLimitBreachedMsg:l}):0<=f-p?("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),k.removeClass("hidden"),a.is(":checked")&&k.trigger("click"),m.addClass("hidden"),d.attr("disabled","disabled"),0==f-p?(la.hide(),pa.show()):(la.show(),pa.hide())):0<f-b?0>=b?(m.removeClass("hidden"),d.attr("disabled","disabled"),c.isTouchCX()&&m.find("i").addClass("a-button-disabled checkbox-disabled"),k.addClass("hidden"),a.attr("disabled","disabled"),pa.show(),
la.hide()):("disabled"===a.attr("disabled")&&a.removeAttr("disabled"),k.removeClass("hidden"),a.is(":checked")?k.trigger("click"):c.isTouchCX()&&k.find("i").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"),m.addClass("hidden"),d.attr("disabled","disabled"),la.show(),pa.hide()):("disabled"===d.attr("disabled")&&(d.removeAttr("disabled"),c.isTouchCX()&&m.find("i").removeClass("a-button-disabled checkbox-disabled")),m.removeClass("hidden"),(h=m.closest(".payment-row"))&&
h.hasClass("payment-selected")&&h.removeClass("payment-selected"),k.addClass("hidden"),a.attr("disabled","disabled"),"1"===n?C.renderAPBInsufficientMessaging({shortMsg:pa,longMsg:la},f,g):(pa.show(),la.hide()));"1"===e&&(a.attr("disabled","disabled"),d.attr("disabled","disabled"),(h=m.closest(".payment-row"))&&h.hasClass("payment-selected")&&h.removeClass("payment-selected"))}}function ia(b){var c=H().find(".enter-custom-rewards");if("rewardscustom"===I(b.currentTarget).children('input[type\x3d"radio"]').val()){c.show();
var d=c.find("input.custom-rewards-input");d.focus();B.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")&&(c=d.val().length,d=d.get(0),d.setSelectionRange?d.setSelectionRange(c,c):d.createTextRange&&(d=d.createTextRange(),d.collapse(!0),d.moveStart("character",c),d.moveEnd("character",c),d.select()))}else c.hide();r.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",I(b.currentTarget))});Ba()}function ja(a){a=
a.$target||I(a.currentTarget);ua(a)}function ua(b){if(b.length){var c=B.paymentRows.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]'),d=B.paymentRows.find(".installments-select.a-row"),e=d.siblings(".installments-message"),f=d.siblings(".card-offers"),n=B.paymentRows.find('input[type\x3d"radio"][value\x3d"morePaymentMethod"]'),h=B.installmentsOnlyCards,g=B.paymentRows.find('input[type\x3d"radio"][id\x3d"pmEmiPaymentOptions"]'),l=B.paymentRows.find('input[type\x3d"radio"][value\x3d"amazonBusinessCredit"]');
if(c.length){var k=c.closest(".payment-row"),p=n.closest(".payment-row"),m=g.closest(".payment-row"),la=l.closest(".payment-row");b.is(":checked")?(c.prop("disabled",!0),c.is(":checked")&&(c.prop("checked",!1),k.removeClass("payment-selected")),c.parent().siblings().addClass("a-color-secondary"),Ha(u,u.disableEMIPaymentMethods,g),r.when("abc-helper").execute(function(b){a.trigger("abc-helper:disable-payment",l)}),K.showInstantBankDiscountAmazonPaySelected(),va(n,p),(b=d.find("select"))&&b.each(function(){var a=
this.id.replace(/\./g,"\\.");z.setValue(a,"")}),d.find(".installments-enabled-text").hide(),e.find(".installments-enabled-text").hide(),f.find(".installments-enabled-text").hide(),d.find(".installments-disabled-text").show(),e.find(".installments-disabled-text").show(),f.find(".installments-disabled-text").show(),h.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").removeAttr("checked"),h.removeClass("payment-selected")):(k.find(".payment-invalid").length||(c.prop("disabled",!1),c.parent().siblings().removeClass("a-color-secondary")),
p.find(".payment-invalid").length||xa(n,p),m.find(".payment-invalid").length||Ha(u,u.enableEMIPaymentMethods,g),la.find(".payment-invalid").length||r.when("abc-helper").execute(function(b){a.trigger("abc-helper:enable-payment",l)}),K.showInstantBankDiscountAmazonPayDeselected(),d.find(".installments-disabled-text").hide(),e.find(".installments-disabled-text").hide(),f.find(".installments-disabled-text").hide(),d.find(".installments-enabled-text").show(),e.find(".installments-enabled-text").show(),
f.find(".installments-enabled-text").show(),h.find("input[name\x3dpaymentMethod]").removeAttr("disabled"))}}}function xa(a,b){a.prop("disabled",!1);a.parent().siblings().removeClass("a-color-secondary");b.find(".selected-section-more-payment-method").show();b.find(".more-payment-gc-disabled-text").hide()}function va(a,b){a.prop("disabled",!0);a.is(":checked")&&(a.prop("checked",!1),b.removeClass("payment-selected"));a.parent().siblings().addClass("a-color-secondary");b.find(".selected-section-more-payment-method").hide();
b.find(".more-payment-gc-disabled-text").show()}function na(a){var b=a.$target||I(a.currentTarget);a=b.closest(".currency-list");b=b.val();!0===(c.isTouchCX()?"Other"===b:"Other"!==b)?(a.find("select").attr("disabled",!0),a.find(".a-button.a-button-dropdown").addClass("a-button-disabled"),a.find(".a-button.a-touch-select").addClass("a-button-disabled")):(a.find("select").attr("disabled",!1),a.find(".a-button.a-button-dropdown").removeClass("a-button-disabled"),a.find(".a-button.a-touch-select").removeClass("a-button-disabled"));
Ba()}function Da(a){v.actionReregisterCardInBox(a);c.scrollTopTo(H())}function T(a){Ba()}function la(){B.paymentRows.each(function(){var a=I(this),b=".card-ref-num, .addr-challenge, .addr-challenge-msg, .cup-expired-msg, .enter-date, .expire-date-fields, .rewards-static-help-link, .verified-fail-msg, .tv-update, .billing-address, .cc-continue-button",d=".card-info, .card-name, .card-reg-info, .expire-info, .rewards-err-msg, .rewards-list label, .rewards-list div.a-radio, .rewards-dynamic-help-link, .financial-offer-err-detail";
a.hasClass("payment-selected")&&("1"===c.getAttributeData(a,"hasDerivedCurrency")||"1"===c.getAttributeData(a,"hasPreferredCurrency")&&"1"===c.getAttributeData(a,"isNewCard"))||(b+=", .currency-list");"1"===c.getAttributeData(a,"hasPreferredCurrency")&&"1"!==c.getAttributeData(a,"isNewCard")&&(d+=", .change-currency");a.find(b).hide();a.find(d).show()})}function pa(){B.paymentRows.each(function(){var a=I(this),b="#cc-errors, .enter-date, .expire-date-fields",d=".expire-info";if(a.hasClass("payment-selected")&&
"1"===c.getAttributeData(a,"hasDerivedCurrency"))b+=", .change-currency",d+=", .currency-list";else{var e=a.find(".currency-list"),f=e.find("[type\x3dradio]:checked").val();if(f){var n;if("Other"!==f)n=e.find(".currencyNameLabel").html();else{var f=e.find("#cardCurrencyDropDown option:selected"),h=f.val();"-1"!==h&&"-2"!==h&&(n=f.text())}n&&(d+=", .change-currency",e.closest("div.payment-row").find(".change-currency .currencyNameLabel").html(n))}b+=", .currency-list"}a.find(b).hide();a.find(d).show()})}
function $a(){var a=I("#aan-ads-box");if(a.length){var b=a.data("adsendpoint"),c=a.data("adsclient"),d="https://"+b+"/2009-09-09/ad/",b="/jsc?pt\x3dstatic\x26slot\x3dlib\x26pt2\x3daanjs";a.data("useaannojq")&&(b+="-nojq");I.getScript(d+c+b,function(){q.d16g&&q.d16g.requestAanAd({elemId:"aan-ads-box",baseUrl:d,afterOnload:!0,client:c,pt:"checkout",slot:"display-ad-right",pt2:"payselect"})})}}function ab(){Za&&(a.declarative("auto-rewards-reg",["click"],N),a.declarative("complete-rewards-register",
["click"],G),a.declarative("confirm-card",["click"],V),a.declarative("register-card-rewards",["click"],Y),a.declarative("cancel-register-card-rewards",["click"],O),a.declarative("show-currencies",["click"],ba),a.declarative("show-expire-date-fields",["click"],ga),a.declarative("focus-cc-update-fields",["click"],x),a.declarative("show-rewards-reg",["click"],sa),a.declarative("submit-payment-form",["submit"],ya),a.declarative("toggle-tfx-option",["click"],na),a.declarative("reregister-cc-in-dashboard",
["click"],Da),a.declarative("modify-expire-date-fields",["change"],T),c.isTouchCX()&&a.declarative("continue-button",["click"],Q),Za=!1);B.paymentRows.unbind("click").has("input[name\x3dpaymentMethod]:enabled").bind("click",ta);r.when("apx-payselect-helper").execute(function(){var a=L.get("payselect");a&&a.initEvents(B.paymentRows,Ba)});B.paymentRows.find("input[name\x3dusePromoBalance]").unbind("change",qa).bind("change",qa);B.disableSubmitButtons.length&&B.paymentRows.has("input[type\x3dcheckbox]:enabled").unbind("click",
Aa).bind("click",Aa);B.existingPincodeNum.unbind("click",Ja).bind("click",Ja);B.paymentRows.find("select#cardCurrencyDropDown").unbind("change",R).bind("change",R);B.paymentRows.find(".rewards-list").hasClass("show-currency-input-widget-new")?B.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ia).each(function(b,c){c=a.$(c);b=c.find("input.custom-rewards-input");c=c.find(".custom-reward-points");var d=a.$(b);b={$element:d,maxAmount:d.data("max")};c={$element:a.$(c),
decimalPlaces:d.data("decimalplaces"),ratio:d.data("ratio")};d=d.data("country-code");d=y.getCurrencyFormatByCountryCode(d);y.initializeInlineFormatting(b,c,d)}):B.paymentRows.find(".rewards-list").undelegate("label","click").delegate("label","click",ia).undelegate("input.custom-rewards-input","keyup").delegate("input.custom-rewards-input","keyup",P);if(c.isTouchCX())B.pageContainer.find("#existing-payment-methods").find("select, input[type\x3dtext], input[type\x3dpassword]").unbind("change",E).bind("change",
E),B.pageContainer.find("#existing-payment-methods").find("div.currency-list label.a-touch-radio").unbind("click").bind("click",na),B.pageContainer.find("#existing-payment-methods").find("label.promoLabel").unbind("click").bind("click",ea);else if(!l.isSPP()){var b=B.continueBtns.find(".a-button-text");I("#payPageContinueBtnStateFixEnabled").length?b.filter('input[type\x3d"button"]').unbind("mouseenter",Ia).bind("mouseenter",Ia).unbind("focus",Ia).bind("focus",Ia).unbind("mouseleave",X).bind("mouseleave",
X).unbind("blur",X).bind("blur",X):(b.filter('input[type\x3d"submit"]').unbind("mouseenter").bind("mouseenter",D).unbind("focus").bind("focus",D),b.filter('input[type\x3d"button"]').unbind("mouseleave").bind("mouseleave",aa).unbind("blur").bind("blur",aa))}B.netBankingSelect.unbind("change",Fa).bind("change",Fa);B.morePaymentMethodsSelect.unbind("change",U).bind("change",U);B.continueBtnBottom.unbind("click").bind("click",Z);0<I("input[name\x3d'needDisableCODandEMIforGC']").length&&(b=I("input#pm_300[type\x3d'checkbox'], #pm_gc_checkbox"),
b.length&&(b.bind("change",ja),b.is(":checked")&&ua(b)));B.jppoints.length&&B.paymentRows.find('input[name\x3d"useAvailableBalance"]').bind("click",d.handleJPPointsOnPaymentRows);r.when("installments-payselect").execute(function(){a.trigger("installments-payselect:initEvents")});B.hideInputBoxes.length&&(B.paymentRows.find("#confirm-card").unbind("focus").bind("focus",F),B.paymentRows.find("#newExpDate").unbind("focus").bind("focus",ha),B.paymentRows.find("#newExpDate").unbind("change").bind("change",
da))}function Ka(){var a=f.create();a.validatePayment(H());a.hasErrors()||l.makePrefetch(B.existingPaymentForm)}function Ja(a){a=B.showAmexWarning;null!==a&&(a.removeClass("hidden"),a.removeClass("amex_display"))}function La(){if(!c.isMobileCX()){B=c.getElements(ib);B.paymentRows.filter(".payment-selected-marker").removeClass("payment-selected-marker").addClass("payment-selected");var b=H();r.when("rewards-section-desktop").execute(function(b){a.trigger("rewards-section-desktop:page-load",Ba)});r.when("installments-payselect").execute(function(b){a.trigger("installments-payselect:page-load")});
Ra(b);Ta(b);ra(b);la();Oa(b);Pa(b);Qa(b);Ua(b);Va(b);Wa(b);Sa(b);qa();Xa();I.isEmptyObject(A)||A.toggleCustomerNudgingMessage(b);I(document).undelegate("div.pay-desktop .checkout-page-form","keypress").delegate("div.pay-desktop .checkout-page-form","keypress",fa);I(document).undelegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup").delegate("div.pay-desktop .checkout-page-form .enter-custom-rewards","keyup",Ba);B.addressChallengeCardList.length&&B.addressChallengeCardList.show();
B.paymentRows.find('input[type\x3d"radio"][value\x3d"rewardsmax"]').each(function(){I(this).siblings('[type\x3d"checkbox"]').remove()}).removeClass("hidden");J();ka();ab();B.existingPaymentForm.data("checkoutFormReady",!0);Ka();$a();B.orderSummaryBottom.show();ca(b);E();Ba();Ca(b);n.determineIsMCBEnabled(B);n.toggleGCForMCB(b,B);I(".a-popover-preload").each(function(){var b=I(this).find(".rewards-registration").data("parentPaymentMethodId");b&&(a.off("a:popover:show:rewards-registration-"+b,h.displayRewardsRegister),
a.off("a:popover:hide:rewards-registration-"+b,h.hideRewardsRegister),a.on("a:popover:show:rewards-registration-"+b,h.displayRewardsRegister),a.on("a:popover:hide:rewards-registration-"+b,h.hideRewardsRegister))});r.when("a-tv").execute(function(c){a.trigger("a:tv:resize");b.find(".a-tv-navigate").length&&oa(b,b,!1)})}}function Ba(b){l.isSPP()?(Ea()?B.disableSubmitButtons.length?(b=H(),b.find(".continue-center").addClass("aok-hidden"),b.find(".a-button-disabled").removeClass("aok-hidden")):(B.continueBtns.find(".a-button-primary:not(.a-button-disabled)").addClass("aok-hidden"),
B.continueBtns.find(".a-button-disabled").removeClass("aok-hidden")):aa(),a.trigger("orderSummary:primaryActionButton:mirrorPanelBtnState")):I("#payPageContinueBtnStateFixEnabled").length&&D(b)}function Ma(a,b){a=I(a.target).closest(".order-summary-box").find(".continue-button-errors");a.length&&b.length&&(b=e.triggerLeft(a,b),a.show(),a.offset(b))}function Ia(a){if((!B.continueErrPopover.filter(":visible").length||c.isTouchCX())&&B.continueErrPopover.find(".error-message:not(.hidden)").length&&a&&
("mouseenter"===a.type||"focus"===a.type)){var b=I(a.target).closest(".continue-buttons").find(".a-button-disabled");Ma(a,b)}}function Ea(a){if(B.continueErrPopover.filter(":visible").length&&!c.isTouchCX())return!0;var b=H(),d=f.create();Ha(u,u.isEMIPaymentInstrument,b)&&(d.validateEMIMenuForContinueButton(b),b=Ha(u,u.getEMIMenuSelectedCardSection));d.validatePayment(b);d.apxValidatePayment(b,B.paymentRows);d=d.getHighestErrorId();if(!d||!d.identifier)return!1;B.continueErrPopover.find(".error-message").hide();
b=b.find(".pincode-err-block");b.hide();b&&b.length&&d.target&&d.target.length&&d.target.addClass("a-form-error");d.isPincodeError?(b.show(),b.addClass("a-form-error")):(B.continueErrPopover.find("#"+d.identifier).show(),B.continueErrPopover.find("#"+d.identifier).removeClass("hidden"),!a||"mouseenter"!==a.type&&"focus"!==a.type?l.isSPP||B.continueBtns.find(".a-button input").filter(":visible").each(function(){var a=I(this).closest(".order-summary-box").find(".continue-button-errors"),b=e.triggerLeft(a,
I(this));a.show();a.offset(b)}):(b=I(a.target).closest(".continue-buttons").find(".a-button-primary"),Ma(a,b)));return!0}function Oa(b){B.paymentRows.find(".addr-challenge, .addr-challenge-msg").hide();B.hideInputBoxes.length?B.paymentRows.find(".card-name").show():B.paymentRows.find(".card-info").show();if("true"===c.getAttributeData(b,"isaddresschallenge")){var d=b.find(".addr-challenge, .addr-challenge-msg");0===d.length&&k.increaseCount("Checkout:Payment:AddressChallengeMissingInputAndMsg");d.show();
B.hideInputBoxes.length?b.find(".card-name").hide():b.find(".card-info").hide();b=b.attr("paymentmethodid")?b.attr("paymentmethodid"):b.attr("data-paymentmethodid");a.trigger("checkout:payment:challenge:log",b)}}function Na(a){B.paymentRows.find(".expire-date-fields").hide();a=a.find(".expire-date-fields");a.length&&a.show()}function Xa(){B.paymentRows.find(".pci-blocking-cvv").length&&B.paymentRows.each(function(){var a=I(this),b=a.find(".pci-blocking-cvv");a.find("[type\x3dradio]:checked").val()&&
b.length?b.show():b.length&&b.hide()})}function Ya(a,b){r.when("a-tv").execute(function(c){c.add(b.find(".payment-container"));b.find(".tv-update").hide();var d=a.find(".tv-update");d.length&&(c.remove(a.find(".payment-container")),d.show(),S(d.find(".a-button-primary")))})}function Pa(a){B.paymentRows.find(".verified-fail-msg").hide();"true"===c.getAttributeData(a,"isverifiedfail")&&a.find(".verified-fail-msg").show()}function Qa(a){B.paymentRows.find(".cup-expired-msg").hide();"true"!==c.getAttributeData(a,
"iscupcardexpired")&&"true"!==c.getAttributeData(a,"iscupcardexpiringsoon")||a.find(".cup-expired-msg").show()}function Ra(b){B.paymentRows.find(".rewards-list").hide();B.paymentRows.find(".top-cell .inner-grid-left").show().find(".rewards-info").show();var d=b.find('.rewards-list input[type\x3d"radio"]'),e=d.filter(":checked");B.paymentRows.find('.rewards-list input[type\x3d"radio"]').prop("checked",!1);0<e.length?e.prop("checked",!0):b.find(".rewards-list").hasClass("apply-by-default")?d.filter('[value\x3d"rewardsmax"]').prop("checked",
!0):d.filter('[value\x3d"rewardsnone"]').prop("checked",!0);d=b.find(".rewards-list").show();d.find('input[type\x3d"radio"][value\x3d"rewardscustom"]').is(":checked")&&d.children(".enter-custom-rewards").show();c.isTouchCX()&&d.length&&(b.find(".rewards-info").hide(),b.find(".top-cell").addClass("bottom-line"),b.find(".bottom-cell").show());r.when("installments-payselect").execute(function(c){a.trigger("installments-payselect:toggleRewardsInstallmentEligibility",b)})}function Ta(a){B.paymentRows.find(".financial-offer-list").hide();
B.paymentRows.find(".financial-offer-err-detail").hide();var b=a.find('.financial-offer-list input[type\x3d"radio"]'),d=b.filter(":checked");b.prop("checked",!1);0<d.length?d.prop("checked",!0):b.first().prop("checked",!0);b=a.find(".financial-offer-list").show();a.find(".financial-offer-err-detail").show();c.isTouchCX()&&b.length&&(a.find(".top-cell").addClass("bottom-line"),a.find(".bottom-cell").show())}function bb(){I(document.body).find(".a-dropdown").each(function(){t.hide(I(this))})}function cb(a){B.paymentRows.find(".installments-select").hide();
B.paymentRows.find(".installments-message").show();a.find(".installments-select").show();a.find(".installments-message").hide()}function db(a){B.paymentRows.find("#savedCardSuppressed").hide();a.find("#savedCardSuppressed").show()}function eb(a){B.paymentRows.find(".installments-list").hide();a.find(".installments-list").show()}function Sa(a){B.paymentRows.find(".card-ref-num, .selected-note, .selected-more-payment-option").hide();B.paymentRows.find(".card-benefit").show();a.find(".card-ref-num, .selected-note, .selected-more-payment-option").show();
a.find(".card-benefit").hide()}function fb(a){B.paymentRows.find(".otpBlock").hide();a.find(".otpBlock").show()}function gb(a){B.paymentRows.find(B.ovdWidgetSection).hide();a.find(B.ovdWidgetSection).show()}function Ua(a){B.paymentRows.find(".vcc-info-prompt,.vcc-form-fields").hide();a.find(".vcc-info-prompt,.vcc-form-fields").show()}function Va(a){var b=B.newVDC.find("#vdcBanksSelect"),c=B.newVDC.find(".vdc-selected-bank-prompt").hide(),d=B.newVDC.find("#suppressedVerifiedDebitCard").hide(),e=b.val(),
f="1"===I("#save_citi_card").val()?"CIT"!==e:!0,n="1"===I("#save_citi_card").val()&&"CIT"===e;a.find("#vdcBanksSelect").length?""!==e&&"OtherBanks"!==e&&f&&(B.newVDC.find("option:selected").prop("disabled")?(d.show(),c.hide()):(d.hide(),c.show())):(("OtherBanks"===e||n)&&b.val(b.children("option").first().val()).trigger("change"),c.hide())}function Ha(a,b,c){if(!I.isEmptyObject(a)&&b)return b(c)}function Wa(a){var b=I("#cash-back-ineligible-for-cod-message");b&&b.length&&((a=a.find("#cashOnDeliveryCash"))&&
a.length?b.removeClass("hidden"):b.addClass("hidden"))}function hb(){var a=I("#imb-wrapper");if(a.length&&a.is(":visible")){var b=a.find(".defaultPaymentMethodExpired"),c=a.find(".codUnavailable"),d=a.find("p").length;0===b.length&&0===c.length||1!==d||a.hide()}}var I=a.$,Za=!0,B={},ib={cardImages:"#newCreditCardImages",continueBtns:".continue-buttons:not(.place-order-button)",continueBtnTop:"#continue-top",continueBtnBottom:"#continue-bottom",continueErrPopover:".continue-button-errors",cvvColumnLabel:"#cvvColumnLabel",
existingPaymentForm:"form.checkout-page-form",netBankingSelect:"#net-banking-select-list",morePaymentMethodsSelect:"#more-payment-methods-select-list",newVDC:"#new-vdc",newEMI:"#newEmiCard",orderSummaryBottom:"#order-summary-bottom",pageContainer:"div.a-container",paymentRows:"#existing-payment-methods .payment-row",rewardsRegister:"#rewards-register",addressChallengeCardList:".address-challenge-card",hiddenFormFields:"#hiddenFormFields",jppoints:"#jppoints",gcpromo:"#gcPromo",disableSubmitButtons:"#disableSubmitButtons",
hideInputBoxes:"#hideInputBoxes",showAmexWarning:"#showAmexWarning",existingPincodeNum:"#existingPincodeNum",mcbBalanceWarning:"#mcbBalanceWarning",installmentsOnlyCards:".installments-only-card",ovdWidgetSection:"#ovdWidgetSection"};a.on("checkout:reload:payselect",La);a.on("checkout:reload:spp-payment",La);return{getSelectedPayment:H}});"use strict";r.when("A","page-detector").register("wechat-detector",function(a,m){var k=a.$,c=function(a){a&&!1!==a.isWeChatInstalled&&(a=k("#wechat_payment"),a.length&&
a.show())},f=function(a){},g="MShopWeChatPayment";a.on("checkout:reload:payselect",function(){k("#wechat_payment").length&&(k("#mShopWeChatApiName").length&&(g=k("#mShopWeChatApiName").val()),r.when("safe-mash").execute(function(a){q.cordova.require("cordova/exec")(c,f,g,"isWeChatInstalled",[])}))})});"use strict";r.when("A","page-main","client-side-metrics","ready").register("otp-for-cod",function(a,m,k){function c(){y=q("#cashOnDeliveryCash");if(y.length&&(w=y.find(F.verifyOTP),v=y.find(F.sendOTP),
H=w.length&&v.length,N=q(F.payMobile).length?1:0,H&&(n=y.find(F.submitSendOTP),u=y.find(F.submitVerifyOTP),r=y.find(F.submitResendOTP),A=y.find(F.changeOTPNumber),L=y.find(F.OTPPhoneNumber),C=y.find(F.otpCode),n.length&&u.length&&r.length&&A.length))){P=y.find(F.addURLHash).length;k.increaseCount(X.metricPrefix+X.block,1,1);n.click(function(){t();k.increaseCount(X.metricPrefix+X.send,1,1)});u.click(function(){G=L.val();E=C.val();p();var a=g(G),c;c=/^\d{6}$/;c=E&&c.test(E);a&&c&&""!==M?b("VerifyOTP",
M):c?a||y.find(F.otpServiceFailed).removeClass(F.aokHidden):y.find(F.invalidOTPError).removeClass(F.aokHidden);k.increaseCount(X.metricPrefix+X.verify,1,1)});if(P&&location.hash&&location.hash.length){for(var a=location.hash,a=a.replace("#",""),a=a.split(";"),c=0;c<a.length;c++)0<=a[c].indexOf(V.codehandle)&&(M=a[c].replace(V.codehandle,"")),0<=a[c].indexOf(V.contactid)&&(Q=a[c].replace(V.contactid,"")),0<=a[c].indexOf(V.phonenumber)&&(G=a[c].replace(V.phonenumber,""),L.val(G));""!==M&&""!==Q&&""!==
G&&e()}r.click(function(){k.increaseCount(X.metricPrefix+X.resend,1,1);t()});A.click(function(){w.addClass(F.aokHidden);v.removeClass(F.aokHidden);f(r,!1);f(u,!1);p();k.increaseCount(X.metricPrefix+X.changeNumber,1,1)})}}function f(a,b){b?a.addClass(F.aButtonDisabled):a.removeClass(F.aButtonDisabled);N?a.find("button").prop("disabled",b):a.find("input").prop("disabled",b)}function g(a){var b=/^\d{10}$/;return a&&b.test(a)}function l(){y.find(F.otpServiceFailed).removeClass(F.aokHidden)}function e(){var a=
y.find(F.verifyOTPPhoneNumber);y.find(F.invalidPhoneNumber).addClass(F.aokHidden);v.hasClass(F.aokHidden)?y.find(F.otpResentSuccess).removeClass(F.aokHidden):N&&y.find(F.otpSentSuccess).removeClass(F.aokHidden);v.addClass(F.aokHidden);w.removeClass(F.aokHidden);var b=G.substr(0,2)+"*****"+G.substr(7,9);a.text(b);f(r,!1)}function h(a){if(a!==D&&"object"!==typeof a)try{a=q.parseJSON(a)}catch(b){a={}}a=a||{};var c,e=P&&location.hash?location.hash:"#";P&&location.hash&&";"!==e.slice(-1)&&(e+=";");c=a.status;
a.codeHandle&&null!==a.codeHandle&&(M=a.codeHandle,P&&"SEND-SUCCESS"===c&&(e=d(e,V.codehandle,M)));a.contactId&&null!==a.contactId&&(Q=a.contactId,P&&"SEND-SUCCESS"===c&&(e=d(e,V.contactid,Q),e=d(e,V.phonenumber,G)));P&&(location.hash=e);y.find(F.otpAlertClass).addClass(F.aokHidden);if(aa[c])aa[c]();else aa.DEFAULT()}function d(a,b,c){var d=a.indexOf(b);if(0<=d){var e=a.indexOf(";",d),e=0<=e?e:a.length;a=a.substring(0,d)+a.substring(e+1,a.length+1)}return a+b+c+";"}function b(b,c){a.ajax("/gp/buy/payselect/handlers/otpAjaxHandler.html",
{method:"get",params:{phoneNumber:G,method:b,codeHandle:c,contactId:Q,otp:E},success:h,error:function(){h({status:"SERVICE-FAILED"})}})}function p(){C.val("");y.find(F.otpAlertClass).addClass(F.aokHidden)}function t(){p();G=L.val();g(G)?b("SendOTP",M):y.find(F.invalidPhoneNumber).removeClass(F.aokHidden)}var q=a.$,y,w,v,n,u,r,A,L,C,H,N,P,G="",M="",Q="",E="",F={aokHidden:"aok-hidden",aRadio:".a-radio",aButtonHidden:"a-button-hidden",aButtonDisabled:"a-button-disabled",payMobile:".pay-mobile",invalidOTPError:".invalidOTPError",
verifyOTP:"#verifyOTP",sendOTP:"#sendOTP",submitSendOTP:"#submitSendOTP",submitVerifyOTP:"#submitVerifyOTP",submitResendOTP:"#submitResendOTP",changeOTPNumber:"#changeOTPNumber",OTPPhoneNumber:"#OTPPhoneNumber",otpCode:"#otpCode",cashOnDeliveryCash:"#cashOnDeliveryCash",invalidPhoneNumber:".invalidPhoneNumber",otpServiceFailed:".otpServiceFailed",enterOTPLabel:"#enterOTPLabel",reEnterOTPLabel:"#reEnterOTPLabel",maxOTPError:".maxOTPError",numberAlreadyUsed:".numberAlreadyUsed",verifiedOTPSuccess:".verifiedOTPSuccess",
verifyOTPPhoneNumber:"#verifyOTPPhoneNumber",otpResentSuccess:".otpResentSuccess",otpSentSuccess:".otpSentSuccess",otpAlertClass:".otpAlertClass",phonenumberNotVerified:"phonenumberNotVerified",addURLHash:".addURLHash"},V={codehandle:"codehandle:",contactid:"contactid:",phonenumber:"phonenumber:"},X={metricPrefix:"PayPage-COD-OTP-",block:"Block",send:"Send",verify:"Verify",resend:"ReSend",changeNumber:"ChangeNumber"},aa={"SERVICE-FAILED":l,"SEND-SUCCESS":e,"VERIFY-SUCCESS":function(){v.addClass(F.aokHidden);
w.addClass(F.aokHidden);y.find(F.verifiedOTPSuccess).removeClass(F.aokHidden);y.find("."+F.phonenumberNotVerified).removeClass(F.phonenumberNotVerified);N&&m.setContinueButtonStatus(!0)},"INVALID-NUMBER":function(){y.find(F.invalidPhoneNumber).removeClass(F.aokHidden)},"NUMBER-ALREADY-USED":function(){f(r,!0);f(u,!0);y.find(F.numberAlreadyUsed).removeClass(F.aokHidden)},"MAX-OTP-REACHED":function(){y.find(F.maxOTPError).removeClass(F.aokHidden);f(r,!0)},"INVALID-OTP":function(){y.find(F.invalidOTPError).removeClass(F.aokHidden);
C.val("");N?C.attr("placeholder","Re-enter OTP"):(y.find(F.enterOTPLabel).addClass(F.aokHidden),y.find(F.reEnterOTPLabel).removeClass(F.aokHidden))},DEFAULT:l};a.on("checkout:reload:payselect",c);a.on("checkout:reload:spp-payment",c)});"use strict";r.when("A","pay-common-util","ready").execute(function(a,m){var k={productGls:"#productGls",gcTypes:"#gcDeliveryTypes",device:"#device"},c=m.getElements(k);a.on("checkout:payment:challenge:log",function(f){var g={},l;for(l in k)k.hasOwnProperty(l)&&c[l]&&
c[l].val()&&(g[l]=c[l].val());f&&(g.paymentInstrumentId=f);Object.keys&&Object.keys(g).length&&a.ajax("/gp/buy/payselect/handlers/log-payment-challenge.html?ref_\x3dcheckout-payment-challenge",{method:"POST",params:g,timeout:1E3,cache:!1})})});"use strict";r.when("A","page-spinner-controller","page-main","page-transition-controller","page-conductor","client-side-metrics","button-blocker","ready").register("pay-auth",function(a,m,k,c,f,g,l){function e(){var a=p("#otp_id").val(),b=/^\d{6}$/;a&&b.test(a)?
l.hide("pay-auth-otp-checks"):(a=p("#otp_invalid_msg").val(),l.show("pay-auth-otp-checks",a))}function h(b,c){m.show();a.ajax("validate-otp.html",{method:"post",params:{otp_name:b,paystationRequestId:c},success:function(a){!a||"APPROVED"!==a.status&&"PENDING"!==a.status?(p("#otp_id").addClass("a-form-error"),p("#otpBadCode").removeClass("hidden"),m.hide()):(p("#isFormValidated").val("1"),q.submit())},error:function(a){m.hide()}})}function d(){p("#otp_id").removeClass("a-form-error");p("#otpBadCode").addClass("hidden")}
function b(){g.increaseCount(y.metricPrefix+y.resend,1,1);var b="1"===p("#isPaystationFlow").val(),c;b?(c="resend-otp.html?returnHtml\x3d0\x26isPaystationFlow\x3d1",m.show()):c="resend-otp.html?returnHtml\x3d0";a.ajax(c,{method:"get",success:function(a){b&&(a&&1===a.successful&&(p("#authSourceId").val(a.authSourceId),p("#paystationRequestId").val(a.paystationRequestId)),m.hide())},error:function(a){b&&m.hide()}})}var p=a.$,t,q,y={metricPrefix:"Payauth-",resend:"Resend"};a.on("checkout:reload:payauth",
function(){t=p("#resend_form");q=p("#otp_form");q.submit(function(a){var b=p(a.currentTarget);if("1"===b.find('input[id\x3d"isPaystationFlow"]').val()&&(d(),"1"!==b.find('input[id\x3d"isFormValidated"]').val()))return a=b.find('input[id\x3d"otp_id"]').val(),b=b.find('input[id\x3d"paystationRequestId"]').val(),h(a,b),!1});t.submit(function(a){"1"===p("#isPaystationFlow").val()&&d();b();return!1});e();p("#otp_id").unbind("keyup").bind("keyup",e)})});"use strict";r.when("A","ajax-utility","client-side-metrics",
"loading-spinner-controller","pay-common-lib","pay-common-util","page-conductor","page-transition-controller","quantity-service","weblab-helper").register("pay-gil",function(a,m,k,c,f,g,l,e,h,d){function b(a){L=a.popover;var b=n(L);r("#gil-estimates-popover-"+b+" .gil-popover-content").html("");r("#gil-estimates-popover-"+b+" .gil-popover-error").html("");a.popover.updatePosition(!0)}function p(a){L=a.popover;var b=n(L),d=r("#gil-estimates-popover-"+b);d.find("input[name\x3dgil-subtype]").val(b);
c.showSpinner(d,!1,L);a="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime();var e="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(b);r.ajax({type:"POST",url:a,data:e,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return m.jsonify(a)},success:function(a,e,f){n(L)===b&&(k.increaseCount("Checkout:GIL:"+b+":IneligiblePopoverSuccess",1),e=L,c.hideSpinner(d),a&&a.errors&&0<a.errors.length?d.find(".gil-popover-error").show():a&&a.widgetHTML?
d.find(".gil-popover-content").html(decodeURIComponent(a.widgetHTML)):d.find(".gil-popover-error").show(),e.updatePosition(!0))},error:function(a){n(L)===b&&(k.increaseCount("Checkout:GIL:"+b+":IneligiblePopoverError",1),a=L,c.hideSpinner(d),d.find(".gil-popover-error").show(),a.updatePosition(!0))}})}function t(a){a.$event.preventDefault();a.$target.closest(".a-popover").find(".a-button-close").trigger("click")}function q(a){a.$event.preventDefault();var b=n(L),f=r("#gil-estimates-popover-"+b);c.showSpinner(f,
!1,L);var g=y(a.$currentTarget.parents("#gil-estimates-popover-"+b));c.showSpinner(f,!1,L);h.callBatch(g,{success:function(c,f,h){n(L)===b&&(k.increaseCount("Checkout:GIL:"+b+":SubmitIneligiblePopoverSuccess",1),t(a),e.show(),1==parseInt(r("input[name\x3d'gil-rendered-using-apx']").val(),10)&&d.isGILCreditCardEnabled()?(c=r(".pmts-select-payment-instrument-form"),f=L,"APX_PSP_TO_RCX_SPC"==(f.attrs?f.attrs("data").onSubmit:f.data.onSubmit)&&c&&0<c.length?l.continueClicked(null,c):k.increaseCount("Checkout:GIL:"+
b+"Popover:ErrorRedirectingToSPC",1)):v(b))},error:function(a){n(L)===b&&(k.increaseCount("Checkout:GIL:"+b+":SubmitIneligiblePopoverError",1),a=L,c.hideSpinner(f),f.find(".gil-popover-error").show(),a.updatePosition(!0))},isTrial:0})}function y(a){var b={};a.find(".gil-ineligible-items").children(".gil-ineligible-item").each(function(a,c){a=r(c).find('input[name^\x3d"ineligible-item"]').val();b[a]=0});return b}function w(a){a.$event.preventDefault();var b=r("#gil-ineligible-"+a.data.subtype).find(".gil-ineligible-items"),
c=b.data("index"),d=b.data("size"),c=(c+("next"===a.data.direction?1:-1)+d)%d,d=(c+1)%d;b.find(".gil-ineligible-item").addClass("aok-hidden").removeClass("a-span-last");a=b.find("#gil-ineligible-item-"+c);d=b.find("#gil-ineligible-item-"+d);a.removeClass("aok-hidden");d.addClass("a-span-last").removeClass("aok-hidden");b.data("index",c)}function v(b){g.makeAjaxCall("/gp/buy/payselect/handlers/submit.html",{handler:"new-gil-payment",subtype:b},{successHandler:function(c,d,e){k.increaseCount("Checkout:GIL:"+
b+":NewToExistingSuccess",1);l.ajaxUpdatePage(c,d,e);g.scrollTopTo(r("#existing-payment-methods [value\x3d"+b+"]"));if(l.isSPP())a.on("checkout:afterReload",function M(){r("#existing-gil input[value\x3d"+b+"]").trigger("click");a.off("checkout:afterReload",M)});else r("#existing-gil input[value\x3d"+b+"]").trigger("click")},errorHandler:function(a,c,d){k.increaseCount("Checkout:GIL:"+b+":NewToExistingError",1);l.ajaxUpdatePage(a,c,d)}})}function n(a){return a.attrs?a.attrs("data").subtype:a.data.subtype}
function u(){A&&(a.declarative("gil-close-popover",["click"],t),a.declarative("gil-submit-popover",["click"],q),a.declarative("gil-ineligible-pagination",["click"],w));r("#gil-cc-payment-type").length&&(a.off("a:popover:beforeShow:gil-estimates",b),a.off("a:popover:show:gil-estimates",p),a.on("a:popover:beforeShow:gil-estimates",b),a.on("a:popover:show:gil-estimates",p));r("#gil-payment-type").length&&(a.off("a:popover:beforeShow:gil-si-estimates",b),a.off("a:popover:show:gil-si-estimates",p),a.on("a:popover:beforeShow:gil-si-estimates",
b),a.on("a:popover:show:gil-si-estimates",p));A=!1}var r=a.$,A=!0,L;a.on("checkout:reload:payselect",u);a.on("checkout:reload:spp-payment",u);return{submitNewGilPayment:v,displayGILEstimatesMobile:function(a,b,c){var d="/gp/buy/payselect/handlers/get-gil-popover-content.html?cachebuster\x3d"+(new Date).getTime(),e="hasWorkingJavascript\x3d1\x26subtype\x3d"+encodeURIComponent(a);g.makeAjaxCall(d,e,{successHandler:function(c,d,e){var f=m.jsonify(c);f&&!f.errors&&f.widgetHTML?k.increaseCount("Checkout:GIL:"+
a+":Mobile:IneligibleSubPageSuccess",1):k.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageError",1);b(c,d,e)},errorHandler:function(b){k.increaseCount("Checkout:GIL:"+a+":Mobile:IneligibleSubPageError",1);c(b)}})},actionCloseGilMobileSubpage:function(a){a.$event.preventDefault();r("#gil-estimates-subpage").remove();r(g.pages.main.pageId).show()},actionSubmitGilMobileSubpage:function(a,b,c){a.$event.preventDefault();r("#gil-ineligible-view");var d=y(a.$currentTarget.parents("#gil-ineligible-view"));
h.callBatch(d,{success:function(c,d,e){k.increaseCount("Checkout:GIL:"+a.data.subtype+":Mobile:SubmitIneligibleSubPageSuccess",1);b(c,d,e)},error:function(b){k.increaseCount("Checkout:GIL:"+a.data.subtype+":Mobile:SubmitIneligibleSubPageError",1);c(b)},isTrial:0})}}});"use strict";r.when("A","ready").register("new-verified-debit-card",function(a){});"use strict";r.when().register("recommendation-helper",function(){return{}});"use strict";r.when("A").register("apb-limit-messaging-helper",function(a){return{}});
"use strict";r.when("A","jQuery","client-side-metrics","ready").register("temporary-preference-indicator",function(a,m,k){function c(){m.ajax({type:"GET",url:"/gp/shopwithpoints/temporaryPreference/has-active-temporary-preference.html",async:!0,dataType:"json",success:function(a){a.hasOwnProperty("Result")?(f=a.Result,k.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::Ajax::Success",1),k.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::TPPCheckBackendCall::Success",
1)):k.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::TPPCheckBackendCall::Failure",1)},error:function(){k.increaseCount("Checkout::PayPage::TemporaryPaymentPreferenceIndicator::Ajax::Failure",1)}})}var f="False";a.on("checkout:reload:payselect",c);a.on("checkout:reload:spp-payment",c);a.on("checkout:reload:pay",c);return{hasActiveTemporaryPreference:function(){return"True"===f}}});"use strict";r.when("A","page-detector").register("alipay-detector",function(a,m){var k=a.$,c=
function(){var a=k("input[name\x3d'isAlipayAppPayment']");0<a.length&&m.isMobileSpc&&a.val("1")},f=function(a){},g=function(){var a=k("input[name\x3d'isAlipayRedirect']");0<a.length&&m.isMobileSpc&&a.val("1")},l=function(a){};a.on("checkout:reload:spc",function(){k("input[name\x3d'isAlipayAppPayment']").length&&r.when("safe-mash").execute(function(a){a=q.cordova.require("cordova/exec");a(c,f,"AlipayPlugin","isAlipayInstalled",[]);k("input[name\x3d'isAlipayRedirect']").length&&a(g,l,"AlipayPlugin",
"isAlipayFailReturnSupported",[])})})});"use strict";r.when("A","page-transition-controller","page-detector").execute(function(a,m,k){function c(){var a=f("#backButtonProtection");a.length&&"1"===a.val()&&(m.showPageTransition(),document.location.reload())}var f=a.$;r.register("back-button-protection",function(){return{markAsDirty:function(){f("#backButtonProtection").val(1)}}});a.on("checkout:reload:spc",c);a.on("checkout:reload:spp-revieworder",c)});"use strict";r.when("A","page-transition-controller",
"loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","delivery-preferences-csm-helper").register("delivery-preferences-controller",function(a,m,k,c,f,g,l,e,h){function d(){l.isTabletSpc()&&(u=n("#spc-orders .delivery-preferences-options"),w(),u.find("select").trigger("change"),q())}function b(){var a=u.find("input[name\x3dpreference]:checked").val(),b=u.find("select[name\x3dSafePlaceLocation]");"NeighborDelivery"===a?(u.find("input[name\x3dneighbor-name]").removeAttr("disabled").removeClass("a-form-disabled"),
u.find("input[name\x3dneighbor-house]").removeAttr("disabled").removeClass("a-form-disabled"),f.isSPP()?r.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),u.find(".safe-place-error").hide()):"SafePlaceDelivery"===a?(f.isSPP()?r.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"enabled"})}):b.removeAttr("disabled").closest(".a-button").removeClass("a-button-disabled"),
u.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),u.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),u.find(".neighbor-name-error").hide(),u.find(".neighbor-house-error").hide()):(u.find("input[name\x3dneighbor-name]").attr("disabled","disabled").addClass("a-form-disabled"),u.find("input[name\x3dneighbor-house]").attr("disabled","disabled").addClass("a-form-disabled"),f.isSPP()?r.when("a-dropdown").execute(function(a){a.getSelect(b).update({status:"disabled"})}):
b.attr("disabled","disabled").closest(".a-button").addClass("a-button-disabled"),u.find(".neighbor-name-error").hide(),u.find(".neighbor-house-error").hide(),u.find(".safe-place-error").hide());p(!0)}function p(a){var b=u.find("input[name\x3dpreference]:checked").val();u.find(".safe-place-error").hide();u.find(".neighbor-name-error").hide();u.find(".neighbor-house-error").hide();u.find("input").removeClass("a-form-error");u.find("div.a-input-text-wrapper").removeClass("a-form-error");u.find("select").closest(".a-button").removeClass("a-button-error");
0<n("div.spc-tablet").length?u.find(".set-delivery-preferences-button").removeClass("a-button-disabled"):u.find(".set-delivery-preferences-button").show();u.find(".save-disabled").hide();u.find(".current-blocker-content").text("");var c=!1;if("NeighborDelivery"===b){var d=u.find("input[name\x3dneighbor-name]");d.data("defaultValueRemoved")&&d.val()||(u.find(".neighbor-name-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),u.find(".current-blocker-content").html(u.find(".neighbor-name-error-text").text()),
c=!0);d=u.find("input[name\x3dneighbor-house]");d.data("defaultValueRemoved")&&d.val()||(u.find(".neighbor-house-error").show(),d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),u.find(".current-blocker-content").html(u.find(".neighbor-house-error-text").text()),c=!0)}else"SafePlaceDelivery"===b&&(d=u.find("select[name\x3dSafePlaceLocation]"),d.val()||(u.find(".safe-place-error").show(),d.closest(".a-button").addClass("a-button-error"),u.find(".current-blocker-content").html(u.find(".safe-place-error-text").text()),
c=!0));d=n("#disableSaveBtnWhenNoDeliveryPrefSelected").val();if(a&&c||"true"===d&&b===D)0<n("div.spc-tablet").length?u.find(".set-delivery-preferences-button").addClass("a-button-disabled"):u.find(".set-delivery-preferences-button").hide(),u.find(".save-disabled").show();return!c}function t(a){a&&a.$event&&a.$event.preventDefault();a="hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26";var b="",d=u.find(".popover-deliv-prefs-content");d.data("obfuscatedEntityId")?
b=d.data("obfuscatedEntityId"):u.data("obfuscatedEntityId")&&(b=u.data("obfuscatedEntityId"));a+="obfuscatedEntityId\x3d"+b+"\x26";b=u.find("input[name\x3dpreference]:checked").val();""!==b&&(a+="prefDelLocation\x3d"+b+"\x26","NeighborDelivery"===b?(a+="neighborName\x3d"+encodeURIComponent(u.find("input[name\x3dneighbor-name]").val())+"\x26",a+="houseNo\x3d"+encodeURIComponent(u.find("input[name\x3dneighbor-house]").val())+"\x26"):"SafePlaceDelivery"===b&&(a+="safePlaceLocation\x3d"+u.find("select[name\x3dSafePlaceLocation]").val()+
"\x26"),b=u.find("input[name\x3ddefaultPreference]:checked").val(),b!==D&&""!==b&&(a+="isDefaultPreference\x3d1"));0<n("div.spc-tablet").length?m.show():k.showSpinner(u.find(".popover-deliv-prefs-content"),!1,K);h.recordCSMWithCurrentFieldValues("popover-submitted","preference","defaultPreference");n.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-delivery-preference.html",data:a,dataType:"text",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc",
"x-amz-checkout-transition":"ajax"},success:function(a,b,d){A=!0;0<n("div.spc-tablet").length?m.hide():k.hideSpinner(u.find(".popover-deliv-prefs-content"));d.getResponseHeader("x-amz-checkout-page")?(u.find(".a-button-close").trigger("click"),f.ajaxUpdatePage(a,b,d)):(a=c.jsonify(a),f.redirect(a));e.increaseCount("checkoutSpcDeliveryPref-save",1)},error:function(a,b,c){0<n("div.spc-tablet").length?m.hide():k.hideSpinner(u.find(".popover-deliv-prefs-content"));p(!0)}})}function q(){u.find("input[name\x3d'neighbor-name'], input[name\x3d'neighbor-house']").unbind("focus").bind("focus",
function(){if(!n(this).data("defaultValueRemoved")){if(l.isMobileSpc()||l.isDesktopSpc())n(this).val(""),n(this).css("color","black");n(this).data("defaultValueRemoved",!0)}}).each(function(){(l.isMobileSpc()||l.isDesktopSpc())&&n(this).data("defaultValueRemoved")&&n(this).css("color","black")});u.find("input:radio[name\x3dpreference]").unbind("click").bind("click",b);u.find("input[name^\x3dneighbor]").unbind("keyup").bind("keyup",function(){p(!1)});0<n("div.spc-tablet").length?u.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",
y):u.find("select[name\x3dSafePlaceLocation]").unbind("change").bind("change",function(){p(!1)})}function y(a){p(!0)&&t(a)}function w(a){var b=n("#spc-orders .delivery-preferences-options"),c,d="";a?(c=a.$currentTarget.find("input"),d=b.find("input[name\x3dpreference]:checked").val()):c=b.find("input[name\x3dpreference]:checked");b=c.val();if(d!==b){u.find(".expand-content").hide();var d=c,e=d.closest(".delivery-preferences-options");e.find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");
e.find("input").attr("checked",!1);d.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");d.attr("checked",!0);"NeighborDelivery"===b||"SafePlaceDelivery"===b?c.closest(".deliverypreference-option").siblings(".expand-content").show():a&&t(a)}}function v(a){(a=u.find("#delivery-preferences-set-default-checkbox"))&&1===a.length&&(a.prop("checked")?e.increaseCount("checkoutSpcDeliveryPref-setAsDefault",1):e.increaseCount("checkoutSpcDeliveryPref-setAsTemporary",
1))}var n=a.$;if(!n("html").hasClass("a-ie6")){var u,K,A;a.on("a:popover:beforeShow",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-delivprefs")&&(a.popover.$popover.find(".a-popover-inner").html(u.find(".current-blocker-content").text()),a.popover.updatePosition())});a.on("a:popover:show",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(e.increaseCount("checkoutSpcDeliveryPref-open",1),K=a.popover,u=K.$popover,A=!1,q(),h.recordCSMWithCurrentFieldValues("popover-displayed",
"preference","defaultPreference"),b(),u.find("select").trigger("change"))});a.on("a:popover:dismiss",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(A||e.increaseCount("checkoutSpcDeliveryPref-dismissed",1))});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("deliv-prefs")&&(A||h.recordCSM("popover-dismissed"))});a.declarative("delivery-preferences-switch-tablet",["click"],function(a){w(a)});a.declarative("delivery-preferences-expander-toggle",
["click"],function(a){g.toggleExpanderContent(a)});a.declarative("set-delivery-preferences",["click","touchend"],function(a){a.$event.preventDefault();g.protectAgainstDoubleAction("set-delivery-preferences")||p(!0)&&t()});a.declarative("delivery-preferences-set-default-checkbox-triggered","change",v);a.on("checkout:reload:spc",d)}});"use strict";r.when("A","page-detector","time-left-formatter").register("fast-track-controller",function(a,m,k){function c(){for(var b in t)t[b]&&clearInterval(t[b]);
a.defer(f)}function f(){b.DAY=d("#fasttrack-day").html();b.DAYS=d("#fasttrack-days").html();b.HOUR=d("#fasttrack-hour").html();b.HOURS=d("#fasttrack-hours").html();b.AND=d("#fasttrack-and").html();b.MINUTE=d("#fasttrack-minute").html();b.MINUTES=d("#fasttrack-minutes").html();b.SECOND=d("#fasttrack-second").html();b.SECONDS=d("#fasttrack-seconds").html();(d("#isfresh").length&&d(".checkout.spc-mobile").length||d("#lazy-fresh-promise-delivery-message").length?d("#spc-form"):d("#spc-orders")).find(".fasttrack-span").each(function(){var b=
d(this),c=b.find("input[name\x3d'countdownId']").val();p[c]=parseInt(b.find("input[name\x3d'fasttrackExpiration']").val());q[c]=a.now()/1E3+p[c];g(b.find("input[name\x3d'countdownThreshold']").val(),b,b.find("input[name\x3d'showSimplifiedCountdown']").val(),c);b.show()})}function g(a,b,c,d){0>=p[d]?e(b,null):a&&0<a&&p[d]>a?b.find("span.fasttrackavailable").hide():(l(b,c),t[d]=setInterval(function(){l(b,c,d)},1E3))}function l(c,f,h){0<p[h]?(p[h]=Math.round(q[h]-a.now()/1E3),f=k.getTimeLeftFormatted(p[h],
1===f||"1"===f?!0:!1,b),d("html").hasClass("a-tablet")?c.find("span[data-field\x3d'fasttrackcountdown']").html("\x26nbsp;"+f):c.find("span[data-field\x3d'fasttrackcountdown']").html(f),c.find("span.fasttrackexpired").hide(),c.find("span.fasttrackcountdown").show(),c.find("span.fasttrackavailable").show()):e(c,h)}function e(a,b){b?(t[b]&&clearInterval(t[b]),a.find("span.fasttrackavailable").hide(),a.find("span.fasttrackexpired").show()):clearInterval(t[b])}function h(){c()}var d=a.$;if(!d("html").hasClass("a-ie6")){var b=
{},p={},t={},q={};a.on("checkout:reload:spc",c);a.on("checkout:reload:spp-revieworder",c);return{spcLiteLazyLoadFastTrack:h}}});"use strict";r.when("A","page-transition-controller","ajax-utility","page-conductor","client-side-metrics").register("gc-redeem-controller",function(a,m,k,c,f){function g(a){if(!t){a.preventDefault();p(a.currentTarget);var b;0<p("#spc-gcpromoinput").length&&(b=encodeURIComponent(p("#spc-gcpromoinput").val()));0<p("#gc-promo-input").length&&(b=encodeURIComponent(p("#gc-promo-input").val()));
var d=encodeURIComponent(p("#spc-usePromoOnly").val());if(b&&0!==b.length){var e=encodeURIComponent(p("input[name\x3dpurchaseTotal]").val());p("#gc-error").hide();p("#gc-promo-success").hide();p("#gc-success").hide();p("#gc-ineligible").hide();p("#promo-success").hide();c.isSPP()?(m.blockAllActions(),m.showTransitionInContainer(p("#payment"))):m.show();var f=(new Date).getTime();a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_pay_page_gc_add";p(".checkout.spc.aui-templatized").length&&
(a="/gp/buy/spc/handlers/add-giftcard-promotion.html/ref\x3dox_spc_gc_add");b="purchaseTotal\x3d"+e+"\x26claimcode\x3d"+b+"\x26disablegc\x3d"+d+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+p("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+f;d=c.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});p.ajax({type:"POST",url:a,data:b,headers:d,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",complete:function(){t=!1},success:l,error:c.ajaxRedirect});t=!0}else h("addGiftCardOrPromo_NoCode")}}function l(a,b,f){var n=f.getResponseHeader("x-amz-checkout-page");if(n){if(c.ajaxUpdatePage(a,b,f),"spc"===n||"spclite"===n||"spp-revieworder"===n)(a=parseInt(p("#checkoutDisplayPage").data("delaySetTitle"),10)||parseInt(p("#gc-promo-delay").data("egcDelayUpdateRedemptionMessage"),10)||0)?setTimeout(function(){e(f)},a):e(f)}else{a=k.jsonify(a);if(!a)return c.redirect();if(a.error)return h(a.error);
if(a.errors)return h(a.errors);if(a.autohandlererror)return d(a.autohandlererror);c.redirect(a)}}function e(a){var c=a.getResponseHeader("x-updated-promo-type");a=a.getResponseHeader("x-updated-gc-applied-but-ineligible");c&&(a||p("#gc-promo-success").show(),0<p("div.spc-desktop").length?(p("#spc-gcpromoinput").removeClass("a-form-error"),p("#gc-promo-input").removeClass("a-form-error")):(p("#spc-gcpromoinput").closest(".a-input-text-wrapper").removeClass("a-form-error"),p("#gc-promo-input").closest(".a-input-text-wrapper").removeClass("a-form-error")),
"giftcard"===c?(b("applied"),a?(p("#gc-ineligible").show(),b("gcIneligible")):p("#gc-success").show()):p("#promo-success").show())}function h(a){m.hide();p("#gc-error p").hide();p("#gc-error").show();b("error");0<p("div.spc-desktop").length?(p("#spc-gcpromoinput").addClass("a-form-error"),p("#gc-promo-input").addClass("a-form-error")):(p("#spc-gcpromoinput").closest(".a-input-text-wrapper").addClass("a-form-error"),p("#gc-promo-input").closest(".a-input-text-wrapper").addClass("a-form-error"));p(0<
p("#gc-promo-input").length?"."+r[a]:"#"+a).show()}function d(a){if(a){var b=a.action,c="/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(a.type?a.type:b&&b.code?b.code:"string"===typeof a?a:"Unknown:pipelineJSError");"fatal"===b?c+="\x26errorAction\x3dfatal":"redirect"===b&&(a.url?c=a.url:"cart"===a.page&&(c="/gp/cart/view.html"));q.location.href=c}else q.location.href="/gp/buy/payselect/handlers/error.html?errorType\x3dUnknown:pipelineJSError"}function b(b){var c=a.state("cxt-gc-redemption-method").method;
f.increaseCount("rcxGCRedeem:"+c+":"+b,1)}var p=a.$,t=!1;if(!p("html").hasClass("a-ie6")){a.state("cxt-gc-redemption-method",{method:"type"});var r={addGiftCardOrPromo_Unknown:"UNKNOWN",addGiftCardOrPromo_NoCode:"NO_CODE",addPromo_InvalidForPurchase:"PROMO_INVALID_FOR_PURCHASE",addPromo_BadCode:"PROMO_BAD_CODE",addPromo_ExpiredCode:"PROMO_EXPIRED_CODE",addPromo_InvalidForOrgUnit:"PROMO_INVALID_FOR_ORG_UNIT",addPromo_OfferNotYetBegun:"USED_BEFORE_START_DATE",addPromo_AlreadyRedeemed:"PROMO_ALREADY_REDEEMED",
addGiftCard_AlreadyRedeemedByAnotherAccount:"GC_ALREADY_REDEEMED_BY_ANOTHER_ACCOUNT",addGiftCard_AlreadyRedeemedByThisAccount:"GC_ALREADY_REDEEMED_BY_THIS_ACCOUNT",addGiftCard_BadCode:"GC_BAD_CODE",addGiftCard_ExpiredCode:"GC_EXPIRED_CODE",addGiftCard_Cancelled:"CANCELLED_CODE",addGiftCard_WrongOrgUnit:"GC_WRONG_ORG_UNIT",addGiftCard_ServiceDown:"GC_SERVICE_DOWN",addGiftCard_InvalidForAGS:"GC_INVALID_FOR_AGS",addGiftCard_PassedClaimByDate:"PASSED_CLAIM_BY_DATE",addGiftCard_OfferNotYetBegun:"GC_NOT_YET_BEGUN",
addGiftCard_ExceededMaxLimit:"GC_EXCEED_MAX_LIMIT",addGiftCard_Disabled:"GC_DISABLED",addGiftCard_OTP_Required:"GC_OTP_REQUIRED",addGiftCard_SEVIS_Decline:"GC_SEVIS_DECLINE",addGiftCard_OCRAH_Decline:"GC_OCRAH_DECLINE",addGiftCard_DEFAULT_Message:"GC_DEFAULT_MESSAGE"};a.declarative("gc-element",["click"],function(a){var b=a.data.click;b&&null!==b&&g(a.$event)});a.on("a:expander:redeem-gc-expander:toggle:expand",function(a){f.increaseCount("checkout:spp-payment:expand_addgc_coll",1)});p(document).delegate("#spc-gcpromoinput, #gc-promo-input",
"keypress",function(a){13===a.which&&g(a)});return{actionAddGiftPromotion:g,giftSystemErrorHandling:d}}});"use strict";r.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor","checkout-general-utils","page-detector","client-side-metrics","gift-utility","weblab-helper").register("gift-popover-controller",function(a,m,k,c,f,g,l,e,h,d){function b(){var a=U;a.find("#select-recipient").empty();for(var b=0;b<ja.length;b++){var c=J("\x3coption/\x3e").attr({value:ja[b].value}).text(ja[b].text);
a.find("#select-recipient").append(c)}va&&(b=a.find('#select-recipient option[value\x3d"'+va+'"]').attr("selected","selected"),a.find("#select-recipient").closest("#popover-gift-connection-recipient").find(".a-placeholder").text(b.text()),da())}function p(){a.defer(function(){J("#spc-orders").find(".gift-popover-link").each(function(){J(this).data("action")&&J(this).removeAttr("href").attr("tabindex",0)})});J(".larger-image-link").find("a").removeAttr("href")}function t(a){var c=U;c.find(".gift-error-box").hide();
c.find(".fake-label").each(function(){J(this).unbind("click").bind("click",function(){J(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&c.find(".popover-gift-top .gift-item-title span").html(a.item.title);a&&a.item&&a.item.isAutoripEligible?c.find("#gift-autorip-unavailable-msg").show():c.find("#gift-autorip-unavailable-msg").hide();if(a&&a.obfuscatedEntityId){var d=c.find(".set-gift-options-button input");d.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,
giftData:a},r);g.bindActionEnterKeyOnButton(d)}ea?(ia=a&&a.item&&a.item.isAmazonFulfilled,qa=!(a&&a.address&&0===a.address.shipToSelf),ia&&(a&&a.options&&a.options.canHaveMessage||a&&a.options&&a.options.canBeWrapped)?(v(!0),c.find(".mfn-hide-prices").hide(),c.find(".include-gift-receipt").show()):ia||(v(!0),c.find(".include-gift-receipt").hide(),c.find(".mfn-hide-prices").show(),c.find(".include-gift-message").show()),Ga=c.find(".include-gift-message").is(":visible"),L()):a&&a.options&&a.options.canHidePrices?
c.find(".hide-prices-checkbox").closest("div").show():c.find(".hide-prices-checkbox").closest("div").hide();a&&a.selected&&(d=T(c.find(".hide-prices-checkbox")),a.selected.hidePrices?d.attr("checked",!0):d.removeAttr("checked"));if(a&&a.item&&a.item.purchaseIsKindle){if(d=c.find(".kindle-registration-box"),d.show(),d.find(".register-kindle-customer-name").html(c.find(".gift-customer-name").html()),!ea){var d=T(c.find(".kindle-reg-radio-another-account")),e=T(c.find(".kindle-reg-radio-your-account"));
a.selected.hidePrices||a.selected.isWrapped?(e.removeAttr("checked"),d.attr("checked",!0)):(d.removeAttr("checked"),e.attr("checked","checked"));T(c.find(".hide-prices-checkbox")).trigger("change")}}else c.find(".kindle-registration-box").hide();if(a&&a.options&&a.options.canHaveMessage){a&&a.selected&&(d=a.selected.message,e=T(c.find(".include-gift-message-checkbox")),d&&d.length?(c.find("textarea[name\x3d'gift-message-text']").val(d),u(!0)):null===d&&(a.selected.isWrapped||a.selected.hasReceipt)?
(e.removeAttr("checked"),c.find(".textarea[name\x3d'gift-message-text']").val("")):(c.find("textarea[name\x3d'gift-message-text']").val(""),d="",ea?(d+=c.find(".sample-gift-msg-greeting").html(),a&&a.address&&a.address.firstName&&!qa&&(d+=" "+a.address.firstName),d=d+",\n"+c.find(".sample-gift-msg").html(),d+="\n"):(d+=c.find(".sample-gift-msg").html(),d+="\n\n"),d+=c.find(".sample-gift-msg-from").text(),d=ea?d+h.getNameWithNoTitle(c.find(".gift-customer-name").html()):d+h.getFirstName(c.find(".gift-customer-name").html()),
c.find("textarea[name\x3d'gift-message-text']").val(d),!ea||qa&&Ga||u(!0)));var f=J(".gift-message-warning").length,d=function(){ea&&u(!0);M(a.options.maxMessageChars,a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);if(f){var b=U.find("textarea[name\x3d'gift-message-text']");h.toggleGiftMessageWarning(b,U)}};if(a&&a.options){var n=c.find("textarea[name\x3d'gift-message-text']");n.bind("keyup",d);n.bind("mouseup",d);M(a.options.maxMessageChars,a.options.maxMessageLines,a.options.hasFixedGiftMsgLimit);
f&&h.toggleGiftMessageWarning(n,c);T(c.find(".include-gift-message-checkbox")).bind("change",function(){var b=J(this).is(":checked"),d=a.options.maxMessageChars,e=a.options.maxMessageLines,g=a.options.hasFixedGiftMsgLimit,p=U,k=p.find("textarea[name\x3d'gift-message-text']");b?ea&&A():(0<p.find(".validateInputCharactersOnBlur.a-form-error").size()&&(p.find(".validateInputCharactersOnBlur.a-form-error").removeClass("a-form-error"),0<p.find("#onblur-character-validation-error-gift-message-text").size()&&
p.find("#onblur-character-validation-error-gift-message-text").remove()),ea?L():(k.val(""),M(d,e,g)));f&&h.toggleGiftMessageWarning(n,c)})}}else c.find(".popover-gift-message-text").css("visibility","hidden"),c.find(".include-gift-message").css("visibility","hidden"),ea&&(c.find(".include-gift-message").hide(),c.find(".popover-gift-message").css("visibility","hidden")),c.find(".popover-gift-message-not-available").show();a&&a.options&&!a.options.canBeWrapped?(c.find(".wrap-option").hide(),c.find(".popover-gift-no-wrap-available").show(),
c.find(".hide-prices-amazon-msg").hide(),c.find(".hide-prices-note").hide(),c.find(".hide-prices-merchant-msg").show(),T(c.find(".hide-prices-checkbox")).attr("disabled",!1)):a&&a.item&&a.item.isAmazonFulfilled?(c.find(".wrap-option").hide(),c.find(".popover-gift-fba-wrap").show(),c.find(".hide-prices-amazon-msg").show(),c.find(".hide-prices-merchant-msg").hide(),(d=a.options.wraps[0].imageurl)&&0<d.length&&(c.find(".large-preview").find("img").attr("src",d),c.find(".large-preview").show(),c.find(".fba-wrap-checkbox").show(),
e=c.find(".larger-image-link"),e.unbind("click").bind("click",{imageURL:d},Q),g.bindActionEnterKeyOnButton(e)),a.options.wraps[0].description&&c.find(".gift-wrap-title").show().html(a.options.wraps[0].description),"1"===J("#multipleAFNGiftWrapOption").val()?a.options&&a.options.wraps&&1<=a.options.wraps.length&&(d=c.find(".popover-gift-amazon-wrap"),y(c,d),Y(a,"afn",d)):a.options&&a.options.wraps&&1===a.options.wraps.length?(c.find(".popover-gift-amazon-wrap").hide(),c.find(".popover-gift-merchant-wrap").hide(),
c.find(".fba-wrap-checkbox .gift-wrap-price").html(a.options.wraps[0].price),e=T(c.find(".amazon-gift-wrap")),e.val(a.options.wraps[0].id),d=T(c.find(".hide-prices-checkbox")),a.selected.isWrapped?(e.attr("checked",!0),a.item.purchaseIsKindle||(d.attr("checked",!0),d.attr("disabled",!0),c.find(".hide-prices-note").show())):(e.removeAttr("checked"),d.attr("disabled",!1),c.find(".hide-prices-note").hide())):a.options&&a.options.wraps&&1<a.options.wraps.length&&(d=c.find(".popover-gift-amazon-wrap"),
y(c,d),ba(a,"afn",d))):(c.find(".wrap-option").hide(),T(c.find(".hide-prices-checkbox")).removeAttr("disabled"),c.find(".hide-prices-amazon-msg").hide(),c.find(".hide-prices-note").hide(),c.find(".hide-prices-merchant-msg").show(),c.find(".large-preview").hide(),d=c.find(".popover-gift-merchant-wrap").show(),d.find(".mfn-wrap-copy").remove(),ba(a,"mfn",d));ea&&(P(),G(),C());if(0<J(".enable-gift-connections").length){c.find("#popover-gift-connection select.a-touch-select-input").each(function(){J(this).unbind("change").bind("change",
function(){var a=J(this),b=a.siblings("a.a-placeholder"),a=a.find(":selected").text();b.text(a);return!1})});c.find("#select-recipient").bind("change",function(a){O(a);return!1});c.find("#select-occasion").bind("change",function(a){sa(a);return!1});c.find("#input-recipient-first-name").keyup(function(){da()});c.find("#input-recipient-last-name").keyup(function(){da()});c.find("#popover-gift-connection-recipient").unbind("click").bind("click",function(a){a=U;ua||a.find("#select-recipient-spinner").show()});
va=D;if(a.giftConnection){typeof a.giftConnection.giftlistTypeId!==D&&"0"===a.giftConnection.giftlistTypeId&&typeof a.giftConnection.occasionId!==D&&"0"===a.giftConnection.occasionId&&c.find("#include-gift-connection-checkbox").attr("checked",!1);a.giftConnection.firstName&&c.find("#input-recipient-first-name").val(a.giftConnection.firstName);a.giftConnection.lastName&&c.find("#input-recipient-last-name").val(a.giftConnection.lastName);if("1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)d=
c.find('#select-recipient option[value\x3d"'+a.giftConnection.giftlistTypeId+'"]').attr("selected","selected"),c.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(d.text()),c.find(".gift-connection-recipient-extra").show();if(a.giftConnection.giftlistId&&"0"!==a.giftConnection.giftlistId)va=a.giftConnection.giftlistId;else if("0"===a.giftConnection.giftlistTypeId||"1"===a.giftConnection.giftlistTypeId||"2"===a.giftConnection.giftlistTypeId)va=a.giftConnection.giftlistTypeId;
a.giftConnection.occasionId&&(d=c.find('#select-occasion option[value\x3d"'+a.giftConnection.occasionId+'"]').attr("selected","selected"),c.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(d.text()));a.giftConnection.occasionMonth&&(d=c.find('#select-occasion-month option[value\x3d"'+a.giftConnection.occasionMonth+'"]').attr("selected","selected"),c.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(d.text()));a.giftConnection.occasionDay&&
(d=c.find('#select-occasion-day option[value\x3d"'+a.giftConnection.occasionDay+'"]').attr("selected","selected"),c.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(d.text()));a.giftConnection.age&&(d=c.find('#select-occasion-age option[value\x3d"'+a.giftConnection.age+'"]').attr("selected","selected"),c.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(d.text()));if("1"===a.giftConnection.occasionId||"2"===a.giftConnection.occasionId)c.find(".gift-connection-occasion-extra").show(),
"2"===a.giftConnection.giftlistTypeId&&c.find("#select-occasion-age-row").show();a.giftConnection.hasReminder&&"0"===a.giftConnection.hasReminder&&c.find("#occasion-has-reminder-checkbox").attr("checked",!1)}(!a.giftConnection||typeof a.giftConnection.occasionId===D||"1"!==a.giftConnection.occasionId&&"2"!==a.giftConnection.occasionId&&"3"!==a.giftConnection.occasionId)&&da();ja&&(typeof va!==D||a.registryId in xa)?(typeof va===D&&(va=xa[a.registryId]),b(),c.find("#select-recipient").show(),c.find("#select-recipient-spinner").hide(),
ua=!0):(ua=!1,typeof va!==D?ta():ta(a.registryId))}U.find(".content-container").css("visibility","visible");ya.updatePosition(!0);k.hideSpinner(c.find(".popover-content-main"))}function r(a){var b=U,d="";if(!(0<b.find(".validateInputCharactersOnBlur.a-form-error").size())){a&&a.data&&a.data.obfuscatedentityid&&(d+="obfuscatedEntityId\x3d"+a.data.obfuscatedentityid+"\x26");ia&&(d+="isAFN\x3d1\x26");T(b.find(".include-gift-receipt-checkbox")).is(":checked")&&(d+="includeReceipt\x3d1\x26");T(b.find(".include-gift-message-checkbox")).is(":checked")?
(d+="includeMessage\x3d1\x26message\x3d"+encodeURIComponent(b.find("textarea[name\x3d'gift-message-text']").val())+"\x26",d+="maxChars\x3d"+a.data.giftData.options.maxMessageChars+"\x26",d+="maxLines\x3d"+a.data.giftData.options.maxMessageLines+"\x26"):d+="includeMessage\x3d0\x26";d=T(b.find(".hide-prices-checkbox")).is(":checked")?d+"hidePrices\x3d1\x26":d+"hidePrices\x3d0\x26";b.find(".kindle-registration-box").is(":visible")&&(d+="isKindlePurchase\x3d1\x26");var e;if(b.find(".popover-gift-fba-wrap").is(":visible"))if(b.find(".popover-gift-amazon-wrap").is(":visible")){if((e=
b.find("input[name\x3d'afn-gift-wrap']:checked").eq(0).val())&&e.length)for(d+="giftWrap\x3d"+e+"\x26",e=0;e<a.data.giftData.options.wraps.length;e++)if(b.find(".popover-gift-amazon-wrap").find(".afn-wrap-"+e).is(":checked")){d+="currencyAmount\x3d"+a.data.giftData.options.wraps[e].priceAmount+"\x26";d+="currencyUnit\x3d"+a.data.giftData.options.wraps[e].unit+"\x26";break}}else e=T(b.find(".amazon-gift-wrap")),e.is(":checked")&&(d+="giftWrap\x3d"+e.val()+"\x26",a.data.giftData.options&&(d+="currencyAmount\x3d"+
a.data.giftData.options.wraps[0].priceAmount+"\x26",d+="currencyUnit\x3d"+a.data.giftData.options.wraps[0].unit+"\x26"));else if(b.find(".popover-gift-merchant-wrap").is(":visible")&&(e=b.find("input[name\x3d'mfn-gift-wrap']:checked").eq(0).val())&&e.length)for(d+="giftWrap\x3d"+e+"\x26",e=0;e<a.data.giftData.options.wraps.length;e++)if(b.find(".popover-gift-merchant-wrap").find(".mfn-wrap-"+e).is(":checked")){d+="currencyAmount\x3d"+a.data.giftData.options.wraps[e].priceAmount+"\x26";d+="currencyUnit\x3d"+
a.data.giftData.options.wraps[e].unit+"\x26";break}if(0<J(".enable-gift-connections").length)if(b.find("#include-gift-connection-checkbox").is(":checked")){d+="includeGiftConnection\x3d1\x26";a=b.find("#select-recipient").val();d+="gcGiftlistTypeId\x3d"+a+"\x26";if("1"===a||"2"===a)d+="gcFirstName\x3d"+b.find("#input-recipient-first-name").val()+"\x26",d+="gcLastName\x3d"+b.find("#input-recipient-last-name").val()+"\x26";e=b.find("#select-occasion").val();d+="gcOccasionId\x3d"+e+"\x26";if("1"===e||
"2"===e)d+="gcMonth\x3d"+b.find("#select-occasion-month").val()+"\x26",d+="gcDay\x3d"+b.find("#select-occasion-day").val()+"\x26","1"===e&&"2"===a&&(d+="gcAge\x3d"+b.find("#select-occasion-age").val()+"\x26"),d+="gcHasReminder\x3d"+(b.find("#occasion-has-reminder-checkbox").is(":checked")?"1":"0")+"\x26"}else d+="includeGiftConnection\x3d0\x26";(a=J("input#executionId").val())&&(d+="executionId\x3d"+a+"\x26");a=(new Date).getTime();d+="isClientTimeBased\x3d"+J("input[name\x3d'useCtb']").val()+"\x26returnjson\x3d1\x26isDecoupleSPC\x3d1\x26hasWorkingJavascript\x3d1\x26returnFullHTML\x3d1\x26cachebuster\x3d"+
a;f.isSPP()&&(ya.hide(),a=J("#setOrderingPrefsCheckbox"),a.length&&a.is(":checked")&&(d+="\x26saveAsDefaultsSelected\x3d1"));m.show();a=f.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"});J.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/update-gift.html",data:d,dataType:"text",async:!0,cache:!1,headers:a,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,d,e){e.getResponseHeader("x-amz-checkout-page")?(f.isSPP()||b.find(".a-button-close").trigger("click"),
f.ajaxUpdatePage(a,d,e)):(a=c.jsonify(a),f.redirect(a))},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}}function y(a,b){a.find(".fba-wrap-checkbox").hide();a.find(".large-preview").hide();b.show();b.find(".afn-wrap-copy").remove()}function w(){var a=U,b=a.find(".popover-gift-amazon-wrap").is(":visible"),c=T(a.find(".amazon-gift-wrap")),d=T(a.find(".afn-wrap-none")),e=T(a.find(".hide-prices-checkbox"));if(c.is(":checked")||!d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!0),a.find(".hide-prices-note").show();
else if(c.not(":checked")||d.is(":checked")&&b)e.attr("checked",!0),e.attr("disabled",!1),a.find(".hide-prices-note").hide()}function v(a){var b=U,c=T(b.find(".include-gift-receipt-checkbox")),b=T(b.find(".mfn-hide-prices-checkbox"));a?(ia&&!c.is(":checked")&&c.attr("checked",!0).trigger("change"),ia||b.is(":checked")||b.attr("checked",!0).trigger("change")):(ia&&c.is(":checked")&&c.removeAttr("checked").trigger("change"),!ia&&b.is(":checked")&&b.removeAttr("checked").trigger("change"))}function n(a){var b=
U,c=T(b.find(".include-gift-receipt-checkbox")),b=T(b.find(".mfn-hide-prices-checkbox"));a?(v(!0),ia?c.attr("disabled","disabled"):b.attr("disabled","disabled")):ia?c.removeAttr("disabled"):b.removeAttr("disabled")}function u(a){var b=T(U.find(".include-gift-message-checkbox"));a?(b.is(":checked")||b.attr("checked",!0).trigger("change"),K(!1),A()):(b.is(":checked")&&b.removeAttr("checked").trigger("change"),L())}function K(a){var b=U,c=b.find(".no-message-warning"),e=b.find(".no-receipt-warning"),
f=b.find("textarea[name\x3d'gift-message-text']"),b=b.find(".message-remaining-text");a&&!e.is(":visible")?(d.showGiftTextAreaOnWarning()||f.addClass("gift-message-warning"),b.hide(),c.show()):(d.showGiftTextAreaOnWarning()||f.removeClass("gift-message-warning"),c.hide(),b.show())}function A(){var a=U,b=a.find("textarea[name\x3d'gift-message-text']"),a=a.find(".gift-message-label");b.removeClass("gift-message-inactive");a.removeClass("a-color-secondary")}function L(){var a=U,b=a.find("textarea[name\x3d'gift-message-text']"),
a=a.find(".gift-message-label");b.addClass("gift-message-inactive");a.addClass("a-color-secondary")}function C(){var b=U,c=T(b.find(".include-gift-message-checkbox")),d=b.find(".gift-msg-on-card"),e=b.find(".gift-msg-on-receipt"),f=a.trim(b.find(".gift-message-default-placeholder").text()),n=a.trim(b.find(".gift-message-with-wrap-placeholder").text()),h=b.find("textarea"),g=!1;b.find(".amazon-gift-wrap").each(function(){T(J(this)).is(":checked")&&(g=!0)});b.find(".afn-gift-wrap").each(function(){T(J(this)).is(":checked")&&
(g=!0)});b.find(".mfn-gift-wrap").each(function(){T(J(this)).is(":checked")&&(g=!0)});g?(e.hide(),d.show(),h.attr("placeholder",n),ia&&(u(!0),Ga&&c.attr("disabled","disabled"))):(d.hide(),ia&&e.show(),h.attr("placeholder",f),c.removeAttr("disabled"))}function H(){var a=U,b=T(a.find(".include-gift-message-checkbox")),a=a.find("textarea[name\x3d'gift-message-text']");!qa&&ia&&(b.is(":checked")&&0<a.val().length?K(!1):K(!0))}function N(){var a=U,b=T(a.find(".include-gift-receipt-checkbox")),c=a.find(".no-receipt-warning"),
a=a.find(".no-message-warning");b.is(":checked")?(c.hide(),Ga||u(!0)):(a.hide(),c.show(),u(!1))}function P(a){a=U;var b=T(a.find(".include-gift-receipt-checkbox")),b=ia&&b.is(":checked"),c=T(a.find(".mfn-hide-prices-checkbox")),c=!ia&&c.is(":checked");b||c?(V(),a.find(".kindle-reg-msg-your-account").hide(),a.find(".kindle-reg-msg-another-account").show()):(X(),n(!1),a.find(".kindle-reg-msg-another-account").hide(),a.find(".kindle-reg-msg-your-account").show())}function G(a){a=U;var b=!1;T(a.find(".include-gift-message-checkbox")).is(":checked")&&
(b=!0);var c=!1;a.find(".amazon-gift-wrap").each(function(){T(J(this)).is(":checked")&&(c=!0)});a.find(".afn-gift-wrap").each(function(){T(J(this)).is(":checked")&&(c=!0)});a.find(".mfn-gift-wrap").each(function(){T(J(this)).is(":checked")&&(c=!0)});(b||c)&&v(!0);b&&Ga||c?n(!0):n(!1)}function M(a,b,c){var d=U;za=a;na=b;if(a=d.find("textarea[name\x3d'gift-message-text']")){b=c?a.val().length:q.unescape(encodeURIComponent(a.val())).length;ea&&!qa&&ia&&(0<b?K(!1):K(!0));var e=a.val().split("\n").length;
c=za-b;e=na-e;!ea&&0<b&&d.find(".include-gift-message-checkbox").not(":checked")&&d.find(".include-gift-message-checkbox").attr("checked",!0);a=a.val().split("\n");for(var n in a)24<a[n].length&&(e=0===a[n].length%24?e-(Math.floor(a[n].length/24)-1):e-Math.floor(a[n].length/24));d.find(".popover-gift-center .remainder-count").hide();(-1>c?d.find(".popover-gift-center .remaining-char-over-multiple").show():0>c?d.find(".popover-gift-center .remaining-char-over-single").show():1===c?d.find(".popover-gift-center .remaining-char-single").show():
d.find(".popover-gift-center .remaining-char-multiple").show()).find(".chars-remaining").html(Math.abs(c));(-1>e?d.find(".popover-gift-center .remaining-line-over-multiple").show():0>e?d.find(".popover-gift-center .remaining-line-over-single").show():1===e?d.find(".popover-gift-center .remaining-line-single").show():d.find(".popover-gift-center .remaining-line-multiple").show()).find(".lines-remaining").html(Math.abs(e));if(0>c||0>e)f.isSPP()?(d.find(".set-gift-options-button").addClass("aok-hidden"),
d.find(".set-gift-options-button-disabled").removeClass("aok-hidden")):(d.find(".set-gift-options-button").hide(),d.find(".set-gift-options-button-disabled").show()),0>c?(d.find(".gift-char-limit-error").find(".char-limit-error").html(za),d.find(".current-blocker-content").html(d.find(".gift-char-limit-error").html())):0>e&&(d.find(".gift-line-limit-error").find(".line-limit-error").html(na),d.find(".current-blocker-content").html(d.find(".gift-line-limit-error").html()));-1<c&&-1<e&&(f.isSPP()?(d.find(".set-gift-options-button").removeClass("aok-hidden"),
d.find(".set-gift-options-button-disabled").addClass("aok-hidden")):(d.find(".set-gift-options-button").show(),d.find(".set-gift-options-button-disabled").hide()))}}function Q(a){a.stopPropagation();var b=U;b.find(".popover-content-main").fadeOut(100,function(){b.find(".popover-content-gift-wrap-preview .gift-wrap-preview-image").attr("src",a.data.imageURL);b.find(".popover-content-gift-wrap-preview").fadeIn(100)});var c=b.find(".popover-content-gift-wrap-preview .back-to-gift-options-button");c.unbind("click").bind("click",
E);g.bindActionEnterKeyOnButton(c);Aa=!0}function E(a){Aa=!1;var b=U;a?b.find(".popover-content-gift-wrap-preview").fadeOut(100,function(){b.find(".popover-content-main").fadeIn(100)}):setTimeout(function(){b.find(".popover-content-gift-wrap-preview").hide();b.find(".popover-content-main").show()},500)}function F(a){var b=U,c=!1;J(".amazon-gift-wrap").each(function(){T(J(this)).is(":checked")&&(c=!0)});J(".afn-gift-wrap").each(function(){T(J(this)).is(":checked")&&(c=!0)});J(".mfn-gift-wrap").each(function(){T(J(this)).is(":checked")&&
(c=!0)});if(c)V(),aa();else if(T(b.find(".hide-prices-checkbox")).is(":disabled"))Z();else if(a.is("input[type\x3dcheckbox]")&&(a.closest(".a-checkbox").hasClass("hide-prices-checkbox")||a.hasClass("hide-prices-checkbox")))a.is(":checked")?V():X();else if(f.isSPP())(b=a.closest(".a-radio"))&&a.is(":checked")&&(b.hasClass("kindle-reg-radio-your-account")?X():b.hasClass("kindle-reg-radio-another-account")&&V());else if(a.hasClass("kindle-reg-radio-another-account")||a.hasClass("kindle-reg-radio-your-account"))b.find(".kindle-reg-radio-your-account").is(":checked")?
X():V()}function V(){var a=U,b=T(a.find(".hide-prices-checkbox"));b.is(":checked")&&!f.isSPP()||b.attr("checked","checked");T(a.find(".kindle-reg-radio-your-account")).is(":checked")&&T(a.find(".kindle-reg-radio-another-account")).attr("checked",!0)}function X(){var a=U,b=T(a.find(".hide-prices-checkbox"));b.is(":checked")&&b.removeAttr("checked");T(a.find(".kindle-reg-radio-another-account")).is(":checked")&&T(a.find(".kindle-reg-radio-your-account")).attr("checked",!0)}function aa(){var a=U;T(a.find(".hide-prices-checkbox")).attr("disabled",
"true");T(a.find(".kindle-reg-radio-another-account")).attr("disabled",!0);T(a.find(".kindle-reg-radio-your-account")).attr("disabled",!0);a.find(".hide-prices-merchant-cant").is(":visible")||a.find(".hide-prices-note").show()}function Z(){var a=U;T(a.find(".hide-prices-checkbox")).removeAttr("disabled");T(a.find(".kindle-reg-radio-another-account")).removeAttr("disabled");T(a.find(".kindle-reg-radio-your-account")).removeAttr("disabled");a.find(".hide-prices-note").hide()}function fa(a){var b=g.getPosition(a,
"#",2),c=g.getPosition(a,"#",3);return"60"===a.substring(b+1,c)}function Y(b,c,e){var f=R(),n,h;f?(n=e.find('li[class\x3d"a-carousel-card gift-wrap noshi-wrap none-wrap"]'),h=e.find(".carousel-gift-wrap").find("ol")):(n=e.find("."+c+"-wrap-template"),h=e.find("ul.allGiftWrapList"));f&&a.trigger("checkout:gift:removeEmptyCarouselCards",h);var g=(e.data("lineitemid")||b.obfuscatedEntityId||"").replace(":","-");"afn"!==c||f||(h.find('li[class!\x3d"none-wrap gift-wrap noshi-wrap"]').remove(),J("#giftwrap-carousel-wrap-holder-"+
g).css("width",90*(b.options.wraps.length+1)),J("#giftwrap-carousel-wrap-pane-"+g).css("width",360));for(var p=U,k=p.find(".larger-image-link-carousel-template"),l=0;l<b.options.wraps.length;l++){var m=n.clone(!0).removeClass(c+"-wrap-template").addClass(c+"-wrap-copy"),t=k.clone(!0).removeClass("larger-image-link-carousel-template").addClass("larger-image-link-carousel-"+l),u=c,q=b,x=l,v=m,r=t,z=q.options.wraps[x].id;v.find("input").addClass(u+"-wrap-"+x).val(z);v.find("label").attr("for",u+"-wrap-"+
x);z=q.options.wraps[x].description;v.find("."+u+"-wrap-description").html(z);z=q.options.wraps[x].price;v.find("."+u+"-wrap-price").html(z);(q=q.options.wraps[x].imageurl)&&q.length?(v.find("."+u+"-image").attr("src",q).show(),u=v.find(".larger-image-link"),u.show(),u.unbind("click").bind("click",{imageURL:q},Q),r.unbind("click").bind("click",{imageURL:q},Q),r.find("a").unbind("click").bind("click",{imageURL:q},Q)):"mfn"!==u||R()||(v.find(".a-span3").hide(),v.find(".a-span9").addClass("a-span12").removeClass("a-span9"),
v.find(".a-color-price").removeClass("wrap-price"));if("afn"===c){x=b;r=l;v=g;u=h;q=p;z=x.options.wraps[r].id;m.data("giftwrap-id",z);m.data("wrap-no",r);if(x.selected.wrap===z){u.find("li.none-wrap").find("img").removeClass("selected-giftwrap-image");m.find("img").addClass("selected-giftwrap-image");var x=m.find("img").attr("src"),A=J("#giftwrap-option-preview-imagearea-image-"+v);A.find("img").attr("src",x);A.removeClass("aok-hidden");J("#giftwrap-option-preview-imagearea-default-"+v).addClass("aok-hidden");
F(m.find("input"));w();d.isNoshiGiftMessageEnabled()||fa(z)&&ka(v);t.removeClass("aok-hidden");t.addClass("selectedWrapLargeLink")}R()?(v=fa(z)?"gift-wrap":"noshi-wrap",m.removeClass(v).removeClass("none-wrap"),u.append(m.show())):(v=fa(z)?"\x3cli class\x3dnoshi-wrap\x3e":"\x3cli class\x3dgift-wrap\x3e",u.append(J(v).append(m.show())));m=q.find("#carousel-larger-image-div");m.find(".larger-image-link-carousel-"+r).length||m.append(t.show())}}e.find("."+c+"-wrap-checkbox").removeAttr("checked");b.selected&&
b.selected.isWrapped?e.find("input[value\x3d'"+b.selected.wrap+"']").attr("checked",!0):T(e.find("."+c+"-wrap-none")).attr("checked",!0);f&&a.trigger("checkout:gift:adjustCarouselInitial",b,e)}function R(){return f.isSPP()&&J("input[name\x3dsppGiftPopoverWithCarousel]").length}function ba(a,b,c){for(var d=c.find("."+b+"-wrap-template"),e=0;e<a.options.wraps.length;e++){var n=d.clone(!0).removeClass(b+"-wrap-template").addClass(b+"-wrap-copy"),h=a.options.wraps[e].id;n.find("input").addClass(b+"-wrap-"+
e).val(h);n.find("label").attr("for",b+"-wrap-"+e);h=a.options.wraps[e].description;n.find("."+b+"-wrap-description").html(h);h=a.options.wraps[e].price;n.find("."+b+"-wrap-price").html(h);if((h=a.options.wraps[e].imageurl)&&h.length){var g=n.find("."+b+"-image");f.isSPP()&&g.removeClass("hidden");g.attr("src",h).show();g=n.find(".larger-image-link");f.isSPP()&&g.removeClass("hidden");g.show();g.unbind("click").bind("click",{imageURL:h},Q)}else n.find(".a-span3").hide(),n.find(".a-span9").addClass("a-span12").removeClass("a-span9"),
n.find(".a-color-price").removeClass("wrap-price");f.isSPP()&&n.removeClass("hidden");n.insertAfter(d).show()}c.find("."+b+"-wrap-checkbox").removeAttr("checked");a.selected&&a.selected.isWrapped?c.find("input[value\x3d'"+a.selected.wrap+"']").attr("checked",!0):T(c.find("."+b+"-wrap-none")).attr("checked",!0)}function ga(){U.find("#include-gift-connection-checkbox").attr("checked",!0)}function x(){if(U.find(".include-gift-connection-checkbox").not(":checked")){var a=U;a.find(".gift-connection-recipient-extra").hide();
var b;b=a.find('#select-recipient option[value\x3d"0"]').attr("selected","selected");a.find("#select-recipient").closest(".a-button-inner").find(".a-placeholder").text(b.text());a.find("#input-recipient-first-name").val("");a.find("#input-recipient-last-name").val("");da()}}function ha(a){for(var b=U,c=0;c<ja.length;c++)if(a&&a===ja[c].value&&ja[c].bMonth&&ja[c].bDay){var d;d=b.find('#select-occasion-month option[value\x3d"'+ja[c].bMonth+'"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(d.text());
d=b.find('#select-occasion-day option[value\x3d"'+ja[c].bDay+'"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(d.text())}}function da(){var a=U,b=a.find("#popover-gift-connection #select-recipient").find(":selected").val();if(""!==b&&"0"!==b&&("1"!==b&&"2"!==b||a.find("#input-recipient-first-name").val()||a.find("#input-recipient-last-name").val()))a.find("#select-occasion").prop("disabled",!1),a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:1});
else{b=U;b.find(".gift-connection-occasion-extra").hide();var c;c=b.find('#select-occasion option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-month option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-month").closest(".a-button-inner").find(".a-placeholder").text(c.text());c=b.find('#select-occasion-day option[value\x3d"0"]').attr("selected","selected");b.find("#select-occasion-day").closest(".a-button-inner").find(".a-placeholder").text(c.text());
c=b.find('#select-occasion-age option[value\x3d"-1"]').attr("selected","selected");b.find("#select-occasion-age").closest(".a-button-inner").find(".a-placeholder").text(c.text());b.find("#occasion-has-reminder-checkbox").attr("checked",!0);a.find("#select-occasion").prop("disabled",!0);a.find("#popover-gift-connection-occasion .a-touch-select").css({opacity:.5})}}function ma(a,b){var c=U;"1"===a&&"2"===b?c.find("#select-occasion-age-row").show():c.find("#select-occasion-age-row").hide()}function O(a){a=
U;var b=a.find("#popover-gift-connection #select-recipient").find(":selected").val(),c=a.find("#popover-gift-connection #select-occasion").find(":selected").val();!b||"1"!==b&&"2"!==b?(a.find(".gift-connection-recipient-extra").hide(),"1"===c&&b&&ha(b)):a.find(".gift-connection-recipient-extra").show();ma(c,b);da()}function sa(a){a=U;var b=a.find("#popover-gift-connection #select-occasion").find(":selected").val(),c=a.find("#popover-gift-connection #select-recipient").find(":selected").val();!b||
"1"!==b&&"2"!==b?a.find(".gift-connection-occasion-extra").hide():("1"===b&&c&&"1"!==c&&"2"!==c&&ha(c),a.find(".gift-connection-occasion-extra").show());ma(b,c)}function ta(a){var c=U,d="/gp/buy/pipeline/handlers/list-of-giftlists.html?escape\x3d0";ja&&(d+="\x26mappingOnly\x3d1");a&&(d+="\x26fromRegistryIds\x3d"+a);J.ajax({type:"POST",url:d,dataType:"json",async:!0,cache:!1,timeout:5E3,success:function(d){c.find("#select-recipient").hide();!ja&&d.options&&0<d.options.length&&(ja=d.options);a&&d.registryIdMapping?
(xa[a]=d.registryIdMapping[a],va=d.registryIdMapping[a]):a&&(xa[a]=D);ja&&b();c.find("#select-recipient").show();c.find("#select-recipient-spinner").hide();ua=!0},error:function(){c.find("#select-recipient").show();c.find("#select-recipient-spinner").hide();ua=!0}})}function W(b,c){var e=R(),f=c.lineItemId;c=R()?c.currentTab:b.data("current-tab");var n=J("#popover-gift-options-wrapper-"+f).data("active-tab");c!==n&&(b.parent().find(".selected-giftwrap-tab").removeClass("selected-giftwrap-tab"),b.addClass("selected-giftwrap-tab"),
b=J("#giftwrap-carousel-wrap-holder-"+f),e||b.css("left",0),n=J("#giftwrap-carousel-wrap-holder-"+f+" li"),e?(a.trigger("checkout:gift:changeCarouselWrapOptions",b,c,f),a.trigger("checkout:gift:adaptCarouselSPCPanel",f,c)):"all"===c?n.show():(n.hide(),n.filter("."+{"gift-wrap":"gift-wrap",noshi:"noshi-wrap"}[c]).show()),J("#popover-gift-options-wrapper-"+f).data("active-tab",c),n.find(".selected-giftwrap-image").removeClass("selected-giftwrap-image"),n.filter(".none-wrap").find("img").addClass("selected-giftwrap-image"),
J("#giftwrap-option-preview-imagearea-default-"+f).removeClass("aok-hidden"),J("#giftwrap-option-preview-imagearea-image-"+f).addClass("aok-hidden"),e=J("#allGiftWrapList-"+f).find(".none-wrap").find("input"),c=J(".selectedWrapLargeLink"),e.prop("checked",!0),e.val("").change(),d.isNoshiGiftMessageEnabled()||wa(f),c.length&&(c.addClass("aok-hidden"),c.removeClass("selectedWrapLargeLink")))}function Ca(a,b,c){c.$event.preventDefault();a=b.lineItemId;b=parseInt(J("#giftwrap-carousel-wrap-holder-"+a).css("left"),
10);0>b&&(b=b+90+"px",J("#giftwrap-carousel-wrap-holder-"+a).css("left",b))}function S(a,b,c){c.$event.preventDefault();a=b.lineItemId;var d=J("#allGiftWrapList-"+a);b=d.find("li").size();c=d.find("li.gift-wrap").size();var d=d.find("li.noshi-wrap").size(),e=J("#popover-gift-options-wrapper-"+a).data("active-tab"),f;"all"===e?f=b:"gift-wrap"===e?f=c:"noshi"===e&&(f=d);b=parseInt(J("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);b>-90*(f-4)&&(b=b-90+"px",J("#giftwrap-carousel-wrap-holder-"+a).css("left",
b))}function oa(a,b){var c=b.lineItemId;J("#allGiftWrapList-"+c).find(".selected-giftwrap-image").removeClass("selected-giftwrap-image");a.find(".afn-image").addClass("selected-giftwrap-image");b=a.parent();d.isNoshiGiftMessageEnabled()||(b.hasClass("noshi-wrap")&&!b.hasClass("none-wrap")?(ka(c),J("#afn-message-span-"+c).find("input").prop("checked",!1)):(wa(c),J("#afn-message-span-"+c).find("input").prop("checked",!0)));var e=a.data("giftwrap-id"),f=a.find("input"),n=a.data("wrap-no");f.prop("checked",
!0);f.val(e).change();e=J("#giftwrap-option-preview-imagearea-default-"+c);c=J("#giftwrap-option-preview-imagearea-image-"+c);f=J(".selectedWrapLargeLink");n=J(".larger-image-link-carousel-"+n);b.hasClass("none-wrap")?(e.removeClass("aok-hidden"),c.addClass("aok-hidden"),f.length&&(f.addClass("aok-hidden"),f.removeClass("selectedWrapLargeLink"))):(a=a.find("img").attr("src"),c.find("img").attr("src",a),e.addClass("aok-hidden"),c.removeClass("aok-hidden"),f.length&&(f.addClass("aok-hidden"),f.removeClass("selectedWrapLargeLink")),
n.length&&(n.addClass("selectedWrapLargeLink"),n.removeClass("aok-hidden")))}function ra(a,b){var c=b.lineItemId;b=J("#giftwrap-option-preview-imagearea-default-"+c);c=J("#giftwrap-option-preview-imagearea-image-"+c);a.hasClass("none-wrap")?(b.removeClass("aok-hidden"),c.addClass("aok-hidden")):(a=a.find("img").attr("src"),c.find("img").attr("src",a),b.addClass("aok-hidden"),c.removeClass("aok-hidden"))}function ca(a,b){var c=b.lineItemId;a=J("#giftwrap-option-preview-imagearea-default-"+c);b=J("#giftwrap-option-preview-imagearea-image-"+
c);J("#allGiftWrapList-"+c).find(".selected-giftwrap-image").parentsUntil("ul","li").hasClass("none-wrap")?(a.removeClass("aok-hidden"),b.addClass("aok-hidden")):(c=J("#allGiftWrapList-"+c).find(".selected-giftwrap-image").attr("src"),b.find("img").attr("src",c),a.addClass("aok-hidden"),b.removeClass("aok-hidden"))}function wa(a){var b=J("#afn-message-span-"+a+", #gift-message-"+a);J("#gift-message-noshi-warning-"+a).addClass("aok-hidden");b.removeClass("disable-message-area").addClass("enable-message-area");
b.find("input").removeAttr("disabled");b.find("textarea").removeAttr("disabled")}function ka(a){var b=J("#afn-message-span-"+a+", #gift-message-"+a);J("#gift-message-noshi-warning-"+a).removeClass("aok-hidden");b.removeClass("enable-message-area").addClass("disable-message-area");b.find("input").attr("disabled","disabled");b.find("textarea").attr("disabled","disabled")}var J=a.$;if(!J("html").hasClass("a-ie6")){var za,na,U,ya,Aa=!1,ea=!1,qa=!0,ia=!0,ja,ua=!1,xa={},va,Ga=!1;a.on("a:popover:hide",function(a){a.popover&&
a.popover.name&&0===a.popover.name.indexOf("gift-")&&(f.isSPP()&&e.increaseCount("checkout:spp-revieworder:gift_pop_cancel_sec",1),Aa&&E(),ea&&(a=U,a.find(".gift-msg-on-card").hide(),a.find(".popover-gift-warning").hide(),a.find(".message-remaining-text").show(),T(a.find(".amazon-gift-wrap")).removeAttr("checked"),u(!1),a.find('input[type\x3d"checkbox"]').removeAttr("disabled")))});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("gift-")){U=a.popover.$popover;
ya=a.popover;0<U.find(".include-gift-receipt-checkbox").length&&(ea=!0);k.showSpinner(U.find(".popover-content-main"),!1,ya);U.find(".content-container").css("visibility","hidden");a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var b=ya.data;if(b)a+="\x26obfuscatedEntityId\x3d"+b;else throw{name:"MissingData",message:"lineItemId is undefined"};}catch(d){q.ueLogError&&q.ueLogError(d,{logLevel:"FATAL",attribution:"gift-popover",message:"[No lineItemId to open the gift-popover with]. "})}J.ajax({type:"POST",
url:"/gp/buy/pipeline/handlers/gift-select-content.html",data:a,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},dataFilter:function(a){return c.jsonify(a)},success:function(a,b,c){a&&a.conductoraction&&a.conductoraction.url&&f.redirect(a);null!==a?t(a,b,c):f.ajaxRedirect()},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-gift"))b=U,a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text()),
a.popover.updatePosition(!0);else if(a.popover&&a.popover.$popover){var b=a.popover.$popover;a=b.find(".validateInputCharactersOnBlur.a-form-error");0<a.size()&&a.removeClass("a-form-error");b=b.find("#onblur-character-validation-error-gift-message-text");0<b.size()&&b.remove()}});var Da={enforceSelectorParity:F,enforceGiftReceiptParity:G,enforceHidePriceParity:P,disableHidePrice:w,toggleMessageBoxDisplay:C,toggleEmptyMsgWarning:H,toggleNoReceiptWarning:N,includeGiftConnection:ga,clearGiftConnection:x,
toggleGiftConnectionRecipientArea:O,toggleGiftConnectionOccasionArea:sa,updateGiftOptionsTabSelection:W,updateCarouselOnLeftClick:Ca,updateCarouselOnRightClick:S,updateSelectedGiftWrap:oa,updatePreviewImageOnMouseEnter:ra,updatePreviewImageOnMouseLeave:ca},T=h.getInput;a.declarative("gift-popover-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(Da[b[c]])Da[b[c]](a.$target,a.data)});a.declarative("gift-popover-element","click mouseenter mouseleave",
function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(Da[b[c]])Da[b[c]](a.$currentTarget,a.data,a)});a.declarative("spc-update-gift-options-tab-selection","click",function(a){var b=a.$target.parents("li");b.attr("data",a.data);W(b,a.data)});a.on("checkout:reload:spc",p);a.on("checkout:reload:spp-revieworder",p)}});"use strict";r.when("A","page-transition-controller","loading-spinner-controller","ajax-utility","page-conductor",
"checkout-general-utils","page-detector","client-side-metrics").register("concealment-popover-controller",function(a,m,k,c,f,g,l,e){function h(){t("#spc-orders").find(".concealment-widgets-desktop").removeClass("no-js-hide");a.defer(function(){t("#spc-orders").find(".concealment-popover-link").each(function(){t(this).data("action")&&t(this).removeAttr("href").attr("tabindex",0)})})}function d(a){return a.is("input")?a:a.find("input")}function b(a){var b=r;b.find(".fake-label").each(function(){t(this).unbind("click").bind("click",
function(){t(this).closest(".popover-checkbox").find("input").trigger("click")})});a&&a.item&&a.item.title&&b.find(".concealment-item-title").html(a.item.title);if(a&&a.obfuscatedEntityId){var c=b.find(".set-concealment-options-button input");c.unbind("click").bind("click",{obfuscatedentityid:a.obfuscatedEntityId,concealmentData:a,quantity:a.quantity},p);g.bindActionEnterKeyOnButton(c)}w=a&&a.item&&a.item.isAmazonFulfilled;a&&a.selected&&(c=d(b.find(".conceal-item-checkbox")),a.selected.concealItem?
c.attr("checked",!0):c.removeAttr("checked"));r.find(".content-container").css("visibility","visible");y.updatePosition(!0);k.hideSpinner(b.find(".popover-content-main"))}function p(a){var b=r,h="";a&&a.data&&a.data.obfuscatedentityid&&(h+="obfuscatedEntityId.0\x3d"+a.data.obfuscatedentityid+"\x26");a&&a.data&&a.data.quantity&&(h+="quantity.0\x3d"+a.data.quantity+"\x26");var g="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.saveConcealmentRefTag&&(g=a.data.concealmentData.saveConcealmentRefTag);
var p="";a&&a.data&&a.data.concealmentData&&a.data.concealmentData.cancelConcealmentRefTag&&(p=a.data.concealmentData.cancelConcealmentRefTag);(a=d(b.find(".conceal-item-checkbox")).is(":checked"))?(w&&(h+="isAFN.0\x3d1\x26"),h=h+"includeReceipt.0\x3d1\x26includeMessage.0\x3d1\x26"+("message.0\x3d"+encodeURIComponent(t("input[name\x3d'concealment-item-message']").val())+"\x26"),h=h+"hidePrices.0\x3d0\x26saveOnly\x3d1"+("ref\x3d"+g+"\x26")):h+="ref\x3d"+p+"\x26";var k=t("input#executionId").val();
k&&(h+="executionId\x3d"+k+"\x26");k="/gp/buy/gift/handlers/save-all.html/ref\x3d";a?(k+=g,e.increaseCount("CPEX.Checkout.Select.Concealment",1)):(k+=p,e.increaseCount("CPEX.Checkout.Cancel.Concealment",1));f.isSPP()&&(b.find(".a-button-close").trigger("click"),g=t("#setOrderingPrefsCheckbox"),g.length&&g.is(":checked")&&(h+="\x26saveAsDefaultsSelected\x3d1"));m.show();t.ajax({type:"POST",url:k,data:h,dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"},
contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,d,e){e.getResponseHeader("x-amz-checkout-page")?(f.isSPP()||b.find(".a-button-close").trigger("click"),f.ajaxUpdatePage(a,d,e)):(a=c.jsonify(a),f.redirect(a))},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}var t=a.$;if(!t("html").hasClass("a-ie6")){var r,y,w=!0;t(document).delegate(".concealment-popover-link, .concealment-options-button","click",function(){e.increaseCount("CPEX.Checkout.Concealment.Button.click",
1)});a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")&&(f.isSPP()&&e.increaseCount("checkout:spp-revieworder:concealment_pop_cancel_sec",1),d(r.find(".conceal-item-checkbox")).removeAttr("checked"))});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("concealment-")){r=a.popover.$popover;y=a.popover;k.showSpinner(r.find(".popover-content-main"),!1,y);r.find(".content-container").css("visibility","hidden");
a="returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isDecoupleSPC\x3d1\x26cachebuster\x3d"+(new Date).getTime();try{var d=y.data.lineItemEntityId,e=y.data.itemId;if(d)a+="\x26obfuscatedEntityId\x3d"+d;else if(e)a+="\x26lineItemEntityId\x3d"+e;else throw{name:"MissingData",message:"lineItemId is undefined"};var h=y.data.quantity;if(h)a+="\x26quantity\x3d"+h;else throw{name:"MissingData",message:"quantity is undefined"};}catch(g){q.ueLogError&&q.ueLogError(g,{logLevel:"FATAL",attribution:"concealment-popover",
message:"[Data missing to open the concealment-popover]. "})}d=y.data.ref;t.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/concealment-select-content.html/ref\x3d"+d,data:a+("\x26ref\x3d"+d),dataType:"text",async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},dataFilter:function(a){return c.jsonify(a)},success:function(a,c,d){a&&a.conductoraction&&a.conductoraction.url&&f.redirect(a);null!==a?b(a,c,d):f.ajaxRedirect()},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}});a.on("a:popover:beforeShow",
function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("button-blocker-concealment")){var b=r;a.popover.$popover.find(".a-popover-inner").html(b.find(".current-blocker-content").text());a.popover.updatePosition(!0)}});var v={};a.declarative("concealment-popover-element",["change"],function(a){var b;b=a.$event.isInit?a.data.onInit||[]:a.data.onChange||[];for(var c=0;c<b.length;c++)if(v[b[c]])v[b[c]](a.$target,a.data)});a.declarative("concealment-popover-element","click mouseenter mouseleave",
function(a){var b;if(b=a.data[{click:"onClick",mouseenter:"mouseEnter",mouseleave:"mouseLeave"}[a.type]])for(var c=0;c<b.length;c++)if(v[b[c]])v[b[c]](a.$currentTarget,a.data,a)});a.on("checkout:reload:spc",h);a.on("checkout:reload:spp-revieworder",h)}});"use strict";r.when("A","page-conductor","scroll-controller","page-detector","client-side-metrics","button-blocker").register("gold-box-controller",function(a,m,k,c,f,g){function l(){a.defer(h);a.defer(d)}var e=a.$;if(!e("html").hasClass("a-ie6")){var h=
function(){var a=e("#goldbox-countdown"),c=e("#spc-orders");c&&0!==c.length||(c=e("#spclite-items-block"));c=c.find("input[name\x3dgoldboxexpirelefttime]");if(0!==c.length){if(1<c.size()){var d=parseInt(c.attr("data-timeleftms"),10),h=c;e.each(c,function(){var a=e(this),b=parseInt(a.attr("data-timeleftms"),10);b<d&&(h=a,d=b)});c=h}var g=parseFloat(c.attr("data-pagestarttime")),l=parseFloat(c.attr("data-timeleftms")/1E3);if(!(isNaN(g)||isNaN(l)||0>=l)){var v=(new Date).getTime(),n=a.find("span[data-timefield\x3dminute]"),
u=a.find("span[data-timefield\x3dsecond]"),r=q.setInterval(function(){var c=(new Date).getTime();l-=(c-v)/1E3;v=c;if(0>l&&r)u.html("00"),q.clearInterval(r),r=null,m.isSPP()&&f.increaseCount("checkout:spp-revieworder:deal_expired",1),e("#gold-box-modal-launcher").trigger("click"),k.scrollToTop(),k.toggleScrollOff();else{var c=Math.floor(l/60%60),d=Math.floor(l%60),d=10>d?"0"+d:d;n.html(c);u.html(d);a.is(":visible")||a.show()}},1E3);m.isSPP()&&f.increaseCount("checkout:spp-revieworder:deal_countdown",
1)}}},d=function(){var a=e("#gold-box-button-blocker");1===a.length&&g.show("place-order-gold-box-blocker",a.attr("data-blocker-message"))};a.on("checkout:reload:spc",l);a.on("checkout:reload:spclite",l);a.on("checkout:reload:spp-revieworder",l)}});"use strict";r.when("A","page-transition-controller","ajax-utility","page-conductor","currency-formatter","page-detector","client-side-metrics","pay-rewards-currency").register("inline-points-controller",function(a,m,k,c,f,g,l,e){function h(){v("#spc-points-input")&&
v("#spc-points-input").data("points-used")&&(v("#points-applied").show(),v("#inline-points-button").hide());v("#inline-points-register")&&v("#inline-points-register").removeAttr("href");v("#spc-loyalty-points-input")&&v("#spc-loyalty-points-input").val()&&(v("#loyalty-points-applied").show(),v("#loyalty-points-button").hide());v("#spc-points-input")&&v("#spc-points-input").hasClass("show-currency-input-widget-new")&&v("#spc-points-input").each(function(b,c){var d=a.$(c);b={$element:d,maxAmount:d.data("max-dollar-amount")};
c={$element:a.$("#inline-raw-points"),decimalPlaces:d.data("decimal-places"),ratio:d.data("conversion-ratio")};var f=d.data("country-code"),f=e.getCurrencyFormatByCountryCode(f);e.initializeInlineFormatting(b,c,f);v(document).delegate("#spc-points-input","keydown",function(a){if(d.data("points-used")!==d.val){a=v("#inline-points-button");var b=!1;a.is("span")&&(b=!0);var c=a.find("span.apply"),e=a.find("span.change");v("#points-applied").hide();d.data("points-used")?(c.hide(),e.show()):(c.show(),
e.hide());b?a.addClass("display-inline-block"):a.show()}})})}function d(a,d){a.preventDefault();if(b(d)){c.isSPP()?(m.blockAllActions(),m.showTransitionInContainer(v("#payment"))):m.show();var e;a={"x-amz-checkout-page":"spc"};if(d)e=v("#loyalty-points-hidden-fields"),d="/gp/buy/spc/handlers/update-loyalty-points.html/ref\x3dox_spc_points_edit",e="\x26jpPointsPaymentInstrumentId\x3d"+encodeURIComponent(e.find("input[name\x3d'jpPointsPaymentInstrumentId']").val())+"\x26jpPointsCustomerRequestedAmount\x3d"+
v("#spc-loyalty-points-input").val()+"\x26jpPointsConversionRate\x3d"+e.find("input[name\x3d'jpPointsConversionRate']").val()+"\x26jpPointsBaseCurrencyCode\x3d"+e.find("input[name\x3d'jpPointsBaseCurrencyCode']").val()+"\x26jpPointsTargetCurrencyCode\x3d"+e.find("input[name\x3d'jpPointsTargetCurrencyCode']").val()+"\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+v("input[name\x3duseCtb]").val();else{a=c.setAjaxTransitionHeader(a);e=v("#inline-points-hidden-fields");var f=e.find("input[name\x3d'useGCBalance']").val();
d="/gp/buy/pipeline/handlers/update-reward-points.html/ref\x3d"+(c.isSPP()?"chk_pay_addswp_coll":"ox_pay_page_points_apply");e="paymentMethodId\x3d"+e.find("input[name\x3d'paymentMethodId']").val()+"\x26paymentMethodType\x3d"+e.find("input[name\x3d'paymentMethodType']").val()+"\x26rewardAccountId\x3d"+e.find("input[name\x3d'rewardAccountId']").val()+"\x26rewardAccountAmount\x3d"+v("#spc-points-input").val()+"\x26rewardAccountRate\x3d"+e.find("input[name\x3d'rewardAccountRate']").val()+"\x26useGCBalance\x3d"+
f+"\x26usePromoBalance\x3d"+f+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+v("input[name\x3duseCtb]").val()}v.ajax({type:"POST",url:d,data:e,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",headers:a,success:function(a,b,d){d.getResponseHeader("x-amz-checkout-page")?c.ajaxUpdatePage(a,b,d):(a=k.jsonify(a),c.redirect(a))},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}}function b(a){var b=!1,c=
v("input[name\x3drewardAccountAmount]"),d=v("#inline-points-error-block");a||v("#spc-points-input")&&!v("#spc-points-input").hasClass("show-currency-input-widget-new")?(a&&(c=v("input[name\x3dloyaltyPointsValue]"),d=v("#loyalty-points-error")),d.hide(),d.find("p").hide(),t(c))?q(c,a)?r(c,a)||(d.find("p").filter(function(){return"badMax"===v(this).data("error")}).show().css("display","inline"),b=!0):(d.find("p").filter(function(){return"badMin"===v(this).data("error")}).show().css("display","inline"),
b=!0):(d.find("p").filter(function(){return"badValue"===v(this).data("error")}).show().css("display","inline"),b=!0):a||q(c,a)||(d.find("p").filter(function(){return"badMin"===v(this).data("error")}).show().css("display","inline"),b=!0);if(b)return d.show(),c.addClass("a-form-error"),!1;c.removeClass("a-form-error");return!0}function p(a,b){var c=v(a.currentTarget),d=c.val();a=v("#inline-raw-points");b&&(a=v("#loyalty-points-applied-value"));var e=a.html();if(b)!/^\s*$/.test(d)&&!isNaN(d)&&0<d?a.html(d):
a.html(0);else if(!v("#spc-points-input").hasClass("show-currency-input-widget-new")){var h=c.data("min-dollar-amount");!/^\s*$/.test(d)&&!isNaN(d)&&0<d&&!isNaN(h)&&d>=h?(h=c.data("conversion-ratio"),c=c.data("decimal-places"),d=f.getNumberWithSeparators(d/h,c),a.html(d)):a.html(0)}(b||v("#points-applied").is(":visible"))&&e!==a.html()&&(a=v("#spc-loyalty-points-display"),e=v("#loyalty-points-applied"),d=v("#loyalty-points-button"),c=!1,b||(a=v("#inline-points-button"),a.is("span")&&(c=!0),e=a.find("span.apply"),
d=a.find("span.change"),v("#points-applied").hide()),e.hide(),d.show(),c?a.css("display","inline-block"):a.show())}function t(a){a=a.val();return/^\s*$/.test(a)||!isNaN(a)}function q(a,b){if(b)return!0;b=a.val();if(/^\s*$/.test(b))return!0;b=parseFloat(b);return isNaN(b)||!a.data("min-dollar-amount")?!0:0===b||b>=a.data("min-dollar-amount")}function r(a,b){var c=a.val();if(/^\s*$/.test(c))return!0;var c=parseFloat(c),d=a.data("max-dollar-amount");b&&(d=a.data("available-points"));return isNaN(c)||
!d?!0:c<=d}function w(a){switch(a.keyCode?a.keyCode:a.which){case 13:case 10:var b=v("#loyalty-points-button"),c=v("#spc-points-input");0<b.length&&b.is(":visible")?d(a,1):0<c.length&&d(a,0)}}var v=a.$;v("html").hasClass("a-ie6")||(v(document).delegate("#spc-loyalty-points-input","keypress",function(a){w(a)}),v("#spc-points-input")&&!v("#spc-points-input").hasClass("show-currency-input-widget-new")&&(v(document).delegate("#spc-points-input","keypress",function(a){w(a)}),v(document).delegate("#spc-points-input",
"keyup",function(a){p(a,0)})),v(document).delegate("#spc-loyalty-points-input","keyup",function(a){p(a,1)}),v(document).delegate("#inline-points-button","click",function(a){d(a,0)}),v(document).delegate("#loyalty-points-button","click",function(a){d(a,1)}),a.on("a:expander:apply-point-expander:toggle:expand",function(a){l.increaseCount("checkout:spp-payment:expand_addswp_coll",1)}),a.on("checkout:reload:spc",h),a.on("checkout:reload:spp-revieworder",h))});"use strict";r.when("A","client-side-metrics",
"ready").execute(function(a,m){var k=a.$;a.on("checkout:reload:spc",function(){var a=k("input[name\x3d'rewardsProgramId']").val(),f=k("input[name\x3d'swpWidgetCase']").val();a&&f&&m.increaseCount("Checkout::SPC::SWPWidgetCSM::"+a+"::"+f,1)})});"use strict";r.when("A","client-side-metrics","ready").execute(function(a,m){function k(){f||c.ajax({type:"POST",url:"/gp/shopwithpoints/temporaryPreference/verify-and-log-temporary-preference.html",data:{sourcePage:"SPC"},dataType:"text",async:!0,success:function(){f=
!0;m.increaseCount("Checkout::SPC::LogTemporaryPaymentPreferenceAppliedAjax::Success",1)},error:function(){m.increaseCount("Checkout::SPC::LogTemporaryPaymentPreferenceAppliedAjax::Failure",1)}})}var c=a.$,f=!1;a.on("checkout:reload:spc",k);a.on("checkout:reload:spclite",k);a.on("checkout:reload:spp-revieworder",k);a.on("checkout:reload:spp-collapsed",k)});"use strict";r.when("A","page-transition-controller","ajax-utility","page-conductor").register("inline-fps-balance-controller",function(a,m,k,
c){function f(a){a.preventDefault();g("#inline-fps-balance-checkbox").prop("disabled","disabled");c.isSPP()?(m.blockAllActions(),m.showTransitionInContainer(g("#payment"))):m.show();var e=g("#inline-fps-balance-hidden-fields"),f=0;g("#inline-fps-balance-checkbox").prop("checked")&&(f=1);a=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});var d="/gp/buy/pipeline/handlers/update-fps-balance.html/ref\x3d"+(c.isSPP()?"chk_pay_"+(f?"apply":"remmove")+"_fps_balance_coll":"ox_spc_page_fps_balance_apply"),
e="fpsPaymentMethodId\x3d"+e.find("input[name\x3d'fpsPaymentMethodId']").val()+"\x26useFlexiblePayments\x3d"+f+"\x26returnFullHTML\x3d1\x26returnjson\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+g("input[name\x3duseCtb]").val();g.ajax({type:"POST",url:d,data:e,dataType:"text",async:!0,cache:!1,headers:a,success:function(a,d,e){e.getResponseHeader("x-amz-checkout-page")?c.ajaxUpdatePage(a,d,e):(a=k.jsonify(a),c.redirect(a))},error:function(a,d,e){c.ajaxRedirect(a,d,e)}})}var g=a.$;g("html").hasClass("a-ie6")||
g(document).delegate("#inline-fps-balance-checkbox","click",function(a){f(a)})});"use strict";r.when("A","page-transition-controller","ajax-utility","page-conductor","checkout-general-utils","error-feature-detection","page-detector","client-side-metrics","weblab-helper","a-modal").register("shipping-speed-selection-controller",function(a,m,k,c,f,g,l,e,h,d){function b(){X?E("fieldset div.a-radio").addClass("a-touch-radio").removeClass("a-radio"):a.defer(function(){var a=E("#spc-orders").find("div.ship-option");
a.filter(".no-scheduled-delivery");a.each(function(){E(this).find("input.radio-image").remove()});a.each(function(){var a=E(this).find("input.radio-standard");a.attr("checked")&&a.attr("checked",!0)})});fa=E("#spc-orders").find("div.ship-option").find('input[type\x3d"radio"]:checked');p();g.markFeatureAvailable("shipping-speed-selection-controller");t()}function p(){var a=0<E("#trigger-case-call-to-resolve-cv").length||0<E(".force-resolve-invalid-ship-option").length;if(c.isSPP()&&a){var a=function(){var a=
q.setInterval(function(){c.isAnimating()||(m.show(),q.clearInterval(a))},50)},b=E("div.ship-option").filter(".call-set-to-resolve-cv").first().find("input[type\x3d'radio']");if(b&&b.length){var d=b.parents(".shipping-speeds").find("input.lineitemidinput[type\x3dhidden]").val();C(b,null,null,{transitionAction:a,refTag:"chk_revieworder_set_ship_option_no_default",extraData:{callingCASEResolveCV:1,lineItemIds:d}})}}}function t(){E("#buy-button-disabled-state").length&&r(function(a){y(a)})}function r(a){E("div.sd_widget_root").each(function(b,
c){a(c)})}function y(a){var b=setInterval(E.proxy(function(){if(E(this).hasClass("sd_widget_initialized")){var a=E(this),c=E(a).attr("id");c&&(a=w(a),a["ScheduledDeliveryEntity.startDeliveryDate"]&&C(null,c,a));q.clearInterval(b)}},a),1E3)}function w(a){var b={};v(a,function(a){var c=E(a).attr("key");a=E(a).val();b[c]=a||""});return b}function v(a,b){E(a).find("input[type\x3d'hidden']").each(function(a,c){b(c)})}function n(){F||(F=E("input[type\x3d'hidden'][name\x3d'scopeId']").val());return F}function u(a,
b,d){if(d.getResponseHeader("x-amz-checkout-page")){var e=k.jsonify(a);return e&&e.success&&e.trialkey&&V[e.trialkey]?(a=V[e.trialkey],c.isSPP()&&"object"===typeof a&&(a=JSON.stringify(V[e.trialkey])),h.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<E(".mobile-view").length?c.ajaxUpdatePage(a,b,d,{pushNewFrame:"false"}):c.ajaxUpdatePage(a,b,d),aa&&(clearTimeout(aa),aa=null),V={},!0):h.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<E(".mobile-view").length?c.ajaxUpdatePage(a,b,d,{pushNewFrame:"false"}):
c.ajaxUpdatePage(a,b,d)}return c.redirect(a)}function K(a,b){if(a){var c=a.data(b);if(c!==D)return c;(a=a.closest(".radio-standard"))&&(c=a.data(b));return c}}function A(a){a.closest("fieldset").find("i.a-icon-touch-radio-active").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");a.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive")}function L(a){var b=a;E(".shipping-group").each(function(a,c){var d=!1;E(c).parents().each(function(a,
b){return E(b).hasClass("shipment")?(d=!0,!1):!0});d||(b=b.add(c))});return b}function C(a,b,d,e){X&&A(a);e&&e.transitionAction?e.transitionAction():m.show();for(var f in Z)Z.hasOwnProperty(f)&&(Z[f].abort(),delete Z[f]);f=E("#spc-orders").find("input[type\x3d'hidden'][name\x3d'shiptrialprefix']").val();var g;a||(a=E("#"+b).closest(".shipping-speed").find("input[type\x3d'radio']"));g=a.closest(".shipment").data("orderid");a&&a.length&&a.hasClass("valid-btn")&&a.closest(".prime-calendar").hasClass("long-calendar")&&
(g=a.closest(".prime-calendar").data("orderid"));var k="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1";if(e&&e.extraData)for(var l in e.extraData)e.extraData.hasOwnProperty(l)&&(k+="\x26"+l+"\x3d"+e.extraData[l]);var p=E(".shipment"),t=0;l=p.length;p=L(p);k+="\x26groupsadded\x3d"+(p.length-l);p.each(function(c,e){var f=E(e),h="";c=f.has(".prime-calendar-container");e=f.find("input[name\x3d'currentshippingspeed']").attr("value");
var n=f.find("input[name\x3d'currentshipsplitpreference']").attr("value");1===p.length&&(k+="\x26oldoption\x3d"+e+"."+n);e=f.find("input[name\x3d'defaultshipsplitpreference."+t+"']").attr("value");n=f.find("input[name\x3d'usingprimeshipping."+t+"']").attr("value");e&&n&&(k+="\x26defaultshipsplitpreference."+t+"\x3d"+e,k+="\x26usingprimeshipping."+t+"\x3d"+n);e=f.find(".shipping-speed");e=a?e.find('input[type\x3d"radio"]:checked'):e.find("input[src*\x3dradio-on]");c&&!e.length&&(e=f.find("input[name\x3d'hiddenSelection"+
t+"']"));n=f.find(".ship-split-preferences").find("input[type\x3d'radio']:checked");1!==n.length&&(n=f.find(".ship-split-preferences").find("input[type\x3d'hidden'][name^\x3d'shippriority']"));g===f.data("orderid")&&(K(a,"shippingofferingid")?e=a:n=a,1===p.length&&(h=c?h+("\x26option\x3d"+e.data("key")+"."+(n?n.attr("value"):"")):h+("\x26option\x3d"+e.attr("value")+"."+(n?n.attr("value"):""))));var l=f.find("input[name\x3d'lineitemids"+t+"']");0<l.length&&(h+="\x26lineitemids"+t+"\x3d"+l.attr("value"));
h+=M(f,t);if(e.length){var f=e,m="",l=t;K(f,"rcxsspdecoupling")?(m={},m["shippingspeed"+l]=c?f.attr("key"):f.attr("value"),m["shippingofferingid"+l]=K(f,"shippingofferingid"),m["guaranteetype"+l]=K(f,"guaranteetype"),m["issss"+l]=K(f,"issss"),m["forceshipsplitpreference"+l]=K(f,"forceshipsplitpreference"),c="shipWhenComplete",n&&(c=n.attr("value")),1===K(f,"isscheduleddelivery")&&(m["isscheduleddelivery"+l]="1",c="shipWhenComplete"),m["shippriority"+l]=c,m["preferredSSP"+l]=K(f,"shipsplitpriority"),
m["currentSSP"+l]=n.attr("value"),m["isShipWheneverValid"+l]=K(f,"isshipwhenevervalid"),m["isShipWhenCompleteValid"+l]=K(f,"isshipwhencompletevalid"),m=E.param(m),c="\x26"+m):(m=c?m+("\x26shippingspeed"+l+"\x3d"+f.data("key")):m+("\x26shippingspeed"+l+"\x3d"+f.attr("value")),m+="\x26shippingofferingid"+l+"\x3d"+K(f,"shippingofferingid"),m+="\x26guaranteetype"+l+"\x3d"+K(f,"guaranteetype"),m+="\x26issss"+l+"\x3d"+K(f,"issss"),m+="\x26forceshipsplitpreference"+l+"\x3d"+K(f,"forceshipsplitpreference"),
c="shipWhenComplete",n&&(c=n.attr("value")),1===K(f,"isscheduleddelivery")&&(m+="\x26isscheduleddelivery"+l+"\x3d1",c="shipWhenComplete"),c=m+("\x26shippriority"+l+"\x3d"+c));h+=c;if(1===K(e,"isscheduleddelivery"))if(c=e.closest(".shipping-speed").find('[id^\x3d"sd_widgets_"]'),b&&d&&(b===c.attr("id")||b===D))for(var q in d)d.hasOwnProperty(q)&&(h+="\x26"+q+"."+t+"\x3d"+d[q]);else h+="\x26"+c.children(":input").serialize();else 1===K(e,"isscheduleddeliveryslot")&&K(e,"sddatastring")&&(h+="\x26ScheduledDeliveryEntity.data."+
t+"\x3d"+encodeURIComponent(e.data("sddatastring")))}else h+="\x26isdigital"+t+"\x3d1";t++;k+=h});0<t&&(k+="\x26groupcount\x3d"+t);l="ox_spc_set_ship_option";if(c.isSPP()){l="chk_revieworder_set_ship_option";var q=E("#setOrderingPrefsCheckbox");q.length&&q.is(":checked")&&(k+="\x26saveAsDefaultsSelected\x3d1")}q=E("input[name\x3duseCtb]").val();k+="\x26isClientTimeBased\x3d"+q;1===K(a,"istrial")?(f=n()+":"+a.attr("name")+":"+a.attr("value"),k+="\x26trialkey\x3d"+f,V[f]&&(aa&&clearTimeout(aa),l="ox_spc_set_cached_ship_option",
c.isSPP()&&(l="chk_revieworder_set_cached_ship_option"),k=k.replace("returnFullHTML\x3d1","returnFullHTML\x3d0"),k+="\x26trialSuccess\x3d1")):"undefined"!==typeof f&&(f=f+":"+a.attr("name")+":"+a.attr("value"),k+="\x26trialkey\x3d"+f);e&&e.refTag&&(l=e.refTag);e&&e.removeGiftOption&&(k+="\x26giftOrderid\x3d"+a.closest(".shipment").data("orderid"));0===k.indexOf("\x26")&&(k=k.substr(1));e="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+l;f=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});
h.isSPCMobileDisplayMoreShipOptionsEnabled()&&0<E(".mobile-view").length&&(f=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc","x-amz-checkout-transition":"ajax"}));E.ajax({type:"POST",url:e,data:k,dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){u(a,b,c)},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function H(a){var b=[a.closest(".shipment").data("orderid")];P(a,b)}function N(a){var b=[];E("#spc-orders").find(".shipment").each(function(a,c){b.push(a)});h.isFTCMobileUpsellBannerMetricsEnabled()&&
e.increaseCount("checkout:spc:mobile:same-day-upsell-banner:clicked",1);P(a,b)}function P(a,b){m.show();var d="returnpipedata\x3d0\x26returnFullHTML\x3d1\x26cachebuster\x3d"+(new Date).getTime()+"\x26hasWorkingJavascript\x3d1",e="/gp/buy/spc/handlers/set-delivery-options.html/ref\x3d"+a.data("reftag");E("#spc-orders").find(".shipment").each(function(c,e){d+="\x26lineitemids"+c+"\x3d"+E(e).find("input[type\x3d'hidden'][name\x3d'lineitemids"+c+"']").attr("value");d+=M(E(e),c);var f=E(e).find("input[type\x3d'hidden'][name^\x3d'shippriority']");
if(e=-1===b.indexOf(c)?E(e).find("#selected-ship-option-"+c):a)d+="\x26shippingofferingid"+c+"\x3d"+e.data("shippingofferingid"),d+="\x26guaranteetype"+c+"\x3d"+e.data("guaranteetype"),d+="\x26issss"+c+"\x3d"+e.data("issss"),d+="\x26forceshipsplitpreference"+c+"\x3d"+e.data("forceshipsplitpreference"),d+="\x26shippriority"+c+"\x3d"+e.data("targetshipoptionkey"),e.data("rcxsspdecoupling")&&(d+="\x26preferredSSP"+c+"\x3d"+e.data("shipsplitpriority"),d+="\x26currentSSP"+c+"\x3d"+f.attr("value"),d+="\x26isShipWheneverValid"+
c+"\x3d"+e.data("isshipwhenevervalid"),d+="\x26isShipWhenCompleteValid"+c+"\x3d"+e.data("isshipwhencompletevalid"))});var f=E("#spc-orders").find("input[type\x3d'hidden'][name\x3d'groupcount']").val(),d=d+("\x26groupcount\x3d"+f),d=d+("\x26isClientTimeBased\x3d"+E("input[type\x3d'hidden'][name\x3d'useCtb']").attr("value")),d=d+("\x26trialkey\x3d"+n()+":"+a.data("orderindex")+":"+a.data("targetshipoptionkey")),f=c.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});E.ajax({type:"POST",url:e,data:d,
dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){u(a,b,c)},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function G(b,c,d,e){f.protectAgainstDoubleAction(c)||R||(a.trigger(d,b),b=b.$currentTarget.find("a"),e&&e(b))}function M(a,b){var c=a.find("input[name\x3d'onOrAfterAppointment"+b+"']").val();a=a.find("input[name\x3d'onOrAfterLineItemId"+b+"']").val();var d="";c&&a&&(d=d+("\x26onOrAfterAppointment"+b+"\x3d"+c)+("\x26onOrAfterLineItemId"+b+"\x3d"+a));return d}function Q(){Y.closest("div.shipping-speed").find('input[type\x3d"radio"]').attr("checked",
!0);"undefined"!==typeof d?(0<E(".mobile-view").length?d.get(E("#faster-than-same-day-sosp-popover")):d.get(E("#faster-than-same-day-spc-popover"))).hide():a.$("div.a-popover button.a-button-close").trigger("click");C(Y,null,null,{removeGiftOption:!0})}var E=a.$;if(!E("html").hasClass("a-ie6")){var F,V={},X=E("html").hasClass("a-touch"),aa,Z={},fa,Y;q.spcpage.scheduledDeliverySetSOCallback=function(b,d){c.isSPP()&&a.objectIsEmpty(b)||(q.spcpage&&E("#spcpagecontent").is(":visible")?q.spcpage.actionSetShipOptions(null,
d,b):C(null,d,b))};q.spcpage.scheduledDeliveryEnableSOCallback=function(){};E(document).delegate(".ship-option","click",function(b){var c=E(b.target);h.isSPCMobileDisplayMoreShipOptionsEnabled()&&E(b.target).closest(".ship-option").hasClass("mobile-view")&&b.preventDefault();var g=E(b.currentTarget);e.resetMetrics();if(!(c.is('a[target\x3d"AmazonHelp"]')||c.is('a[target\x3d"PromoDetails"]')||c.hasClass("no-ship-option-selection-change")||g.is("input")||c.hasClass("a-button")||c.closest("a-button").length||
c.is("img")&&(c.closest("div").is(".prime-ship-speed")||c.closest(".prime-fake-radio").parent().is(".prime-ship-speed"))))if(c=g.find("div.prime-ship-speed"),0<c.length)c.find("a:first img").trigger("click");else if((c=g.find("input[type\x3d'image']").attr("src"))&&c.match(/radio-off/)&&E(".ap_popover_sprited").hide(),g=g.find("input[type\x3d'radio']"),(c=g.closest("div.shipping-speeds").data("sospargs"))&&1===g.data("isscheduleddelivery")&&!g.is(":checked"))m.show(),g.attr("checked",!0),A(g),f.redirectWithJavascript("/gp/buy/shipoptionselect/handlers/display.html?"+
c);else if(h.removesGiftOptionOnRush()&&0<g.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1===g.closest(".radio-standard").data("nosupportforgiftoption")){Y=g;Y.is(":checked")&&(Y.attr("checked",!1),fa.attr("checked",!0));var n=0<E(".mobile-view").length?E("#faster-than-same-day-sosp-popover"):E("#faster-than-same-day-spc-popover");"undefined"!==typeof d?d.get(n).show():a.delay(function(){n.trigger("click")},10)}else{g.hasClass("js-no-serverside-callback")&&(g.attr("checked",!0),
A(g),g.closest(".a-section-expander-container").find(".a-link-section-expander").click());var c=E("#disableSubmitButtons").length,l=!1;h.isSPCMobileDisplayMoreShipOptionsEnabled()&&(b=E(b.currentTarget).closest(".ship-option"),b.hasClass("mobile-view")&&!b.hasClass("mobile-selected-option")&&(l=!0));!c&&g.is(":checked")&&!l||1===g.data("isscheduleddelivery")||(g.attr("checked",!0),C(g))}});E(document).delegate(".ship-option input[type\x3d'radio']","change",function(a){if(!h.isSPCMobileDisplayMoreShipOptionsEnabled()||
!E(a.target).closest(".ship-option").hasClass("mobile-view")){a=E(a.currentTarget);var b=a.closest("div.prime-ship-speed");h.removesGiftOptionOnRush()&&0<a.closest(".shipment").find("input[name^\x3dItemIsGift]").length&&1===a.closest(".radio-standard").data("nosupportforgiftoption")||(0<b.length?b.find('input[type\x3d"radio"]').attr("checked",!1):1!==a.data("isscheduleddelivery")&&C(a))}});a.declarative("shipping-speed-expander-toggle",["click"],function(a){var b=a.$target.closest(".a-box"),c,d;b.hasClass("a-single")?
(c=b.find(".expanded-header-content"),d=b.find(".collapsed-header-content"),d.hide(),c.hasClass("prime-title")&&c.find("div").attr("style",""),c.show()):(d=b.find(".collapsed-header-content"),c=b.find(".expanded-header-content"),b=b.siblings(".a-expander-content").find(".a-icon-touch-radio-active").siblings(".a-radio-label").html(),d.html(b),c.hide(),d.show());f.toggleExpanderContent(a)});a.declarative("select-prime-slot",["click"],function(a){a=a.$currentTarget;E(".a-button-close").trigger("click");
a.closest(".valid-slot").hasClass("selected-slot")||C(a)});var R=!1;E(document).delegate(".mobile-upsell","touchmove",function(a){R=!0});E(document).delegate(".mobile-upsell","touchstart",function(a){R=!1});a.declarative("select-upsell-shipping-speed",["click","touchend"],function(a){G(a,"select-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select",H)});a.declarative("select-all-upsell-shipping-speed",["click","touchend"],function(a){G(a,"select-all-upsell-shipping-speed","a:checkout:mobile-upsell-shipping-speed:select-all",
N)});a.declarative("faster-than-same-day-save",["click"],Q);a.declarative("faster-than-same-day-sosp-save",["click"],Q);a.on("checkout:reload:spc",b);a.on("checkout:reload:spp-revieworder",b)}});"use strict";r.when("A","page-detector","spc-page-state","client-side-metrics","page-conductor","weblab-helper").register("order-summary-controller",function(a,m,k,c,f,g){function l(){r=b("#transactionalRadio");y=b("#marketplaceRadio");b("#tfx-see-exchange-rates");t=b("#tfx-switch-currency-options");p||(c.increaseCount("removeauijs15"),
b("#transactionalRadioImage").remove(),b("#marketplaceRadioImage").remove(),b("#acceptAccImage").remove());var a=b("#exchange-rate-link"),d=b("#switch-currency-link");if(0!==y.length){var f=t.find('input[name\x3d"switchCurrency"]'),h=f.not(":checked"),f=k.prop("currencyType")||f.filter(":checked").val();h.val()===f?h.parent().trigger("click"):e(f);p||(c.increaseCount("removeauijs16"),a.find("i.a-icon-collapse").remove(),d.find("i.a-icon-collapse").remove())}}function e(d){b(".tfx-currency").each(function(){b(this).text(b(this).data(d))});
k.prop("currencyType",d);var e=b("#subtotals-marketplace-table"),h=b("#subtotals-transactional-table"),g=b("#subtotals-marketplace-spp-bottom"),l=b("#subtotals-transactional-spp-bottom"),t=b("#vatRetailSubtotals-transactional-table"),q=b("#vatGlobalSubtotals-transactional-table"),C=b("#vatMerchantSubtotals-transactional-table"),H=b("#vatRetailSubtotals-marketplace-table"),D=b("#vatGlobalSubtotals-marketplace-table"),P=b("#vatMerchantSubtotals-marketplace-table"),G=b(".place-your-order-button"),M=
f.isSPP()?b(".place-order-button-text"):b(".place-your-order-button + span");f.isSPP()||setTimeout(function(){var a=Math.max(e.outerHeight(),h.outerHeight());0<a&&(e.height(a),h.height(a))},500);if(!p){c.increaseCount("removeauijs17");var Q=y.siblings("i"),E=r.siblings("i");if(Q.hasClass("a-icon-touch-radio-inactive")||Q.hasClass("a-icon-touch-radio-active"))"marketplace"===d?(Q.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),E.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive")):
(E.removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"),Q.removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive"))}"marketplace"===d?(b("#fxGoodNews-transactional").hide(),b("#fxGoodNews-marketplace").show(),h.hide(),e.show(),l.hide(),g.show(),t.hide(),q.hide(),C.hide(),H.show(),D.show(),P.show(),G.val(b("#placeYourOrderTextMarketplace").val()),p&&M.text(b("#placeYourOrderTextMarketplace").val()),b("#currencyChanged").attr("value","true"),b("#fxCurrencyChoice").attr("value",
"marketplace"),b("#tfx-total-header").addClass("aok-hidden"),b("#mkt-total-header").removeClass("aok-hidden")):(b("#fxGoodNews-transactional").show(),b("#fxGoodNews-marketplace").hide(),e.hide(),h.show(),g.hide(),l.show(),H.hide(),D.hide(),P.hide(),t.show(),q.show(),C.show(),G.val(b("#placeYourOrderTextTransactional").val()),p&&M.text(b("#placeYourOrderTextTransactional").val()),b("#currencyChanged").attr("value","false"),b("#fxCurrencyChoice").attr("value","transactional"),b("#mkt-total-header").addClass("aok-hidden"),
b("#tfx-total-header").removeClass("aok-hidden"));a.trigger("checkout:spc:ordersummary:sizeChanged");m.isMobileSpc()&&(g=b("#vatBreakdownNote"),0<g.size()&&(l=g.attr("href"),l=0<l.lastIndexOf(".html?")?l+("\x26currencyType\x3d"+d):l+("?currencyType\x3d"+d),g.attr("href",l)))}function h(a){var f=b("#tfx-footer"),h=b("#tfx-header");if(!p){c.increaseCount("removeauijs18");var g=b("#fxApplicabilityDecision").siblings("i"),l=b("#fxApplicabilityAdoption").siblings("i");if(l.hasClass("a-icon-touch-checkbox-inactive")||
l.hasClass("a-icon-touch-checkbox-active"))l.removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive"),g.removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active")}"accept"===a?(d()?(b("#fx-terms-and-conditions").show(),b("#fxCardCurrencySubcondition").hide()):(b("#fx-enable").show(),b("#fx-disable").hide()),b("#fxApplicabilityDecision").prop("checked",!0),h.show(),e("transactional"),f.show(),b("#marketplaceRadio").prop("checked",!1),b("#transactionalRadio").prop("checked",
!0),b("#fxApplicabilityChoice").attr("value","accept")):(d()?(b("#fx-terms-and-conditions").hide(),b("#fxCardCurrencySubcondition").show()):(b("#fx-enable").hide(),b("#fx-disable").show()),b("#fxApplicabilityAdoption").prop("checked",!1),h.hide(),e("marketplace"),f.hide(),b("#transactionalRadio").prop("checked",!1),b("#marketplaceRadio").prop("checked",!0),b("#fxApplicabilityChoice").attr("value","decline"))}function d(){return f.isSPP()&&b("input[name\x3disNewTFXExperienceEnabled]").length}var b=
a.$;if(!b("html").hasClass("a-ie6")){var p=q.P&&q.P.AUI_BUILD_DATE,t,r,y;g.isFixTfxCurrencyToggleEnabled()?(b(document).delegate("#transactionalRadio","click",function(){e("transactional")}),b(document).delegate("#marketplaceRadio","click",function(){e("marketplace")})):(b(document).delegate("#checkoutCurrencyTransactional","click",function(){e("transactional")}),b(document).delegate("#checkoutCurrencyMarketplace","click",function(){e("marketplace")}));b(document).delegate("#fxApplicabilityDecisionCheckbox",
"click",function(){h("decline")});b(document).delegate("#fxApplicabilityAdoptionCheckbox","click",function(){var a=d()&&!b("#fxApplicabilityAdoption").is(":checked");h(a?"decline":"accept")});a.on("a:expander:tfx-options-expander:toggle:expand",function(a){c.increaseCount("checkout:spp-ordersummary:expand_tfx_options",1)});a.on("a:expander:tfx-see-rate-expander:toggle:expand",function(a){c.increaseCount("checkout:spp-ordersummary:expand_tfx_see_rate",1)});return{changeCurrency:e,initOrderSummary:l}}});
"use strict";r.when("A","ready").register("spc-page-state",function(a){var m={};return{prop:function(a,c){if(a&&"string"===typeof a)return 1<arguments.length&&(m[a]=c),m[a]}}});"use strict";r.when("A","ready").execute(function(a){function m(){0<k("#spcCachedPromiseData").length&&(c=(new Date).getTime(),k(".place-your-order-button").click(function(){var a=(new Date).getTime()-c;k("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'spcWaitingTime' value\x3d'"+a+"' /\x3e")}))}var k=a.$,c=0;a.on("checkout:reload:spc",
m);a.on("checkout:reload:spclite",m);a.on("checkout:reload:spp-revieworder",m)});"use strict";r.when("A","page-transition-controller","scroll-controller","loading-spinner-controller","page-conductor","checkout-general-utils","ready").register("changeCustomerDetailsPopover",function(a,m,k,c,f,g){function l(){return 0<d("#onblur-character-validation-error-changeNameInput").size()}function e(){b&&b.find("button[data-action\x3da-popover-close]").trigger("click")}function h(){var a=d("#saveButton");if(a.length){var b=
d("#changeNameInput"),c=d("#changePostNumberInput"),e=d("#changePhoneInput"),f=1,h=1,g=1;b.length&&!b.val()&&(f=0);c.length&&!c.val()&&(h=0);e.length&&!e.val()&&(g=0);f&&h&&g&&!l()?(a.removeClass("a-button-disabled"),a.removeAttr("disabled")):(a.addClass("a-button-disabled"),a.attr("disabled","true"))}}var d=a.$,b;a.declarative("clickedsave","click submit",function(a){if(!l()){var b=d("#changeNameInput").val(),c=d("#changePhoneInput").val(),h=d("#changePostNumberInput").val(),g=d("#changeAccountNameCheckBox").is(":checked")?
1:0,k=d("#changePostNumberCheckBox").is(":checked")?1:0,b="custName\x3d"+encodeURIComponent(b)+"\x26changeAccountName\x3d"+encodeURIComponent(g);c&&(b=b+"\x26custPhoneNumber\x3d"+encodeURIComponent(c));h&&(b=b+"\x26dhlPostNumber\x3d"+encodeURIComponent(h),k&&(b=b+"\x26changeDhlPostNumberInEmbu\x3d"+encodeURIComponent(k)));c=a.data.changeDetailUrl;f.isSPP()&&(c=a.$target.data("changedetailurl"),d("#cancelReminderPopover").click());f.isSPP()||(b+="\x26usePipelineDispatch\x3d1");m.show();c&&d.ajax({type:"POST",
data:b,url:c,dataType:"html",contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",async:!0,cache:!1,headers:f.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"}),success:function(a,b,c){e();m.hide();f.ajaxUpdatePage(a,b,c)},error:function(a,b,c){f.ajaxRedirect(a,b,c)}})}});a.declarative("clickedsave","mouseenter mousemove touchstart",function(a){h()});a.declarative("changeNameKeyIn changePostNumberKeyIn changePhoneNumberKeyIn","keydown keyup change keypress mouseenter mouseleave mousemove",
function(a){h()});a.declarative("clickedcancel","click submit",function(a){e()});a.on("a:popover:beforeShow:changeDetailPopover",function(a){l()&&d("#onblur-character-validation-error-changeNameInput").remove()});a.on("a:popover:show:changeDetailPopover",function(a){if(!f.isSPP()){var c=d(q).width(),e=d(q).height(),c=parseInt(.6*c,10),e=parseInt(.7*e,10);b=a.popover.$popover;var g=a.popover;b.css("position","absolute");b.css("top","50px");b.css("height",e+"px");b.css("width",c+"px");g.updatePosition()}c=
f.isSPP()?a.popover.originalnamevalue:a.popover.$trigger.data("original-name-value");e=f.isSPP()?a.popover.originalcellphonevalue:a.popover.$trigger.data("original-cellphone-value");a=f.isSPP()?a.popover.originalpostnumbervalue:a.popover.$trigger.data("original-postnumber-value");var g=d("#changeNameInput"),l=d("#changePhoneInput"),k=d("#changePostNumberInput");g.val(c);l.val(e);k.val(a);h()})});"use strict";r.when("A","page-transition-controller","ajax-utility","page-conductor","page-detector","checkout-general-utils").register("prime-decline-controller",
function(a,m,k,c,f,g){function l(){h("input[name\x3d'changeCardNoEndDatePrime']").attr("data-action","prime-decline-element")}function e(a,b,e){if(e.getResponseHeader("x-amz-checkout-page"))c.ajaxUpdatePage(a,b,e);else{a=k.jsonify(a);if(!a)return c.redirect();a.error?m.hide():a.errors?m.hide():a.autohandlererror?(b=(a=a.autohandlererror)?a.action:null,e=a&&a.type?a.type:b&&b.code?b.code:"string"===typeof a?a:"Unknown:pipelineJSError",q.location.href="fatal"===b?"/gp/buy/payselect/handlers/error.html?errorAction\x3dfatal\x26errorType\x3d"+
encodeURIComponent(e):"redirect"===b?a.url:"/gp/buy/payselect/handlers/error.html?errorType\x3d"+encodeURIComponent(e)):c.redirect(a)}}var h=a.$;h("html").hasClass("a-ie6")||(a.declarative("prime-decline-element",["click","touchend"],function(a){g.protectAgainstDoubleAction("prime-decline-element")||(a.$event.preventDefault(),m.show(),a=(new Date).getTime(),a="changeCardNoEndDatePrime\x3d1\x26hasWorkingJavascript\x3d1\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26fromAnywhere\x3d"+h("input[name\x3dfromAnywhere]").val()+
"\x26cachebuster\x3d"+a,h.ajax({type:"POST",url:"/gp/buy/spc/handlers/stuff-handler.html/ref\x3dox_spc_prime_renew_nodate",data:a,headers:{"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"},contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:e,error:c.ajaxRedirect}))}),a.on("checkout:reload:spc",l),a.on("checkout:reload:spp-revieworder",l))});"use strict";r.when("A","loading-spinner-controller","page-conductor").register("prime-popover-controller",
function(a,m,k){function c(){g={};a.defer(function(){0!==f("#spc-orders").find(".prime-popover-link").length&&(f("#spc-orders").find(".prime-popover-link").each(function(){var a=f(this);if(a.data("action")){a.removeAttr("href").attr("tabindex",0);var c=a.data("aCheckoutModalPopover");var h=c.name,d="";c.width&&c.height&&(d="width:"+c.width+"px;height:"+c.height+"px;");0<f("#spc-orders").find("#"+h+"-popover").length||(c=f(['\x3cdiv id\x3d"a-popover-'+h+'" class\x3d"a-popover-preload" style\x3d"display:none;"\x3e',
'\x3cdiv id\x3d"'+h+'-popover" class\x3d"checkout" style\x3d"'+d+'"\x3e\x3c/div\x3e',"\x3c/div\x3e"].join("")),f("#spc-orders").append(c));a=a.data("aCheckoutModalPopover").name;g[a]||(c=f(".prime-popover-content").html())&&0<c.length&&(g[a]=c,f("#"+a+"-popover").html(c))}}),f("#spc-orders").find(".a-box").each(function(){var a=f(this),c=a.find(".prime-ad-banner-content .prime-popover-link");1<c.length&&(c=c.first());a.find("a.primeAdLauncher").each(function(){var a=f(this);a.wrap('\x3cspan class\x3d"a-declarative" data-action\x3d"prime-event" data-prime-event\x3d\'{"metric":"lm3"}\'\x3e\x3c/span\x3e');
a.replaceWith(c.clone().text(a.text()).addClass("a-size-mini"))})}))})}var f=a.$;if(!f("html").hasClass("a-ie6")){var g={};a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("prime")&&(a=a.popover.name,!g[a])){var c=f("input#primePopopverFallbackContent").val()||"";g[a]=c;f("#"+a+"-popover").html(c)}});a.on("checkout:reload:spc",c);a.on("checkout:reload:spp-revieworder",c)}});"use strict";r.when("A","page-transition-controller","back-button-protection","page-conductor",
"continue-wrapper-selector","weblab-helper").register("place-order-controller",function(a,m,k,c,f,g){function l(){if(!c.isAnimating()){var d=h("#spc-form");if("0"===h("#showPageTransition").attr("content"))if(d.hasClass("paylast-spc"))m.show();else{if(0<h("#enableAlternatePYOBlocker").length){var b;b=f.SELECTOR?h(f.SELECTOR):d.find(".a-button.continue-button");if("disabled"===b.find("input").attr("disabled"))return;b.find("input").attr("disabled","disabled");b.addClass("a-button-disabled");setTimeout(function(){b.removeClass("a-button-disabled");
b.find("input").removeAttr("disabled")},4E4)}}else m.showPageTransition();var e=h("#currencyChanged");0<e.length&&"true"===e.val()&&(e='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+h("#tfx-switch-currency-options").find("input:radio:checked").val()+'" /\x3e',h("#spc-form-inputs").append(e));if(g.isMfaPSD2DeviceDescriptionCollectionEnabled())for(var e=[{name:"javaEnabled",value:q&&q.navigator&&q.navigator.javaEnabled()},{name:"language",value:q&&q.navigator&&q.navigator.language},
{name:"screenColorDepth",value:q&&q.screen&&q.screen.colorDepth},{name:"screenHeight",value:q&&q.screen&&q.screen.height},{name:"screenWidth",value:q&&q.screen&&q.screen.width},{name:"timeZone",value:(new Date).getTimezoneOffset()}],l=0;l<e.length;l++)if(e[l].name!==D&&e[l].value!==D){var r='\x3cinput type\x3d"hidden" name\x3d"'+e[l].name+'" value\x3d"'+e[l].value+'" /\x3e';h("#spc-form-inputs").append(r)}d.append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");(e=a.state("firetv-aws-attributes"))&&
e.queryParams&&(l=d.attr("action"),l+=0<=l.indexOf("?")?"\x26":"?",l+=h.param(e.queryParams),d.attr("action",l));c.isSPP()&&d.append(h("#subtotalsSection").find("input").hide());k.markAsDirty();d.submit()}}function e(a){a.preventDefault();l(a.target)}var h=a.$;if(!h("html").hasClass("a-ie6"))return a.declarative("a-checkout-place-order",["click"],function(a){l(a.target)}),h(document).delegate("span.place-order-button-link","click",e),{placeOrderClick:l,placeOrderClickDelegate:e,PLACE_ORDER_BUTTON_LINK_SELECTOR:"span.place-order-button-link"}});
"use strict";r.register("continue-wrapper-selector",function(){return{SELECTOR:null}});"use strict";r.when("A","page-conductor","button-blocker","client-side-metrics","weblab-helper").register("verification-checkbox-controller",function(a,m,k,c,f){function g(a){w?l(a):e(a);v&&a&&a.blocking&&(c.setmarker("fn"),v=!1)}function l(a){var c=t(".continue-button"),d=t(".continue-button-blocker"),e=t(".place-order-blocker-message.custom-blocker-message");if(a.blocking||!b())a.blocking?(e.text(a.message),c.addClass("aok-hidden"),
d.removeClass("aok-hidden")):(e.empty(),c.removeClass("aok-hidden"),d.addClass("aok-hidden"),r.when("a-tooltip").execute(function(a){(a=a.get(d))&&a.isActive()&&a.hide()}))}function e(a){a.blocking?k.show("place-order-imb-checks",a.message):(k.hide("place-order-imb-checks"),t("#hasTVNavigation").length&&r.when("a-tv").execute(function(a){a.select(".continue-button")}))}function h(){var b,d={blocking:!1,message:""};if(w)b=t("#spc-imb").find(".verification-checkbox input:not(:checked)"),0<b.length&&
(d={blocking:!0,message:b.first().closest(".verification-checkbox").attr("data-blocker-message")});else{c.increaseCount("removeauijs23");if(!t("#spc-imb").find(".verification-checkbox").length)return;b=m.isSPP()?t("#spc-imb").find(".verification-checkbox input:not(:checked)"):t("#spc-imb").find(".verification-checkbox:not(:checked)");0<b.length&&(d={blocking:!0,message:m.isSPP()?b.first().closest(".spp-panel").hasClass("aok-hidden")?b.first().closest(".verification-checkbox").data("non-review-panel-blocker-msg"):
b.first().closest(".verification-checkbox").data("blocker-message"):b.first().attr("data-blocker-message")})}f.isPyoClientSideInitiationEnabled()?g(d):a.trigger("checkbox:primaryActionBlocker:blockingStateChanged",d)}function d(){var a=t("#wineNoticeCheckbox");a&&a.length&&(z?(a.attr("checked",""),y&&(a=a.siblings(".a-icon-touch-checkbox-inactive"))&&a.length&&(a.removeClass("a-icon-touch-checkbox-inactive"),a.addClass("a-icon-touch-checkbox-active"))):(a.removeAttr("checked",""),y&&(a=a.siblings(".a-icon-touch-checkbox-active"))&&
a.length&&(a.removeClass("a-icon-touch-checkbox-active"),a.addClass("a-icon-touch-checkbox-inactive"))))}function b(){var a=t("input[name\x3disINExpressCheckoutCC]");return a&&a.length?1===parseInt(a.val(),10):!1}function p(){f.isPyoClientSideInitiationEnabled()||d();t('[data-client-component\x3d"PrimaryActionBlockerCheckbox"]').length||(h(),f.isPyoClientSideInitiationEnabled()&&d());var a=q.P&&q.P.AUI_BUILD_DATE?'.verification-checkbox input[type\x3d"checkbox"]':"input.verification-checkbox";t("#spc-imb").find(a).unbind("change.verification-checkbox").bind("change.verification-checkbox",
h)}var t=a.$,z,y=t("html").hasClass("a-touch"),w=!m.isSPP()&&q.P&&q.P.AUI_BUILD_DATE,v=!0;if(!t("html").hasClass("a-ie6")){if(!f.isPyoClientSideInitiationEnabled())a.on("checkbox:primaryActionBlocker:blockingStateChanged",g);a.declarative("change-wine-notice-checkbox",["change"],function(a){z=a.$target.is(":checked")?1:0});a.on("checkout:reload:spc",p);a.on("checkout:reload:spclite",p);a.on("checkout:reload:spp-revieworder",p);a.on("checkout:reload:spp-collapsed",p);a.on("checkout:unload",function(){v=
!0});a.on("checkout:afterReload",function(){v=!1});return{verifyCheckboxes:h,updatePyo:g}}});"use strict";r.when("A","page-transition-controller","scroll-controller","ajax-utility","page-conductor","quantity-service","checkout-modal-popover","page-detector","checkout-general-utils","a-popover","client-side-metrics","weblab-helper").register("quantity-update-controller",function(a,m,k,c,f,g,l,e,h,d,b,p){function t(){aa=X=!1;a.defer(function(){var a=G("#spc-orders");a.find("a.quantity-change-button-static").remove();
"1"!==G("#spc-form-inputs").find("input[name\x3d'isQuantityInvariant']").val()&&a.find("div.quantity-value-static").remove()});G(".lineitem").each(function(a,b){a=G(b);a.find(".no-js-quantity").remove();b=a.find(".quantity-dropdown");b.is(":visible")?(a.find(".js-select").prop("disabled",!1),b.removeClass("a-button-disabled")):(a=a.find(".quantity-input"),a.prop("disabled",!1),a.removeClass("a-form-disabled"))});var c=G("#pantry-mov-popover-content"),d=G("#pantry-mov-popover-placeholder");!c.length&&
d.length&&(c=d.attr("data-device"),G.ajax({type:"GET",url:"/gp/pantry/checkout/mov/get-pantry-mov-popover-contents.html",data:"device\x3d"+c,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",success:function(a,c,e){~a.indexOf("pantry-mov-popover-content")?d.append(a):b.increaseCount("checkout:pantry:pantry_mov_popover_contents:bad-content",1)},error:function(a,c,d){b.increaseCount("checkout:pantry:pantry_mov_popover_contents:"+d,1)}}))}function z(a,
b){a=G('.update-quantity-error[data-itemid\x3d"'+a+'"]');a.find(".error-message").hide();a.find('.error-message[data-error-type\x3d"'+b+'"]').show();a.find("i").show();a.find(".a-span12").show();a.show();b=a.closest(".item-details-right-column");b.find(".spc-quantity-dropdown-button").addClass("a-button-error");b.find(".spc-quantity-input").addClass("a-form-error");b=a.parents("div.update-quantity-error");a=b.siblings(".item-details");0<a.length&&(a.find(".a-input-text-wrapper").addClass("a-form-error"),
a.removeClass("a-spacing-large"),a.find(".a-touch-select").addClass("a-input-text a-form-error"));b.show()}function y(a,e,g){var l=g.getResponseHeader("x-amz-checkout-new-cart-quantity");h.updateCartByMash(l);if(g.getResponseHeader("x-amz-checkout-page"))f.ajaxUpdatePage(a,e,g,{pushNewFrame:"false"}),a=g.getResponseHeader("x-amz-checkout-updated-itemid"),g=g.getResponseHeader("x-amz-checkout-quantity-error"),a&&g&&z(a,g);else if(a=c.jsonify(a))if(a&&a.errors&&a.errors.pantry&&a.errors.pantry.mov)v(a.errors.pantry.showAddonInfo);
else{if(a&&a.errors&&a.errors.addon&&(f.isSPP()&&b.increaseCount("checkout:spp-revieworder:addon_warn_pri",1),g=a.errors.addon.type,e=a.errors.addon.asins,w(),G(".item-list").hide(),e.forEach(function(a){G('[data-asin\x3d"'+a+'"]').show()}),g=G("#addon-warning-"+g+"-launcher"),g.length)){G("input[name\x3duseLiveAUI]").length?d.get(g).attrs({$trigger:Z}).show():fa&&G("div.checkout.spc-mobile.aui-templatized").length?g.click():(b.increaseCount("removeauijs19"),a=G.Event("keyup",{triggerPositioningElement:Z,
manualTrigger:!0}),g.trigger(a),0<G("div.spc-mobile").length&&(k.scrollToTop(),k.toggleScrollOff()));m.hide();return}return f.redirect(a)}else f.redirect()}function w(){G("#a-popover-addon-warning-normal .select-address-title").hide();0<M?(G("#a-popover-addon-warning-normal .reduce-title").show(),G("#a-popover-addon-warning-normal .delete-title").hide()):(G("#a-popover-addon-warning-normal .delete-title").show(),G("#a-popover-addon-warning-normal .reduce-title").hide())}function v(a){var c=G("#pantry-mov-popover-launcher"),
d=G(".pantry-mov-reduce-prompt"),e=G(".pantry-mov-delete-prompt"),g=G("#pantry-mov-addon-info-container");c.length?(P()||b.increaseCount("checkout:pantry:pantry_mov_popover:non_spc",1),g.length&&g.empty(),a&&G("#addon-warning-normal-popover-content").length&&(w(),g.length||(g=G("\x3cdiv/\x3e",{id:"pantry-mov-addon-info-container"})),g.append('\x3chr class\x3d"a-divider-normal"\x3e').append(G("#addon-warning-normal-popover-content").html()).appendTo("#pantry-mov-popover-content")),0<M?(d.show(),e.hide()):
(e.show(),d.hide()),c.length&&(c.click(),m.hide())):(b.increaseCount("checkout:pantry:pantry_mov_popover_contents:no-launcher",1),f.redirect())}function n(a,b){m.show();var c={isClientTimeBased:G('input[name\x3d"useCtb"]').val(),fromAnywhere:G("input[name\x3dfromAnywhere]").val(),success:y};if(b)for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);f.isSPP()?(c.ref="chk_ship_chg_qty_pri",b=G("#setOrderingPrefsCheckbox"),b.length&&b.is(":checked")&&(c.saveAsDefaultsSelected=1)):G(".spc-mobile.aui-templatized").length&&
(c.ref="ox_spc_change_quantity");b=G("#addon-indicator")&&"true"===G("#addon-indicator").attr("data-has-addon-items");d=G("#pantry-mov-indicator")&&"true"===G("#pantry-mov-indicator").attr("data-has-pantry-items");a||!b&&!d||(c.istrial=1);g.call(E,M,c);F?F.data("currentQuantity",M):V&&V.data("currentQuantity",M)}function u(){m.hide();q.location="/gp/aw/c/ref\x3dox_spc_deal_expired?app-action\x3dcart"}function D(a){var b=Q;M=Q;F&&r.when("a-dropdown").execute(function(a){F&&(a.getSelect(F).setValue(b.toString()),
F.data("currentQuantity",M))});a===Y.addOn&&k.toggleScrollOn();V&&(V.val(b),V.data("currentQuantity",M),a=V.closest(".quantity-block"),a.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),a.find(".quantity-display").removeClass("hidden"),a.find(".quantity-display-block-tablet").removeClass("hidden"),a.find(".dynamic-quantity-update").hasClass("stay-visible")||a.find(".dynamic-quantity-update").addClass("hidden").children().addClass("hidden"))}function A(a,b){var c=a.$currentTarget.is("a")?
a.$currentTarget:a.$currentTarget.find("a");E=c.data("entityId");M=0;F=null;Q=c.data("currentQuantity");Z=G("a.quantity-delete-button[data-entity-id\x3d'"+E+"']");Z.length||(Z=a.$currentTarget);V=c.closest(".dynamic-quantity-update").find(".quantity-input");V.length||(V=null);c.data("isBundleDelete")?setTimeout(function(){G("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click")},100):(n(!1,b),l.hideById(c.closest(".a-popover").data("aPopoverId")))}function L(a){if(!h.protectAgainstDoubleAction("order-summary-update-quantity",
200)){b.resetMetrics();var c=a.$currentTarget,d=c.closest(".lineitem"),e=c.find("select"),e=e.length?e:c;E=d.data("entityId");var f=G('.update-quantity-error[data-itemid\x3d"'+E+'"]');V=F=null;e.is("select")?(F=c.find("select"),M=e.val()):(V=d.find(".quantity-input"),M=V.val());Q!==M&&(Z=e.is("select")?F.parent():V,""===M?N(d):"Delete"===M||0===parseInt(M,10)?(a.$event.preventDefault(),h.protectAgainstDoubleAction("delete-item")||C(a)):h.validateNumber(M,0,999)?(f.hide(),d.blur(),d.data("isBundleDelete")?
setTimeout(function(){G("#pb-delete-trigger-"+d.data("bundleGroupId")).trigger("click")},100):n(!1)):z(E,"changeQuantity_quantityNotInRange"))}}function C(a,b){var c=a.$currentTarget.closest(".lineitem");E=c.data("entityId");M=0;c.data("isBundleDelete")?setTimeout(function(){G("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click")},100):(n(!1,b),l.hideById(c.closest(".a-popover").data("aPopoverId")))}function H(a){var b=a.$currentTarget.closest(".quantity-text-field").find(".update-quantity-link"),
c=a.$currentTarget.is("input")?a.$currentTarget.val():a.$currentTarget.find("input").val(),d=a.$currentTarget.find("input").data("currentQuantity");Q=d;-1===parseInt(c,10)||""===c?("change"===a.type&&N(a.$currentTarget.closest(".lineitem")),b.hide()):parseInt(c,10)!==d?b.show():b.hide()}function N(a){a.find(".quantity-input").val(Q)}function P(){return f.isSPP()?G("#revieworder").hasClass("expanded")?!0:!1:0<G("div.spc").length?!0:!1}var G=a.$;if(!G("html").hasClass("a-ie6")){var M,Q,E,F,V,X=!1,aa=
!1,Z,fa=q.P&&q.P.AUI_BUILD_DATE,Y={addOn:"addOn",pantryMOV:"pantryMOV"};a.declarative("change-quantity",["click","touchend"],function(a){if(!h.protectAgainstDoubleAction("lock-update-quantity",200)){a=a.$currentTarget;var b=!0;a.addClass("hidden");a=a.closest(".quantity-block");a.find(".change-quantity").addClass("hidden");a.find(".quantity-display").addClass("hidden");a.find(".quantity-display-block-tablet").addClass("hidden");a.find(".dynamic-quantity-update").removeClass("hidden").find(".hidden").each(function(){var a=
G(this);a.removeClass("hidden");a.is("input")&&(a.focus(),a.select(),a.unbind("keydown.update-quantity-spc").bind("keydown.update-quantity-spc",function(a){13===a.which&&a.preventDefault()}),a.unbind("keyup.update-quantity-spc").bind("keyup.update-quantity-spc",function(a){13!==a.which||b||G(a.target).closest(".dynamic-quantity-update").find(".update-quantity-button").trigger("click")}))});setTimeout(function(){b=!1},500)}});a.declarative("order-summary-get-quantity",["click","touchend"],function(a){h.protectAgainstDoubleAction("order-summary-get-quantity",
200)||a.$currentTarget.find("select").length&&(Q=a.$currentTarget.find("select").val())});a.declarative("order-summary-update-quantity",["change"],L);a.declarative("order-summary-update-quantity-text-field",["click","touchend"],L);a.declarative("order-summary-handle-text-input",["keydown"],function(a){13===a.$event.which?(a.$event.preventDefault(),L(a)):h.limitInputToNumbers(a)});a.declarative("order-summary-show-update-button",["change","keyup"],H);a.declarative("trigger-update-quantity-button",
["keydown"],function(a){13===a.$event.which&&(a.$event.preventDefault(),a.$currentTarget.closest(".quantity-block").find(".update-quantity-button").trigger("click"))});a.declarative("toggle-update-quantity-button",["change","keyup"],function(a){var b=a.$currentTarget.closest(".quantity-block").find(".update-quantity-button"),c=a.$currentTarget.find("input"),d=c.val(),e=c.data("currentQuantity");""===d?("change"===a.type&&c.val(e),b.hide()):parseInt(d,10)!==e?b.show():b.hide()});a.declarative("update-quantity",
["click","touchend"],function(a){b.resetMetrics();var c=a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a");a=c.closest(".quantity-block");var d=c.closest(".dynamic-quantity-update"),e=d.find(".quantity-input");d.length||(e=a.find(".quantity-input"));if(h.protectAgainstDoubleAction("lock-update-quantity",200))e.focus();else{var f=e.val();E=c.data("entityId");var g=G('.update-quantity-error[data-itemid\x3d"'+E+'"]');h.validateNumber(f,0,999)?(g.hide(),d.find(".a-form-error").removeClass("a-form-error"),
e.removeClass("a-form-error"),f=parseInt(f,10),V=e,Q=V.data("currentQuantity"),Q=parseInt(Q,10),f===Q?(a.find(".change-quantity-button").closest(".a-declarative").removeClass("hidden"),a.find(".quantity-display").removeClass("hidden"),a.find(".quantity-display-block-tablet").removeClass("hidden"),d.addClass("hidden").children().addClass("hidden")):(M=f,Z=c,c.blur(),c.data("isBundleDelete")?setTimeout(function(){G("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click")},100):n(!1))):z(E,"changeQuantity_quantityNotInRange")}});
G(document).delegate(".spc-quantity-dropdown","change",function(a){F=G(a.currentTarget);b.resetMetrics();fa?(a=F.next(),E=a.data("entityId"),Q=a.data("currentQuantity")):(b.increaseCount("removeauijs21"),E=F.data("entityId"),Q=F.data("currentQuantity"));var c=F.find(":selected");M=parseInt(c.val(),10);Q!==M&&(a=G("#toggleDropdownQuantityTrigger"),a.length&&M===parseInt(a.val(),10)?(a=F.closest(".quantity-block"),a.find(".spc-quantity-dropdown-button").hide(),a.find(".quantity-input").show()):(Z=F.parent(),
F.blur(),c&&c.data("isBundleDelete")?setTimeout(function(){G("#pb-delete-trigger-"+c.data("bundleGroupId")).trigger("click")},100):n(!1)))});a.declarative("dont-delete-item",["click","touchend"],function(a){a.$event.preventDefault();h.protectAgainstDoubleAction("dont-delete-item")||l.hideById(a.$currentTarget.closest(".a-popover").data("aPopoverId"))});a.declarative("delete-item",["click","touchend"],function(a){a.$event.preventDefault();h.protectAgainstDoubleAction("delete-item")||A(a)});a.declarative("delete-prime-membership-item-confirm",
["click","touchend"],function(a){a.$event.preventDefault();if(!h.protectAgainstDoubleAction("delete-prime-membership-item-confirm")){var b={additionalData:{deletePrimeMembership:1,primeMembershipASIN:(a.$currentTarget.is("a")?a.$currentTarget:a.$currentTarget.find("a")).data("asin")}};A(a,b)}});a.declarative("bundle-delete",["click","touchend"],function(){h.protectAgainstDoubleAction("bundle-delete")||n(!1)});a.declarative("bundle-delete-action",["click","touchend"],function(a){h.protectAgainstDoubleAction("bundle-delete-action")||
(r.when("a-popover-base").execute(function(b){b.get(a.data.popoverName).hide()}),n(!1))});a.declarative("egc-delete",function(a){E=a.entityId;M=0;n(!0)});a.declarative("bundle-dont-delete",["click","touchend"],function(){h.protectAgainstDoubleAction("bundle-dont-delete")||(M=Q,F&&r.when("a-dropdown").execute(function(a){a.setValue(F.attr("id"),Q.toString());F.data("currentQuantity",M)}))});a.declarative("pantry-return-to-cart-btn",["click","touchend"],function(){h.protectAgainstDoubleAction("pantry-return-to-cart-btn")||
P()&&u()});a.declarative("pantry-delete-items-btn",["click","touchend"],function(){!h.protectAgainstDoubleAction("pantry-delete-items-btn")&&P()&&(aa=!0,G(".a-button-close").trigger("click"),n(!0))});a.declarative("pantry-cancel-delete-btn",["click","touchend"],function(){h.protectAgainstDoubleAction("pantry-cancel-delete-btn")||P()&&D(Y.pantryMOV)});a.on("a:popover:hide:pantry-mov-popover",function(){P()&&(aa||D(Y.pantryMOV))});a.declarative("addon-return-to-cart",["click","touchend"],function(){h.protectAgainstDoubleAction("addon-return-to-cart")||
P()&&u()});a.declarative("addon-delete-items",["click","touchend"],function(){h.protectAgainstDoubleAction("addon-delete-items")||(P()&&(X=!0,G(".a-button-close").trigger("click"),n(!0)),f.isSPP()&&b.increaseCount("checkout:spp-revieworder:addon_delete_pri",1))});a.declarative("addon-dont-delete",["click","touchend"],function(){h.protectAgainstDoubleAction("addon-dont-delete")||(P()&&D(Y.addOn),f.isSPP()&&b.increaseCount("checkout:spp-revieworder:addon_keep_pri",1))});a.on("a:popover:hide:addon-warning-normal",
function(){0<G("div.spc-mobile").length?u():P()&&(X||D(Y.addOn))});a.on("a:popover:hide:addon-warning-special",function(){P()&&(X||D(Y.addOn))});a.on("checkout:reload:spc",t);a.on("checkout:reload:spp-revieworder",t)}});r.when("A","ready").execute(function(a){a.on("a:popover:beforeShow",function(a){if(a.popover.$trigger.hasClass("quantity-dropdown-button")){var k=a.popover.$popover,c=k.closest("div.a-dropdown");c.length&&(a.popover.$iframe.css("max-height","260px"),k.css("max-height","260px"),k=c.find("div.a-popover-inner"),
k.css({"max-height":"260px"}),a.popover.updatePosition(),k.css({"overflow-y":"scroll"}))}})});"use strict";r.when("A","page-transition-controller","page-conductor","ajax-utility").register("tax-exemption-controller",function(a,m,k,c){function f(a,f,d){return d.getResponseHeader("x-amz-checkout-page")?k.ajaxUpdatePage(a,f,d,{pushNewFrame:"false"}):(a=c.jsonify(a))?k.redirect(a):k.redirect()}function g(a,c){var d=c.$target.data("entityId");if(d){m.show();var b={isClientTimeBased:l('input[name\x3d"useCtb"]').val(),
fromAnywhere:l("input[name\x3dfromAnywhere]").val()},b=b||{};c={returnFullHTML:1,cachebuster:(new Date).getTime(),isClientTimeBased:0,hasWorkingJavascript:1};l.extend(c,b);c.entityId=d;c.optOut=a;a=k.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});l.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/tax-exemption-optout.html",data:l.param(c),dataType:"text",async:!0,cache:!1,headers:a,success:f,error:k.ajaxRedirect})}else q.ueLogError&&q.ueLogError({name:"MissingData",message:"lineItemId is undefined, when trying to opt out from tax exemption",
logLevel:"FATAL"})}var l=a.$;l("html").hasClass("a-ie6")||(a.declarative("tax-exemption-opt-out",["click","touchend"],function(a){g(!0,a)}),a.declarative("tax-exemption-opt-in",["click","touchend"],function(a){g(!1,a)}))});"use strict";r.when("A").execute(function(a){return{}});"use strict";r.when("A","page-transition-controller","page-conductor").register("sns-subscription-controller",function(a,m,k){function c(){var c=l(document);c.delegate(".sns-option","click",function(a){a=l(this);g(a.closest(".sns-upsell"),
a)});c.delegate(".sns-option-mobile","click",function(a){var c=l(this);a.target.name&&"snsSetCreateSubscription"===a.target.name&&g(c.closest(".sns-upsell-mobile"),c)});c.delegate(".sns-option-tablet","click",function(a){a=l(this);g(a.closest(".sns-upsell-tablet"),a)});c.delegate(".sns-upsell-nextdelivery","change",function(){f(l(this))});a.declarative("sns-upsell-nextdelivery-dropdown","change",function(a){f(l(a.$target))});c.delegate(".sns-upsell-learn-more","click",function(a){var c=l(this);a=
c.width();var b=c.height(),e=c.position(),c=c.find(".sns-upsell-popover-learn-more");c.removeClass("aok-hidden");var f=c.width();c.height();c.css({top:e.top+b,left:e.left-(f-a)/2,position:"absolute"})});c.delegate(".sns-upsell-learn-more-close","click",function(a){(a=l(this))&&a.closest(".sns-upsell-popover-learn-more")&&a.closest(".sns-upsell-popover-learn-more").addClass("aok-hidden");return!1})}function f(a){var c=a.closest(".sns-upsell,.sns-upsell-mobile,.sns-upsell-tablet");if(a.length&&c.length){var d=
c.data("index"),b=c.find("span.sns-change-delivery-txt");b&&b.text(a.find("option:selected").data("date"));b=a.find("option:selected").data("epoch");a=a.find("option:selected").val();c.find("input[type\x3d'hidden'][name\x3d'sns_nextDelivery"+d+"']").val(b);c.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+d+"']").val(a)}}function g(a,c){m.show();var d=a.data("index"),b=(new Date).getTime(),f=a.find("input[type\x3d'hidden'][name\x3d'sns_lineItemIdentifier"+d+"']").attr("value"),g=a.find("input[type\x3d'hidden'][name\x3d'sns_merchantId"+
d+"']").attr("value"),q=a.find("input[type\x3d'hidden'][name\x3d'sns_asin"+d+"']").attr("value");a=a.find("input[type\x3d'hidden'][name\x3d'sns_frequency"+d+"']").attr("value");c=c.prop("checked")||c.find("[type\x3dcheckbox]").is(":checked");b={returnpipedata:0,returnFullHTML:1,cachebuster:b,hasWorkingJavascript:1};b.lineItemIdentifier=f;b.isONMLSelected=c?1:0;b.merchantId=g;b.asin=q;b.frequency=a;f=k.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});l.ajax({type:"POST",url:"/gp/buy/spc/handlers/set-sns-options.html",
data:l.param(b),dataType:"text",async:!0,cache:!1,headers:f,success:function(a,b,c){return k.ajaxUpdatePage(a,b,c)},error:function(a,b,c){k.ajaxRedirect(a,b,c)}})}var l=a.$;l("html").hasClass("a-ie6")||c()});"use strict";r.when("A","page-detector","page-detector-current-page","page-conductor","page-transition-controller","ajax-utility","place-order-controller","client-side-metrics").execute(function(a,m,k,c,f,g,l,e){function h(a){"function"===typeof q.ues&&(q.ues("t0",a,new Date),q.ues("ctb",a,"1"));
"function"===typeof q.uet&&q.uet("tc",a,{wb:1})}function d(a,b){"function"===typeof q.ues&&q.ues("id",a,b)}function b(a,b){"function"===typeof q.uet&&q.uet(a,b,{wb:1})}function p(a){"function"===typeof q.uex&&q.uex("ld",a,{wb:1})}function t(a){q.ueLogError&&q.ueLogError({message:a},{logLevel:"WARN",attribution:"ajax-typ"})}function r(){var a=N("span#typ-load").attr("data-typ-args");q.location.href="https://"+q.location.hostname+"/gp/buy/thankyou/handlers/display.html?"+a}function y(){if(aa){var a=
N("#typ-desktop-frame").contents(),b=aa;if(b.deliveryestimates)for(var c in b.deliveryestimates)if(b.deliveryestimates.hasOwnProperty(c)){var d=a.find("span#"+c);d&&d.replaceWith(b.deliveryestimates[c])}b.autorip&&(a=a.find("#thank-you-rogue"))&&a.replaceWith(b.autorip)}}function w(){b("cf","ajax-typ:place-your-order");y();var a=N("#typ-desktop-frame").contents(),c="ThankYouCart",g=a.find("span#typ-rewrite-url");history&&history.pushState&&g&&0<g.length&&(history.pushState({},"",g.attr("data-url")),
c=g.attr("data-view"));a=a.find("title").text();N("#checkoutDisplayPage").hide();N("#typ-desktop").show();document.title=a;f.hide();c=N("span#typ-load").attr("data-typ-args")+"\x26viewId\x3d"+c;b("be","ajax-typ:place-your-order");e.setmarker&&(a=e.getscope(),fa&&(c+="\x26requestID\x3d"+Y,e.setscope("ajax-typ")),e.setmarker("cf"),fa&&e.setscope(a));N.ajax({type:"POST",url:"/gp/buy/thankyou/handlers/log-data.html",data:c,dataType:"text",async:!0,cache:!1,complete:function(a,b){b=N("#typ-desktop-frame")[0].contentWindow;
"function"===typeof b.updateCart&&b.updateCart();a.getResponseHeader("x-amz-checkout-requestid")&&(a=a.getResponseHeader("x-amz-checkout-requestid"),e.sendue&&(b=e.getscope(),e.setscope("ajax-typ"),e.setrid(a),e.sendue("ld"),e.setscope(b)),d("ajax-typ:place-your-order",a),p("ajax-typ:place-your-order"))}});fa||(e.sendUEPageLoadStats(),p("ajax-typ:place-your-order"))}function v(a,d,e){a&&a.conductoraction&&a.conductoraction.url?c.redirect(a):(b("af","ajax-typ:place-your-order"),aa=a,Q?w():G?E=1:(t("No TYP data available after place-order, redirecting to static TYP"),
r()))}function n(){if(!ga)if(ba&&clearTimeout(ba),3===R.readyState){var a;try{a=g.jsonify(R.responseText)}catch(b){a=null}null!==a?(ga=1,v(a)):ba=setTimeout(n,50)}else 4===R.readyState&&(ga=1,200===R.status?(a=g.jsonify(R.responseText),null!==a?v(a):(t("No results from place-order, calling ajaxRedirect"),c.ajaxRedirect())):(t("Error calling place-order, calling ajaxRedirect"),c.ajaxRedirect()))}function u(){M=1;V&&clearTimeout(V);X&&clearTimeout(X);var a=N("#currencyChanged");0<a.length&&"true"===
a.val()&&(a='\x3cinput type\x3d"hidden" name\x3d"checkoutCurrencySelection.'+N("#tfx-switch-currency-options").find("input:radio:checked").val()+'" /\x3e',N("#spc-form-inputs").append(a));N("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");a=(new Date).getTime()-x;N("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'waitingTime' value\x3d'"+a+"' /\x3e");N("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'returnjson' value\x3d'1' /\x3e");ha&&
N("#spc-form").append("\x3cinput type\x3d'hidden' name\x3d'isAsyncTYPEnabled' value\x3d'1' /\x3e");var a=N("#spc-form").serialize(),b=N("#typ-desktop-frame").contents().find("input#cached-promise-data");0<b.length&&(a+="\x26cachedPromiseData\x3d"+b.val());if(Z){if(q.XMLHttpRequest)R=new XMLHttpRequest;else if(q.ActiveXObject)try{R=new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(d){R=null}if(!R){t("Can't get XMLHttpRequest for data stream, calling standard placeOrderController");M=1;l.placeOrderClick();
return}R.open("POST","/gp/buy/spc/handlers/place-your-decoupled-order.html",!0);R.setRequestHeader("Content-type","application/x-www-form-urlencoded");R.setRequestHeader("Content-length",a.length);R.setRequestHeader("Connection","close");R.onreadystatechange=n;R.overrideMimeType("text/plain");R.send(a)}else N.ajax({type:"POST",url:"/gp/buy/spc/handlers/place-your-decoupled-order.html",data:a,dataType:"text",async:!0,cache:!1,dataFilter:function(a){return g.jsonify(a)},success:function(a,b,d){null!==
a?v(a,b,d):(t("No results from place-order, calling ajaxRedirect"),c.ajaxRedirect())},error:function(a,b,d){t("Error calling place-order, calling ajaxRedirect");c.ajaxRedirect(a,b,d)}});"function"===typeof q.uet&&q.uet("bb","ajax-typ:place-your-order",{wb:1})}function D(){Q=G=F=0;N("div#typ-desktop").empty()}function A(a,b,c){F||(F=1,clearTimeout(X),G=0,Q=1,P++,(a=N("#typ-desktop-frame").contents().find("span#typ-rewrite-url"))&&0<a.length&&(a=a.attr("data-requestid"),h("ajax-typ:place-your-order"),
fa?Y=a:(e.setAsyncRequestId(a),d("ajax-typ:place-your-order",a))),E?w():!M&&5>P&&(V=setTimeout(function(){D();L()},12E4)))}function L(){if(!(M||G||5<=P)){G=1;var a=N("span#typ-load").attr("data-typ-args");X=setTimeout(function(){D();E&&(t("Timed out waiting for TYP fetch after place-order, redirecting to static TYP"),r())},45E3);N("\x3ciframe /\x3e",{name:"typ-desktop-frame",id:"typ-desktop-frame",width:"100%",height:"100%",frameborder:"0",src:"/gp/buy/thankyou/handlers/display.html?"+a}).appendTo("div#typ-desktop").load(A)}}
function C(){A()}function H(){m.isSpc()&&0<N("span#typ-load").length&&(x=(new Date).getTime(),P=0,N("div#typ-desktop").length?D():N("body").append('\x3cdiv id\x3d"typ-desktop" style\x3d"position:absolute;left:0;right:0;bottom:0;top:0;display:none;"\x3e\x3c/div\x3e'),Z=N("span#typ-load").attr("data-early-json-flush")&&!N("html").hasClass("a-lt-ie10"),ha=0<N("span#async-typ-enabled").length,fa=N("span#typ-load").attr("data-use-cds-stub"),N(document).undelegate("span.place-order-button-link","click"),
N(document).delegate("span.place-order-button-link","click",function(a){a.preventDefault();fa?(a=e.getscope(),e.setscope("ajax-typ"),e.setctb(),e.resetue(),e.setmarker("tc"),e.setscope(a)):(e.resetMetrics(),e.setmarker("tc"));G||Q?(f.show(),u()):(M=1,l.placeOrderClick())}),L())}var N=a.$;if(!N("html").hasClass("a-ie6")){var P=0,G=0,M=0,Q=0,E=0,F=0,V,X,aa,Z=0,fa=0,Y,R,ba,ga=0,x=0,ha=0;a.on("ajax-typ-cf",C);a.on("checkout:reload:spc",H);a.on("checkout:reload:spp-revieworder",H);a.on("checkout:reload:spclite",
H)}});"use strict";r.when("A","client-side-metrics").register("trialSignPrefetchCommon",function(a,m){function k(){c()&&(b().val(0),m.increaseCount("TrialSign:js:activated"),f(),r!==D&&d(),r=a.interval(h,5E4),y=0)}function c(){return 0!==b().length&&0!==p("input[name\x3d'purchaseID']").length}function f(){q!==D&&q.abort();q=a.ajax("/gp/buy/spc/handlers/trigger-trial-sign.html",{method:"post",params:{purchaseId:p("input[name\x3d'purchaseID']").val()},success:g,error:l,abort:e})}function g(a,c,d){b().val(a.signPurchaseTrialId);
q=D;m.increaseCount("TrialSign:js:success")}function l(a,b,c){d();q=D;m.increaseCount("TrialSign:js:failed")}function e(){d();q=D;m.increaseCount("TrialSign:js:aborted")}function h(){y++;10<y?d():(m.increaseCount("TrialSign:js:retry"),m.increaseCount("TrialSign:js:retry:"+y),f())}function d(){r!==D&&(clearInterval(r),r=D)}function b(){return p("input[name\x3d'trialSignId']")}var p=a.$,q,r,y=0;a.on("checkout:reload:spc",k);a.on("checkout:reload:spclite",k);a.on("checkout:billing-address-update",k);
return{makeTrialSignCall:f,trialSignCallSucceeded:g,isTrialSignActivated:c}});"use strict";r.when("A","client-side-metrics","ajax-utility","button-blocker","button-blocker-popover","spclite-items-viewer","fast-track-controller").register("get-final-results-update",function(a,m,k,c,f,g,l){function e(){for(var b=function(){a.trigger("checkout:spc:ordersummary:sizeChanged")},c=0;20>c;++c)setTimeout(b,100*c)}function h(a,b){setTimeout(function(){var c=g.prepare(a);c&&z("#spclite-items-operation").show();
z("#spclite-items-header-dynamic").fadeIn(b?0:300,function(){c&&z("#spclite-items-operation").find(".spclite-items-view-switch").each(function(){var a=z(this).attr("view-name");a&&z(this).find("a").click(function(){m.increaseCount("SPCLite:ClientSide:SwitchViewClick:"+a,1);g.switchToView(a);z("#spclite-items-operation").fadeOut(b?0:300);e()})})})},b?0:800)}function d(b,c,d){if(b&&z.isArray(b))for(var e=!1,f=0;f<b.length;f++){var g=b[f];if(g.identifier&&g.content){var h=z("#"+c+"-"+g.identifier);h&&
0!==h.length?a.slideDown(h.html(g.content),d?0:500,"ease-out",function(){}):(m.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Item:"+c,1),e||(m.increaseCount("SPCLite:LazyContentPlaceHolderMissing:Page:"+c,1),e=!0))}}}function b(b,c){if(b.presentCVs&&0<b.presentCVs.countOfCVs)p();else{b.orderSummaryHTML&&(a.fadeOut(z("#order-summary-footer"),c?0:250,"ease-out"),a.fadeOut(z("#spc-order-summary"),c?0:250,"ease-out",function(){z("#spc-order-summary").replaceWith(b.orderSummaryHTML).hide();b.additionalOrderSummaryHTML&&
z("#order-summary-footer").html(b.additionalOrderSummaryHTML);a.fadeIn(z("#spc-order-summary"),c?0:400,"ease-out");a.fadeIn(z("#order-summary-footer"),c?0:400,"ease-out")}));b.freshDeliveryMessageHTML&&(z("#lazy-fresh-promise-delivery-message").html(b.freshDeliveryMessageHTML),a.slideDown(z("#lazy-fresh-promise-delivery-message"),c?0:500,"ease-out"),l.spcLiteLazyLoadFastTrack());d(b.itemToPrimeMembershipDelivery,"lazy-membership-delivery",c);d(b.itemToGiftContentMapping,"lazy-gift-options",c);d(b.itemToShipOfferingMapping,
"lazy-ship-method",c);d(b.itemToPromise,"lazy-promise",c);b.freshDeliverySlotInformationHTML&&(z("#lazy-fresh-delivery-slot-information").html(b.freshDeliverySlotInformationHTML),a.slideDown(z("#lazy-fresh-delivery-slot-information"),c?0:250,"ease-out"));b.freshDeliveryInstructionsHTML&&(z("#lazy-fresh-delivery-instructions").html(b.freshDeliveryInstructionsHTML),a.slideDown(z("#lazy-fresh-delivery-instructions"),c?0:250,"ease-out"));if(b.itemToPromoMapping&&z.isArray(b.itemToPromoMapping))for(var f=
z("#items-block"),g=0;g<b.itemToPromoMapping.length;g++){var k=b.itemToPromoMapping[g];"lightningdeal"===k.type?f.find(".lazy-lightning-promo-details-"+k.identifier).removeClass("aok-hidden"):"promotion"===k.type&&f.find(".lazy-promo-details-"+k.identifier).removeClass("aok-hidden")}b.freeShippingId&&z("#"+b.freeShippingId).removeClass("aok-hidden");z("input#isOrderSummaryReady").val(1);h(b.itemGroupData,c);e()}}function p(){var b=z("#spclite-block-order-place-message").html()||"";c.show("disabled-order-place",
b);c.lock();f.create({name:"disabled-order-place",content:b});f.lock();var d=c.getButtonBlocker().data("a-popover-id");a.on("checkout:beforeReload",function(){f.unlock();c.unlock();f.destroy();z("#a-popover-"+d).remove()})}function r(a){if(a&&a.data){var b;try{b=q.atob(a.data)}catch(c){return m.increaseCount("SPCLite:FinalResult:Base64Decode:Failure",1),null}if((b=k.jsonify(b))&&!z.isEmptyObject(b))return b}return null}var z=a.$,y,w=function(a,b){function c(){if(f&&0!==f.length){for(var a="",b=0;b<
d%3+1;b++)a+=".";f.html(a);d++}}var d=0,e,f;this.start=function(){b&&b.useTextAnimate&&(d=0,f=a.find(".spclite-loading-text .spclite-processing-indicator"),e=setInterval(c,800))};this.stop=function(){e&&(clearInterval(e),f&&0<f.length&&f.html(""),d=0);a.find(".spclite-loading-spinner").hide();b&&b.showTextAlways||a.find(".spclite-loading-text").hide()}};a.on("checkout:reload:spclite",function(){if("1"===z('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")){var a=r(q.__spcliteFinalResultsData);
if(a){b(a,!0);return}}else if(q.__spcliteFinalResultsData){b(q.__spcliteFinalResultsData,!0);return}var a="",c=z("input#executionId").val();c&&(a+="executionId\x3d"+c);return z.ajax({type:"GET",url:"/gp/buy/spclite/handlers/get-final-results.html/ref\x3dox_spclite_get_final_results",data:a,dataType:"text",async:!0,beforeSend:function(a){y=new w(z("#spclite-order-summary-loading-indicator"),{showTextAlways:!0});y.start();q.uet&&q.uet("bb","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},success:function(a,
c,d){a=k.jsonify(a);"1"===z('script[type\x3d"spclite-encoding"]').attr("data-base64-encode-final-results")?(a=r(a))?b(a,!1):p():a&&!z.isEmptyObject(a)?b(a,!1):p()},error:function(a,b,c){p()},complete:function(a){y.stop();q.uex&&q.uex("ld","SPCLite:ClientSide:Perf:FinalAjax",{wb:1})},cache:!1})});a.on("checkout:beforeLoadPage",function(){q.__spcliteFinalResultsData=D})});"use strict";r.when("A","client-side-metrics").register("spclite-items-viewer",function(a,m){function k(){var a=f("#spclite-items-block").find(".spclite-item-detail");
a&&0<a.length&&(l={},a.each(function(a){a=f(this).attr("entity-id");l[a]=f("\x3cp\x3e\x3c/p\x3e").append(f(this).clone().removeClass("a-span-last")).html()}))}function c(a,c){if(!c||0===c.length)return null;a=f('\x3cdiv class\x3d"a-row spclite-item-view" view-type\x3d"order-by-delivery"\x3e\x3c/div\x3e');var d=c;c=[];for(var b=[],g=0;g<d.length;g++){var k=d[g];if("normal"!==k.type)b.push(k);else{for(var m=0;m<c.length;)if(k.data.destinationAddressId!==c[m].data.destinationAddressId)m++;else break;
for(;m<c.length;)if(k.data.destinationAddressId===c[m].data.destinationAddressId&&k.data.promise.starttime.dayepoch>c[m].data.promise.starttime.dayepoch)m++;else break;c.splice(m,0,k)}}for(d=0;d<b.length;d++)switch(k=b[d],k.type){case "primemembership":c.unshift(k);break;case "vas":case "digital":case "no-promise":case "exception":c.push(k);break;default:c.push(k)}for(b=0;b<c.length;b++){k=c[b];if(d=k.content)g='\x3cdiv class\x3d"row spclite-item-group-title"\x3e',d.destination&&(g+='\x3cdiv class\x3d"row destination"\x3e'+
d.destination+"\x3c/div\x3e"),d.promise&&(g+='\x3cdiv class\x3d"row promise"\x3e'+d.promise+"\x3c/div\x3e"),g+="\x3c/div\x3e",a.append(g);a:if(d=k.items,l&&d&&0!==d.length){g="";for(m=0;m<d.length;m++){0===m%2&&(g+='\x3cdiv class\x3d"a-row"\x3e');var q=d[m].identifier;if(!l[q]){d=null;break a}q=f(l[q]);1===m%2&&q.addClass("a-span-last");g+=f("\x3cp\x3e\x3c/p\x3e").append(q).html();1===m%2&&(g+="\x3c/div\x3e")}1===d.length%2&&(g+='\x3cdiv class\x3d"a-column a-span6 a-span-last"\x3e\x3c/div\x3e\x3c/div\x3e');
d=g}else d=null;if(d)d=f(d),("no-promise"===k.type||"normal"===k.type&&k.data&&k.data.promise&&"scheduled"!==k.data.promise.type)&&d.find(".spclite-promise").hide(),a.append(d);else return null;b<c.length-1&&a.append("\x3chr\x3e")}return a}var f=a.$,g,l;return{prepare:function(a){try{var f;a:{k();if(l){var d=c("order-by-delivery",a);if(d){g={"order-by-delivery":d};f=!0;break a}}f=!1}return f}catch(b){m.increaseCount("SPCLite:ClientSide:Exception:SwitchViewPrepare",1)}return!1},switchToView:function(a,
h){var d;g&&g[a]?d=g[a]:(m.increaseCount("SPCLite:ClientSide:SwitchViewNoPrepared:"+a,1),"order-by-delivery"===a&&(d=c(a,h)));if(d){var b=f("#spclite-items-block");b.find(".spclite-item-view").fadeOut(300,function(){b.empty();b.append(d.clone().hide());b.find(".spclite-item-view").fadeIn(500)})}}}});"use strict";r.when("A","loading-spinner-controller").register("cpf-controller",function(a,m){function k(a){var c,k,e;if(/^\d{11}$/.test(a)||/^\d{3}\.\d{3}\.\d{3}-\d{2}$/.test(a)){a=a.replace(/[^\w\s]|_/g,
"");if(/(\d)\1{10}/.test(a))return!1;c=a.substring(0,9);k=a.substring(9);e=0;for(var h=10;1<h;h--)e+=c.charAt(10-h)*h;if((2>e%11?0:11-e%11)!==k.charAt(0))return!1;c=a.substring(0,10);e=0;for(a=11;1<a;a--)e+=c.charAt(11-a)*a;return(2>e%11?0:11-e%11)!==k.charAt(1)?!1:!0}return!1}var c=a.$;a.on("checkout:reload:spp-taxid",function(){c("#useThresholdTaxIdService").length||c("#taxidForm").submit(function(){var a=c("#taxidregistration-imb");if(!k(c("#taxid-field").val()))return m.hideSpinner(c("#spinner-anchor"),
!0),a.show(),!1;a.hide();return!0})})});"use strict";r.when("A","page-conductor","ready").register("taxid-threshold-controller",function(a,m){function k(){var a=c();m.isSPP()?a?(f("#taxid-continue-disabled").hide(),f("#taxid-continue-enabled").show()):(f("#taxid-continue-enabled").hide(),f("#taxid-continue-disabled").show()):a?f("span.#continue").removeClass("a-button-disabled").find('input[type\x3d"submit"]').removeAttr("disabled"):f("span.#continue").addClass("a-button-disabled").find('input[type\x3d"submit"]').attr("disabled",
"disabled")}function c(){var a=!0,c=f("#taxIdForm");c.length&&c.find('input[type\x3d"text"]').each(function(){var c=f(this);if(!c.val()||7>c.val().length)c.parents(".taxid-form").find('input[type\x3d"checkbox"]').attr("checked")||(a=!1)});return a}var f=a.$;a.on("checkout:reload:spp-taxid",function(){if(f("#useThresholdTaxIdService").length){var a=f("#taxIdForm");a.length&&(a.find('input[type\x3d"text"]').keyup(k),a.find('input[type\x3d"checkbox"]').change(k));k()}})});"use strict";r.when("A","page-conductor",
"loading-spinner-controller","taxaddress-page-config","ready").register("taxaddress-controller",function(a,m,k,c){function f(){var a=e(d.taxidInputIdSelector).val();if(0===a.length)return!0;var b=e(d.taxlegalnameInputIdSelector).val();return h.test(a)&&0!==b.trim().length?(a=e(d.taxaddressInputNameSelector).val())&&0<a.length:!1}function g(){var a=f();if(m.isSPP()){var b=e("#taxid-continue-enabled"),c=e("#taxid-continue-disabled");a?(c.hide(),b.show()):(b.hide(),c.show());0<e(d.taxidInputIdSelector).val().length?
(b.find("span.a-button-text").text(d.saveContinueLabel),c.find("span.a-button-text").text(d.saveContinueLabel)):(b.find("span.a-button-text").text(d.continueLabel),c.find("span.a-button-text").text(d.continueLabel))}}function l(){var a=e(d.taxidInputIdSelector).val();if(b||0===a.length)b=!1;else{var c=0<e(d.newTaxaddressInputIdSelector).val().length;b||!c&&!f()||e.ajax({type:"POST",url:d.sifEncryptionUrl,dataType:"json",data:{taxid:a},success:function(a,c,f){e(d.taxidInputIdSelector).val(a.sifEncryptedPayload);
b=!0;e(d.taxaddressFormIdSelector).submit()},error:function(a,b,c){console.log("Error [tramway][away] failed calling sifcontinue.html :"+b)}});return!1}}var e=a.$,h=/^\d{11}$/,d=c.getConfig(),b=!1;a.on("checkout:reload:spp-taxaddress",function(){e(d.taxidInputIdSelector).keyup(g);e(d.taxlegalnameInputIdSelector).keyup(g);e('input:radio[name\x3d"'+d.taxaddressInputName+'"]').each(function(){e(this).change(g)});e(d.taxaddressFormIdSelector).submit(l);g()});return{getNewTaxAddressPopoverURL:function(){return d.newTaxAddressPopoverURL},
submitTaxAddressFormWithNewAddressId:function(a){e(d.newTaxaddressInputIdSelector).val(a);k.showSpinner(e(d.taxAddressPanelSelector),!1);e(d.taxaddressFormIdSelector).submit()}}});r.when("A","address-popovers","taxaddress-controller","ready").register("taxaddress-addresspopover-helper",function(a,m,k){m.actionRegisterTaxAddressController(k)});"use strict";r.when("A","page-spinner-controller","ajax-utility","page-conductor","client-side-metrics").execute(function(a,m,k,c,f){function g(){function f(a){if(!g)if(a.preventDefault(),
a=encodeURIComponent(l("#spc-deliverytipinput").val()),l("#tip-error").addClass("aok-hidden"),l("#tip-promo-success").addClass("aok-hidden"),l("#tip-success").addClass("aok-hidden"),l("#tip-ineligible").addClass("aok-hidden"),l("#tip-success").addClass("aok-hidden"),a&&0!==a.length)if(0>a)b("invalidDeliveryTip_NoAmount");else if(/^[0-9]*(\.[0-9]{1,2})?$/.test(a)){m.show();k=l("#spc-deliverytipnoticecheckbox").attr("checked")?1:0;var e=(new Date).getTime();a="tipamount\x3d"+a+"\x26isDefaultTip\x3d"+
k+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+l("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+e;e=c.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});l.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-tip.html/ref\x3dox_tip_page_delivery_tip_add",data:a,headers:e,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",complete:function(){g=!1;m.hide()},
success:d,error:c.ajaxRedirect});g=!1}else b("invalidDeliveryTip_NoAmount");else b("addDeliveryTip_NoAmount")}function d(a,b,c){m.hide()}function b(a){m.hide();l("#tip-error").removeClass("aok-hidden");0<l("div.spc-desktop").length?l("#spc-deliverytipinput").addClass("a-form-error"):l("#spc-deliverytipinput").closest(".a-input-text-wrapper").addClass("a-form-error");l("#"+a).removeClass("aok-hidden")}var g=!1,k=0;e&&(a.declarative("tip-element",["click"],function(a){var b=a.data.click;b&&null!==b&&
f(a.$event)}),e=!1)}var l=a.$;if(!l("html").hasClass("a-ie6")){var e=!0;a.on("checkout:reload:spc",g);a.on("checkout:reload:spclite",g)}});"use strict";r.when("A","checkout-general-utils","page-conductor","loading-spinner-controller").register("checkout-feedback-controller",function(a,m,k,c){function f(){if(!l||"function"!==typeof l)return"";var a=l(),c="";if(a)for(var d in a)if("number"===typeof a[d]||"string"===typeof a[d]||"boolean"===typeof a[d])c+="\x26__pagedata_"+d+"\x3d"+a[d];return c}var g=
a.$,l;a.declarative("checkout-submit-feedback",["click","touchend"],function(a){if(!m.protectAgainstDoubleAction("checkout-submit-feedback",200)&&(a=g("#checkout-feedback-form"),a.length)){c.showSpinner(a,!1);var h=a.serialize(),h=h+f();g.ajax({type:"POST",url:a.attr("action"),data:h,dataType:"text",error:k.ajaxRedirect,success:function(a,b,c){b=c.getResponseHeader("checkout-feedback-submitted");g(".a-button-close").trigger("click");null!==b&&b!==D&&g("#checkout-feedback-banner").append(a)}})}});
return{registerPageDataCollecter:function(a){a&&"function"===typeof a&&(l=a)}}});"use strict";r.when("A","page-spinner-controller","scroll-controller","ajax-utility","page-conductor","checkout-modal-popover","page-detector","checkout-general-utils","a-popover","client-side-metrics").execute(function(a,m,k,c,f,g,l,e,h,d){function b(){function b(a){a=a.$currentTarget.closest(".delivery-instructions-block");a.find(".edit-delivery-instructions-link").addClass("aok-hidden");a.find(".delivery-instructions-display").addClass("aok-hidden");
var c=a.find(".dynamic-delivery-instructions-update").find(".delivery-instructions-input").attr("maxlength");a.find(".dynamic-delivery-instructions-update").removeClass("aok-hidden");p("#deliveryInstructions").focus();p("#deliveryInstructions").select();p("#deliveryInstructions").keydown(function(a){10===a.which&&a.preventDefault()});p("#deliveryInstructions").keyup(function(){p("#delivery-instructions-left-text").hasClass("aok-hidden")&&p("#delivery-instructions-left-text").removeClass("aok-hidden");
var a=c-p(this).val().length;0>a&&(a=0);p("#delivery-instructions-left").text(a)});setTimeout(function(){},500)}function d(a){m.show();a=a.$currentTarget;var b=p("#deliveryInstructions").val(),c=a.closest(".delivery-instructions-block"),g=a.closest(".dynamic-delivery-instructions-update");c.find(".edit-delivery-instructions-link").removeClass("aok-hidden");c.find(".delivery-instructions-display").removeClass("aok-hidden");g.addClass("aok-hidden");c=(new Date).getTime();b="deliveryInstructions\x3d"+
encodeURIComponent(b)+"\x26returnjson\x3d1\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26fromAnywhere\x3d"+p("input[name\x3dfromAnywhere]").val()+"\x26cachebuster\x3d"+c;c=f.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});p.ajax({type:"POST",url:"/gp/buy/spc/handlers/add-delivery-instructions.html/ref\x3dox_instructions_page_delivery_instructions_update",data:b,headers:c,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",
dataType:"text",complete:function(){m.hide()},success:e,error:f.ajaxRedirect});a.blur()}function e(a,b,d){(a=c.jsonify(a))&&!p.isEmptyObject(a)&&p("#deliveryInstructionsDisplay").html(a.deliveryInstructions);m.hide()}q&&(a.declarative("edit-delivery-instructions",["click"],b),a.declarative("update-delivery-instructions",["click"],d),q=!1)}var p=a.$;if(!p("html").hasClass("a-ie6")){var q=!0;a.on("checkout:reload:spc",b);a.on("checkout:reload:spclite",b)}});"use strict";r.when("A","page-conductor").register("installments-service",
function(a,m){var k=a.$;return{call:function(a,f,g){k.ajax({type:"POST",url:"/gp/buy/installments/handlers/set-item-installments.html/ref\x3dox_spc_inst_toggle",data:{itemId:a,programId:f},dataType:"text",async:!0,cache:!1,headers:m.setAjaxTransitionHeader(),success:g.success||null,error:g.error||null})}}});"use strict";r.when("A","page-transition-controller","page-conductor","page-detector","button-blocker","installments-service","client-side-metrics").register("installments-controller",function(a,
m,k,c,f,g,l){function e(){a.defer(d)}function h(a,b,c){m.hide();k.ajaxUpdatePage(a,b,c,{pushNewFrame:"false"})}function d(){var a=b("#installments-button-blocker");1===a.length&&(a=a.data("blocker-message"),f.show("place-order-installments-blocker",a))}var b=a.$;a.declarative("installments-sync-state",["change"],function(a){var b=a.data.itemId,c=a.$target.is(":checked");a=c?a.data.programId:"";var d={success:h,error:k.ajaxRedirect};l.increaseCount(c?"Checkout:Installments:UpdateOptIn":"Checkout:Installments:UpdateOptOut");
m.show();g.call(b,a,d)});a.on("checkout:reload:spp-revieworder",e);a.on("checkout:reload:spc",e)});"use strict";r.when("A","page-conductor","checkout-modal-popover","page-transition-controller","ajax-utility","page-detector","payments-portal-common","ready").register("spc-payments-portal",function(a,m,k,c,f,g,l){function e(b,c){c={refTag:c,callbackBeforePageUpdate:function(){a.$("div.a-popover button.a-button-close").trigger("click")}};m.isSPP()&&(c.keepCachedPagesData=1);m.loadPage("spc",b,null,
c)}function h(a,e,f){m.isSPP()?(c.blockAllActions(),c.showTransitionInContainer(d("#payment"))):c.show();a="/gp/buy/spc/handlers/pmts-continue-widget.html/ref\x3d"+a;var g=m.setAjaxTransitionHeader({"Cache-Control":"no-cache",pragma:"no-cache","x-amz-checkout-page":"spc"});d.ajax({type:"POST",url:a,data:e,headers:g,contentType:"application/x-www-form-urlencoded; charset\x3dUTF-8;",dataType:"text",success:function(a,b,c){c.getResponseHeader("x-amz-checkout-page")?m.ajaxUpdatePage(a,b,c):f(a)},error:m.ajaxRedirect})}
var d=a.$;return{prepareDelegatedPopovers:function(b){function c(a,b){a=d(a);a.data("aCheckoutModalPopover",b);k.createModal({$declarativeParent:a},b)}a.on("pmts:retail:billing-address-popover",function(a){c(".pmts-change-address-link",{header:b.billingAddressPopoverHeader,footer:"",name:"billing-address",allowScrollOnPage:!0})});a.on("pmts:retail:rewards-registration",function(a){c(".pmts-shop-with-points-learn-more-link",{header:b.rewardsRegistrationPopoverHeader,footer:"",name:"rewards-registration",
allowScrollOnPage:!0})})},handleClaimCodeSubmittedEvent:function(a,c){var e={returnjson:"1",returnFullHTML:"1",hasWorkingJavascript:"1",fromAnywhere:d("input[name\x3dfromAnywhere]").val(),cachebuster:(new Date).getTime(),nextAction:"pipeline-dispatch",embedOnlyData:"1"};a=d.param(a)+"\x26"+d.param(e);h("ox_pay_page_gc_add",a,function(a){l.claimCodePageUpdater(c,a)})},handleChangeBillingAddressRequestedEvent:function(){g.isDesktopSpc()?m.isSPP()?d("#pmts-change-billing-address-popover").trigger("click"):
a.trigger("pmts:retail:billing-address-popover"):(c.show(),m.isPipeliningOn()&&e("billingaddressselect","ox_spc_change_ship_addr"))},handleChangePaymentInstrumentRequestedEvent:function(){c.show();m.isPipeliningOn()&&e("payselect","ox_spc_change_payment")},handleRewardsAccountLearnMoreRequestedEvent:function(){a.trigger("pmts:retail:rewards-registration")},handlePointsAccountSubmittedEvent:function(a){var c={hasWorkingJavascript:"1",isClientTimeBased:d("input[name\x3duseCtb]").val(),nextAction:"dispatch"};
a=d.param(a)+"\x26"+d.param(c);h("ox_spc_points_edit",a,function(a){a=f.jsonify(a);m.redirect(a)})}}});"use strict";r.when("ajax-utility","gc-redeem-controller","page-transition-controller","ready").register("payments-portal-common",function(a,m,k){return{claimCodePageUpdater:function(c,f){f=a.jsonify(f);null!==f?f.widgetJsonData?(c.update(f.widgetJsonData),k.hide()):f.autohandlererror&&m.giftSystemErrorHandling(f.autohandlererror):k.hide()}}});"use strict";r.when("A","page-detector-current-page",
"a-button","a-meter").register("checkout-throttle-error",function(a,m,k,c){var f=a.$;a.on("checkout:reload:throttle",function(){if(f("#checkout-throttle-meter").length){var a=1E3*f('input[name\x3d"waiting-time"]').val()/100;k("#checkout-throttle-return-to-cart").disable();var l=c("#checkout-throttle-meter"),e=0,h=setInterval(function(){l.percent(e);if(100>e)e+=1;else{clearInterval(h);var a=k("#checkout-throttle-return-to-cart");a.text(f("#checkout-throttle-primary-button-active-text").text());a.enable()}},
a)}})});"use strict";r.when("A","weblab-helper").register("nav-bar-helper",function(a,m){function k(){try{r.register("navCF")}catch(a){if(-1===a.message.toLowerCase().indexOf("already registered"))throw a;}}if(m.isNavCFWeblabOn())a.on("checkout:reload",k)});r.when("A").execute(function(a){a.declarative("remaining-customizations-action","click",function(a){a.$currentTarget.parent().find(".remaining_customization_info").removeClass("aok-hidden");a.$currentTarget.hide();a.$event.preventDefault()})});
"use strict";r.when("A","checkout-federation-utilities","client-side-metrics").register("checkout-federation-wrapper",function(a,m,k){function c(a){for(var c=[],e=f;e<a.length;e++)c.push(a[e]);return c}var f=2;return{wrap:function(a,f){try{return a.apply(null,c(arguments))}catch(b){var e=f,h=b,d;d=e;d=m.getExternalDependecies()[d];d=d!==D&&null!==d?d.cti:"Undefined";k.logError(h,"["+e+"] Javascript error thrown while executing wrapper",d,"FATAL");q.console&&q.console.error&&q.console.error(h,e,d)}}}});
"use strict";r.when("A","jQuery","checkout-federation-utilities").register("checkout-federation-injector",function(a,m,k){function c(a){a=a.assetsModule;if(f[a]?0:0<m('script[type\x3d"checkout-asset-trigger"][data-checkout-asset-trigger\x3d"'+a+'"]').length)f[a]=!0,r.register("trigger"+a,function(){})}var f={};a.on("checkout:reload",function(){var a=k.getExternalDependecies(),f;for(f in a)a.hasOwnProperty(f)&&c(a[f])})});"use strict";r.when("A","client-side-metrics").register("checkout-federation-utilities",
function(a,m){return{getExternalDependecies:function(){var k=a.state("triggerExternalDependencies");Object&&Object.keys&&m.increaseCount("Checkout:ExternalDependencies:count:"+(k?Object.keys(k).length:"undefined"));return k===D||null===k?{}:k}}})});
/* ******** */
(function(m){var k=window.AmazonUIPageJS||window.P,H=k._namespace||k.attributeErrors,a=H?H("CheckoutMultiPagePipeline",""):k;a.guardFatal?a.guardFatal(m)(a,window):a.execute(function(){m(a,window)})})(function(m,k,H){m.when("A","a-tooltip").register("button-blocker-mpp",function(a,b){var d=a.$;a.declarative("a-tooltip-button-blocker",["mouseenter","click","touchstart"],function(a){a=a.$target;if(0<a.length){var e=b.get(a),g=d(".place-order-blocker-message.custom-blocker-message");if(g.is(":empty")){var f=
d("#gold-box-button-blocker");1===f.length&&g.text(f.attr("data-blocker-message"))}g.is(":empty")&&d("div.locale-cn").length&&(g=d(".place-order-blocker-message.china-invoice-message"));e?e.updateContent(g.text()):e=b.create(a,{content:g.text()});e.isActive()||e.show()}})});m.when("A","a-popover-base","a-popover-util","button-blocker").register("button-blocker-popover",function(a,b,d,c){function e(a,f){if(f.name)b.show({$trigger:a?a.$target:c.getButtonBlocker(),skin:t,alone:!1,update:p,hide:k,content:f.content,
name:f.name,position:f.position||"triggerVertical"});else if(f=b.show({$trigger:a.$target,skin:t,alone:!1,update:p,hide:k,content:a.$currentTarget.data("blockerText"),position:f.position||"triggerVertical"}))f.update(a.$currentTarget.data("blockerText")),f.updatePosition()}function g(f){var e=f?f.$target:c.getButtonBlocker();e&&a.delay(function(){f&&d.eventOccursWithin(f,e)||b.hide(e)},250)}var f=a.$,t=function(a){return['\x3cdiv class\x3d"a-popover"\x3e\x3cdiv class\x3d"a-popover-wrapper"\x3e','\x3cdiv class\x3d"a-popover-inner"\x3e'+
a+"\x3c/div\x3e",'\x3cdiv class\x3d"a-arrow-border"\x3e\x3cdiv class\x3d"a-arrow"\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'].join("")},w=!1,p=function(a){w||f(".a-popover-inner",this.$popover).html(a)},k=function(){w||a.fadeOut(this.$popover,250)},z={mouseenter:e,mouseleave:g},v={click:e};a.declarative("a-button-blocker",["mouseenter","mouseleave","click"],function(b){try{b.$event.preventDefault()}catch(e){if(!f("html").hasClass("a-lt-ie9"))throw e;}if(!w){var d=(a.capabilities.touch?v:
z)[b.type];d&&d(b,b.data)}});return{create:function(a){a&&a.name&&a.content&&e(null,a)},destroy:function(a){g(null)},lock:function(){w=!0},unlock:function(){w=!1}}});"use strict";m.when("jQuery").register("form-icon-controller",function(a){function b(a){a.is(":checked")?a.closest("label").find("i").removeClass("a-icon-touch-checkbox-inactive").addClass("a-icon-touch-checkbox-active"):a.closest("label").find("i").removeClass("a-icon-touch-checkbox-active").addClass("a-icon-touch-checkbox-inactive");
a.is(":disabled")?a.closest("label").addClass("a-touch-selector-disabled"):a.closest("label").removeClass("a-touch-selector-disabled")}function d(a){a.is(":checked")?a.closest("label").find("i").removeClass("a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active"):a.closest("label").find("i").removeClass("a-icon-touch-radio-active").addClass("a-icon-touch-radio-inactive");a.is(":disabled")?a.closest("label").addClass("a-touch-selector-disabled"):a.closest("label").removeClass("a-touch-selector-disabled")}
function c(){a("label.a-touch-checkbox-control input").each(function(f){b(a(this))});a("label.a-touch-radio-control input").each(function(f){d(a(this))})}function e(){a("label.a-touch-checkbox-control input").unbind("change.form-icon-controller").bind("change.form-icon-controller",function(f){b(a(this))});a("label.a-touch-radio-control input").unbind("change.form-icon-controller").bind("change.form-icon-controller",function(f){d(a(this))});a("label.a-touch-radio-control").unbind("click.form-icon-controller").bind("click.form-icon-controller",
function(f){f=a("input",this);if(!f.is(":disabled")){var b=a("i.a-icon",this),e=a('i[data-a-input-name\x3d"'+f.attr("name")+'"]'),d=a('input[name\x3d"'+f.attr("name")+'"]');d.removeAttr("checked");f.attr("checked","checked");e.addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active");b.addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");d.trigger("change");f.trigger("change")}});a("label.a-touch-checkbox-control").unbind("click.form-icon-controller").bind("click.form-icon-controller",
function(b){b=a("input",this);if(!b.is(":disabled")){var e=a("i.a-icon",this);b.is(":checked")?b.removeAttr("checked"):b.attr("checked","checked");e.toggleClass("a-icon-touch-checkbox-active").toggleClass("a-icon-touch-checkbox-inactive");b.trigger("change")}})}function g(){a("html").hasClass("a-touch")&&(c(),e(),a("label.a-touch-radio-control input").trigger("change"))}m.when("A").execute(function(a){a.on("checkout:reload",g)});return{initializeIconControllers:c,bindIconControllers:e}});"use strict";
m.when("A","checkout-general-utils").register("inline-expander",function(a,b){function d(a){var b=a.parent().find(".a-expander-inner");b.length||(b=c("#"+a.data("expanderContent")));a.data("isShown")&&"false"!==a.data("isShown")?(b.slideUp("fast"),a.data("isShown","false")):(b.slideDown("fast"),a.data("isShown","true"),b=c("#"+a.data("expanderAnchor")),b.length&&c("html, body").animate({scrollTop:b.offset().top},"fast"));a=a.find("i");(a.hasClass("a-icon-collapse")||a.hasClass("a-icon-expand"))&&
a.toggleClass("a-icon-collapse").toggleClass("a-icon-expand")}var c=a.$;a.declarative("a-inline-expander",["click","touchend"],{allowLinkDefault:!0},function(a){a.$event.preventDefault();b.protectAgainstDoubleAction("a-inline-expander",400)||d(c(a.$event.currentTarget))});return{toggleExpander:d}});"use strict";m.when("jQuery").register("checkout-pagination",function(a){function b(a,b,e,c,g){var k=b.find("li.checkout-page-selector.a-selected").removeClass("a-selected");a.find("js-hide").hide().removeClass("js-hide");
d(k,a,b,e,g,c);c.height(c.height())}function d(a,b,d,p,k,z){if(!a.hasClass("a-selected")){var v=parseInt(a.text(),0)-1,A=parseInt(a.siblings(".a-selected").text(),0)-1,q=d.find(".checkout-page-previous"),u=d.find(".checkout-page-next");b.stop(!0,!0).clearQueue();0===v?e(q):c(q);v===k-1?e(u):c(u);d.find(".checkout-page-selector").removeClass("a-selected");a.addClass("a-selected");a=function(){return b.slice(v*p,v*p+p).fadeIn("fast")};isNaN(A)?a().stop(!0,!0):b.slice(A*p,A*p+p).fadeOut("fast",a);0<
v&&g(z)}}function c(a){a.hasClass("a-disabled")&&(a.removeClass("a-disabled"),a.wrapInner('\x3ca href\x3d"javascript:void(false)"/\x3e'))}function e(a){a.hasClass("a-disabled")||(a.addClass("a-disabled"),a.html(a.children("a").html()))}function g(b){var d=0;b.children().filter(":visible").each(function(){d+=a(this).outerHeight(1)});d>b.height()&&b.height(d)}return{initializePagination:function(e){e.unbind("checkoutpagination.initializePagination").bind("checkoutpagination.initializePagination",function(){var e=
a(this),c=e.find(".checkout-pagination-content"),f=c.children().addClass("checkout-pagination-item"),g=e.find("div.a-pagination"),k=parseInt(g.data("checkoutPaginationItemsperpage"),0)||5;if(0!==k&&0!==g.length){var v=Math.ceil(f.length/k);1===v?g.hide():(b(f,g,k,c,v),e.delegate("li.checkout-page-selector","click",function(b){b.preventDefault();d(a(this),f,g,k,v,c)}),e.delegate("li.checkout-page-previous","click",function(b){b.preventDefault();if(a(this).hasClass("a-disabled"))return!1;d(g.find(".a-selected").prev(),
f,g,k,v,c)}),e.delegate("li.checkout-page-next","click",function(b){b.preventDefault();if(a(this).hasClass("a-disabled"))return!1;d(g.find(".a-selected").next(),f,g,k,v,c)}),c.delegate(".checkout-pagination-item","activate.checkout-pagination",function(){var b=a(this),b=f.index(b);g.find("li:contains("+(Math.floor(b/k)+1)+")").click()}))}}).trigger("checkoutpagination.initializePagination")}}});"use strict";m.register("latency-logger",function(){var a=[],b=[];return{start:function(d){var c=(new Date).getTime();
a.push(c);b.push(d)},stop:function(){var d=(new Date).getTime(),c=a.pop();if(k.log_latency&&k.console&&k.console.log){var e=b.pop();console.log(e+": "+(d-c)+" ms")}}}});"use strict";m.when("page-conductor","ajax-utility","jQuery","page-detector","weblab-helper").register("page-conductor-mpp",function(a,b,d,c,e){a.initFunc(function(a){d("body").html(a)},function(a){var b=d("#checkoutDisplayPage"),t=e.isFreshMobileNoScrollOnRefreshEnabled()&&"1"===b.data("freshCheckoutNoScrollToTopMobile");b.removeData("freshCheckoutNoScrollToTopMobile");
b.length&&(b.html(a),c.isMobile()&&(t||d(document).scrollTop(b.offset().top),a=d("h1"),a.attr("tabindex","0").css("outline","none"),a.focus()))})});"use strict";m.when("A","loading-spinner-controller","page-conductor").register("long-calendar-popover-controller",function(a,b,d){var c=a.$,e={},g,f,t=0;a.on("a:popover:show:prime-long-calendar",function(a){g=a=a.popover.$trigger.data("orderid");c(".prime-long-calendar-popover").each(function(a){c(this).parent().hasClass("a-popover-inner")&&(f=c(this))});
b.showSpinner(f,!1);var p;if(c("#spc-another-day-link").length)p="spc",t=0;else if(p="sosp",t=1,e[g]){c(".prime-long-calendar-popover").html(e[g]);return}var k;"spc"===p?k=c("input[name\x3dlineitemids"+a+"]").attr("value"):"sosp"===p&&(k=c("input[name\x3dlineItemEntityIds_"+a+"]").attr("value"));c.ajax({type:"POST",url:"/gp/buy/pipeline/handlers/long-calendar-content.html",data:"lineitemids\x3d"+k+"\x26orderid\x3d"+a+"\x26fromPage\x3d"+p,dataType:"html",async:!0,cache:!1,headers:{"x-amz-checkout-page":p},
success:function(a){c(a).find("#recs-server-error").length?c(".a-button-close").trigger("click"):c(".prime-long-calendar-popover").html(a)},error:d.ajaxRedirect})});a.on("a:popover:hide:prime-long-calendar",function(a){t&&(e[g]=f.html())})});"use strict";m.when("A","a-popover-base").execute(function(a,b){function d(a){var c=$(".ags-popover-content").closest(".a-popover-wrapper");c.find(".a-popover-inner").unbind();var f=a.$declarativeParent;if(b.get(f)){var t=setTimeout(function(){b.hide(f)},250);
c.find(".a-popover-inner").bind("mouseenter",function(a){clearTimeout(t);a.stopPropagation()});c.find(".a-popover-inner").bind("mouseleave",function(b){d(a);b.stopPropagation()})}}var c;a.on("a:popover:beforeShow:ags-badge-popover",function(){var a=$(".ags-popover-content").closest(".a-popover-wrapper"),b=a.find(".a-popover-header");1===b.length&&(c=b.find(".a-button-close").clone(),b.remove());a.find(".a-popover-inner").prepend(c)});a.declarative("a-popover","mouseenter",function(a){"ags-badge-popover"===
a.data.name&&a.$currentTarget.trigger("click")});a.declarative("a-popover","mouseleave",function(a){"ags-badge-popover"===a.data.name&&d(a)})});"use strict";m.when("A","ready").register("checkout-buttom-sheet-controller",function(a){a=a.$;var b=a("#a-page");return{disablePageScrolling:function(){b.css({position:"fixed",top:"-"+k.scrollY+"px"})},enablePageScrolling:function(){var a=Math.abs(b.position().top);b.css({position:"",top:""});k.scrollTo(0,a)}}});m.when("A","ready").register("autopopulate-fields-clear",
function(){});"use strict";m.when("A","page-detector").execute(function(a,b){function d(){b.isSpc()&&c("iframe#typ-assets-spc-iframe").attr("src","/gp/checkoutprefetch/typ-assets.html")}var c=a.$;a.on("checkout:reload:spc",function(){setTimeout(d,1E3)})});"use strict";m.when("A","page-detector","page-detector").execute(function(a,b,d){function c(){0<g(".prime-calendar-container").length&&g(".prime-calendar-container").contents().each(function(a,b){8===b.nodeType&&g(b).replaceWith(b.nodeValue)});w=
t=-1;var a=g("html");a.hasClass("a-ie6")&&(a.removeClass("a-js").addClass("a-no-js"),g(".a-declarative").removeClass("a-declarative"));setTimeout(e,1E3)}function e(){if(d.isSpc())if(d.isSpcLite()){p=g("#left-grid");m=g("#right-grid");w=g("#second-buy-button").height();m.css("min-height",0);p.css("min-height",0);var a=p.height(),b=g("#order-summary-box").height(),e=b+w;if(e<a){m.css("min-height",a);p.css("min-height",a);var b=g(document).height(),c=g(k).height()+200;b>c&&e<a?g("#second-buy-button").show():
g("#second-buy-button").hide()}else a<e&&p.css("min-height",b),g("#second-buy-button").hide()}else-1===t&&(p=g("#left-grid"),m=g("#right-grid"),t=p.height(),w=g("#second-buy-button").height()),b=g("#order-summary-box").height(),e=b+w,e<t?(m.css("min-height",t),p.css("min-height",t),b=g(document).height(),c=g(k).height()+200,b>c&&e<t?g("#second-buy-button").show():g("#second-buy-button").hide()):(t<e&&p.css("min-height",b),g("#second-buy-button").hide())}var g=a.$,f,t,w,p,m;a.on("resize",function(){f&&
k.clearTimeout&&k.clearTimeout(f);f=setTimeout(function(){e();f=null},100)});a.on("checkout:spc:ordersummary:sizeChanged",e);a.on("checkout:reload:spc",c);a.on("checkout:reload:spclite",c)});m.when("error-feature-detection").execute(function(a){a.registerFeature("shipping-speed-selection-controller",1)});"use strict";m.when("A","checkout-general-utils","page-transition-controller","page-detector","page-conductor","cache-page-data-controller").execute(function(a,b,d,c,e,g){function f(b,d,c,f,g){a.trigger("checkout:beforeLoadPage");
e.ajaxUpdatePage(p[b+":"+d+":"+c+":"+f+":"+g].data,p[b+":"+d+":"+c+":"+f+":"+g].status,p[b+":"+d+":"+c+":"+f+":"+g].response,{refTag:f,anchor:c})}function t(a){if(k)k=!1;else if(b.protectAgainstDoubleAction("pipeline-link"))a.preventDefault(),a.stopImmediatePropagation();else{var c=w(a.currentTarget),t=c.data("pipelineLinkFromPage"),q=c.data("pipelineLinkToPage"),u=c.data("pipelineLinkAnchor"),l=c.data("pipelineLinkRef"),c=c.data("pipelineLinkArgs");q&&(a.preventDefault(),a.stopImmediatePropagation(),
e.isSPP()&&g.setCachedPageData(t,q),"object"!==typeof p[t+":"+q+":"+u+":"+l+":"+c]||!p[t+":"+q+":"+u+":"+l+":"+c].pending&&"undefined"===typeof p[t+":"+q+":"+u+":"+l+":"+c].data?(d.show(),a={refTag:l,anchor:u},e.isSPP()&&(a.keepCachedPagesData=1),e.loadPage(t,q,c,a)):p[t+":"+q+":"+u+":"+l+":"+c].pending?(d.show(),p[t+":"+q+":"+u+":"+l+":"+c].dispatch=1):f(t,q,u,l,c))}}var w=a.$,p={},k=!1;a.on("checkout:reload:spc",function(){w("a.pipeline-link.static-link-prefetch").each(function(a,b){a=w(b);a.bind("touchmove",
function(){k=!0});a.bind("click keypress touchend",t);var d=a.data("pipelineLinkFromPage"),c=a.data("pipelineLinkToPage"),g=a.data("pipelineLinkAnchor"),l=a.data("pipelineLinkRef"),n=a.data("pipelineLinkArgs");if(c){p[d+":"+c+":"+g+":"+l+":"+n]={};p[d+":"+c+":"+g+":"+l+":"+n].pending=1;p[d+":"+c+":"+g+":"+l+":"+n].dispatch=0;var E={refTag:l,anchor:g,resultscallback:function(a,b,t){p[d+":"+c+":"+g+":"+l+":"+n].pending=0;a?(p[d+":"+c+":"+g+":"+l+":"+n].data=a,p[d+":"+c+":"+g+":"+l+":"+n].response=t,
p[d+":"+c+":"+g+":"+l+":"+n].status=b,p[d+":"+c+":"+g+":"+l+":"+n].dispatch&&f(d,c,g,l,n)):p[d+":"+c+":"+g+":"+l+":"+n].dispatch&&(E.resultscallback=H,e.loadPage(d,c,n,E))}};a="isAsync\x3d1\x26isClientTimeBased\x3d1";n&&(a+="\x26"+n);e.loadPage(d,c,a,E)}})})});"use strict";m.when("A","ready").execute(function(a){var b=a.$,d,c,e;a.on("checkout:beforeReload",function(){e!==H&&(c.css("margin-bottom",e+"px"),e=H)});a.on("checkout:reload:spc",function(){d=b("#pyo-button-pinned");c=b("body");if(1===d.length&&
"fixed"===d.css("position")&&e===H){var a=c.css("margin-bottom");e=parseInt(a,10);c.css("margin-bottom",e+d.height()+"px")}})});"use strict";m.when("A","loading-spinner-controller","page-transition-controller","page-conductor","ajax-utility","checkout-general-utils","page-detector","client-side-metrics").register("inline-address-popover-controller",function(a,b,d,c,e,g,f,t){function w(){F="T1"===h("#fixPopupModalInfiniteSpinner").val();a.defer(function(){h("#spc-top").find(".change-address-popover-link").each(function(){var a=
h(this);a.data("action")&&-1<a.data("action").indexOf("a-checkout-modal-popover")&&a.attr("tabindex",0)})});var b=h(".a-popover-modal");b.find("#shipping-address-popover").remove();b.find("#billing-address-popover").remove();a.defer(function(){p();m()})}function p(){h("#desktop-shipping-address-div .screenreader-address-span").text(" "+h("#desktop-shipping-address-div .displayAddressAddressLine1").text())}function m(){h("#billing-address .duplicate-address").is(":visible")?h("#billing-address .screenreader-address-span").text(" "+
h("#desktop-shipping-address-div .displayAddressAddressLine1").text()):h("#billing-address .screenreader-address-span").text(" "+h("#billing-address .displayAddressAddressLine1").text())}function z(b,f,g){function I(b){b.isSameAsShipping?(h("#billing-address .single-address").hide(),h("#billing-address .duplicate-address").show()):b.addressHTML&&(h("#billing-address .duplicate-address").hide(),h("#billing-address .single-address").html(b.addressHTML).show());m();a.trigger("checkout:billing-address-update")}
function l(a){var b=h("#left-grid");a.isSameAsShipping?b.find(".pmts-billing-address-details").html(b.find(".billing-duplicate-address").html()):a.addressHTML&&b.find(".pmts-billing-address-details").html(a.addressHTML)}function n(a){return"shouldRefreshSPCOnChange"in a&&1===a.shouldRefreshSPCOnChange}if(g.getResponseHeader("x-amz-checkout-page")){var B=g.getResponseHeader("x-amz-checkout-fatal-error");if(null!==B&&B!==H){k.location=B;return}h(".a-button-close").trigger("click");return c.ajaxUpdatePage(b,
f,g)}if((b=e.jsonify(b))&&(b.isSameAddress||b.isSameAsShipping||b.addressHTML)&&(0===h("#billing-address").size()?l(b):I(b),!n(b))){d.hide();h(".a-button-close").trigger("click");b.requestid&&(t.setAsyncRequestId(b.requestid),t.sendUEPageLoadStats());return}c.redirect(b);b&&b.conductoraction?h(".a-button-close").trigger("click"):n(b)||(d.hide(),h(".a-button-close").trigger("click"))}function v(a,d){d=d.toLowerCase();if(F){if("none"===h("#"+d+"-address-popover").closest(".a-popover").css("display")){I.push(d+
"-Address: Not populating popup modal is hidden");return}}else{if(!C){I.push(d+"-Address: Not populating content already loaded");return}C=!1}var c=h("#"+d+"-address-popover .select-address-main"),e="/gp/buy/pipeline/handlers/update-"+d+"-address.html",f=!1;"true"===a.isCampus&&(f=c.closest(".select-address-main"),f.find(".popover-pagination").remove(),f="true"===a.hideAddAddress||!1);U(a.addresses,c,2,3,e,d,"pageConductor.ajaxRedirect",f);a=c.find(".select-address-page").filter(function(){return"template"!==
h(this).data("addresspage")}).length;1<a&&(a=n(0,a,l),f=c.closest(".select-address-main"),f.find(".popover-pagination").remove(),a.appendTo(f).show());!1===B.modifiedForCampus&&c.closest(".address-popover").find(".address-popover-sidebar").css("visibility","visible").hide().fadeIn(300);b.hideSpinner(c);I.push(d+"-Address: Hiding spinner");S(h("#"+d+"-address-popover"));c.find(".select-address-page").filter(function(){return 0===h(this).data("addresspage")}).fadeIn(300)}function A(a){I.push("Billing-Address: AJAX Call returned with data: "+
e.jsonify(a));v(a,"Billing")}function q(a){I.push("Shipping-Address: AJAX Call returned with data: "+e.jsonify(a));v(a,"Shipping");var b=h("#shipping-address-popover .select-address-main"),d=h("#popover-store-pickup-search-spc");a.showPickupSearch?(d.show(),a.useTwoZipStoreSearch?(d.find(".secondary-pickup-input").show(),d.find("input[name\x3d'searchCriterion']").val("storeTwoZips"),d.find(".popover-pickup-input input").removeClass("single-input").addClass("two-inputs")):d.find(".secondary-pickup-input input").val("")):
d.hide();a.canShipToMultiple?h("#spc-popover-ship-to-multiple-link").show():h("#spc-popover-ship-to-multiple-link").hide();d.find(".popover-pickup-input input").focus(function(){h(this).hasClass("pickup-search-field")&&h(this).removeClass("a-color-secondary").val("")});a=b.find(".add-address-button");a.hasClass("pipeline-link")||(a.bind("click",{usecase:"addaddress",reftag:"ox_spc_shipaddr_addnewbox_popover"},u),b=h("#spc-popover-add-new-address-link a"),b.bind("click",{usecase:"addaddress",reftag:"ox_spc_shipaddr_addnewlink_popover"},
u),d=h("#spc-popover-edit-address-link a"),d.bind("click",{usecase:"editaddress",reftag:"ox_spc_shipaddr_editlink_popover"},u),g.bindActionEnterKeyOnButton(a),g.bindActionEnterKeyOnButton(b),g.bindActionEnterKeyOnButton(d));a=h("#spc-popover-ship-to-multiple-link a");a.hasClass("pipeline-link")||(a.bind("click",{usecase:"shiptomultiple",reftag:"ox_spc_shipaddr_multilink_popover"},u),g.bindActionEnterKeyOnButton(a))}function u(a){var b;if(a&&a.data&&a.data.usecase){b=a.data.usecase;a=a.data.reftag?
a.data.reftag:"shipaddr_popover_link";var c=null,e="";"addaddress"===b?(c="/gp/buy/addressselect/handlers/display.html",e="#new-address"):"editaddress"===b?c="/gp/buy/addressselect/handlers/display.html":"shiptomultiple"===b&&(c=g.addQueryStringParameter("/gp/ordering/checkout/item/select.html","useCase","multiAddress"));c&&(d.show(),c=g.addQueryStringParameter(c,"ref",a),c=g.addQueryStringParameter(c,"hasWorkingJavascript","1"),k.location.href=c+e)}}function l(a){if(a&&a.target){var b=h(a.target),
d=parseInt(b.closest("li").data("goto"),10),c=h(a.target).closest(".select-address-main"),e=c.find(".select-address-page").filter(function(){return"template"!==h(this).data("addresspage")}).length;c.find(".select-address-page:visible").fadeOut(300,function(){var a=n(d,e,l);c.find(".popover-pagination").remove();a.appendTo(c).show();c.find("div").filter(function(){return h(this).data("addresspage")===d}).fadeIn(300)})}}function n(a,b,d){var c=h("div[data-pagination\x3d'template']").clone().attr("data-pagination",
"copy"),e=c.find(".pagination-next-disabled"),f=a-1;0>f&&(f=0);var I=f+2;I>=b&&(I=b-1,f=I-2,0>f&&(f=0));3>f&&(f=1);4>b-I&&(I=b-2);e.before(h("\x3cli\x3e").addClass("pagination-link").data("goto",0).html("\x3ca\x3e1\x3c/a\x3e").attr("tabindex",0));for(2<f&&e.before(h("\x3cli\x3e").addClass("a-disabled").html("..."));f<=I;f++)e.before(h("\x3cli\x3e").addClass("pagination-link").data("goto",f).html("\x3ca\x3e"+(f+1)+"\x3c/a\x3e").attr("tabindex",0));3<b-I&&e.before(h("\x3cli\x3e").addClass("a-disabled").html("..."));
e.before(h("\x3cli\x3e").addClass("pagination-link").data("goto",b-1).html("\x3ca\x3e"+b+"\x3c/a\x3e").attr("tabindex",0));0<a&&(c.find(".pagination-previous-disabled").hide(),c.find(".pagination-previous-enabled").addClass("pagination-link").data("goto",a-1).attr("tabindex",0).show());a<b-1&&(e.hide(),c.find(".pagination-next-enabled").addClass("pagination-link").data("goto",a+1).attr("tabindex",0).show());c.find("li.pagination-link").filter(function(){return h(this).data("goto")===a}).removeClass("pagination-link").addClass("a-selected");
b=c.find(".pagination-link");b.bind("click",d);g.bindActionEnterKeyOnButton(b);return c}function E(){return"template"===h(this).data("addresspage")}function L(){return"template"===h(this).data("addressrow")}function Q(){return"template"===h(this).data("newaddressslot")}function J(){return"template"===h(this).data("addressslot")}function O(){return"template"===h(this).data("addressgroup")}function R(a,b,c){var d=h("#shipping-address-popover .address-book").filter(O).clone().data("addressgroup","copy").show();
d.find("h4").html(b);d.find(".popover-address-book-container").html(a.contents());c&&d.find(".popover-address-book-container").removeClass("a-padding-base");return a.empty().prepend(d)}function U(a,b,c,e,f,I,t,l){b.find(".select-address-page").filter(function(){return"template"!==h(this).data("addresspage")}).remove();for(var n=0,B=0,X=0,w=0,p,q=!1,v=function(){h(this).height()>w&&(w=h(this).height())},k=0;n<=a.length;k++){for(var C=b.find(".select-address-page").filter(E).clone().data("addresspage",
k),A=0;A<c&&n<=a.length;A++){var m=C.find(".select-address-row").filter(L).clone().data("addressrow","copy").show();n<a.length&&a[n].addressBook&&(p=a[n].addressBook);for(var u=0;u<e&&n<=a.length;u++){var F;if(n===a.length)F=m.find(".select-address-slot").filter(Q).clone().data("newaddressslot","copy").show(),p&&F.find(".add-address-button").width(170),!0===l&&F.hide();else{if(p&&a[n].addressBook!==p)continue;F=m.find(".select-address-slot").filter(J).clone().data("addressslot","copy").show();F.find(".select-address-slot-content").append(a[n].html);
F.unbind("deliverTo-slotSelected").bind("deliverTo-slotSelected",function(){h(this).find(".select-address-button a").click()});a[n].isInvoiceAddress&&F.append(F.find(".invoice-address-note").clone().show());var M={seturl:f,setargs:a[n].setArgs+"\x26index\x3d"+n,callerType:I,errorhandler:t,popoverdiv:b.closest(".address-popover")},z;z=a[n].isSelected?F.find(".use-current-address-button"):F.find(".use-different-address-button");a[n].isSuggestedPUP?function(a){z.unbind("click").bind("click",function(){d.show()}).show().find("a").attr("href",
a)}(a[n].insertUrl):z.unbind("click").bind("click",M,P).show();g.bindActionEnterKeyOnButton(z)}u===e-1&&F.addClass("a-span-last");m.append(F);n++}A===c-1&&m.addClass("a-spacing-base");p&&(n<a.length&&a[n].addressBook!==p||A===c-1&&!q?m=R(m,p,!1):q=!0);C.find("div:first").append(m)}B++;q&&(C=R(C,p,!0),q=!1);b.append(C);C.show();b.height()>parseInt(b.css("min-height"),10)&&b.css("min-height",b.height());C.height()>X&&b.find(".select-address-page").css("min-height",C.height());C.find(".select-address-slot-content").each(v);
X=C.height();C.hide()}b.find(".select-address-slot-content").height(w);h(".screenreader-address-span").each(function(){var a=h(this);a.text(" "+a.closest(".select-address-slot").find("li.displayAddressAddressLine1").text())})}function P(a){var b,f,g;a&&a.data&&a.data.seturl&&a.data.setargs&&a.data.callerType&&a.data.errorhandler&&(b=a.data.seturl,f=a.data.setargs,g=a.data.callerType);d.show();a=h("input[name\x3duseCtb]").val();f=f+"\x26returnFullHTML\x3d1\x26hasWorkingJavascript\x3d1\x26isClientTimeBased\x3d"+
a+"\x26responsive\x3d1";a=h("input#deliver-to-input");a.length&&(f+="\x26deliverTo\x3d"+a.val());a={"x-amz-checkout-page":"spc"};h("#passAjaxRequestHeader").length&&(a["x-amz-checkout-transition"]="ajax");G({type:"POST",url:b,data:f,dataType:"text",async:!0,cache:!1,contentType:"application/x-www-form-urlencoded;charset\x3dutf-8",headers:a,success:function(a,b,f){"shipping"===g?f.getResponseHeader("x-amz-checkout-page")?(h(".a-button-close").trigger("click"),c.ajaxUpdatePage(a,b,f)):(a=e.jsonify(a))&&
a.isSameAddress?(d.hide(),h(".a-button-close").trigger("click"),a.requestid&&(t.setAsyncRequestId(a.requestid),t.sendUEPageLoadStats())):(p(),c.redirect(a)):"billing"===g&&z(a,b,f)},error:function(a,b,d){c.ajaxRedirect(a,b,d)}})}function T(){B.initialized&&setTimeout(function(){var a=h("#shipping-address-popover .select-address-main");a.css("minHeight",B.shippingAddressPopoverMinHeight).find(".select-address-page").css("minHeight",B.selectAddressPageMinHeight);a.closest(".address-popover").find(".address-popover-sidebar").show()},
300);B.modifiedForCampus=!1}function G(a){if(F){M&&M.abort();var b=a.success;a.success=function(a,c,d){M=null;b&&"function"===typeof b&&(console.log("Success"),b(a,c,d))};var c=a.error;a.error=function(a,b,d){M=null;console.log("Error");"abort"!==b&&c&&"function"===typeof c&&c(a,b,d)}}M=h.ajax(a)}function y(a,b){if(a){b=b||0;I=["Starting spinner monitor"];var c=a.attr("id");K(c);W(c,function(){K(c);var d="none"!==h(".a-popover-modal").css("display"),e=0<a.children(".loading-spinner").length;d&&e&&
(d=1E4+b,d="Popover Modal ("+a.attr("id")+") is still waiting after "+d/1E3+" secs. Current status is: "+I,g.logError(d))},1E4)}}function S(a){a&&(a=a.attr("id"),K(a))}function K(a){X[a]&&(clearTimeout(X[a]),delete X[a])}function W(a,b,c){b=setTimeout(b,c);X[a]=b}var h=a.$;if(!h("html").hasClass("a-ie6")){var C=!1;if(!h("html").hasClass("a-touch")){var B={initialized:!1,modifiedForCampus:!1,shippingAddressPopoverMinHeight:0,selectAddressPageMinHeight:0},F=!1;a.declarative("search-locker",["click",
"touchend"],function(){if(!g.protectAgainstDoubleAction("search-locker")){var a=h("input[name\x3d'searchLockerFormAction']").val();if(a){d.show();var b='\x3cform name\x3d"searchLockerForm" action\x3d"'+a+'" method\x3d"POST"\x3e';h("#popover-store-pickup-search-spc input").each(function(){b+='\x3cinput name\x3d"'+h(this).attr("name")+'" value\x3d"'+h(this).val()+'" type\x3d"hidden" /\x3e'});b+='\x3cinput name\x3d"hasWorkingJavascript" value\x3d"1" type\x3d"hidden" /\x3e';b+="\x3c/form\x3e";a=h(b);
h("body").append(a);a.submit()}}});a.on("a:popover:hide:billing-address",function(){C=!1});a.on("a:popover:hide:shipping-address",function(){C=!1;B.modifiedForCampus&&T()});a.on("a:popover:beforeShow:shipping-address",function(a){if((a=a&&a.popover?a.popover.data:H)&&!0===a.returnCampusAddressesOnly){a=h("#shipping-address-popover .select-address-main");var b=a.closest(".select-address-main");a.closest(".address-popover").css("minWidth",b.width()).find(".address-popover-sidebar").hide();B.modifiedForCampus=
!0;!1===B.initialized&&(B.shippingAddressPopoverMinHeight=a.css("minHeight"),B.selectAddressPageMinHeight=a.closest(".address-popover").find(".select-address-page").css("minHeight"),B.initialized=!0);a.css("minHeight","").find(".select-address-page").css("minHeight","")}else B.modifiedForCampus=!1});a.on("a:popover:show:shipping-address",function(a){C=!0;b.showSpinner(h("#shipping-address-popover"),!1);y(h("#shipping-address-popover"));I.push("Shipping-Address: Executing AJAX request");G({type:"POST",
url:"/gp/buy/pipeline/handlers/shipping-address-select-content.html",dataType:"text",dataFilter:function(a){return e.jsonify(a)},data:a&&a.popover?a.popover.data:H,async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},success:q,error:c.ajaxRedirect})});a.on("a:popover:show:billing-address",function(a){C=!0;b.showSpinner(h("#billing-address-popover"),!1);y(h("#billing-address-popover"));I.push("Billing-Address: Executing AJAX request");G({type:"POST",url:"/gp/buy/pipeline/handlers/billing-address-select-content.html",
dataType:"text",dataFilter:function(a){return e.jsonify(a)},async:!0,cache:!1,headers:{"x-amz-checkout-page":"spc"},success:A,error:c.ajaxRedirect})});a.on("checkout:reload:spc",w);var M,I=[],X={}}}});"use strict";m.when("A").register("thirdparty-redirect-popover-controller",function(a){function b(){k.history&&k.history.pushState?g(document).delegate("span.place-your-order-button-span","click",function(a){a.preventDefault()}):(g("span.place-your-order-button-span").removeClass("a-declarative"),g("input.place-your-order-button").parents("span.a-button-primary").addClass("place-order-button-link"))}
function d(a){var b=g(a);0<b.filter("#thirdpartyform-headless").length?(g("#spc-desktop").append('\x3cdiv id\x3d"thirdparty-redirecting-hidden-form" style\x3d"display:none"\x3e\x3c/div\x3e'),g("#thirdparty-redirecting-hidden-form").append(b),g("#thirdpartyform-headless").submit()):(k.history.pushState({state:"pushed-thirdparty-submit"},null,g("#spc-form").attr("action")),b=document.open(),b.write(a),b.close(),k.onpopstate=function(a){null===a.state&&k.location.reload()})}function c(a){g("#spc-form").submit()}
function e(a){f&&f.abort();var b=a.success;a.success=function(a,c,d){f=null;b&&"function"===typeof b&&b(a,c,d)};var c=a.error;a.error=function(a,b,d){f=null;"abort"!==b&&c&&"function"===typeof c&&c(a,b,d)};f=g.ajax(a)}var g=a.$;a.on("checkout:reload:spc",b);a.on("checkout:reload:spp-revieworder",b);a.on("a:popover:show:thirdparty-redirecting",function(a){a=g("#spc-form");a.append("\x3cinput type\x3d'hidden' name\x3d'placeYourOrder1' value\x3d'1' /\x3e");a.append("\x3cinput type\x3d'hidden' name\x3d'headlessForm' value\x3d'1' /\x3e");
e({type:"POST",url:a.attr("action"),data:a.serialize(),async:!0,cache:!1,success:d,error:c})});var f});"use strict";m.when("A","order-summary-controller","inline-expander","client-side-metrics").register("order-summary-controller-mpp",function(a,b,d,c){var e=a.$,g=k.P&&k.P.AUI_BUILD_DATE;a.on("checkout:reload:spc",function(){b.initOrderSummary();var a=e("#exchange-rate-link"),t=e("#switch-currency-link");if(!g){c.increaseCount("removeauijs67");if(e("html").hasClass("a-touch"))t.unbind("click").bind("click",
function(a){d.toggleExpander(e(a.currentTarget))}),a.unbind("click").bind("click",function(a){d.toggleExpander(e(a.currentTarget))});else{var w=e("#spc-order-summary");w.find(".regulatory-fee-link").removeAttr("href").attr("tabindex",0);w.find(".vat-breakdown-link").removeAttr("href").attr("tabindex",0)}d.toggleExpander(t);d.toggleExpander(a)}})});"use strict";m.when("A","page-transition-controller","page-conductor").register("pallet-delivery-controller",function(a,b,d){function c(a,c,e){if(e.getResponseHeader("x-amz-checkout-pallet-warning"))b.hide(),
g(".pallet-delivery-update").hide(),g(".pallet-delivery-display").show(),g(".pallet-delivery-warning-display").show();else{if(e.getResponseHeader("x-amz-checkout-page"))return d.ajaxUpdatePage(a,c,e);d.redirect(a)}}function e(a,c,e){e.getResponseHeader("x-amz-checkout-pallet-warning")?(b.hide(),g(".pallet-delivery-disclaimer-mobile").hide(),g(".pallet-delivery-warning-mobile").show()):d.redirect(a)}var g=a.$;g("html").hasClass("a-ie6")||(a.declarative("pallet-delivery-update","click",function(a){a=
a.$currentTarget.closest(".pallet-delivery-block");var b=a.find("input[type\x3d'radio']:checked").val();a.data("selection",b);a.find(".pallet-delivery-display").hide();a.find(".pallet-delivery-update").show()}),a.declarative("pallet-delivery-select","click",function(a){var b=a.$currentTarget;a=a.$target;var c=b.find("input[type\x3d'radio']"),b=b.closest(".pallet-delivery-block"),d=b.data("selection")!==c.val();d||(b.find(".pallet-delivery-update").hide(),b.find(".pallet-delivery-display").show());
a.is(c)||(c.attr("checked",!0),d&&c.change())}),a.declarative("pallet-delivery-select","change",function(a){var e=a.$currentTarget.find("input[type\x3d'radio']");a=a.data.addressId;e=e.attr("value");b.show();e="cachebuster\x3d"+(new Date).getTime()+"hasWorkingJavascript\x3d1\x26addressId\x3d"+a+"\x26palletDelivery\x3d"+e;a=d.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});g.ajax({type:"POST",url:"/gp/buy/spc/handlers/set-pallet-delivery.html/ref\x3dox_spc_set_pallet_delivery",data:e,dataType:"text",
async:!0,cache:!1,headers:a,success:c,error:d.ajaxRedirect})}),a.declarative("show-pallet-delivery-disclaimer-mobile","click",function(a){g(".pallet-delivery-disclaimer-mobile").show();g(".pallet-delivery-warning-mobile").hide()}),a.declarative("hide-pallet-delivery-disclaimer-mobile","click",function(a){g(".pallet-delivery-disclaimer-mobile").hide();g(".pallet-delivery-warning-mobile").hide()}),a.declarative("set-pallet-delivery-preference-mobile","click",function(a){a=a.data.addressId;var c=g('input[name\x3d"pallet-delivery-option"]:checked').val();
b.show();a="cachebuster\x3d"+(new Date).getTime()+"hasWorkingJavascript\x3d1\x26addressId\x3d"+a+"\x26palletDelivery\x3d"+c;c=d.setAjaxTransitionHeader({"x-amz-checkout-page":"spc"});g.ajax({type:"POST",url:"/gp/buy/spc/handlers/set-pallet-delivery.html/ref\x3dox_spc_m_set_pallet_delivery",data:a,dataType:"text",async:!0,cache:!1,headers:c,success:e,error:d.ajaxRedirect})}))});"use strict";m.when("A","page-detector").register("time-preferences-controller",function(a,b){function d(a){a=g(a.target).closest("a");
var b=a.next(".time-preferences-options-list");b.is(":hidden")?(a.find(".time-pref-title").hide(),a.find(".time-pref-title-expanded").show(),b.slideDown("fast")):(a.find(".time-pref-title-expanded").hide(),a.find(".time-pref-title").show(),b.slideUp("fast"))}function c(a){var b=g(a.target);a=b.closest(".time-preferences-options-list").prev(".time-preferences-link").find(".time-pref-title-details");f&&(a=b.closest(".a-expander-container").find(".time-pref-title-details"));b=b.closest(".time-preferences-option").find(".time-preference-label").text();
a.text(b)}function e(){if(0!==g("div.locale-cn").length&&g("html").hasClass("a-touch")){var a=g("#spc-orders");a.find(".time-preferences-option").unbind("click").bind("click",c);a.find(".time-preferences-link").unbind("click").bind("click",d)}}var g=a.$;if(!g("html").hasClass("a-ie6")){var f=k.P&&k.P.AUI_BUILD_DATE;a.on("checkout:reload",e)}});"use strict";m.when("A","page-detector").register("imb-controller",function(a,b){function d(){a.defer(function(){var a=c("#spc-imb").find(".imb-message-link");
0<a.length&&a.find("i.js-hide").remove()})}var c=a.$;if(!c("html").hasClass("a-ie6"))a.on("checkout:reload:spc",d)});"use strict";m.when("A","fast-track-controller","page-detector").register("carrier-details-controller",function(a,b,d){function c(){a.defer(function(){g("#spc-reservation-countdown").length&&e()})}function e(){var a=g("#spc-reservation-countdown");if(a.length){var c=a.data("secondsLeft"),d=function(c,e){c--;if(0>=c)e.find(".cn-wireless-notice-js").hide(),e.find(".cn-wireless-expired-message").show();
else{var g=b.getFastTrackCountdown(c,a);e.find("span[data-field\x3d'countdown']").html(g);e.find(".cn-wireless-notice-js").show();e.find(".cn-wireless-expired-message").hide();setTimeout(function(){d(c,e)},1E3)}};d(c,a)}}var g=a.$;g("html").hasClass("a-ie6")||(a.on("a:popover:beforeShow:simcard",function(a){a.popover.$popover.find(".popover-content").html(g("#carrier-sim-card-details").html());a.popover.updatePosition()}),a.on("checkout:reload:spc",c))});"use strict";m.when("A","checkout-buttom-sheet-controller",
"client-side-metrics").execute(function(a,b,d){a.on("a:sheet:beforeShow:assuranceWidget",function(a){d.increaseCount("Checkout:assuranceWidget:WidgetClicked");b.disablePageScrolling()});a.on("a:sheet:afterShow:assuranceWidget",function(a){d.increaseCount("Checkout:assuranceWidget:BottomSheetShown")});a.on("a:sheet:afterHide:assuranceWidget",function(a){b.enablePageScrolling();d.increaseCount("Checkout:assuranceWidget:BottomSheetClosed")})});"use strict";m.when("A","page-transition-controller","checkout-general-utils",
"address-utilities","client-side-metrics").register("as-controller",function(a,b,d,c,e){function g(a){a=a.find("input[type\x3d'checkbox']");0<h(".checkout-as-mobile").length?f(a):0<h(".checkout-as-tablet").length&&t(a)}function f(a){var b=k.P&&k.P.AUI_BUILD_DATE,c=a.closest(".address-book-entry").find(".ship-to-this-link-area"),d=c.find(".a-button"),f=c.find("a");0>=a.length||a.is(":checked")?(d.removeClass("a-button-disabled"),b?(a=c.find(".ship-to-this-link-value"),f.attr("href",a.text())):(e.increaseCount("removeauijs24"),
f.attr("href",f.data("select-locker-url")))):(d.addClass("a-button-disabled"),f.removeAttr("href"))}function t(a){var b=h("#ship-to-this-link-area"),c=b.find(".a-button"),b=b.find("input[type\x3d'submit']");0>=a.length||a.is(":checked")?(c.removeClass("a-button-disabled"),b.prop("disabled",!1)):(c.addClass("a-button-disabled"),b.attr("disabled",!0))}function w(a){a.find("div.enter-address-form form").find("input.a-form-error, select.a-form-error").filter(function(){return 0===h(this).parents().filter(".enhanced-input").length}).closest(".a-input-text-wrapper").addClass("a-form-error")}
function p(a){a=a.find("div.enter-address-form form");a.find(".enhanced-input .enterAddressFormInputError").addClass("a-form-error");a.find(".enhanced-input input.a-form-error, .enhanced-input select.a-form-error, .enhanced-input label.a-form-error").each(function(){h(this).parents(".a-input-text-wrapper").last().addClass("a-form-error")})}function D(a){var b=a.siblings("div.a-input-text-wrapper").andSelf();b.siblings().unwrap();a.removeClass("a-input-text-wrapper");for(var c=h(),b=b.first();b.length;b=
b.parent().nextAll("div.a-input-text-wrapper:first"))if(b.hasClass("a-input-text-wrapper")){var d=b.nextUntil(":not(.a-input-text-wrapper)").andSelf();d.wrapAll("\x3cdiv class\x3d'a-input-text-group'\x3e\x3c/div\x3e");1===d.length&&(c=c.add(b))}c.unwrap();a=a.closest("form");a.find(".a-input-text-group").siblings("div").andSelf().addClass("a-spacing-base");a.find(".a-touch-select").addClass("a-spacing-mini")}function z(a){a.find("#identity-add-new-address select.#enterAddressCountryCode").closest(".a-input-text-wrapper").each(function(){var a=
h(this),b=h(this).closest("form").find("#address-country-container");a.appendTo(b).removeClass("a-input-text-wrapper").addClass("a-spacing-medium")});a=a.find("#identity-add-new-address .a-input-text-wrapper:has(.a-touch-select), #identity-add-new-address .a-input-text-wrapper:has(.javascript-unwrap-row)").not(":has(.enhanced-input)");D(a)}function v(a){var b=a.find(".store-results-list"),c=b.siblings(":not(script)");h(k).unbind("resize.store-results").bind("resize.store-results",function(){A(b,c)});
A(b,c)}function A(a,b){var c=h(k).height();b.each(function(){c-=h(this).outerHeight()});a.height(c)}function q(a){a.undelegate("div.address-book-entry","click.resultToMapBinding").delegate("div.address-book-entry","click.resultToMapBinding",function(){var a=h(this);a.hasClass("address-book-entry")||(a=a.closest("div.address-book-entry"));0!==a.length&&(a=a.index("div.address-book-entry"),k.Map&&k.Map.selectPin&&k.Map.selectPin(a))});a.find("label.a-touch-radio a.a-button").unbind("click.checkout-as").bind("click.checkout-as",
function(a){b.show();a.stopPropagation()})}function u(a){k.Map&&k.Map.registerPinClickCallback&&k.Map.registerPinClickCallback(function(b){var c=a.find("div.store-results-list");b=c.find("div.address-book-entry:eq("+b+")");b.find(".a-control-row").trigger("activate.checkout-pagination").trigger("click",["preventAddressSelectionChangedTrigger"]);b=b.position().top;var d=c.scrollTop();c.animate({scrollTop:d+b+"px"})})}function l(a){k.mapBubbleButtonClicked=function(c){c=h(c).data("storeid");c=a.find("div.store-results-list").find("div.address-book-entry:eq("+
c+")").find(".a-button").attr("href");b.show();d.redirectWithJavascript(c)}}function n(a){a.find("form.controlEnterKeyFormSubmission").find("input[type\x3d'text']").unbind("keypress.controlEnterKeyFormSubmission").bind("keypress.controlEnterKeyFormSubmission",function(a){if(a.which&&13===a.which||a.keyCode&&13===a.keyCode){if(a=h(this).closest("form").find("button[type\x3d'submit'], input[type\x3d'submit']"),a.length)return a.click(),!1}else return!0})}function E(a){a.find("form.controlEnterAddressForm").find("input[type\x3d'text']").unbind("keypress.controlEnterAddressForm").bind("keypress.controlEnterAddressForm",
function(a){return(a.which&&13===a.which||a.keyCode&&13===a.keyCode)&&0<h(this).closest("div").next().length?(d.moveToNextInput(h(this).closest("div")),!1):!0})}function L(a){m.when("checkout-pagination").execute(function(b){b.initializePagination(a.find("div.checkout-pagination-container"));a.find(".a-icon-touch-radio-active").closest(".checkout-pagination-item").trigger("activate.checkout-pagination")})}function Q(){var a=h("div.checkout-as-tablet");a.length&&(a.hasClass("checkout-as-store-search-results")&&
(O(a),v(a),q(a),u(a),l(a),a.find("div.store-opening-hours br").replaceWith(",\x26nbsp;")),L(a),z(a),a.find("div.address-options div.address-feature div.a-expander-content[aria-expanded\x3dfalse]").css({display:"none"}),w(a),p(a),R(a),n(a),c.countrySpecificLabelOptimizationCheck(a),m.when("tablet-address-select-controller").execute(function(){a.find("div.address-book-entry").find(".a-icon-touch-radio-active").closest("label.a-declarative").trigger("click")}))}function J(a){a.find("input[type\x3d'hidden']").each(function(){h(this).appendTo(h(this).closest("form"))})}
function O(a){a.undelegate("click.as").delegate(".addr-display","click.as",function(b,c){b=h(this).closest(".a-box");0===b.length&&(b=h(this).closest(".address-book-entry"));if(!b.hasClass("active-box")){var d=a.find(".active-box");d.removeClass("active-box").addClass("inactive-box");d.find("i").removeClass("a-icon-touch-radio-active");d.find("i:not('.locker-restriction-reminder')").addClass("a-icon-touch-radio-inactive");b.removeClass("inactive-box").addClass("active-box");"preventAddressSelectionChangedTrigger"!==
c&&b.trigger("address-selection-changed");a.hasClass("checkout-as-store-search-results")&&g(b)}});var b=a.find(".address-book-entry:has(input[type\x3dradio]:checked)");b.trigger("click");a.hasClass("checkout-as-store-search-results")&&g(b)}function R(a){m.when("a-form-controls").execute(function(){a.find("select.a-touch-select-input").each(function(){var a=h(this);""!==a.val()&&"--"!==a.val()&&a.change()})})}function U(a){var b=h("input#deliver-to-input").val();if(0<b.length){var c=h(a.currentTarget).attr("href");
h(a.currentTarget).attr("href",c+"\x26deliverTo\x3d"+encodeURIComponent(b))}}function P(){var a=h("div.checkout-as-mobile"),b=0<h("form#address-ui-checkout-form").length;a.length&&!b&&(k.P&&k.P.AUI_BUILD_DATE?(J(a),z(a),c.countrySpecificLabelOptimizationCheck(a),p(a),y(a),a.hasClass("checkout-as-store-search-results")&&(a=h(".address-book-entry:has(input[type\x3dradio]:checked)"),0<a.length&&g(a))):(e.increaseCount("removeauijs25"),J(a),w(a),p(a),O(a),z(a),R(a),c.countrySpecificLabelOptimizationCheck(a),
E(a),y(a),n(a)))}function T(){var a=h("div.checkout-as-desktop");a.length&&c.countrySpecificPopoverOptimizationCheck(a)}function G(a){e.increaseCount("checkout:access-point:"+a,1)}function y(b){C=b.find("div[id$\x3d'-country']");F=b.find("div[id$\x3d'-pickup-type']");C.length&&F.length&&S(C,F);a.declarative("country-filter-pickup-point","change",function(a){C.length&&F.length&&S(C,F)})}function S(a,b){B=a.find("select[name\x3dcountry]");M=b.find("select[name\x3dpickupType]");if(B.length&&M.length){var c=
B.find("option:selected");a=M.find("option[value!\x3d'All']");c=M.find("option."+c.attr("data-pickuptypeclass"));c.length?(a.hide(),c.show(),M.prop("disabled",!1),M.val("All").change(),b.show()):b.length&&M.length&&(M.prop("disabled","disabled"),b.hide())}}function K(){Q();P();T();h("div.checkout-as input[placeholder]").each(function(){var a=h(this).attr("placeholder"),a=h("\x3cdiv /\x3e").html(a).text().replace(":","");h(this).attr("placeholder",a)});h("div.checkout-as #newShippingAddressFormFromIdentity span.field-description, #locker-find span.field-description").each(function(){var a=
h(this),b=a.closest("div.one-new-address-form-field, label").find("input, select, textarea");!(0<a.find("a[href]").length||0===b.length)&&"placeholder"in b[0]&&(b.attr("placeholder",a.text()),a.remove())});h("html.checkout-as-mobile div.displayAddressDiv ul.displayAddressUL, div.checkout-as-tablet div.displayAddressDiv ul.displayAddressUL").bind("touchend",function(a){});(function(){var a=h("div.checkout-as #searchLockerByLocationButton");a.unbind("enable").bind("enable",function(){h(this).removeClass("a-button-disabled").removeAttr("disabled")}).unbind("disable").bind("disable",
function(){h(this).addClass("a-button-disabled").attr("disabled",!0)});if(navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition){a.text();a.data("labelActive");a.data("labelSuccess");a.find(".a-button-text");var c=a.data("submit-url");a.click(function(d){d.preventDefault();var e=h("\x3cdiv id\x3d'turbo-checkout-bottom-sheet' class\x3d'aok-hidden'\x3e\x3c/div\x3e");a.append(e);var f=h("div.checkout-as #clientSideLockerFindErrorIMB").hide().removeClass("hidden").find(".hidden").removeClass("hidden").hide().end();
navigator.geolocation.getCurrentPosition(function(d){e.remove();var f=a.closest("form"),g=c?c:f.attr("action");f.attr("action",g);f.append(h("\x3cinput type\x3d'hidden' /\x3e").attr("name","latitude").attr("value",d.coords.latitude));f.append(h("\x3cinput type\x3d'hidden' /\x3e").attr("name","longitude").attr("value",d.coords.longitude));f.append(h("\x3cinput type\x3d'hidden' /\x3e").attr("name","isGeolocalisationButtonClicked").attr("value",1));b.showPageTransition();f.submit()},function(b){e.remove();
a.closest("div.checkout-as-mobile, div.checkout-as-tablet").length?alert(f.find("p.e"+b.code).text()):f.show().find("p.e"+b.code).show()},{maximumAge:12E4,timeout:1E4})})}else a.hide()})();(function(){h("div.checkout-as-mobile form#locker-find").submit(function(a){a=h(this).find("#locker-find-search-field");var c=h(this).find("#locker-find-inline-alert"),d=h("div.checkout-as-mobile #locker-find-error-imb");a.closest("form");var e=h(this).find("input[name\x3d'latitude']").attr("value"),f=h(this).find("input[name\x3d'longitude']").attr("value"),
g=0<a.val().trim().length;c.removeClass("aok-hidden").addClass("aok-hidden");a.parent().removeClass("a-form-error");if(e&&f)return!0;if(g)return b.showPageTransition(),!0;d&&d.remove();a.parent().removeClass("a-form-error").addClass("a-form-error");c.removeClass("aok-hidden");return!1})})();(function(){h.support.ajax&&h("div.checkout-as a.a-button-text[href], div.checkout-as a.a-button[href], div.checkout-as a.js-add-working-javascript[href]").each(function(){0<h(this).attr("href").indexOf("?")&&
h(this).attr("href",h(this).attr("href")+"\x26hasWorkingJavascript\x3d1")})})();(function(){h("div.checkout-as .enter-address-form").not(".hidden").find("div.a-alert-error").addClass("js-originally-shown-imb");h("div.checkout-as a.js-switch-form").click(function(a){a.preventDefault();a=h(this).closest(".enter-address-form");c.toggleAddressForm(a,a.siblings(".enter-address-form"))})})();(function(){m.when("A").execute(function(a){a.declarative("switch-store-results-display",["click"],function(a){if(a.data&&
a.data.showDiv){var b=h(a.data.showDiv);0!==b.length&&(a.$declarativeParent.addClass("a-button-selected").siblings(".a-button-selected").removeClass("a-button-selected"),b.show(),b.siblings("div").hide())}})})})();(function(){m.when("jQuery").execute(function(a){0!==a(".js-scroll-lock").length&&a(k).unbind("scroll.as").bind("scroll.as",function(){a(".js-scroll-lock").each(function(){var b=a(this),c=b.position().top,c=a(k).scrollTop()-c+10;0>=c||b.outerHeight()>a(k).height()?b.css({marginTop:"auto"}):
b.css({marginTop:c})})})})})();(function(){h(".checkout-as div#deliver-to").length&&h("div#deliver-to").length&&h(".ship-to-this-address").each(function(){h(this).find("a.a-button-text").unbind("click.deliver-to").bind("click.deliver-to",U)})})();h("li[data-a-tab-name\x3dpickupTab]").length&&G("pickupTab:visible");if(0<h(".imb-autoscroll").length){var d=h(".imb-autoscroll:first").closest(".on-imb-scroll-here");d.length&&h("html, body").animate({scrollTop:d.offset().top},1E3)}h("#legacy-non-converged-locker-find").delegate("input[type\x3dtext], select",
"click change",function(a){h(this).closest("tr").find("input[type\x3dradio]").attr("checked",!0)});h("html").hasClass("a-lt-ie8")&&h("div.checkout-as-desktop input[type\x3d'text']").addClass("a-input-text");a.defer(function(){h(".screenreader-address-span").each(function(){var a=h(this);a.text(" "+a.closest(".address-book-entry").find("li.displayAddressAddressLine1").text())})})}function H(b,c,d){a.$("#"+b).addClass("aok-hidden");a.$("#"+c).removeClass("aok-hidden");e.increaseCount("APCX:Checkout:AddressBook:unavailableLocationsIngress:"+
d)}var h=a.$,C,B,F,M;a.declarative("select-address",["click"],function(a){a=h(".address-content input[type\x3dradio]:checked");a.length&&(a=a.data("addressSelect"))&&(b.showPageTransition(),d.redirectWithJavascript(a))});a.declarative("tap-to-field",["click"],function(a){h(k).scrollTop(a.$declarativeParent.offset().top)});m.register("tablet-address-select-controller",function(){a.declarative("tablet-store-select-button",["click"],function(a){if(a=a.$currentTarget.closest("div.store-results-list").find("input[name\x3d'selectedStore']:checked").closest("label").data("selectThisStoreUrl"))b.show(),
d.redirectWithJavascript(a)});a.declarative("tablet-checkout-cancel-address",["click"],function(a){a.$currentTarget.closest(".a-expander-container").find("a.a-expander-header").click();h(document).scrollTop(0)});a.declarative("tablet-address-select",["click"],function(a){function b(a){a.addClass("a-button-disabled");a.find("input").attr("disabled",!0)}function c(a){a.removeClass("a-button-disabled");a.find("input").removeAttr("disabled")}var d=h("div.checkout-as-tablet"),e=d.find(".address-select-button"),
d=d.find(".address-edit-button");a.data&&a.data.disableSelect?b(e):c(e);a.data&&a.data.disableEdit?b(d):c(d)})});a.declarative("edit-address",["click"],function(a){a=h(".address-content input[type\x3dradio]:checked");a.length&&(a=a.data("addressEdit"))&&(b.showPageTransition(),d.redirectWithJavascript(a))});a.declarative("suggestion-edit-address",["click"],function(a){a=h("div.checkout-as-tablet #address-suggestion-form");if(a.length){var c=a.find("input[type\x3dradio]:checked");if(c.length){var c=
c.val(),d=a.find("input#operationField");d.length&&(d.val(c),d.attr("name","edit_"+c),b.show(),a.submit())}}});a.declarative("refine-locker-search-results",["click"],function(a){var b=a.$currentTarget.closest("form");b.find("#latitude").val(a.data.latitude);b.find("#longitude").val(a.data.longitude)});a.declarative("mobile-refine-locker-search-results",["click"],function(a){var c=a.$currentTarget,d=c.closest("form");d.find("#latitude").val(a.data.latitude);d.find("#longitude").val(a.data.longitude);
c.find("input[type\x3dradio]").prop("checked",!0);b.show();d.submit()});a.declarative("mobile-store-results-back-button",["click"],function(a){b.show();k.history&&k.history.length&&0<k.history.length?(k.history.go(-1),a.$event.preventDefault()):d.redirectWithJavascript(a.data.url)});a.declarative("suggestion-select-address",["click"],function(a){a=h("div.checkout-as-tablet #address-suggestion-form");if(a.length){var c=a.find("input[type\x3dradio]:checked");if(c.length){var c=c.val().replace(/^addr_/,
""),d=a.find("input#operationField");d.length&&(d.val(c),d.attr("name","useSelectedAddress"),b.show(),a.submit())}}});a.declarative("tablet-checkout-delete-address",["click"],function(a){k.confirm(h("#addressConfirmDeletion").text())&&(a=a.$currentTarget,b.showPageTransition(),d.redirectWithJavascript(a.attr("href")))});a.declarative("mobile-confirm-locker-restriction",["click"],function(a){f(a.$currentTarget.find("input[type\x3d'checkbox']"))});a.declarative("tablet-confirm-locker-restriction",["click"],
function(a){t(a.$currentTarget.find("input[type\x3d'checkbox']"))});a.declarative("mobile-select-address",["change"],function(a){a=a.$currentTarget.closest("div.address-book-entry");if(!a.hasClass("active-box")){if(h("li[data-a-tab-name\x3ddeliverTab]").length&&h("li[data-a-tab-name\x3dpickupTab]").length){var b=a.closest(".address-book");b&&b.find("div.address-book-entry.active-box").removeClass("active-box").addClass("inactive-box")}else h("div.address-book-entry.active-box").removeClass("active-box").addClass("inactive-box");
a.removeClass("inactive-box").addClass("active-box");0<h("div.checkout-as-mobile").length&&g(a)}});a.declarative("pickup-tab-selected",["click"],function(a){G("pickupTab:clicked")});a.on("checkout:reload:shipaddressselect",K);a.on("checkout:reload:billingaddressselect",K);a.on("checkout:reload:editaddress",K);a.on("checkout:reload:newaddress",K);a.on("a:expander:greyOutExpander:toggle:collapse",function(){H("ineligibleStoresExpandedHeading","ineligibleStoresCollapsedHeading","collapsed")});a.on("a:expander:greyOutExpander:toggle:expand",
function(){H("ineligibleStoresCollapsedHeading","ineligibleStoresExpandedHeading","expanded")})});m.when("A").register("as-faf-controller",function(a){function b(){d("#faf-error-message").hide();d("#faf-content").hide();d("#faf-loading-image").show();d.ajax({type:"GET",url:"/gp/gifting/add-friends-and-family.html?filter\x3d1",dataType:"html",cache:!1,timeout:1E4,success:function(a){d("#faf-loading-image").hide();d("#faf-content").show();d("#faf-content").html(a)},error:function(a){d("#faf-loading-image").hide();
d("#faf-error-message").show()}})}var d=a.$;a.on("a:popover:show:add-friends-and-family",function(a){b()});a.on("checkout:reload:shipaddressselect",function(){d("div.checkout-as-desktop").delegate("#faf_retry","click",function(){b()})})});m.when("A","page-transition-controller","page-conductor","checkout-general-utils").execute(function(a,b,d,c){var e=a.$;a.declarative("checkout-delete-address",["click"],function(a){a.$event.preventDefault();var f=0,t;a.data&&a.data.targetAddress!==H&&(f=1,t=a.data.targetAddress);
var w=a.$declarativeParent.find("a[href]:first").attr("href");!w&&f&&(w=a.$declarativeParent.attr("href"));if(e("div.checkout-as-mobile").length&&!k.confirm(e("#addressConfirmDeletion").text()))return!1;b.show();e.ajax({dataType:"json",url:w,success:function(p,k,m){var v;v=f?e("#"+t):a.$declarativeParent.closest(".address-book-entry");var A=v.parent();if(A.closest("div.checkout-as-mobile").length){if(v.removeClass("address-book-entry").addClass("deleted-address-book-entry"),p=v.find(".displayAddressDiv").text(),
v.find(".a-box-inner").empty(),p=e("\x3cdiv class\x3d'a-box a-alert-inline a-alert-inline-success'\x3e\x3c/div\x3e").append("\x3cdiv class\x3d'a-box-inner'\x3e\x3ci class\x3d'a-icon a-icon-alert' /\x3e\x3cp class\x3d'deleted-address-alert-content'\x3e"+p+"\x3cbr/\x3e"+e("#addressWasDeletedSuccess").text()+"\x3c/p\x3e\x3c/div\x3e"),v.find(".a-box-inner").append(p),p=v.prev(".address-book-entry.a-box"),0===p.length&&(p=v.next(".address-book-entry.a-box")),0===p.length&&!(0<e(".checkout.checkout-as .address-book-entry").length)){b.hidePageTransition();
c.redirectWithJavascript(w);return}}else if(e("div.checkout-as-desktop").length){v.detach();var q=A.find("div.address-book-entry");q.length||d.ajaxUpdatePage(p,k,m);q.removeClass("address-book-new-row").filter(":nth-child(3n+1)").addClass("address-book-new-row");e("div.checkout-as-desktop").trigger("checkout-as-recalculate-address-height")}v.is(".a-box.active-box")&&A.find(".address-book-entry.a-box.inactive-box:first").addClass("active-box").removeClass("inactive-box").find("input[type\x3d'radio']").attr("checked",
!0).change().siblings("i.a-icon-touch-radio-inactive").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");f&&e(".a-button-close").trigger("click");b.hide()},error:function(){b.hidePageTransition();c.redirectWithJavascript(w)}})})});m.when("A","a-expander","ready").register("as-tablet-controller",function(a){var b=a.$;a.on("checkout:reload:shipaddressselect",function(){if(b("div.checkout-as-tablet").length&&k.location.hash){var a=b(k.location.hash+".a-expander-header");
"none"===a.siblings("div.a-expander-content").css("display")&&setTimeout(function(){a.trigger("click")},500)}})});m.when("A","safe-mash","page-detector").register("as-locker-mobile-controller",function(a,b,d){var c=a.$;a.on("checkout:reload:shipaddressselect",function(){d.isMobileAddressSelect()&&a.defer(function(){if(!b||!b.showDeliveryDestinationPicker){var a=c("div.checkout-as-mobile").find("a.checkout-add-locker"),d=a.attr("href");d&&"#"!==d||a.hide()}})})});m.when("A","page-transition-controller",
"safe-mash","page-detector","checkout-general-utils","mash").register("as-mash-controller",function(a,b,d,c,e){var g=a.$;d.showDeliveryDestinationPicker&&g("div.checkout-as-mobile").find("a.checkout-add-locker").show();a.declarative("invoke-mash-store-picker",["click"],function(a){if(d.showDeliveryDestinationPicker){var t;k.app&&k.app.willReappear&&(t=k.app.willReappear,delete k.app.willReappear);c.isTabletAddressSelect()&&a.$currentTarget.closest("div.a-expander-container").find("div.a-expander-content").remove();
d.showDeliveryDestinationPicker({successCallback:function(a){var c="/gp/buy/storeaddress/handlers/select.html",c=e.addQueryStringParameter(c,"addressID",a.addressId),c=e.addQueryStringParameter(c,"requestToken",g("div.checkout-as").data("requestToken")),c=e.addQueryStringParameter(c,"purchaseId",g("div.checkout-as").data("purchaseId"));b.show();k.setTimeout(function(){k.app&&t&&(k.app.willReappear=t);e.redirectWithJavascript(c)},650)},failCallback:function(a){k.app&&t&&(k.app.willReappear=t)}})}else 1<
(a.$currentTarget.attr("href")||"").length&&e.redirectWithJavascript(a.$currentTarget.attr("href"))})});m.when("A","a-checkbox").execute(function(a,b){a.declarative("filter-available-locations",["click"],function(b){var c=a.$;b=b.$target.is(":checked");clientMetrics.increaseCount("APCX:CheckoutMPP:filterAvailableLocations");b?c(".ineligible-store").hide():c(".ineligible-store").show()})});m.when("A","a-checkbox","ready").execute(function(a,b){var d=a.$,c=b("[id\x3d'filterLocationsMpp']");d('[id\x3d"filterLocationsMpp"]').change(function(){c.isChecked()?
d(".ineligible-store").hide():d(".ineligible-store").show();var a=c.isChecked()?!1:!0;"undefined"!==typeof k.Map&&d(".ineligible-store").each(function(){var b=d(this).attr("data-store-display-number");b&&(b=parseInt(b,10)-1,k.Map.togglePinVisibility(b,a))})})});m.when("A").execute("searchLevelAlert",function(a){var b=a.$;b(k);var d=b("#searchLevelMessage"),c=function(){0>d.height()-b(k).scrollTop()?d.removeClass("search-level-message-back-to-top").addClass("search-level-message"):d.removeClass("search-level-message").addClass("search-level-message-back-to-top")};
b("#searchLevelMessage").length&&a.on.scroll(c)});m.when("A","page-transition-controller","checkout-general-utils","page-detector").execute(function(a,b,d,c){function e(){if(c.isMobileAddressSelect()){var a=k.location.href,e=g(".active-box");if("undefined"!==typeof e)var w=e.data("store-id"),p=e.data("address-id"),m=e.data("search-latitude"),e=e.data("search-longitude"),a=d.addQueryStringParameter(decodeURIComponent(a),"selectedStoreId",w),a=d.addQueryStringParameter(decodeURIComponent(a),"optedStoreAddressId",
p),a=d.addQueryStringParameter(decodeURIComponent(a),"latitude",m),a=d.addQueryStringParameter(decodeURIComponent(a),"longitude",e);a&&(b.showPageTransition(),d.redirectWithJavascript(decodeURIComponent(a)))}}var g=a.$;a.on("toggle-preference-success",function(){e()});a.on("toggle-preference-failure",function(){e()});a.on("do-nothing-success",function(){e()})});m.when("A","checkout-general-utils","page-detector").execute(function(a,b,d){a.on("checkout:reload:shipaddressselect",function(){if(d.isMobile()){var b=
a.$,b=b(".active-box");"undefined"!==typeof b&&1==b.data("redirect-from-accessibility")&&(b=b.offset().top,k.scrollTo(0,b))}})});m.when("A","ready").register("delivery-preference-widget-focus",function(a){var b=a.$;a.on("checkout:reload:editaddress",function(a){b("#deliveryPreferenceScrollEnabled").length&&b("#deliveryPreferenceScrollEnabled").offset()&&b("html, body").animate({scrollTop:b("#deliveryPreferenceScrollEnabled").offset().top},"fast")})});"use strict";m.when("A","ready").register("address-autopopulate-fields-clear",
function(){});"use strict";m.when("A","page-transition-controller").register("accesspoint-search-controller",function(a,b){var d=a.$;a.declarative("search-accesspoint-for-location",["click"],function(a){navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition&&navigator.geolocation.getCurrentPosition(function(b){var g=a.data.url,f=d("#accesspoint-search-form");f.attr("action",g);f.append(d("\x3cinput type\x3d'hidden'/\x3e").attr("name","latitude").attr("value",b.coords.latitude));
f.append(d("\x3cinput type\x3d'hidden'/\x3e").attr("name","longitude").attr("value",b.coords.longitude));f.submit()},function(a){a=d("#geolocation-error-strings").find(".e"+a.code).text();alert(a)})});a.on("checkout:reload:accesspoint",function(){d("#legacy-non-converged-locker-find").delegate(".storesearchinput input,.storesearchinput select","click",function(a){d(this).closest(".storesearchinput").siblings().find("input[type\x3dradio]").click()})})});"use strict";m.when("A","checkout-general-utils",
"ready").register("delivery-preference-controller",function(a,b){function d(){return f("form.checkout-page-form").serialize()}function c(a){f(a).addClass("aok-hidden")}function e(){var a=d();a!==m&&5>=p&&(a&&(a+="\x26"),f.ajax({type:"POST",url:"/gp/buy/deliverypreference/handlers/save.html",data:a+"returnjson\x3d1\x26isTrial\x3d1",dataType:"json",async:!0,cache:!1,headers:{"x-amz-checkout-page":"deliverypreference"},complete:function(){}}),p++)}function g(){p=0;m=d();f("form.checkout-page-form").find("input[type\x3d'checkbox'],input[type\x3d'radio'],input[type\x3d'text'],select").unbind("change").change(e);
w&&f("form.checkout-page-form").data("checkoutFormReady",!0).change()}var f=a.$,k=f("input#isPipelinedPage"),w=0<k.length&&"1"===k.val(),p,m;a.declarative("select-delivery-preference-radio-button",["click","touchend"],function(a){b.protectAgainstDoubleAction("select-delivery-preference-radio-button")||a.$currentTarget.closest(".delivery-preference-option").find("input[type\x3d'radio']").trigger("click")});a.declarative("wini-radio-clicked","click",function(a){a=a.$target.context.value;"NeighborDelivery"===
a?(c(".wini-safePlaceInput"),f(".wini-neighborInput").removeClass("aok-hidden")):"SafePlaceDelivery"===a?(c(".wini-neighborInput"),f(".wini-safePlaceInput").removeClass("aok-hidden")):"NoSpecialDelivery"===a&&(c(".wini-neighborInput"),c(".wini-safePlaceInput"))});if(w)a.on("checkout:reload:deliverypreference",g)});"use strict";m.when("A","weekend-availability-expander-helper").register("weekend-availability-expander-desktop",function(a,b){function d(a,b){return{isSaturdayChecked:c("#"+a).prop("checked"),
isSundayChecked:c("#"+b).prop("checked")}}var c=a.$,e=!0,g=!0,f={"sat-sun-expander-header":{saturdayId:"sat-sun-availability-checkbox-sat",sundayId:"sat-sun-availability-checkbox-sun"},"sat-sun-expander-header-domestic":{saturdayId:"sat-sun-availability-checkbox-sat-domestic",sundayId:"sat-sun-availability-checkbox-sun-domestic"}};return{init:function(){b.isBusinessDefaultWeekendDeliveryViewActive()&&(g=e=!1);a.declarative("sat-sun-availability-checkbox-change","change",function(a){a=d(a.data.satCheckboxId,
a.data.sunCheckboxId);b.updateAllWeekendAvailabilityStates(a);var e=c("input[name\x3d'BusinessHours']").attr("value"),e=b.stateToCheckboxes(e);c(".weekend-checkbox-sat").prop("checked",e.isSaturdayChecked);c(".weekend-checkbox-sun").prop("checked",e.isSundayChecked);b.updateAllTitles(a);b.updateAllOptOutMessages(a)});var k="expander"===c("input[name\x3d'weekendDeliveryDisplayType']").attr("value"),w=c("input[name\x3dshipToThisAddress]");w.length&&k&&w.closest("form").submit(function(a){b.logExpanderState("mpp",
"create",g,e)});w=c("input[name\x3dfromAddressEditToContinue]");w.length&&k&&w.closest("form").submit(function(a){b.logExpanderState("mpp","edit",g,e)});a.declarative("a-expander-toggle","click",function(a){a=a.$currentTarget;var c=a.attr("id");a.hasClass("sat-sun-expander-class")&&f[c]!==H&&(a=d(f[c].saturdayId,f[c].sundayId),b.updateAllWeekendAvailabilityStates(a),b.updateAllTitles(a),e=!e,g=!1)})}}});"use strict";m.when("A","delivery-preferences-csm-helper","checkout-general-utils","page-detector-current-page").register("mpp-delivery-preferences-controller",
function(a,b,d,c){a.declarative("delivery-preferences-submit-button",["click","touchend"],function(a){"deliverypreference"===c.getCurrentPage()&&(d.protectAgainstDoubleAction("delivery-preferences-submit-button",400)||b.recordCSMWithCurrentFieldValues("page-submitted","prefDelLocation","isDefaultPreference"))});a.on("checkout:reload:spc",function(){b.recordCSMForEligiblePages()});a.on("checkout:reload:deliverypreference",function(){b.recordCSMWithCurrentFieldValues("page-displayed","prefDelLocation",
"isDefaultPreference")})});"use strict";m.when("A","delivery-preferences-csm-helper","page-detector","page-detector-current-page","client-side-metrics").register("what-if-im-not-in-delivery-preferences",function(a,b,d,c,e){function g(){if(l)a.capabilities.history?k.history.back():m.when(u?"a-secondary-view":"a-popover-base").execute(function(a){a.get("what-if-im-not-in-form-popover").hide()});else{var b=q("#what-if-im-not-in-form-container").closest(".a-popover-wrapper");b.length&&b.find(".a-button-close").click()}}
function f(){q('select[name\x3d"enterAddressCountryCode"]').val()!==q("input[name\x3dcountryOrg]").val()?(q(".what-if-im-not-in-delivery-preferences-summary").hide(),z()):(q(".what-if-im-not-in-delivery-preferences-summary").show(),D())}function t(a,b){u?m.when("a-dropdown").execute(function(c){c.setValue(a.attr("id"),b)}):(e.increaseCount("removeauijs26"),a.find("option").removeAttr("selected"),a.find('option[value\x3d"'+b+'"]').attr("selected","selected"),a.siblings(".a-placeholder").text(a.find("option:selected").text()))}
function w(a,b){u?m.when("a-checkbox").execute(function(c){c=c("#"+a.attr("id"));b?c.check():c.uncheck()}):(e.increaseCount("removeauijs27"),b?a.attr("checked","checked"):a.removeAttr("checked"),a.siblings("i").removeClass("a-icon-touch-checkbox-"+(b?"inactive":"active")).addClass("a-icon-touch-checkbox-"+(b?"active":"inactive")))}function p(){var a=l&&"newaddress"===c.getCurrentPage(),e=!l&&!d.isTablet()&&"shipaddressselect"===c.getCurrentPage();(a||e)&&b.recordCSMForEligiblePages("address-form:")}
function D(){var a=q("#what-if-im-not-in-form-container"),b=q(".what-if-im-not-in-delivery-preferences-summary").closest("form"),c=a.find("input[name\x3dprefDelLocation]:checked").val();b.find('input[name\x3d"prefDelLocation"]').val(c);"NeighborDelivery"===c?(b.find('input[name\x3d"neighborName"]').val(a.find("input[name\x3dneighborName]").val()),b.find('input[name\x3d"houseNo"]').val(a.find("input[name\x3dhouseNo]").val())):"SafePlaceDelivery"===c&&b.find('input[name\x3d"safePlaceLocation"]').val(a.find("select[name\x3dsafePlaceLocation]").val());
b.find('input[name\x3d"isDefaultPreference"]').val(a.find("input[name\x3disDefaultPreference]").is(":checked")?"1":"0")}function z(){var a=q(".what-if-im-not-in-delivery-preferences-summary").closest("form");a.find('input[name\x3d"prefDelLocation"]').removeAttr("value");a.find('input[name\x3d"neighborName"]').removeAttr("value");a.find('input[name\x3d"houseNo"]').removeAttr("value");a.find('input[name\x3d"safePlaceLocation"]').removeAttr("value");a.find('input[name\x3d"isDefaultPreference"]').removeAttr("value")}
function v(){p();q(".what-if-im-not-in-delivery-preferences-summary").length&&(f(),q('select[name\x3d"enterAddressCountryCode"]').change(function(){f()}))}function A(a){a.$event.preventDefault();b.recordCSMWithCurrentFieldValues("embedded-in-address-form-submitted","prefDelLocation","isDefaultPreference");var c=q("#what-if-im-not-in-form-container"),d=c.find("input[name\x3dprefDelLocation]:checked").val();a=q("#what-if-im-not-in-form-container");a.find("input").removeClass("a-form-error");a.find("div.a-input-text-wrapper").removeClass("a-form-error");
u?a.find("select").siblings(".a-button").removeClass("a-button-error"):(e.increaseCount("removeauijs28"),a.find("select").closest(".a-button").removeClass("a-button-error"));a=!1;"NeighborDelivery"===d?(d=c.find("input[name\x3dneighborName]"),d.val()||(d.addClass("a-form-error"),d.closest(".a-input-text-wrapper").addClass("a-form-error"),a=!0),c=c.find("input[name\x3dhouseNo]"),c.val()||(c.addClass("a-form-error"),c.closest(".a-input-text-wrapper").addClass("a-form-error"),a=!0)):"SafePlaceDelivery"===
d&&(c=c.find("select[name\x3dsafePlaceLocation]"),c.val()||(u?c.siblings(".a-button").addClass("a-button-error"):(e.increaseCount("removeauijs29"),c.closest(".a-button").addClass("a-button-error")),a=!0));if(!a){z();D();c=q("#what-if-im-not-in-form-container");a=q(".what-if-im-not-in-delivery-preferences-summary").closest("form");var d=c.find("input[name\x3dprefDelLocation]:checked").val(),f,l;"NeighborDelivery"===d?(f=a.find("input[name\x3dneighborDeliveryLabel]").val(),l=c.find("input[name\x3dneighborName]").val(),
c=c.find("input[name\x3dhouseNo]").val(),l=l+", "+c):"SafePlaceDelivery"===d?(f=a.find("input[name\x3dsafePlaceDeliveryLabel]").val(),l=c.find("select[name\x3dsafePlaceLocation] option:selected").text()):"NoSpecialDelivery"===d&&(f=a.find("input[name\x3dnoSpecialDeliveryLabel]").val());f+=l?": "+l:"";q("#delivery-preference-label").text(f);f=q("#delivery-preference-link");f.length&&f.text(a.find("input[name\x3dchangeYourPreferenceLabel]").val());g()}}var q=a.$,u=k.P&&k.P.AUI_BUILD_DATE,l=d.isMobile();
a.declarative("embedded-what-if-im-not-in-form","submit",A);a.declarative("what-if-im-not-in-mpp-popover","click",A);a.on("a:popover:show:what-if-im-not-in-form-popover",function(){var a=q("#what-if-im-not-in-form-container"),c=q(".what-if-im-not-in-delivery-preferences-summary").closest("form"),d=c.find('input[name\x3d"prefDelLocation"]').val()||"";a.find("input[name\x3dprefDelLocation][value\x3d"+d+"]").click();a.find('input[name\x3d"neighborName"]').val(c.find("input[name\x3dneighborName]").val());
a.find('input[name\x3d"houseNo"]').val(c.find("input[name\x3dhouseNo]").val());var d=a.find('select[name\x3d"safePlaceLocation"]'),e=c.find("input[name\x3dsafePlaceLocation]").val();t(d,e);a=a.find('input[name\x3d"isDefaultPreference"]');w(a,"0"!==c.find("input[name\x3disDefaultPreference]").val());b.recordCSMWithCurrentFieldValues("embedded-in-address-form-displayed","prefDelLocation","isDefaultPreference")});a.on("checkout:reload:shipaddressselect",v);a.on("checkout:reload:newaddress",v)});"use strict";
m.when("A","weekend-availability-expander-helper","a-secondary-view","client-side-metrics","a-checkbox").register("weekend-availability-secondary-view-mobile",function(a,b,d,c,e){function g(){m=!0;var a=p("input[name\x3d'BusinessHours']").attr("value"),a=b.stateToCheckboxes(a);e("#weekend-availability-sat-checkbox").check(a.isSaturdayChecked);e("#weekend-availability-sun-checkbox").check(a.isSundayChecked);e("#weekend-availability-sat-checkbox-domestic").check(a.isSaturdayChecked);e("#weekend-availability-sun-checkbox-domestic").check(a.isSundayChecked);
p(".weekend-availability-opt-out-box").toggleClass("aok-hidden",!0)}function f(a,b){return{isSaturdayChecked:e("#"+a).isChecked(),isSundayChecked:e("#"+b).isChecked()}}function k(){return m&&z?"save":m?"back":"noView"}function w(a,b,d){var e=p("#hasUserDefinedValue").length?"userDefined":"notUserDefined";c.increaseCount("checkout:delivery-preferences:"+a+":secondaryView:"+b+":"+d+":"+e)}var p=a.$,m=!1,z=!1;return{init:function(){a.declarative("sat-sun-availability-checkbox-change","change",function(a){b.updateAllOptOutMessages(f(a.data.saturdayCheckboxId,
a.data.sundayCheckboxId))});var c="secondaryView"===p("input[name\x3d'weekendDeliveryDisplayType']").attr("value"),e=p("input[name\x3dshipToThisAddress]");e.length&&c&&e.closest("form").submit(function(a){w("mpp","create",k())});e=p("input[name\x3dfromAddressEditToContinue]");e.length&&c&&e.closest("form").submit(function(a){w("mpp","edit",k())});a.declarative("weekend-availability-secondary-view-save","click",function(a){var c=a.data;a=d.get(c.popoverName);null!==a&&a!==H&&(c=f(c.saturdayCheckboxId,
c.sundayCheckboxId),b.updateAllWeekendAvailabilityStates(c),b.updateAllTitles(c),a.hide(),z=!0)});a.on("a:popover:beforeShow:weekend-availability-secondary-view",g);a.on("a:popover:beforeShow:weekend-availability-secondary-view-domestic",g)}}});"use strict";m.when("A","page-detector").register("weekend-availability-loader",function(a,b){function d(){b.isMobile()?m.when("weekend-availability-secondary-view-mobile").execute(function(a){a.init()}):m.when("weekend-availability-expander-desktop").execute(function(a){a.init()})}
a.on("checkout:reload:shipaddressselect",d);a.on("checkout:reload:editaddress",d);a.on("checkout:reload:newaddress",d)});"use strict";m.when("A","jQuery","gift-form-base-controller").register("gift-form-controller",function(a,b,d){a.on("checkout:gift:adaptCarousel",function(a){a=b("#giftwrap-carousel-wrap-holder-"+a);parseInt(a.css("left"),10);a.css("left",0)});a.on("checkout:gift:changeCarouselWrapOptions",function(a,d,g){"all"===d?b("#giftwrap-carousel-wrap-holder-"+g+" li").show():"GW"===d?(b("#giftwrap-carousel-wrap-holder-"+
g+" li",b(a)).hide(),b(".gift-wrap",b(a)).show()):"noshi"===d&&(b("#giftwrap-carousel-wrap-holder-"+g+" li",b(a)).hide(),b(".noshi-wrap",b(a)).show())});d.extendFunctions({updateCarouselOnLeftClick:function(a,d,g){g.$event.preventDefault();a=d.itemId;d=parseInt(b("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);0>d&&(d=d+90+"px",b("#giftwrap-carousel-wrap-holder-"+a).css("left",d))},updateCarouselOnRightClick:function(a,d,g){var f;g.$event.preventDefault();a=d.itemId;f=b("#giftwrap-carousel-wrap-pane-"+
a);d=parseInt(b("#giftwrap-carousel-wrap-holder-"+a).css("left"),10);g=f.find("ul li").size();var k=f.find("ul li.gift-wrap").size();f=f.find("ul li.noshi-wrap").size();var m=b("#afn-gift-options-wrapper-"+a).data("active-tab"),p;"all"===m?p=g:"GW"===m?p=k:"noshi"===m&&(p=f);d>-90*(p-4)&&(d=d-90+"px",b("#giftwrap-carousel-wrap-holder-"+a).css("left",d))}})});m.when("A","jQuery","client-side-metrics","ready").execute(function(a,b,d){function c(a,c,d){a=0;var e="",f=!1;b("#includeReceiptCheckbox-"+
d)&&b("#includeReceiptCheckbox-"+d).is(":checked")&&(f=!0);b('input[name\x3d"wrap.'+d+'"]:checked')&&(a=b('input[name\x3d"wrap.'+d+'"]:checked').val());b("#includeMessageCheckbox-"+d)&&b("#includeMessageCheckbox-"+d).is(":checked")&&(e=b("#message-area-"+d).val(),10<e.length&&(e=e.substring(0,10)+"..."));(!a||1>a.length)&&b("#wrapRadio-"+d+"-noWrap").attr("checked","checked").trigger("change");a&&!(1>a.length)||e&&!(1>e.length)||f?(c.find(".no-gift-options-button-text").hide(),c.find(".selected-gift-options-button-text").show(),
c.find(".gift-wrap-button-text").hide(),a&&0<a.length&&c.find(".gift-wrap-button-text-"+a.replace(/#/g,"\\#")).show(),e&&0<e.length?(c.find(".gift-message-button-text").show(),c.find(".gift-message-preview").html(e)):c.find(".gift-message-button-text").hide(),f?c.find(".gift-receipt-button-text").show():c.find(".gift-receipt-button-text").hide()):(c.find(".selected-gift-options-button-text").hide(),c.find(".no-gift-options-button-text").show())}function e(a){a.find(".selected-gift-options-button-text").hide();
a.find(".no-gift-options-button-text").show()}function g(a){a.is(":checked")||(v?a.closest("label").click():(d.increaseCount("removeauijs32"),a.attr("checked",!0).trigger("change")))}function f(a){var b=a.find("div.expando-content"),c=1===a.data("select-gift-receipt");a=1===a.data("select-gift-message");(c||a)&&w(b,c,a)}function t(a){return a.is("input")?a:a.find("input")}function w(a,b,c){var d;d=0<a.find(".includeReceiptCheckbox").length?t(a.find(".includeReceiptCheckbox")):t(a.find(".mfnHidePriceCheckbox"));
a=t(a.find(".includeMessageCheckbox"));(b||c)&&g(d);c&&g(a)}function p(){m.when("A","a-carousel-framework").execute(function(a,b){b.initializeAll()})}function D(){v?m.when("A").execute(function(a){a.off("a:expander:gift-options-expander:toggle:collapse");a.on("a:expander:gift-options-expander:toggle:collapse",function(a){a=a.expander.$expander;var b=a.closest("div.expando-box"),d=b.find("div.expando-content"),b=b.data("itemNumber");c(d,a,b)});a.on("a:sheet:afterShow",function(a){p()});a.on("a:sheet:beforeHide",
function(a){a=a.sheet.$container.find(":radio:checked");var c=a.attr("name"),d=a.parents(".wrap"),e=d.find(".wrap-text").text(),d=d.find("img").attr("src"),c=b('.gift-sheet-radio :radio[name\x3d"'+c+'"]'),f=c.parents(".gift-options-wrapper");c.val(a.val()).prop("checked",!0);f.find(".wrap-text").text(e);f.find(".wrap-img").attr("src",d)});a.off("a:expander:gift-options-expander:toggle:expand");a.on("a:expander:gift-options-expander:toggle:expand",function(a){e(a.expander.$expander);p();var b=a.expander.$expander.closest("div.expando-box");
a=b.find("div.expando-content");var c=1===b.data("select-gift-receipt"),b=1===b.data("select-gift-message");(c||b)&&w(a,c,b)})}):(d.increaseCount("removeauijs33"),b("a.expando-link").unbind("click").bind("click",function(a){var d=b(this),f=d.closest("div.expando-box"),g=f.attr("data-item-number"),k=f.find("div.expando-content");k.is(":visible")?k.slideUp("fast",function(){c(k,d,g);d.find("i").removeClass("a-icon-section-expand").addClass("a-icon-section-collapse")}):(e(d),k.slideDown("fast",function(){d.find("i").removeClass("a-icon-section-collapse").addClass("a-icon-section-expand");
var a=1===f.data("select-gift-receipt"),b=1===f.data("select-gift-message");(a||b)&&w(k,a,b)}))}));var g=b("a.expando-link");if(0<g.length){if(g=g.eq(0),g.click(),v){var k=b("div.expando-box").eq(0);e(g);a.delay(function(){f(k)},100)}}else a.delay(function(){b("div.expando-box").each(function(){f(b(this))})},100)}var z=b("input#isPipelinedPage"),z=0<z.length&&"1"===z.val(),v=k.P&&k.P.AUI_BUILD_DATE;if(z)a.on("checkout:reload:giftselect",D);else D()});"use strict";m.when("A","pay-common-util").register("page-slide",
function(a,b){function d(a,d,f){if(!d)return a;0<a.length&&a.remove();a=c(d).hide();d=b.getCurrentPage();0===d.length?b.elements.pageContainer.append(a):f?a.insertBefore(d):a.insertAfter(d);return a}var c=a.$;return{slideHide:function(a,c){var f=b.getCurrentPage();a=d(a,c,!1);f.hide();a.show()},slideShow:function(a,c){var f=b.getCurrentPage();a=d(a,c,!0);f.hide();a.show()}}});m.when("A","ajax-utility","pay-common-util","page-conductor","page-slide","page-transition-controller","pay-validator","pay-credit-card",
"a-dropdown","client-side-metrics","pay-gil","mobile-carrier-billing-util","emi-helper","instant-bank-discount-helper","new-verified-debit-card","recommendation-helper","safe-apx-helper","weblab-helper","apb-limit-messaging-helper").register("page-main",function(a,b,d,c,e,g,f,t,w,p,D,z,v,A,q,u,l,n,E){function L(a,b){if(null!==a){if(N)return String(a.data(b));p.increaseCount("removeauijs35");return a.attr(b)}}function Q(){x.newVDC.find(".vdc-other-fields").show();var a=x.newVDC.find("#cardErrors_VDC").hide();
a.find("li.error-message").not(".hidden").length&&a.show()}function J(a){var b=r(a.currentTarget).val(),c=x.newVDC.find(".bank-name").hide(),d=x.newVDC.find("#suppressedVerifiedDebitCard").hide(),e=x.newVDC.find("option:selected").data("isdisabled"),f=!1,h="1"===r("#save_citi_card").val()&&"CIT"===b,g="1"===x.newVDC.find("#isRupayAsSavedCardEnabled").val()&&"URP"===b;x.newVDC.find(".vdc-other-fields").hide();x.newVDC.find("#cardErrors_VDC").hide();"OtherBanks"===b||h||g?(Q(),r.isEmptyObject(q)||q.showExpiryDateAndCvv()):
"SMP"!==b||r.isEmptyObject(q)?""!==b&&(a=r(a.currentTarget).find("option:selected").text(),e?d.show().find(".suppress-bank-name-text").html(a):c.show().find(".bank-name-text").html(a),f=!0):(Q(),q.hideExpiryDateAndCvv());Y(f)}function O(a){r(".upi-action").hide();a=r(a.currentTarget).val();r("#"+a).show();Y(U(l))}function R(a){Y(T())}function U(a){if(r("#upi-input")){var b=r("#upiActionSelect").val();if("upi-registration"===b)return T();if("upi-acceptance"===b)return P(a)}else return P(a);return!1}
function P(a){return(a=a.get("ValidatePaymentMethod"))?a.shouldEnableContinueButton():!0}function T(){var a=r("#upiRegistration_bankSelect").val();if(a&&0<a.length)return!0}function G(a,b){if(!r.isEmptyObject(v)&&a)return a(b)}function y(b){var c=Array.prototype.slice.call(arguments);c.shift();m.now("upi-helper").execute("safe-upi-wrapper",function(d){d&&!a.objectIsEmpty(d)&&"function"===typeof d[b]&&d[b].apply(null,c)})}function H(a){G(v.removeEMIMenuSelectionAttributes);x.newEMI.find(".emi-group").hide();
a="CreditCard"===r(a.currentTarget).find("option:selected").val()?x.newEMI.find(".new-emi-card-fields").hide():G(v.getEMIMenuSelectedCardSection);a=G(v.toggleEMITenureSelectBehaviour,a);Y(a)}function K(a){(r(a.currentTarget).hasClass("sv-select-value")?r(a.currentTarget).val():r(a.currentTarget).find("option:selected").val())?Y(!0):Y(!1)}function W(){var a=f.create();a.validatePayment(ia());a.hasErrors()||c.makePrefetch(x.paymentsForm)}function h(){var a=f.create();a.validatePayment(ia());r("form.checkout-page-form").data("checkoutFormReady",
!a.hasErrors())}function C(b){var c=r(b.currentTarget);b=N?c.find("i"):c.children("i");if(N&&c.find("#addCreditCardNumber").is(":visible")){var d=r("#auiTemplatingPaypageSelectionFix");0<d.length&&"T1"===d.val()&&c.find("#addCreditCardNumber").focus()}"1"===c.attr("ischecked")||b.eq(0).hasClass("a-icon-touch-radio-active")||(fa(!0),x.continueErrors.hide(),x.paymentRows.attr("ischecked",0),x.paymentRows.attr("isclicked",0),c.attr("ischecked",1),pa(c),b=ma(c),Y(b),m.when("rewards-section-mobile").execute(function(b){a.trigger("rewards-section-mobile:select-payment-row",
c)}),ea(c),Ha(c),Ia(c),Ja(c),"1"===r("#suppressionMessageFixEnabledStatus").val()&&Ka(c),La(c),Ma(),Da(c),Fa(),ha(),B(c,"#existing-gil-description"),B(c,"#existing-gil-alert"),B(c,"#existing-gil-si-rcl-description"),B(c,"#existing-gil-si-rcl-alert"),n.isFixExtraPspPrefetchEnabled()?h():W(),M(c),z.toggleGCForMCB(c,x),F(c),r.isEmptyObject(u)||u.toggleCustomerNudgingMessage(c))}function B(a,b){var c=r(b);if(c&&0!==c.length){var d=0;0<a.find(b).length&&(d=1);d&&!c.is(":visible")?c.removeClass("aok-hidden"):
!d&&c.is(":visible")&&c.addClass("aok-hidden")}}function F(a){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=r("input[type\x3d'hidden'][name\x3d'paySelectLocale']");b.length&&"IN"===b.val()&&a.length&&m.when("client-side-metrics").execute(function(a){a.increaseCount("PayPage-COD-Mobile",1)})}function M(a){if(r("#isGlobalCODEligible").val()){a=a.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]');var b=r("#new-gc-promo");a.length?b.hide():b.show()}}function I(a){a.$event.preventDefault();
var b=a.$target;N?b.closest("#card-expiration").hide():(p.increaseCount("removeauijs36"),b.parent().hide());b.parents("div.a-box-inner").find("#"+a.data.targetId).show();a=N?".a-touch-radio":"label.a-touch-radio";N?b.parents(a).find("label").trigger("click"):(p.increaseCount("removeauijs37"),b.parents(a).trigger("click"))}function X(a){a=a.$target;N?a.parent().parent().hide():(p.increaseCount("removeauijs38"),a.parent().hide());r("#reward-err-detail").show()}function xa(a){a.$target.parent().hide();
r(".financial-offer-err-detail").show()}function wa(a){a.$event.preventDefault();d.makeAjaxCall(a.data.href,{},{successHandler:function(a,b,c){a&&(b=d.getPageId(c))&&e.slideShow(r(b),a)}})}function ya(a){a.$event.preventDefault();d.makeAjaxCall(a.data.href,{},{successHandler:function(a,b,c){a&&(b=d.getPageId(c))&&e.slideShow(r(b),a)}})}function za(a){var b=r("input#isPipelinedPage"),b=0<b.length&&"1"===b.val(),c=d.prop("activeGoElement");if(c)for(var e=["gcPromo","newVCC","newVDC"],h=0;h<e.length;h++){var B=
x[e[h]];if(B&&B.length&&B.find(c).length)return B.find('input[type\x3d"button"]').trigger("click"),a.$event.preventDefault(),!1}c=V();e=[Aa,Ba];for(h=0;h<e.length;h++)if((0,e[h])(a.data.url,c))return a.$event.preventDefault(),b&&a.$event.stopImmediatePropagation(),!1;c=f.create();e=ia();!r.isEmptyObject(v)&&G(v.isEMIPaymentInstrument,e)&&(e=G(v.getEMIMenuSelectedCardSection));c.validatePayment(e);c.apxValidatePayment(e,x.paymentsForm);if((c=c.getHighestErrorId())&&c.identifier)return a.$event.preventDefault(),
b&&a.$event.stopImmediatePropagation(),"continue_GilCCContinueErrorIneligibleItems"===c.identifier?D.displayGILEstimatesMobile("StandaloneCreditCardInstallment",ca,da):"continue_GilContinueErrorIneligibleItems"===c.identifier?D.displayGILEstimatesMobile("StandaloneInstallment",ca,da):"continue_GilRCLContinueErrorIneligibleItems"===c.identifier?D.displayGILEstimatesMobile("StandaloneReusableCreditLineInstallment",ca,da):x.continueErrors.show().find("#"+c.identifier).show(),!1;x.continueErrors.hide().find(".error-message").hide();
g.showPageTransition()}function ca(a,c,f){var h=b.jsonify(a);h&&!h.errors&&h.widgetHTML?(a=r(d.pages["gil-estimates"].pageId),e.slideShow(a,h.widgetHTML),k.scrollTo(0,0)):da(a,c,f)}function da(a,b,c){r("#continue_GilCCContinueErrorIneligibleItems").show()}function la(a){a=r(a.currentTarget);1===a.data("isclicked")?a.data("isclicked",0):a.data("isclicked",1);ha()}function ha(){var a=r("#pm_promo"),b=r("#pm_gc_radio"),c=r("#pm_gc_checkbox"),d="1"===r("input[name\x3ddoesPurchaseContainOnlyRecurringPrimeMembership]").val();
if(!b.length&&!c.length)return!1;var e=r("input[name\x3dgcBalanceRaw]").val();r("input[name\x3damBalanceRaw]").length&&(e=r("input[name\x3damBalanceRaw]").val());var f=r("input[name\x3disAPBLimitMessagingLaunchWeblabEnabled]").val(),h=r("input[name\x3dhasAPBRedeemableLimitExhausted]").val(),g=r("input[name\x3damAvailableBalanceRaw]").val(),B=r("input[name\x3dremainingBalanceRaw]").val(),k=r("input[name\x3dpurchaseTotalRaw]").val(),l,C,m=r(".purchase-total").length;m?(C=r(".purchase-total").html(),
l=r(".remaining-balance").html()):(C=r("input[name\x3dpurchaseTotal]").val(),l=r("input[name\x3dremainingBalance]").val());var v=r(".balance-applied");m?v.html(C):v.text(C);a=a.closest(".a-control-row");"1"===a.attr("isclicked")||1===a.data("isclicked")?0<B&&(m?v.html(l):v.text(l)):B=k;var a=b.closest(".a-control-row"),p=c.closest(".a-control-row"),t=r(".long"),w=r(".amazon-money-limit-breached"),n=r(".short");f&&E.renderAPBMessagingRemainingBalance({purchaseTotal:C,remainingBalance:l,balanceApplied:v,
isPurchaseTotalInSpan:m},e,k,g);"1"===f&&"1"===h?E.displayAPBRedeemableLimitExhaustedMessaging({gcRadioContainer:a,gcCheckboxContainer:p,gcCheckbox:c,gcRadio:b,shortMsg:n,longMsg:t,amazonMoneyLimitBreachedMsg:w}):0<=e-k?("disabled"===b.attr("disabled")&&b.removeAttr("disabled"),a.removeClass("hidden"),p.addClass("hidden"),c.attr("disabled","disabled"),0==e-k?(t.hide(),n.show()):(t.show(),n.hide())):0<e-B?0>=B?(p.removeClass("hidden"),p.find("i").addClass("a-button-disabled checkbox-disabled"),c.attr("disabled",
"disabled"),a.addClass("hidden"),b.attr("disabled","disabled"),n.show(),t.hide()):("disabled"===b.attr("disabled")&&b.removeAttr("disabled"),a.removeClass("hidden"),p.addClass("hidden"),c.attr("disabled","disabled"),t.show(),n.hide()):("disabled"===c.attr("disabled")&&c.removeAttr("disabled"),p.removeClass("hidden"),p.find("i").removeClass("a-button-disabled checkbox-disabled"),a.addClass("hidden"),b.attr("disabled","disabled"),"1"===f?E.renderAPBInsufficientMessaging({shortMsg:n,longMsg:t},e,g):
(n.show(),t.hide()));d&&(b.attr("disabled","disabled"),c.attr("disabled","disabled"))}function ka(a){a=a.$target||r(a.currentTarget);Z(a)}function Z(b,c){var d=b.find("input[type\x3d'checkbox']")||b.find("input[type\x3d'radio']"),e;e=d.is("input[type\x3d'checkbox']")?"checkbox":"radio";if(d.length){var f=d.siblings("i"),h=x.paymentRows.find('input[type\x3d"radio"][value\x3d"cashOnDeliveryCash"]'),g=x.paymentRows.filter(".a-touch-radio[data-paymentmethodtype\x3d'creditCard']");b=g.siblings(".installments-select.a-row");
var B=g.siblings(".installments-message"),k=g.siblings(".card-offers"),g=g.filter("[data-isinstallmentsonlycard\x3d1]"),l=x.paymentRows.find('input[type\x3d"radio"][value\x3d"morePaymentMethod"]'),C=N?l.parents(".a-control-row"):l.parent(),p=x.paymentRows.find('input[type\x3d"radio"][id\x3d"pmEmiPaymentOptions"]'),t=!p.parent().find('input[type\x3d"hidden"][name\x3d"isEMIMenuDisabled"]').val(),n=x.paymentRows.find('input[type\x3d"radio"][value\x3d"amazonBusinessCredit"]'),q=n.closest(".payment-row"),
F=x.paymentRows.find("#pm_upi_web_collect"),Q=x.paymentRows.filter(".upi-saved-handle");c||f.hasClass("a-icon-touch-"+e+"-inactive")?(h.attr("disabled",!0).prop("disabled",!0),t&&G(v.disableEMIMenu,p),A.showInstantBankDiscountAmazonPaySelected(),y("disableUPIFromSelectionOnPSP",F,Q),h.is(":checked")&&(h.attr("checked",!1),h.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),h.siblings("i").addClass("a-icon-radio-inactive").removeClass("a-icon-radio-active"),
ea(h)),c=N?h.parents(".a-control-row"):h.parent(),c.addClass("a-color-secondary js-gc-disabled"),l.attr("disabled",!0).prop("disabled",!0),l.is(":checked")&&(l.attr("checked",!1),l.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),l.siblings("i").addClass("a-icon-radio-inactive").removeClass("a-icon-radio-active"),ea(l)),C.addClass("a-color-secondary js-gc-disabled"),C.siblings(".selected-section-more-payment-method").hide(),(c=b.find("select"))&&c.each(function(){var a=
this.id.replace(/\./g,"\\.");w.setValue(a,"");a=r(this).find("option").eq(0).text();r(this).siblings(".a-input-dropdown").text(a)}),b.find(".installments-enabled-text").hide(),B.find(".installments-enabled-text").hide(),k.find(".installments-enabled-text").hide(),b.find(".installments-disabled-text").show(),B.find(".installments-disabled-text").show(),k.find(".installments-disabled-text").show(),g.find("input[name\x3dpaymentMethod]").attr("disabled","disabled").removeAttr("checked"),m.when("abc-helper").execute(function(b){a.trigger("abc-helper:disable-payment",
n)})):(h.attr("disabled",!1).prop("disabled",!1),t&&(G(v.enableEMIMenu,p),p.is(":checked")&&(G(v.addEMIMenuSelectionAttributes),r("#selectedSectionEmiPaymentMethod").show())),A.showInstantBankDiscountAmazonPayDeselected(),f.removeClass("a-icon-touch-"+e+"-inactive").addClass("a-icon-touch-"+e+"-active"),c=N?h.parents(".a-control-row"):h.parent(),c.removeClass("a-color-secondary js-gc-disabled"),b.find(".installments-disabled-text").hide(),B.find(".installments-disabled-text").hide(),k.find(".installments-disabled-text").hide(),
b.find(".installments-enabled-text").show(),B.find(".installments-enabled-text").show(),k.find(".installments-enabled-text").show(),g.find("input[name\x3dpaymentMethod]").removeAttr("disabled"),C.parent().find(".payment-invalid").length||(l.attr("disabled",!1).prop("disabled",!1),C.siblings(".selected-section-more-payment-method").show()),C.removeClass("a-color-secondary js-gc-disabled"),q.find(".payment-invalid").length||m.when("abc-helper").execute(function(b){a.trigger("abc-helper:enable-payment",
n)}),y("enableUPIForSelectionOnPSP",F,Q),d.is(":checked")&&(l.attr("disabled",!0).prop("disabled",!0),l.is(":checked")&&l.attr("checked",!1),l.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),l.siblings("i").addClass("a-icon-radio-inactive").removeClass("a-icon-radio-active"),C.siblings(".selected-section-more-payment-method").hide(),t&&(G(v.disableEMIMenu,p),p.is(":checked")&&(r("#selectedSectionEmiPaymentMethod").hide(),G(v.removeEMIMenuSelectionAttributes))),
A.showInstantBankDiscountAmazonPaySelected(),y("disableUPIFromSelectionOnPSP",F,Q),m.when("abc-helper").execute(function(b){a.trigger("abc-helper:disable-payment",n)})))}}function Aa(a,b){if("true"!==L(b,"isaddresschallenge"))return!1;a=b.parent();if(t.runConfirmCardValidator(a,a.find("#confirmCardErrors")))return d.scrollTopTo(a.find("#addCreditCardNumber")),!0;a=d.getInputValues(a);t.confirmCreditCard(a,Ea,a.confirmCardUrl);return!0}function Ba(a,b){b=d.getInputValues(b.parent());if("undefined"===
typeof b.newMonth||!b.newMonth||!b.newYear||"undefined"===typeof b.newYear||parseInt(b.expmonth,10)===parseInt(b.newMonth,10)&&parseInt(b.expyear,10)===parseInt(b.newYear,10))return!1;b.handler="update-credit-card";b.ccId0=b.paymentmethodid;b.issueNumber0=b.issuer;b.month0=b.newMonth;b.year0=b.newYear;d.makeAjaxCall(a,b,{},{useSif:!0});return!0}function Ca(){var a=r("#new-cc-inbox label");if(a&&0!==a.length){var b;N?b=x.paymentRows.filter(".a-touch-radio[data-paymentmethodtype\x3d'creditCard']"):
(p.increaseCount("removeauijs43"),b=x.paymentRows.filter("label[paymentmethodtype\x3d'creditCard']"));if(b=!(0<b.length))b=x.continueBtn.parents(".a-button").hasClass("a-button-disabled")?!0:!1;b&&(d.scrollTopTo(a),a.trigger("click"))}}function Da(a){var b=r("#form-add-credit-card");if(b&&0!==b.length){var c=0;0<a.find('input[value\x3d"addingNewCCInBox"]').length&&(c=1);c&&!b.is(":visible")?b.slideDown():b.is(":visible")&&b.slideUp()}}function ma(a){var b=f.create();a&&a.length||b.addError("continue_BlankSlate");
a&&"function"===typeof a.parent&&b.validatePCICVVBlock(a.parent());b.apxValidatePayment(a,x.paymentsForm);if(b.hasErrors())return!1;if("pmEmiPaymentOptions"===a.find('input[type\x3d"radio"]').attr("id"))return G(v.getEMIMenuSelectedCardSection).find(".emi-menu-tenures-dropdown").find("option:selected").val()?!0:!1;b=a.find('input[name\x3d"paymentMethod"]').val();if("cashOnDeliveryCash"===b&&a.parent().find(".phonenumberNotVerified").length)return!1;if("StandaloneCreditCardInstallment"===b||"StandaloneInstallment"===
b||"StandaloneReusableCreditLineInstallment"===b)return b=a.find('input[name\x3d"gilShowContinueBlocker"]').val(),a=a.find('input[name\x3d"gilShowContinueBlockerIfPromotions"]').val(),"1"!==b&&"1"!==a;if("addingNewCCInBox"===b||"addingNewCUPDCInBox"===b)return!1;if("upi"===b)return U(l);if("verifiedDebitCard"!==b&&"verifiedCreditCard"!==b)return!0;if("verifiedCreditCard"===b)return!1;a=x.newVDC.find("#vdcBanksSelect").val();return""!==a&&"OtherBanks"!==a}function Ea(c){var e=b.jsonify(c);e.imbWidgetHTML&&
r("#imb-wrapper").html(d.decodeJSonResponse(e.imbWidgetHTML));c=V();var f=L(c,"paymentmethodid");!e.cardWidgetHTML||e.newpaymentmethodid!==f&&e.optionalnewpaymentmethodid!==f||(c.closest(".a-box").replaceWith(d.decodeJSonResponse(e.cardWidgetHTML)),null!=e.rewardsAccountsWidgetHTML&&m.when("rewards-section-mobile").execute(function(b){a.trigger("rewards-section-mobile:refresh-rewards-section",d.decodeJSonResponse(e.rewardsAccountsWidgetHTML))}),ja(),c=V(),"true"!==L(c,"isaddresschallenge")&&(t.setCardPasswordInputStatus(c,
e.newpaymentmethodid,"cvv","#existingCvvNum"),t.setCardPasswordInputStatus(c,e.newpaymentmethodid,"pincode","#existingPincodeNum"),x.continueBtn.closest(".a-row").show()))}function V(){var a=x.paymentRows.filter("[ischecked\x3d1]");if(a.length)return p.increaseCount("removeauijs41"),a;if(N)return x.paymentRows.filter("[data-ischecked\x3d1]");p.increaseCount("removeauijs42");return x.paymentRows.children("i").filter(".a-icon-touch-radio-active").parent()}function ia(){var a=[];a.push(V());x.jppoints&&
x.jppoints.length&&x.jppoints.find("#redeemPoints").is(":checked")&&a.push(x.jppoints);return a}function Fa(){for(var a=x.paymentRows.parent(),b=["#reward-err-link",".financial-offer-err-link"],c=0;c<b.length;c++)r(b[c],a).show();for(var b=["#reward-err-detail",".financial-offer-err-detail"],d=0;d<b.length;d++)r(b[c],a).hide()}function Ga(){for(var a=[".financial-offer-err-detail"],b=0;b<a.length;b++){var c=r(a[b]);c.data("isHidden")||c.show()}}function na(a){a.stopPropagation();a.preventDefault()}
function oa(a,b){ga[b]&&(ga[b](),ga[b]=null);var c=a.find(b);c.length&&(c=c[0],c.addEventListener("click",na),ga[b]=function(){c.removeEventListener("click",na)})}function pa(a){r(".pci-blocking-cvv").length&&(x.paymentRows.each(function(){var a=r(this).parent().find(".pci-blocking-cvv");a.length&&a.hide()}),a&&(a=a.parent().find(".pci-blocking-cvv"),a.length&&a.show()))}function ea(a){var b=".card-cvv-field .card-pcard-field #invoice-address .loc-order-number #net-banking-list #selected-section-more-payment-method #selectedSectionEmiPaymentMethod .new-card-fields .installments-link #rewards-balance-link .financial-offer-link .financial-offer-err-detail .review-continue-text #form-add-cupdc-inbox .otpBlock #ovdWidgetSection".split(" ");
r("#upi-input").length?b.push("#upi-input"):b.push("#upi-acceptance-input");aa||b.push("#domestic-card-list","#third-party-list","#installment-payment-warning");var c=r("#cash-back-ineligible-for-cod-message");c&&c.length&&b.push("#cash-back-ineligible-for-cod-message");for(var c=x.paymentRows.parent(),d=a.parent(),e=0;e<b.length;e++){var f=b[e];"#selectedSectionEmiPaymentMethod"===f&&G(v.removeEMIMenuSelectionAttributes);r(f,c).hide();var h=d.find(f);h.data("isHidden")||(h.show(),".card-cvv-field"===
f&&(oa(d,"#existingCvvNum"),oa(d,"#existingPincodeNum")))}"pmEmiPaymentOptions"===a.find('input[type\x3d"radio"]').attr("id")&&G(v.addEMIMenuSelectionAttributes);a=["#reward-points",".financial-offer"];for(b=0;b<a.length;b++)e=a[b],r(e,c).show(),r(e,d).hide()}function Ha(b){var c=x.paymentRows.parent();c.find("#card-expiration,.payment-info").show();c.find("#addr-challenge,#addr-challenge-msg,.addr-challenge-card-scan,.addr-challenge-confirm,#expire-date-fields").hide();x.continueBtn.closest(".a-row").show();
"true"===L(b,"isaddresschallenge")&&(c=b.parent(),c.find("#card-expiration,.payment-info").hide(),c.find("#addr-challenge,#addr-challenge-msg,.addr-challenge-card-scan,.addr-challenge-confirm,#expire-date-fields").show(),x.continueBtn.closest(".a-row").hide(),b=b.attr("paymentmethodid")?b.attr("paymentmethodid"):b.attr("data-paymentmethodid"),a.trigger("checkout:payment:challenge:log",b))}function Ia(a){x.paymentRows.parent().find(".verified-fail-msg").hide();"true"===L(a,"isverifiedfail")&&a.parent().find(".verified-fail-msg").show()}
function Ja(a){x.paymentRows.parent().find(".cup-expired-msg").hide();"true"!==L(a,"iscupcardexpired")&&"true"!==L(a,"iscupcardexpiringsoon")||a.parent().find(".cup-expired-msg").show()}function Ka(a){x.paymentRows.parent().find("#savedCardSuppressed").hide();a.parent().find("#savedCardSuppressed").show()}function La(a){var b=x.paymentRows.parent();b.find(".installments-select").hide();b.find(".installments-message").show();a=a.parent();a.find(".installments-select").show();a.find(".installments-message").hide()}
function Ma(){var a=r("#imb-wrapper");if(a.length&&a.is(":visible")){var b=a.find(".defaultPaymentMethodExpired"),c=a.find(".codUnavailable"),d=a.find("p").length;0===b.length&&0===c.length||1!==d||a.hide()}}function qa(){var a;N?a=r("#select-payments-view input[type\x3d'radio'][name\x3d'paymentMethod']:checked").closest(".a-touch-radio"):(p.increaseCount("removeauijs44"),a=r("#select-payments-view input[type\x3d'radio'][name\x3d'paymentMethod'][checked\x3d'checked']").closest("label.a-touch-radio"));
a=ma(a);Y(a)}function Y(a){var b=x.continueBtn.parents(".a-button");a?(x.continueBtn.removeAttr("disabled"),b.removeClass("a-button-disabled")):(x.continueBtn.attr("disabled",!0),b.addClass("a-button-disabled"))}function Na(b){var c=b.$target.closest("a");b=c.closest("div.extender-section");c=c.find("i");c.hasClass("a-icon-extender-expand")?(b.find(".collapsed").hide(),a.slideDown(b.find(".expanded"),200),c.removeClass("a-icon-extender-expand").addClass("a-icon-extender-collapse")):(b.find(".collapsed").show(),
a.slideUp(b.find(".expanded"),200),c.removeClass("a-icon-extender-collapse").addClass("a-icon-extender-expand"));d.scrollTopTo(ba().find(".reg-expander-anchor"))}function ba(){return V().closest(".payment-box")}function Oa(){fa()}function fa(a){var b=ba();b.find("div.flag-register-rewards").is(":visible")?(b.find(".flag-register-rewards").addClass("aok-hidden"),b.find(".card-unreg-rewards").removeClass("aok-hidden"),b.find(".a-box-inner:first").removeClass("no-padding-bottom")):a||(b.find(".card-unreg-rewards").addClass("aok-hidden"),
b.find(".flag-register-rewards").removeClass("aok-hidden"),b.find(".a-box-inner:first").addClass("no-padding-bottom"));a||d.scrollTopTo(b)}function Pa(a){a.$event.preventDefault();var c=N?".a-touch-radio":"label.a-touch-radio",e=a.$currentTarget.closest(".payment-box"),c=e.find(c);0!==c.length&&(c.find('input[type\x3d"radio"]').click(),"1"===e.find("div.flag-register-rewards").data("cached")?fa():(e=a.$target.attr("href"),g.show(),d.makeAjaxCall(e,a.data,{successHandler:function(a){g.hide();var c=
b.jsonify(a);a=d.decodeJSonResponse(c.widgetHTML);ba().find("div.flag-register-rewards").html(a).data("cached","1").find(".error-message").each(function(){var a=r(this),b=a.data("errorid");a.html(c.displaydata[b])});fa()}})))}function ra(a){a=x.showAmexWarning_mobile;null!==a&&(a.removeClass("hidden"),a.removeClass("amex_display"))}function Qa(a){g.show();var c=ba(),e=c.find("input[type\x3dradio][name\x3dpaymentMethod]").val(),f=c.find(".card-unreg-rewards").data(),h=c.find(".flag-register-rewards"),
h=d.getInputValues(h);h.programid=f.programid;h.paymentinstrumentid=f.paymentinstrumentid;h.CARD_EXPIRATION_DATE=f.expiredate;h.CARD_HOLDER_NAME=f.holdername;h.returnRefreshedPage=a.data.returnRefreshedPage;h.rewardsdateofbirthmonth&&h.rewardsdateofbirthday&&(h.DATE_OF_BIRTH=h.rewardsdateofbirthmonth+h.rewardsdateofbirthday);d.makeAjaxCall(a.data.url,h,{successHandler:function(a,f,h){g.hide();a&&(a=b.jsonify(a),f=ba().find(".register-error"),a.error?f.show().find(".error-message").hide().filter("#"+
a.error).show():(f.hide(),x.pageContainer.html(a.refreshedPage),ja(),a=N?".a-touch-radio":"label.a-touch-radio",c=x.paymentRows.find('input[type\x3dradio][name\x3dpaymentMethod][value\x3d"'+e+'"]').closest(a),c.trigger("click")),d.scrollTopTo(c))}})}function ja(b){if(d.isMobileCX()){d.refreshElements(x,sa);aa=parseInt(r("input[type\x3d'hidden'][name\x3d'showWidgetInSeparateGroup']").val(),10);aa=isNaN(aa)?0:aa;ta&&(a.declarative("show-expire-date-fields",["click"],I),a.declarative("show-reward-err-detail",
["click"],X),a.declarative("show-financial-offer-err-detail",["click"],xa),a.declarative("submit-payment-form",["submit"],za),a.declarative("show-reward-points",["click"],wa),a.declarative("show-financial-offer",["click"],ya),a.declarative("show-rewards-reg-mobile",["click"],Pa),a.declarative("register-card-rewards-mobile",["click"],Qa),a.declarative("cancel-register-card-rewards-mobile",["click"],Oa),a.declarative("extender-toggle-mobile",["click"],Na),ta=!1);y("initiateUpiDeviceCheck");x.existingPincodeNum.unbind("click",
ra).bind("click",ra);N?(x.paymentsForm.undelegate(".a-touch-radio","click").delegate(".a-touch-radio:has(input[name\x3dpaymentMethod]:enabled)","click",C),x.paymentsForm.undelegate(".promoLabel","click").delegate(".promoLabel:has(input[name\x3dusePromoBalance]:enabled)","click",la),b=function(a){a.target.focus()},r("input#existingPincodeNum").bind("click",b),r("input#existingCvvNum").bind("click",b),r("input#existingCvvNum").bind("click",b),r("input#addCreditCardNumber").bind("click",b),r("input#addCreditCardPincode").bind("click",
b),r("input#addCreditCardVerificationNumber").bind("click",b),r(".payment-select").bind("touchstart",function(a){r(this).find("i").removeClass("a-icon-touch-radio-inactive")})):(p.increaseCount("removeauijs46"),x.paymentsForm.undelegate("label.a-touch-radio","click").delegate("label.a-touch-radio:has(input[name\x3dpaymentMethod]:enabled)","click",C),x.paymentsForm.undelegate("label.promoLabel","click").delegate("label.promoLabel:has(input[name\x3dusePromoBalance]:enabled)","click",la));r("#domestic-card-dropdown").unbind("change").bind("change",
function(){r("#label-domestic-card").trigger("click")});r("#third-party-dropdown").unbind("change").bind("change",function(){r("#label-third-party").trigger("click")});r("#vdcBanksSelect").unbind("change",J).bind("change",J);r("#upiActionSelect").unbind("change",O).bind("change",O);r("#upiRegistration_bankSelect").unbind("change",R).bind("change",R);r("#emiPaymentMethodsSelectList").unbind("change",H).bind("change",H);r(".sv-select-option").unbind("click",ua).bind("click",ua);r(".emi-menu-tenures-dropdown").unbind("change",
K).bind("change",K);r("#net-banking-list").unbind("change",va).bind("change",va);if(0<r("input[name\x3d'needDisableCODandEMIforGC']").length){b=r("#existing-gift-card-promo");if(b.length){b.bind("click",ka);x.paymentsForm.delegate(".js-gc-disabled","click",function(){return!1});var c=N?b.find("#pm_300"):b.children("#pm_300");c.is("input[type\x3d'checkbox']:checked")&&Z(b,!0);b.data("gc-initially-checked")&&Z(b,!0)}var e=r(".existing-gift-card-balance");e.length&&(e.bind("click",ka),x.paymentsForm.delegate(".js-gc-disabled",
"click",function(){return!1}),c=N?e.find("#pm_gc_checkbox"):e.children("#pm_gc_checkbox"),c.is(":checked")&&Z(e,!0),e.data("gc-initially-checked")&&Z(b,!0))}m.when("rewards-section-mobile").execute(function(b){a.trigger("rewards-section-mobile:init",x.paymentsForm,f)});m.when("installments-payselect-mobile").execute(function(){a.trigger("installments-payselect-mobile:init",x.paymentsForm,f)});m.when("apx-payselect-helper").execute(function(){var a=l.get("payselect");a&&a.initEvents(x.paymentsForm,
qa)});pa(V());qa();Ca();ea(V());Ga();ha();b=V();M(b);r.isEmptyObject(u)||u.toggleCustomerNudgingMessage(b);z.determineIsMCBEnabled(x);z.toggleGCForMCB(b,x);r("form.checkout-page-form").data("checkoutFormReady",!0).change()}}function va(a){a=r(a.currentTarget).find("option:selected");var b=a.data("isdisabled"),c=r("#net-banking-list");b?(c.find("#disable-bank-content-mob").show(),c.find("#selected-bank-mob").text(a.text()).show()):c.find("#disable-bank-content-mob").hide()}function ua(a){a=r(a.currentTarget);
var b=a.data(),c=r(document.getElementById(b.id)),d=r(document.getElementById("popover-"+b.id));c.find(".sv-select-value").val(b.value).trigger("change");d.find(".sv-select-option").removeClass("a-active");a.addClass("a-active");b=c.find(".a-button-text");a=a.find(".sv-select-option-primary-text").html();b.html(a)}var r=a.$,x={},ta=!0,N=k.P&&k.P.AUI_BUILD_DATE,sa={jppoints:"#jppoints",continueBtn:"#select-payments-view #continueButton",continueErrors:"#continue-errors",gcPromo:"#new-gc-promo",newVCC:"#new-verified-credit-card",
newVDC:"#new-verified-debit-card",newEMI:"#newEmiCard",paymentRows:"#select-payments-view label.a-touch-radio",paymentsForm:"#select-payments-view form",pageContainer:"#page-container",existingBalance:"#pm_300",showAmexWarning_mobile:"#showAmexWarning_mobile",existingPincodeNum:"#existingPincodeNum",mcbBalanceWarning:"#mcbBalanceWarning"};N&&(sa.paymentRows='#select-payments-view .a-touch-radio:not([data-a-input-name\x3d"rewardsAccount"])');var aa,ga={};return{init:ja,setContinueButtonStatus:Y,getSelectedPaymentRow:V,
getGilEstimatesMobileSuccess:ca}});m.when("A","pay-common-util","pay-rewards-currency").register("page-rewards",function(a,b,d){function c(a){a=m(a.currentTarget);var b=p?a.closest("div").data():a.data(),c=a.val()/b.ratio;isNaN(c)||(c=0>c||a.val()<b.min?0:f(c,b.decimalplaces),D.customRewardPoints.html(c))}function e(a){a=m(a.currentTarget);var b=a.data(),c=a.val(),d=parseFloat(D.rewardForm.find("#rewardsmax").val());isNaN(c)||0>c?(D.customRewardPoints.html(0),a.val(0)):c>d&&(b=f(d/b.ratio,b.decimalplaces),
D.customRewardPoints.html(b),a.val(d))}function g(a){a=m(a.currentTarget);"1"!==a.attr("ischecked")&&(D.rewardRows.attr("ischecked",0),a.attr("ischecked",1),"rewardscustom"===a.find("[type\x3dradio]").val()?(D.customReward.show(),D.customRewardText.addClass("a-text-bold")):(D.customReward.hide(),D.customRewardText.removeClass("a-text-bold")))}function f(a,b){isNaN(b)||(a=Number(a).toFixed(b));a=a.toString();b=0<=a.lastIndexOf(".")?a.lastIndexOf("."):a.length;return 3>=b?a:f(a.substring(0,b-3),0)+
","+a.substring(b-3)}var m=a.$,w=!0,p=k.P&&k.P.AUI_BUILD_DATE,D={},z={customReward:"#select-payment-rewards-view #custom-reward",customRewardPoints:"#select-payment-rewards-view #custom-reward-points",customRewardText:"#select-payment-rewards-view #custom-reward-text",rewardForm:"#select-payment-rewards-view form",rewardRows:"#select-payment-rewards-view label.a-touch-radio"};p&&(z.rewardRows="#select-payment-rewards-view .a-touch-radio");return{init:function(){if(b.isMobileCX()){b.refreshElements(D,
z);w&&(w=!1);var a=D.rewardForm.find("input[name\x3drewardsCustom]"),f=!1,k;a.hasClass("show-currency-input-widget-new")?(f=!0,k=m(a)):a.parent().hasClass("show-currency-input-widget-new")&&(f=!0,k=m(a.parent()));if(f){var u=parseFloat(k.data("max")),l=k.data("decimalplaces"),n=k.data("ratio"),E=k.data("country-code");a.each(function(b,c){c=D.rewardForm.find("#custom-reward-points");m(a);b={$element:m(a),maxAmount:u};c={$element:m(c),decimalPlaces:l,ratio:n};var e=d.getCurrencyFormatByCountryCode(E);
d.initializeInlineFormatting(b,c,e)})}else a.unbind("keyup").bind("keyup",c).unbind("blur").bind("blur",e);f=p?".a-touch-radio":"label.a-touch-radio";D.rewardForm.undelegate(f,"click").delegate(f,"click",g)}}}});m.when("A","pay-common-util").register("page-financial-offer",function(a,b){function d(a){a.$event.preventDefault();a=a.$target;var c=b.getInputValues(a),d=a.find(":checked").val();c.selectedFinancialOfferId=d;c.recommendedPaymentMethodId=c.paymentMethodId;b.makeAjaxCall(a.attr("action"),
c)}var c=!0,e={},g={financialOfferForm:"#select-payment-financial-offer-view form",financialOfferRows:"#select-payment-financial-offer-view label.a-touch-radio"};k.P&&k.P.AUI_BUILD_DATE&&(g.financialOfferRows="#select-payment-financial-offer-view .a-touch-radio");return{init:function(){b.isMobileCX()&&(b.refreshElements(e,g),c&&(a.declarative("apply-financial-offer",["submit"],d),c=!1))}}});m.when("A","pay-common-util","ready").execute(function(a,b){function d(){b.isMobileCX()&&(b.init(),b.elements.pageContainer.undelegate(".expando-link",
"click").delegate(".expando-link","click",function(a){var b=c(this);a=b.closest("div.expando-section").find("div.expando-content");a.is(":visible")?a.slideUp("fast",function(){b.find("i").removeClass("a-icon-collapse").addClass("a-icon-expand");b.find("div.expando-toggle-text-show").show();b.find("div.expando-toggle-text-hide").hide()}):a.slideDown("fast",function(){b.find("i").removeClass("a-icon-expand").addClass("a-icon-collapse");b.find("div.expando-toggle-text-show").hide();b.find("div.expando-toggle-text-hide").show()})}))}
var c=a.$,e=c("input#isPipelinedPage");if(0<e.length&&"1"===e.val())a.on("checkout:reload:payselect",d);else d()});m.when("A","pay-common-util","page-slide","pay-validator","ajax-utility","page-transition-controller","pay-credit-card","page-main","pay-common-lib","safe-mash","client-side-metrics","payselect-enhancements","ready").register("mobile-new-payments",function(a,b,d,c,e,g,f,m,w,p,D,z){function v(a){"undefined"!==typeof k.ue&&"undefined"!==typeof k.ue.count&&k.ue.count("PayPage-ClientSide-AddCupClick-Mobile",
1);var c=a.data.url,d={},e;for(e in a.data)"url"!==e&&(d[e]=a.data[e]);"object"===typeof p?"function"===typeof p.showEmbeddedBrowser&&p.showEmbeddedBrowser({targetURL:c,method:"POST",postParameters:d,successCallback:function(){}}):b.submitFormRequest(c,d,{target:"_blank"})}function A(a){"undefined"!==typeof k.ue&&"undefined"!==typeof k.ue.count&&k.ue.count("PayPage-ClientSide-AddCupAckClick-Mobile",1);g.show();k.location.reload()}function q(a,c){var d=a.data.type;f.isWaitingForType(d)?(a.$event.preventDefault(),
g.show(),setTimeout(function(){q(a)},50)):(y("#card-scanner-success-messages").addClass("aok-hidden"),H(d)?a.$event.preventDefault():y("#cupSecurityCode").is(":visible")&&y("#cupMobileNumber").is(":visible")?l(a,c):c?b.makeAjaxCall(a.data.url,c,{successHandler:J},{useSif:!0}):O(a,{useSif:!0}))}function u(a){a.$event.preventDefault();var c=b.getInputValues(y("#new-cc-inbox #form-add-credit-card"));c.handler=c.handler_addNewCC;q(a,c)}function l(a,c){if(!c){c={};for(var d=S?a.$declarativeParent.find("form").serializeArray():
a.$declarativeParent.serializeArray(),f=0;f<d.length;f++)c[d[f].name]=d[f].value}a.$event.preventDefault();b.makeAjaxCall("/gp/buy/payselect/handlers/add-credit-card.html",c,null,{useSif:!0,success:function(a,b,c){a=e.jsonify(a);n(a,b,c)}})}function n(a){var c={},d={success:function(a,c,d){a=e.jsonify(a);a.checkStatusCount?(a.checkStatusCount=parseInt(a.checkStatusCount,10),isNaN(a.checkStatusCount)&&(a.checkStatusCount=1)):a.checkStatusCount=3;"PENDING"===a.cardStatus&&1<a.checkStatusCount?(--a.checkStatusCount,
n(a)):b.submitFormRequest("/gp/buy/payselect/handlers/submit.html",{newPaymentMethodId:a.paymentInstrumentId})}};c.paymentInstrumentId=a.paymentInstrumentId;a.checkStatusCount&&(c.checkStatusCount=a.checkStatusCount);setTimeout(function(){b.makeAjaxCall("/gp/buy/payselect/handlers/check-credit-card-status.html",c,null,d)},2500)}function E(a){f.handleCreditCardType(a,R)}function L(a){a.$event.preventDefault();var c=a.data.type;if(!H(c)){var e=K[c],h=y(e.fieldId),e=e.suffix,g=b.getInputValues(h),h=
g["addCreditCardVerificationNumber"+e],k=g["addCreditCardPincode"+e],c={addCreditCardNumber:g["addCreditCardNumber"+e],addCreditCardVerificationNumber:h,addCreditCardPincode:k,handler:g["handler"+e],month:g["month"+e],name:g["name"+e],newPaymentType:c,recommendedPaymentMethodId:g.paymentMethod,year:g["year"+e],cctype:g["cctype"+e],isCardSavedFromEMIMenu:g["isCardSavedFromEMIMenu"+e],isSBIInternationalMaestroSelected:g["isSBIInternationalMaestroSelected"+e]},l=a.$target.hasClass("addCardAndContinueButton");
b.prop("cvv-newcard",h);b.prop("pincode-newcard",k);b.makeAjaxCall(a.data.url,c,{successHandler:function(a){if(a){var c=y(b.pages.main.pageId);d.slideShow(c,a);a=S?y("#select-payments-view .a-touch-radio"):y("#select-payments-view label.a-touch-radio");f.setNewCardCVVInputStatus(a)}},completeHandler:function(a,b){l&&(D.increaseCount("checkout:payselect:addcardandcontinue:continueactionactivated",1),y("#select-payments-view #continueButton").trigger("submit"));y.isEmptyObject(z)||z.triggerAjaxLoadEvent()}},
{useSif:!0,isAddCardAndContinueEnabled:l})}}function Q(a,b){b=y("#form-add-direct-debit");var d=b.find("input[name\x3daddBankAccountRoutingNumber]"),e=b.find("input[name\x3daddBankAccountNumber]"),f=b.find("input[name\x3ddebitAccountName]"),h=c.create();h.validateDirectDebitRoutingNum(d,d);h.validateDirectDebitAccountNum(e,e);h.validateDirectDebitAccountName(f,f);h.displayErrors(b.find("#direct-debit-errors"),b);h.hasErrors()?a.$event.preventDefault():O(a)}function J(c,e,f){c&&(e=b.getPageId(f))&&
(d.slideShow(y(e),c),a.trigger("checkout:reload:payselect"),(c=0<y(".activateScrollToError").length)&&0<y("#check-errors").length?y(k).scrollTop(y("#check-errors").offset().top):c&&0<y("#direct-debit-errors").length?y(k).scrollTop(y("#direct-debit-errors").offset().top):c&&0<y("#new-invoice-errors").length?y(k).scrollTop(y("#new-invoice-errors").offset().top):"#select-payments-view"===e&&w.scrollTopTo(m.getSelectedPaymentRow()))}function O(a,c){b.handleForm(a,J,c)}function R(a,b){if(a){"1"===a.isDebitCard?
y("#cardWarnings").show().removeClass("hidden"):y("#cardWarnings").hide().addClass("hidden");b=y(K[b].fieldId);f.setDateSelectorStatus(a,b);if("1"===a.hasErrors){var d=c.create();d.validateGetCreditCardTypeResult(a);if(d.hasErrors()){d.displayErrors(b.find("#cardErrors"),b);return}}d=b.find(".cup-card-field");if(0!==d.length){var e=a.specificFields;e&&1===e.securityCode&&1===e.mobileNumber?d.show():d.hide()}if(a&&(d=a.specificFields,e=b.find(".pincode-field"),0!==e.length)){var h=b.find(".cvv-field");
0!==h.length&&(b=b.find("#cardType"),0!==b.length&&(b.val(a.issuer+a.brand),d&&1===d.pincode?(h.hide(),e.show()):d&&0===d.pincode&&0===d.securityCode?(e.hide(),h.hide()):(e.hide(),h.show())))}}}function H(a){if(!(a in K))return!0;var b=K[a],d=y(b.fieldId),b=b.suffix,e="1"===d.find("#isSBIMaestroAsSavedCardEnabled").val()&&"1"===d.find('input[name\x3d"isSBIInternationalMaestroSelected'+b+'"]').val(),h=d.find('input[name\x3d"addCreditCardVerificationNumber'+b+'"]'),f=d.find('select[name\x3d"month'+
b+'"]'),g=d.find('input[name\x3d"name'+b+'"]');a=d.find('input[name\x3d"addCreditCardNumber'+("brdc"===a?"":b)+'"]');var l=d.find('input[name\x3d"addCreditCardMobileNumber'+b+'"]'),m=d.find('select[name\x3d"year'+b+'"]'),p=d.find('input[name\x3d"addCreditCardPincode'+b+'"]'),n=c.create();h&&h.length&&h.is(":visible")&&(n.isAMEXCreditCard(a)?n.validateCreditCardCVV2(h,h,"A"):n.validateCreditCardCVV2(h,h));l&&l.length&&l.is(":visible")&&n.validateCreditCardMobile(l,l);f.is(":disabled")||m.is(":disabled")||
n.validateCreditCardDate(f,f.closest(".card-date").find(".a-button"),m,m.closest(".card-date").find(".a-button"));n.validateCreditCardName(g,g);n.validateCreditCardNumber(a,a);e&&n.validateSBIMaestroCardNumberLength(a,a);p&&p.length&&p.is(":visible")&&n.validateCreditCardPincode(p,p);n.displayErrors(d.find("#cardErrors"+b),d);0<y(".activateScrollToError").length&&0<y("#cardErrors").length&&y(k).scrollTop(y("#cardErrors").offset().top);return n.hasErrors()}function P(){if(b.isMobileCX()&&W){a.declarative("new-payment-methods",
["click"],function(a){a.$event.preventDefault();b.makeAjaxCall(a.data.href,{},{successHandler:function(a){if(a){var c=b.pages["new-payment-methods"].pageId;d.slideShow(y(c),a);b.scrollTopTo(y(c));a=y("#pageHeading");a.attr("tabindex","0").css("outline","none");a.focus()}}})});a.declarative("new-cc",["submit"],q);a.declarative("new-cc-inbox",["click"],u);G()?a.declarative("new-dd",["submit"],Q):a.declarative("new-dd",["submit"],O);a.declarative("new-invoice",["submit"],O);a.declarative("new-brdc",
["submit"],q);a.declarative("new-verified-card",["click"],L);a.declarative("check-card-type",["change"],E);a.declarative("redirect-cup",["click","touchend"],v);a.declarative("cup-popover-close",["click"],A);a.declarative("new-ba",["submit"],function(a){var b=a.$target;if(b.find("#check-account-number").val()!==b.find("#check-account-number-confirm").val())return b.find("#check-errors").show(),b.find("#addBankAccount_AccountNumberMismatch").show(),b.find("[error\x3daddBankAccount_AccountNumberMismatch]").addClass("a-form-error"),
a.$event.preventDefault(),!1;O(a)});var c;a.declarative("check-terms-show",["click"],function(b){c=y(document).scrollTop();a.$("#check-terms-content").show();y(document).scrollTop(0)});a.declarative("check-terms-close",["click"],function(b){y(document).scrollTop(c);a.$("#check-terms-content").hide()});a.declarative("new-gc-promo",["click"],T);a.declarative("invoice-policy",["click"],function(a){a=a.$declarativeParent;a.find("i.a-icon-touch-link").hide();a.find("span.policy-preview").hide();a.find("span.policy-full").show()});
W=!1}}function T(a){var c=b.getInputValues(y("#new-gc-promo"));a.data.handler&&(c.handler=a.data.handler);b.makeAjaxCall(a.data.url,c,{successHandler:function(a,c,e){a&&(c=b.getPageId(e))&&d.slideShow(y(c),a)},completeHandler:function(a,b){y.isEmptyObject(z)||z.triggerAjaxLoadEvent()}});a.$event.preventDefault()}function G(){var a=y("#useDDNewErrorMessage");return a.length&&"1"===a.val()}var y=a.$,S=k.P&&k.P.AUI_BUILD_DATE,K={cc:{fieldId:"#form-add-credit-card",suffix:""},vcc:{fieldId:"#new-verified-credit-card",
suffix:"_VCC"},emi:{fieldId:"#newEmiCard",suffix:"_VCC"},vdc:{fieldId:"#new-verified-debit-card",suffix:"_VDC"},brdc:{fieldId:"#form-add-br-debit-card",suffix:"_BRDC"}},W=!0,h=y("input#isPipelinedPage");if(0<h.length&&"1"===h.val())a.on("checkout:reload:payselect",P);else P()});m.when("A","pay-common-util","ajax-utility","page-transition-controller","page-main","safe-mash","client-side-metrics","pay-gil","page-conductor","weblab-helper","ready").register("mobile-gil-estimates",function(a,b,d,c,e,
g,f,k,m,p){function D(a){k.actionCloseGilMobileSubpage(a);b.scrollTopTo(e.getSelectedPaymentRow());return!1}function z(a){c.show();k.actionSubmitGilMobileSubpage(a,v,A);return!1}function v(a,c,d){e.getSelectedPaymentRow().find('input[name\x3d"showIneligibleItemSubpage"]').val("");1==parseInt(u("input[name\x3d'gil-rendered-using-apx']").val(),10)&&p.isGILCreditCardEnabled()?(a=u(".pmts-select-payment-instrument-form"))&&0<a.length?m.continueClicked(null,a):f.increaseCount("Checkout:GIL:IneligibleSubpage:ErrorRedirectingToSPC",
1):u(b.pages.main.pageId).find("#continueButton").trigger("click")}function A(a){u("#gil-estimates-subpage").find(".gil-estimates-error").show()}function q(){b.isMobileCX()&&(a.declarative("gil-close-subpage",["click"],D),a.declarative("gil-submit-subpage",["click"],z))}var u=a.$;d=u("input#isPipelinedPage");if(0<d.length&&"1"===d.val())a.on("checkout:reload:payselect",q);else q()});m.when("A","page-main","ready").execute(function(a,b){var d=a.$,d=d("input#isPipelinedPage");if(0<d.length&&"1"===d.val())a.on("checkout:reload:payselect",
b.init);else b.init()});m.when("A","page-rewards","ready").execute(function(a,b){var d=a.$,d=d("input#isPipelinedPage");if(0<d.length&&"1"===d.val())a.on("checkout:reload:payselect",b.init);else b.init()});m.when("A","page-financial-offer","ready").execute(function(a,b){var d=a.$,d=d("input#isPipelinedPage");if(0<d.length&&"1"===d.val())a.on("checkout:reload:payselect",b.init);else b.init()});m.when("A","page-main","pay-common-util","client-side-metrics","mobile-carrier-billing-util","weblab-helper").register("jppoints-mobile",
function(a,b,d,c,e,g){function f(){l.gcCheckbox.is(":checked")||(l.redeemableAmount.text(l.redeemableAmountWithoutGC.val()),l.redeemableValue.text(l.redeemableValueWithoutGC.val()));l.gcRadio&&l.gcRadio.is(":checked")&&t();(u?l.redeemPoints.parents(".a-control-row"):l.redeemPoints.parent("label")).bind("click",D);var a=u?".a-control-row":"label";l.jppoints.find('input[type\x3d"radio"][name\x3d"jpPointsUseMaxPoints"]').closest(a).bind("click",z);l.jpPointsCustomAmount.bind("keyup",A);l.jpPointsCustomAmount.bind("click",
function(){l.useCustomPoints.attr("checked",!0);l.useCustomPoints.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");l.useMaxPoints.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active");w()||b.setContinueButtonStatus(!1)});(u?l.gcCheckbox.parents(".a-control-row"):l.gcCheckbox.parent("label")).bind("click",v);l.paymentRows.bind("click",function(){var a=q(this).find('input[type\x3d"radio"]');a&&a.length&&(0<a.filter("[value^\x3davailablebalance]").size()?
t():!g.isMCBMultiTenderWeblabEnabled()&&0<a.filter("[value^\x3dMCB]").size()?(t(),e.showMCBWarningMessageForPoints(l)):(l.redeemPoints.attr("disabled",!1),l.jppoints.find('input[type\x3d"radio"]').attr("disabled",!1),l.jppoints.find('input[type\x3d"checkbox"]').attr("disabled",!1),l.useCustomPoints.attr("disabled",!1),l.jpPointsCustomAmount.attr("disabled",!1),l.jppoints.find("#canApplyPoints").show(),l.jppoints.find("#cannotApplyPoints").hide(),e.hideMCBWarningMessageForPoints(l)))})}function t(){l.redeemPoints.attr("checked",
!1).attr("disabled",!0);l.redeemPoints.siblings("i").addClass("a-icon-touch-checkbox-inactive").removeClass("a-icon-touch-checkbox-active");l.jppoints.find('input[type\x3d"radio"]').attr("checked",!1).attr("disabled",!0);l.jppoints.find('input[type\x3d"checkbox"]').attr("checked",!1).attr("disabled",!0);l.jppoints.find("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active");l.useCustomPoints.attr("disabled",!0);l.jpPointsCustomAmount.val("");l.jpPointsCustomAmount.attr("disabled",
!0);l.jppoints.find("#canApplyPoints").hide();l.hiddenSection.hide();l.jppoints.find("#cannotApplyPoints").show()}function w(){if(u)return 0<l.paymentRows.filter("[data-ischecked\x3d1]").length;c.increaseCount("removeauijs48");return 0<l.paymentRows.filter("[ischecked\x3d1]").length}function p(){var a=q('input[type\x3d"radio"][name\x3d"paymentMethod"]');a.attr("checked",!1);a.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active");a.closest("label").attr("ischecked",
0)}function D(c){q(c.target);l.redeemPoints.siblings("i").toggleClass("a-icon-touch-checkbox-active").toggleClass("a-icon-touch-checkbox-inactive");l.redeemPoints.attr("checked",!l.redeemPoints.attr("checked"));if(l.redeemPoints.is(":checked")){l.hiddenSection.show();l.useMaxPoints.attr("checked",!0);l.useMaxPoints.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");c=parseInt(l.redeemableAmount.text(),10);var d=parseInt(l.jpPointsConversionRate.val(),10),
e=parseInt(l.purchaseTotalRaw.val(),10);l.gcCheckbox.is(":checked")&&(e-=parseInt(l.jpPointsCustomerGCValue.val(),10));d*c>=e?(p(),b.setContinueButtonStatus(!0)):w()||b.setContinueButtonStatus(!1)}else l.hiddenSection.hide(),l.useMaxPoints.attr("checked",!1),l.useMaxPoints.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),l.useCustomPoints.attr("checked",!1),l.useCustomPoints.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),
l.jpPointsCustomAmount.val(""),w()||b.setContinueButtonStatus(!1);m.when("installments-payselect-mobile").execute(function(b){a.trigger("installments-payselect-mobile:toggleJPPointsInstallmentEligibility",l.jppoints)});return!1}function z(c){var d=q(c.target);if(d.find("#jpPointsMax").length||d.siblings("#jpPointsMax").length){l.useMaxPoints.attr("checked",!0);l.jpPointsError.hide();l.jpPointsCustomAmount.val("");l.jpPointsCustomAmount.removeClass("a-form-error");l.useMaxPoints.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive");
l.useCustomPoints.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active");var d=parseInt(l.redeemableAmount.text(),10),e=parseInt(l.jpPointsConversionRate.val(),10),d=d*e,e=parseInt(l.purchaseTotalRaw.val(),10);l.gcCheckbox.is(":checked")&&(e-=parseInt(l.jpPointsCustomerGCValue.val(),10));d>=e?(p(),b.setContinueButtonStatus(!0)):w()||b.setContinueButtonStatus(!1)}else l.useCustomPoints.attr("checked",!0),l.useCustomPoints.siblings("i").addClass("a-icon-touch-radio-active").removeClass("a-icon-touch-radio-inactive"),
l.useMaxPoints.siblings("i").addClass("a-icon-touch-radio-inactive").removeClass("a-icon-touch-radio-active"),l.jpPointsCustomAmount.focus(),w()||b.setContinueButtonStatus(!1);m.when("installments-payselect-mobile").execute(function(b){a.trigger("installments-payselect-mobile:toggleJPPointsInstallmentEligibility",q(c.currentTarget))});return!1}function v(){var a=l.gcCheckbox;if(!a.length&&(a=q('input[type\x3d"radio"][value\x3d"availableBalance"]'),!a.length))return;var b;a.is(":checked")?(a=parseInt(l.redeemableAmountWithoutGC.val(),
10),b=l.redeemableValueWithoutGC.val()):(a=parseInt(l.redeemableAmountWithGC.val(),10),b=l.redeemableValueWithGC.val());l.redeemableAmount.text(a);l.redeemableValue.text(b);A()}function A(){var c=parseInt(l.jpPointsCustomAmount.val(),10);if(!c||0>c)l.jpPointsCustomAmount.val(""),l.jpPointsCustomAmount.removeClass("a-form-error"),l.jpPointsError.hide();else if(l.jpPointsCustomAmount.val(c),parseInt(l.redeemableAmount.text(),10)<c)l.jpPointsError.show(),l.jpPointsCustomAmount.addClass("a-form-error");
else{l.jpPointsError.hide();l.jpPointsCustomAmount.removeClass("a-form-error");var d=parseInt(l.purchaseTotalRaw.val(),10),e=parseInt(l.jpPointsConversionRate.val(),10),e=c*e;if(l.gcCheckbox.is(":checked"))var f=parseInt(l.jpPointsCustomerGCValue.val(),10),e=e+f;e>=d?(p(),b.setContinueButtonStatus(!0)):w()||b.setContinueButtonStatus(!1);m.when("installments-payselect-mobile").execute(function(b){a.trigger("installments-payselect-mobile:actionToggleJPPointsSection",c)})}}var q=a.$,u=k.P&&k.P.AUI_BUILD_DATE,
l={},n={jppoints:"#jppoints",paymentRows:"#select-payments-view label.a-touch-radio",gcCheckbox:'input[type\x3d"checkbox"][name\x3d"useAvailableBalance"]',gcRadio:'input[type\x3d"radio"][value\x3d"availablebalance"]',hiddenSection:"#hiddenSection",jpPointsConversionRate:'input[type\x3d"hidden"][name\x3d"jpPointsConversionRate"]',jpPointsCustomAmount:'input[type\x3d"text"][name\x3d"jpPointsCustomAmount"]',jpPointsCustomerGCValue:'input[type\x3d"hidden"][name\x3d"jpPointsCustomerGCValue"]',jpPointsError:"#jpPointsError",
purchaseTotalRaw:'input[type\x3d"hidden"][name\x3d"purchaseTotalRaw"]',redeemableAmount:"#redeemableAmount",redeemableAmountWithGC:'input[type\x3d"hidden"][name\x3d"redeemableAmountWithGC"]',redeemableAmountWithoutGC:'input[type\x3d"hidden"][name\x3d"redeemableAmountWithoutGC"]',redeemPoints:"#redeemPoints",redeemableValue:"#redeemableValue",redeemableValueWithGC:'input[type\x3d"hidden"][name\x3d"redeemableValueWithGC"]',redeemableValueWithoutGC:'input[type\x3d"hidden"][name\x3d"redeemableValueWithoutGC"]',
useCustomPoints:"#jpPointsCustom",useMaxPoints:"#jpPointsMax",mcbPointsWarning:"#mcbPointsWarning"};u&&(n.paymentRows="#select-payments-view .a-touch-radio");a.on("checkout:reload:payselect",function(){d.isMobileCX()&&(d.refreshElements(l,n),l.jppoints&&l.jppoints.length&&f())})});m.when("A","pay-common-util").execute(function(a,b){function d(){c('.a-radio[data-isaddresschallenge\x3d"true"]').unbind("click").bind("click",function(){var a=c(this),b=a.find('input[type\x3d"radio"]').is(":checked"),d=
"1"===a.attr("isfocused");a.attr("isfocused",b?1:0);d&&b&&a.find("#addCreditCardNumber").focus()})}var c=a.$;a.on("checkout:reload:payselect",function(){var a;if(a=k.P&&k.P.AUI_BUILD_DATE){a=parseFloat;var g;g=navigator.userAgent.toLowerCase();g=g.match(/android\/([0-9\.]*)/);a=4.4===a(g?g[1]:0)}a&&(a=c("#useFocusFixForTextBoxWithinRadio"),a=a.length&&"1"===a.val());a&&b.isMobileCX()&&d()})});"use strict";m.when("A","ready").register("purchase-order-number-trial",function(a){function b(){}function d(){}
var c=a.$;a.on("checkout:reload:payselect",function(){var a=c(".checkout-page-form");a&&0!==a.length&&parseInt(a.attr("data-trial-po-number"),10)&&c('#existing-loc-accounts input[type\x3d"text"]').each(function(a){var e=c(this);e.unbind("change").bind("change",function(){var a=e.val();if(a&&0!==a.length){var g;if(e.attr("name")){var k=e.attr("name").split(".");k&&2===k.length&&(g=k[1])}g&&0!==g.length&&c.ajax({type:"POST",url:"/gp/buy/payselect/handlers/set-po-number-trial.html",data:{purchaseOrderNumber:a,
paymentMethodId:g},dataType:"text",async:!0,success:b,error:d,cache:!1})}})})})});"use strict";m.when("A","safe-mash","a-dropdown","client-side-metrics","ready").execute(function(a,b,d,c){function e(){setTimeout(function(){f("#stop-mash-reappear").remove()},100)}function g(a,g){a.append('\x3cdiv id\x3d"stop-mash-reappear" /\x3e');f("#ccScannerUsed").val(1);var D=[1],z="undefined"!==typeof k.ue&&"undefined"!==typeof k.ue.count;z&&!b.showCardScanner?k.ue.count("ccScannerFailureMashFtNotFound",1):b.showCardScanner({cardTypes:D,
successCallback:function(b){if(b&&b.cardData){b=b.cardData;var A;f.isArray(b.number)&&b.number.length&&(A=b.number[0].value);if(A){z&&k.ue.count("ccScannerSuccess",1);a.find("#card-scanner-feature").addClass("aok-hidden");a.find("#addCreditCardNumber").val(A);A=null;if(f.isArray(b.expirationMonth)&&f.isArray(b.expirationYear)&&b.expirationMonth.length&&b.expirationYear.length){var q=parseInt(b.expirationYear[0].value,10);100>q&&(q+=2E3);q>=(new Date).getFullYear()&&(A={month:""+parseInt(b.expirationMonth[0].value,
10),year:""+q})}if(A){z&&k.ue.count("ccScannerSuccessWithMonth",1);var u=a.find("#ccMonth");b=a.find("#ccYear");if(0>=u.length||0>=b.length){e();g&&a.find("#confirm-card").trigger("click");return}m?(d.getSelect(u).val(A.month),d.getSelect(b).val(A.year)):(c.increaseCount("removeauijs34"),u.val(A.month),q=u.siblings("a.a-placeholder"),u=u.find("option[value\x3d"+A.month+"]").text(),q.html(u),b.val(A.year),q=b.siblings("a.a-placeholder"),b=b.find("option[value\x3d"+A.year+"]").text(),q.html(b))}b=!1;
q=a.find("#card-scanner-success-messages");f("#ccName").val()||(q.find("#cc-scan-missing-name").removeClass("aok-hidden"),b=!0);A||(q.find("#cc-scan-missing-exp-date").removeClass("aok-hidden"),b=!0);b&&q.removeClass("aok-hidden")}else z&&(k.ue.count("ccScannerFailure",1),k.ue.count("ccScannerFailureNoNum",1));e();g&&a.find("#confirm-card").trigger("click")}else e()},failCallback:function(a){z&&(k.ue.count("ccScannerFailure",1),k.ue.count("ccScannerFailureError",1));e()}})}var f=a.$,m=k.P&&k.P.AUI_BUILD_DATE;
a.declarative("card-scanner",["click"],function(a){a.$event.preventDefault();a=a.$currentTarget.parents("#add-new-cc, #new-cc, #new-cc-inbox");g(a,!1)});a.declarative("card-scanner-addr-challenge",["click"],function(a){a.$event.preventDefault();a=a.$currentTarget.parents(".payment-box, .payment-row");g(a,!0)})});"use strict";m.when("page-detector","A","ready").register("third-party-account-alternative",function(a,b){var d=b.$;b.declarative("a-third-party-payment-select",["click"],function(a){var b=
null;a.data&&a.data.value?b=a.data.value:(a=a.$target.closest(".payment-alternate"),a.length&&(b=a.data("value")));b&&d("#third-party-select").val(b)});b.on("checkout:reload:payselect",function(){if(a.isMobile()){var b=d(".payment-alternate");b.length&&(b=b.find("input[type\x3d'radio']:checked"),b.length&&b.click())}else if(b=d("#third-party-account").find(".payment-alternate"),0!==b.length){var e=d("#pm-third-party-account");e.length&&e.is(":checked")&&(e=d("#third-party-select").val(),b=b.filter("[data-value\x3d"+
e+"]"),b.length&&(b.addClass("payment-selected"),b.find("input").prop("checked",!0)))}})});"use strict";m.when("A","ready").register("credit-card-autopopulated-fields-clear",function(){});"use strict";m.when("A","ready").register("credit-card-number-format-spacing",function(){});"use strict";m.when("A","ready").register("payselect-enhancements",function(){});"use strict";m.when("A","page-transition-controller","scroll-controller","checkout-modal-popover","page-conductor","checkout-general-utils",
"safe-mash").register("itemselect-controller",function(a,b,d,c,e,g,f){function m(a){D(a.data);a.$event.preventDefault();a=a.$target.closest(E?"button[type\x3dbutton]":"input[type\x3dbutton]");var b={};b[a.attr("name")]=a.val();w(b)}function w(a){b.show();var c=n("form#changeQuantityFormId"),d=c.serialize(),d=d+("\x26"+n.param(a));n.ajax({type:"POST",url:c.attr("action"),data:d,dataType:"text",headers:{"x-amz-checkout-page":"itemselect"},error:e.ajaxRedirect,success:p})}function p(a,c,d){var f=d.getResponseHeader("x-amz-checkout-new-cart-quantity");
g.updateCartByMash(f);f=d.getResponseHeader("x-amz-checkout-redirect-to-cart");null!==f&&f!==H?(b.hide(),k.location=f):e.ajaxUpdatePage(a,c,d,{pushNewFrame:"false"})}function D(a){""!==a&&n("form#changeQuantityFormId").attr("action",a)}function z(){b.hide();k.location="/gp/aw/c/ref\x3dox_spc_deal_expired?app-action\x3dcart"}function v(){d.toggleScrollOn();n("div.stma-line-item-hidden-fields input[name^\x3dpreviousQuantity]").each(function(){var a=n(this);if(a.attr("name")&&17<a.attr("name").length){var b=
a.attr("name").substring(17);n('div.stma-line-item-details input[name\x3d"quantity.'+b+'"]').val(a.val())}})}function A(a){function b(a){var c=n("#stma-address-selector"),d=a.data("itemCount"),e=a.data("addressSelectorName"),f=n("#address-item-id-"+d).val();a=a.data("ineligibleAddresses");n("#address-selector-selector").val(e);n("#address-selector-id").val(f);n("#address-selector-num").val(d);c.find(".addressLine").removeClass("a-active");c.find("."+f).addClass("a-active");n("#stma-page-container").hide();
n("#stma-page-header").hide();E&&n("#stma-page-footer").hide();c.show();q(a)}L||(L={value:!1},"1"===n("#rmMultiaddress2ndBackApp").val()&&(L.value=f&&f.navigate&&n("#checkoutDisplayPage").data("useMashNavigateForTransitions")));L.value?f.navigate({url:null,transitionEffect:"slide",successCallback:function(){b(a);k.history.pushState({multipleAddressPageMarker:!0},"");k.history.pushState(null,"");var c=k.onpopstate;k.onpopstate=function(a){a.state.multipleAddressPageMarker&&(l(),k.onpopstate=c,k.history.back())}},
failCallback:function(a){}}):b(a)}function q(a){n(".addressLine").prop("disabled",!1);n(".addressLine").show();n(a.split(" ")).each(function(){n("#"+this).prop("disabled",!0).hide()});var b=n("#filterMessage");a?b.show():b.hide()}function u(a){var b="#"+n("#address-selector-selector").val();if(n(b).hasClass("pantry-item")&&(b=n(".pantry-item"),!(2>b.length))){var c=a.data("addressid"),d=a.data("addresskey"),e=a.data("addresshtml");b.each(function(){var a=n(this);if(a.val()===d)return!0;var b,f=a.parents("a[data-item-count]")[0];
f&&(b=n(f).attr("data-item-count"));b&&(a.val(d),n("#address-item-id-"+b).val(c),n("#address-item-display-"+b).text(e))})}}function l(){n("#stma-page-header").show();n("#stma-page-container").show();E&&n("#stma-page-footer").show();n("#stma-address-selector").hide()}var n=a.$,E=k.P&&k.P.AUI_BUILD_DATE,L=null;a.on("checkout:reload:itemselect",function(){n("form#changeQuantityFormId").attr("action",n("form#changeQuantityFormId").attr("action")+"\x26action\x3dcontinue");a.defer(function(){n("html").hasClass("a-touch")&&
n("a[target\x3d'AmazonHelp']").removeAttr("onclick")});0<n("div.checkout-stma-tablet").length&&n(".quantity-field").unbind("keypress.stma-qty-field").bind("keypress.stma-qty-field",function(c){13===c.which&&(c.preventDefault(),b.show(),a.trigger("a:declarative:ship-to-multiple-continue:click"),n("form#changeQuantityFormId").submit())});var c=n("#addon-indicator");if(c.data("hasAddonItems")){var e=c.data("addonWarningType"),e=n("#addon-warning-"+e+"-launcher");e.length&&(c.data("showAddressTitle")?
(n("#a-popover-addon-warning-normal .select-address-title").show(),n("#a-popover-addon-warning-normal .delete-title").hide(),n("#a-popover-addon-warning-normal .reduce-title").hide()):(n("#a-popover-addon-warning-normal .delete-title").show(),n("#a-popover-addon-warning-normal .reduce-title").hide(),n("#a-popover-addon-warning-normal .select-address-title").hide()),e.trigger("click"),d.scrollToTop(),d.toggleScrollOff())}});(function(){a.declarative("stma-delete-item",["click"],function(a){m(a)});
a.declarative("ship-to-multiple-delete",["click"],function(a){0<n("div.checkout-stma").length&&(n(".quantity-delete-button[data-entity-id\x3d'"+a.$currentTarget.data("entityId")+"']"),k.confirm(n("#addressConfirmDeletion").val())?m(a):a.$event.preventDefault())});a.declarative("ship-to-multiple-continue",["click"],function(a){D(a.data)});a.declarative("stma-items",["click"],function(a){a=a.$currentTarget;var b=n("#stma-address-selector"),c=a.data("addressid"),d=a.data("addresskey");b.find(".addressLine").removeClass("a-active");
b.find("."+c).addClass("a-active");b="#"+n("#address-selector-selector").val();n(b).val(d);d=n("#address-selector-num").val();n("#address-item-id-"+d).val(c);c="#address-item-display-"+d;a=a.data("addresshtml");n(c).text(a);L.value?f.goBack():l()});a.declarative("stma-address-select",["click"],function(a){A(a.$currentTarget)});a.declarative("stma-back",["click"],function(a){a.$event.preventDefault();l()});a.declarative("addon-return-to-cart",["click"],function(a){0<n("div.checkout-stma-mobile").length&&
z()});a.declarative("addon-delete-items",["click","touchend"],function(a){0<n("div.checkout-stma").length&&(a.$event.preventDefault(),d.toggleScrollOn(),a=n("input#updateLinkAction").val(),D(a),w({"deleteAddon.x":1,"deleteAddon.y":1}))});a.declarative("addon-dont-delete",["click","touchend"],function(a){0<n("div.checkout-stma").length&&v()});a.declarative("stma-items",["click"],function(a){u(a.$currentTarget)});a.on("a:popover:hide:addon-warning-normal",function(a){0<n("div.checkout-stma-mobile").length?
z():0<n("div.checkout-stma-tablet").length&&v()});a.on("a:popover:hide:addon-warning-special",function(a){0<n("div.checkout-stma").length&&v()})})()});"use strict";m.when("A","checkout-general-utils").register("checkout-confirm-action",function(a,b){var d;a.declarative("a-checkout-confirm-action",["click","touchend"],function(c){if(!b.protectAgainstDoubleAction("checkout-confirm-action")){var d=a.$("#rcx-confirm-"+c.data.confirmAction).find("#rcx-modal-trigger"),g=d.data("a-checkout-modal-popover");
g.data=c.data;d.data("a-checkout-modal-popover",g);setTimeout(function(){d.trigger("click")},30)}});a.declarative("a-popover-confirm",["click","touchend"],function(c){b.protectAgainstDoubleAction("popover-confirm")||(c=c.data,d&&d.data&&c&&a.trigger("a:declarative:"+c,d.data),d&&d.$popover.find("button[data-action]\x3da-popover-close").trigger("click"))});a.on("a:popover:show:checkout-confirm",function(b){d=b.popover;b=d.$popover.find(".a-popover-inner");var e=a.$("#rcx-confirm-"+d.data.confirmAction).find("#rcx-confirm-template").html();
b.html(e);d.updatePosition()});a.on("a:popover:hide:checkout-confirm",function(){d=null})});"use strict";m.when("A").register("pip-controller",function(a){var b=a.$;a.on("checkout:reload:pip",function(){b(".checkout.checkout-pip").length||b("head .aui-page-asset").attr("disabled",!0);b("head .old-pipeline-asset").attr("disabled",!0);0<b("#disablePIPPrefetch").length?(b(".prime-checkout-continue-link").removeClass("checkout-continue-link"),b(".prime-checkout-continue-form").removeClass("checkout-page-form")):
(b(".prime-checkout-continue-link").addClass("checkout-continue-link"),b(".prime-checkout-continue-form").addClass("checkout-page-form"))})});"use strict";m.when("A","page-detector").register("locker-promo-controller",function(a,b){function d(){var a=e("#locker-search-link"),b=a.attr("href");a.attr("href",b+"\x26hasWorkingJavascript\x3d1");e("#locker-promo-checkbox-link").addClass("has-js")}function c(){e("#locker-promo-checkbox-link").addClass("has-js");if(e("#locker-promo").hasClass("trigger-interstitial")){var a=
e("#locker-high-vis-promo-title");setTimeout(function(){a.trigger("click")},50)}}var e=a.$;e("html").hasClass("a-ie6")||(a.on("checkout:reload:spc",d),a.on("checkout:reload:shipoptionselect",c))});"use strict";m.when("A","page-transition-controller","scroll-controller","loading-spinner-controller","page-conductor","checkout-general-utils").register("store-search-popover-controller",function(a,b,d,c,e,g){function f(){if(0<U&&"undefined"!==typeof k.Map)try{k.Map.getMapAndIcons(),Q=!0}catch(a){--U,setTimeout(f,
500)}U=20}function m(){S=0;u.find("button.a-button-close").trigger("click")}function w(a){var b=q("#locker-promo");b.hasClass("trigger-interstitial")&&(b.removeClass("trigger-interstitial"),A(y),0<q("#lockerInterstitialHeader").length&&q("#lockerInterstitialHeader").hide(),q.ajax({type:"POST",url:"/gp/azbox/interstitial/handlers/interstitial-opt-out.html/ref\x3d"+a,dataType:"html",cache:!1,headers:{"x-amz-checkout-page":"sosp"}}))}function p(a){a.filter("style").each(function(){var a=this.text||this.textContent||
this.innerHTML||"";if(null!==a){var b=document.createElement("style");b.type="text/css";b.styleSheet?b.styleSheet.cssText=a:b.appendChild(document.createTextNode(a));u.find("#storeResultContent").append(b)}})}function D(a){a.filter("script").each(function(){if(this.src)0<this.src.indexOf("mapcontrol")&&(H=this.src);else{var a=this.text||this.textContent||this.innerHTML||"";if(null!==a){var b=document.createElement("script");b.type="text/javascript";b.text=a;u.find("#storeResultContent").append(b)}}})}
function z(a,b){a.find("div#wrapper").css("width","100%");a.find("div#ft").hide();c.hideSpinner(J);J.show();J.html(a.find("div#wrapper"));J.css({"overflow-y":"scroll"});u.css("position","absolute");u.css("top","50px");q("#storeResultContent").css("height",P+"px");p(a);D(a);null!==H&&!1===Q?q.ajax({url:H,async:!1,success:f,dataType:"script",error:function(a,b,c){e.ajaxRedirect(a,b,c)}}):f();d.scrollToTop();d.toggleScrollOff()}function v(a){J=l.$popover.find("#storeResultContent");c.showSpinner(J);
q.ajax({type:"POST",url:a,dataType:"html",data:{defaultStoreUpsellSelectedAddressId:W},async:!0,cache:!1,headers:{"x-amz-checkout-page":"sosp"},success:function(a,b,d){null!==a?(b=q(a),0<b.find("div.errorblock").length?(c.hideSpinner(J),J.show(),J.html(b.find("div.errorblock").parent())):0<b.find("input[name\x3drefineSearch]").length?(E=b.find("form[name\x3dlocationForm]"),null!==E&&(E.find("input").attr("id","storeSearchRefineButton"),E.parent().find("h1").css("color","black")),z(b,a)):0<b.find("div#wrapper").length?
(b.find("#wrapper").find("tr:first").children("td")[0].style.width="49%",b.find("#wrapper").find("tr:first").children("td")[1].style.width="2%",b.find("#wrapper").find("tr:first").children("td")[2].style.width="49%",b.find("#sl_map").css("width","100%"),b.find("#whatsThisPopoverLink").removeAttr("href"),b.find("#whatsThisPopoverLink").addClass("a-declarative"),b.find("#whatsThisPopoverLink").css("a-declarative"),b.find("#whatsThisLink").addClass("a-declarative"),b.find("#whatsThisLink").attr("data-action",
"a-tooltip"),d='{"position":"triggerBottom","content":"'+R+'"}',b.find("#whatsThisLink").attr("data-a-tooltip",d),b.find("#whatsThisLink").css("max-width","100px"),b.find("input[name\x3dshipToThisAddress]").attr("src",O),b.find("input[name\x3dshipToThisAddress], span.default-store-upsell-selected-address").parent().css("text-align","center"),b.find("input[name\x3dshipToThisAddress], span.default-store-upsell-selected-address").parent().css("vertical-align","middle"),n=b.find("table.storesearchtable").parent(),
n.find("label").css("display","inline"),b.find("table.storesearchtable").parent().append(G),b.find("table.storesearchtable").parent().find("div#lockerPromoPopover").show(),z(b,a)):k.location.reload()):e.ajaxRedirect()},error:function(a,b,c){e.ajaxRedirect(a,b,c)}})}function A(a){u.find("div.a-popover-header h4").text(a)}var q=a.$;if(!q("html").hasClass("a-ie6")){var u,l,n,E,H=null,Q=!1,J,O,R,U=20,P,T,G,y,S,K,W;a.on("a:popover:hide",function(a){a.popover&&a.popover.name&&a.popover.name.indexOf("store-search-popover")});
q(document).delegate("#storeResultContent input.storesearchprimaryinput","click",function(a){a.preventDefault();q(this).parent().parent().find("input[type\x3dradio]").attr("checked","checked")});q(document).delegate("#storeResultContent input[name\x3dshipToThisAddress]","click",function(a){a.preventDefault();a=q(this).parents().find("form")[0].action;a+="?usecase\x3dcheckout\x26hasWorkingJavascript\x3d1\x26shipToThisAddress\x3dContinue";var c=q(this).parent().parent().find("input:hidden"),d,e;for(e=
0;e<c.length;e++){d=c[e].name;var f=c[e].value;if(S&&K&&"storeUpsellAddressId"===d&&f){d=g.addQueryStringParameter(K,"storeUpsellSelectedAddressId",f);break}d=a=a+"\x26"+d+"\x3d"+f}m();b.show();g.redirectWithJavascript(d)});q(document).delegate("#storeResultContent input[name\x3dshowDetailedMap]","click",function(a){a=a.$target[0].id.replace("pinpointImage_idx_","");"undefined"!==typeof k.Map&&k.Map.selectPin(a-1)});q(document).delegate("#storeResultContent input[name\x3dsearchStoreByName]","click",
function(a){a.preventDefault();E=u.find("form");a=E[0].action;a+="?usecase\x3dcheckout\x26hasWorkingJavascript\x3d1\x26searchStoreByName\x3dContinue";var b=E.find("input:hidden"),c;for(c=0;c<b.length;c++)a=a+"\x26"+b[c].name+"\x3d"+b[c].value;v(a)});q(document).delegate("#storeResultContent #storeSearchRefineButton","click",function(a){a.preventDefault();E=u.find("form[name\x3dlocationForm]");a=E[0].action;a+="?usecase\x3dcheckout\x26hasWorkingJavascript\x3d1\x26";var b=E.find("input:hidden"),c;for(c=
0;c<b.length;c++)a=a+"\x26"+b[c].name+"\x3d"+b[c].value;v(a)});q(document).delegate("#storeResultContent div.storesearchaction input","click",function(a){a.preventDefault();n=u.find("#new-store").parent().find("form");var b=n.find("input:checked")[0].value;a=n[0].action;var c=n.find("input:checked")[0].name,d=u.find("#"+b)[0].name,e=u.find("#"+b)[0].value;a=a+"?usecase\x3dcheckout\x26hasWorkingJavascript\x3d1\x26"+c+"\x3d"+b+"\x26"+d+"\x3d"+e;for(b=0;b<n.find("select").length;b++)c=n.find("select")[b].name,
d=n.find("option:checked")[b].value,a=a+"\x26"+c+"\x3d"+d;c=n.find("input:hidden");for(b=0;b<c.length;b++)a=a+"\x26"+c[b].name+"\x3d"+c[b].value;v(a)});q(document).delegate("div#promoFooter button","click",function(a){w("sosp_locker_tp_optout_nt");m()});q(document).delegate("div.a-popover-header button.a-button-close","click",function(a){w("sosp_locker_tp_optout_cb")});a.on("a:popover:show",function(a){if(a.popover&&a.popover.name&&0===a.popover.name.indexOf("store-search-popover")){var b=q(k).width(),
c=q(k).height(),b=parseInt(.88*b,10);P=parseInt(.62*c,10);var d=a.popover.$trigger.data("locker-search-url");u=a.popover.$popover;l=a.popover;y=u.find("div.a-popover-header h4").text();q("#locker-promo").hasClass("trigger-interstitial")&&(A(a.popover.$trigger.data("header-interstitial")),0<q("#lockerInterstitialHeader").length&&q("#lockerInterstitialHeader").show(),d=a.popover.$trigger.data("locker-search-url-interstitial"),P=parseInt(.45*c,10));q("#storeResultContent").css("height",P+"px");q("#storeResultContent").css("width",
b+"px");u.css("position","absolute");u.css("top","50px");l.updatePosition(!0);T=u.find("div#lockerPromo");G=T.clone(!0);G.attr("id","lockerPromoPopover");u.find("#storeResultContent").empty();O=a.popover.$trigger.data("locker-search-button");a.popover.$trigger.data("locker-search-disabled-button");R=a.popover.$trigger.data("restricted-locker-disclaimer-text");S=0;v(d)}});a.on("a:popover:show:store-upsell-ship-options",function(a){var b=q(k).width(),c=q(k).height(),b=parseInt(.88*b,10);P=parseInt(.62*
c,10);c=a.popover.$trigger.data("store-search-url");u=a.popover.$popover;l=a.popover;q("#storeResultContent").css("height",P+"px");q("#storeResultContent").css("width",b+"px");u.css("position","absolute");u.css("top","50px");l.updatePosition(!0);T=u.find("div#store-upsell-pickup-instructions");G=T.clone(!0);G.attr("id","lockerPromoPopover");u.find("#storeResultContent").empty();O=a.popover.$trigger.data("store-search-button-url");R=a.popover.$trigger.data("restricted-store-disclaimer-text");S=1;K=
a.popover.$trigger.data("store-select-pickup-url");W=a.popover.$trigger.data("default-store-upsell-selected-address-id");v(c)});a.on("a:popover:hide:store-upsell-ship-options",function(a){S=0})}});"use strict";m.when("A","page-detector-current-page","first-load-dependencies-base","client-side-metrics","weblab-helper").register("first-load-dependencies",function(a,b,d,c,e){var g=a.$,f=["shared-kitchensink","page-transition-controller","page-conductor","page-conductor-mpp","checkout-federation-injector"];
k.P&&k.P.AUI_BUILD_DATE||(c.increaseCount("removeauijs62"),f.concat(["checkout-modal-popover","form-icon-controller"]));c={accesspoint:["accesspoint-search-controller"],deliverypreference:["delivery-preference-controller"],shipaddressselect:"as-controller as-faf-controller as-tablet-controller as-locker-mobile-controller address-book-controller address-utilities what-if-im-not-in-delivery-preferences weekend-availability-loader".split(" "),billingaddressselect:["as-controller","as-tablet-controller",
"address-book-controller"],editaddress:["as-controller","as-tablet-controller","weekend-availability-loader"],giftselect:["gift-form-controller","gift-form-del-opt-controller"],itemselect:["itemselect-controller","itemselect-quantity-controller","address-popovers","itemselect-address-controller","address-popovers"],newaddress:["what-if-im-not-in-delivery-preferences","weekend-availability-loader"],payselect:"pay-common-lib pay-common-util pay-gil pay-validator pay-credit-card existing-payments jppoints page-slide page-main page-rewards mobile-new-payments mobile-gil-estimates jppoints-mobile purchase-order-number-trial otp-for-cod mobile-carrier-billing-util emi-helper instant-bank-discount-helper".split(" "),
payauth:["pay-auth"],pip:["pip-controller"],shipoptionselect:["shipoptionselect-controller","deliv-prefs-sosp","scheduled-delivery-readiness-checker"],spc:"delivery-preferences-controller gc-redeem-controller gift-popover-controller inline-address-popover-controller thirdparty-redirect-popover-controller inline-fps-balance-controller inline-points-controller order-summary-controller-mpp place-order-controller prime-decline-controller quantity-update-controller shipping-speed-selection-controller time-preferences-controller verification-checkbox-controller installments-controller pay-validator page-conductor toggle-pyo-button toggle-pyo-button-common".split(" "),
spclite:["verification-checkbox-controller","get-final-results-update"],throttle:["checkout-throttle-error"]};e.isSospCalendarFixEnabled()&&c.shipoptionselect.push("load");b=b.getCurrentPage();var m=g.merge(f,c[b]||[]);a.on("afterReady",function(){d.allDependenciesCheck(m)})});"use strict";m.when("A","ready").execute(function(a){function b(){d()?f("span.#button_verify").removeClass("a-button-disabled").find('input[type\x3d"submit"]').removeAttr("disabled"):f("span.#button_verify").addClass("a-button-disabled").find('input[type\x3d"submit"]').attr("disabled",
"disabled")}function d(){var a=!0;f('input[type\x3d"text"]:visible').each(function(){var b=f(this);a=b.val()?"documentNumber"===b.attr("name")&&10!==b.val().length||"birthdate"===b.attr("name")&&7!==b.val().length||"expiry"===b.attr("name")&&7!==b.val().length?!1:!0:!1;if(!a)return!1});return a}function c(){f('input[type\x3d"radio"][name\x3d"idType"]').change(function(){f(".container").removeClass("newGermanId oldGermanId passportId").addClass(this.value);f('input[type\x3d"text"]:visible').each(function(){f(this).val("")});
b()})}function e(){a.on("a:dropdown:selected:idType",function(a){f(".container").removeClass("newGermanId oldGermanId passportId").addClass(a.value);f('input[type\x3d"text"]:visible').each(function(){f(this).val("")});b()})}function g(){f("form").submit(function(a){f("#documentNumber").attr("name","");f("#expiry").attr("name","");return!0})}var f=a.$;a.on("checkout:reload",function(){if(0<f(".checkout-ageEntry").length){var a=0<f(".checkout-ageEntry-mobile").length;f(".checkout-age-verification-inputs").removeClass("nojs").addClass("js");
a?(a=f("#idSelector option:selected").attr("value"),-1<["newGermanId","oldGermanId","passportId"].indexOf(a)?f(".container").removeClass("newGermanId oldGermanId passportId").addClass(a):f(".container").removeClass("newGermanId oldGermanId passportId").addClass("newGermanId")):(a=f('input[type\x3d"radio"]:checked').val(),f(".container").removeClass("newGermanId oldGermanId passportId").addClass(a));b();-1<f(location).attr("href").indexOf("age-verification")&&k.history.replaceState({page:"ageDisplay"},
"","/gp/buy/age-verification/handlers/display.html");f('input[type\x3d"text"]').keyup(b);c();e();g()}})});"use strict";m.when("A","ready").execute(function(a){var b=a.$;b(document).ready(function(){b("#changeCORForm").find("#learnMorePopoverLinkPhoneNumber").remove()});b("#changeCORForm").submit(function(){var d={};b(this).find("input").each(function(a,b){d[b.name]=b.value});b(this).find("select").each(function(a,b){d[b.name]=b.options[b.selectedIndex].value||b.options[b.selectedIndex].innerHTML});
a.ajax("/gp/buy/dsv/handlers/change-country-setting.html",{method:"post",params:d,success:function(a){a.success?b("#continueCheckout").submit():"FormErrors"===a.error?b("#dsvAddressForm").html(a.newForm):"DependencyFailure"===a.error?b("#continueCheckout").submit():b("#showWereSorryPage").submit()},error:function(a){b("#continueCheckout").submit()}});return!1})});"use strict";m.when("A","client-side-metrics").execute(function(a,b){var d=a.$;a.declarative("imb-enter-cvv","click",function(a){b.increaseCount("checkout:spc:desktop:expresscheckout:imbclicked");
(a=a.data)&&a.focusTarget&&(a=d("#"+a.focusTarget))&&a.length&&a.focus()})});m.when("A").register("toggle-pyo-button",function(){});m.when("A").register("toggle-pyo-button-common",function(){});"use strict";m.when("A","mash","client-side-metrics","ready").register("gc-scan-to-claim",function(a,b,d){function c(){setTimeout(function(){k("#stop-mash-reappear").remove()},100)}function e(a){c();d.increaseCount("gcScannerOnRCXFailureError",1);a.code===b.cardScanError.CANNOT_OPEN_CAMERA?d.increaseCount("gcScannerOnRCXFailureError:cannotOpenCamera",
1):a.code===b.cardScanError.INVALID_CARD_TYPE?d.increaseCount("gcScannerOnRCXFailureError:invalidCardType",1):a.code===b.cardScanError.NO_SUPPORTED_CARD_TYPES&&d.increaseCount("gcScannerOnRCXFailureError:unsupportedCardType",1)}function g(b){b?(b=b.cardData)?(b=b.number)?(14>b.length&&d.increaseCount("gcScannerOnRCXMashError:invalidClaimCodeLength",1),b=14>b.length?b:b.replace(/^(.{4})(.{6})(.+)?$/,"$1-$2-$3"),(k("#spc-gcpromoinput").length?k("#spc-gcpromoinput"):k("#gcpromoinput")).val(b),d.increaseCount("gcScannerOnRCXSuccess:showClaimCode",
1),a.state.replace("cxt-gc-redemption-method",{method:"scan"}),(k("#apply-gc-button").length?k("#apply-gc-button"):k("#button-add-gcpromo")).trigger("click"),a.trigger("gc:scan:rcx:success")):(d.increaseCount("gcScannerOnRCXMashError:noClaimCode",1),c()):(d.increaseCount("gcScannerOnRCXMashError:noCardData",1),c()):(d.increaseCount("gcScannerOnRCXMashError:noCardInfo",1),c())}function f(a){a.$event.preventDefault();k("#apply-gc-button-container").append('\x3cdiv id\x3d"stop-mash-reappear" /\x3e');
d.increaseCount("gcScannerOnRCXSuccess:clickOnScanButton",1);b.showCardScanner({cardTypes:[2],successCallback:g,failCallback:e})}var k=a.$;a.declarative("gc-scan","click",f);a.declarative("gc-scan-input-box","keyup change",function(a){a=k("#spc-gcpromoinput").length?k("#spc-gcpromoinput"):k("#gcpromoinput");var b=k("#apply-gc-button-container");0<k.trim(a.val()).length?b.removeClass("hidden"):b.hasClass("hidden")||b.addClass("hidden")});return 0>=k("div#gc-promo-delay").length?{showScanner:a.constants.NOOP}:
{showScanner:f}})});
/* ******** */
